<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€std::async å¼‚æ­¥ä»»åŠ¡åˆ›å»º</title>
    <link href="/2025/01/02/20250102/"/>
    <url>/2025/01/02/20250102/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æºï¼š<a href="https://www.pixiv.net/artworks/115126697">pixiv_id=115126697</a></p><h2 id="1-å¼‚æ­¥ä»»åŠ¡">1 å¼‚æ­¥ä»»åŠ¡</h2><p><strong>å¼‚æ­¥ä»»åŠ¡</strong>ï¼šä¸€ä¸ªä»»åŠ¡çš„æ‰§è¡Œä¸å½“å‰çº¿ç¨‹çš„æ‰§è¡Œæµç¨‹ä¸åŒæ­¥ã€‚</p><p>åœ¨ä¼ ç»Ÿçš„åŒæ­¥é—®é¢˜ä¸­ï¼Œè°ƒç”¨ä¸€ä¸ªå‡½æ•°éœ€è¦ç­‰å¾…å…¶æ‰§è¡Œå®Œæ¯•å¹¶è¿”å›ç»“æœåï¼Œåœ¨ç»§ç»­ä¸‹é¢çš„æ“ä½œã€‚ç„¶è€Œï¼Œå¼‚æ­¥ä»»åŠ¡åˆ™æ˜¯åœ¨è°ƒç”¨å‡½æ•°åï¼Œè°ƒç”¨è€…æ— éœ€ç­‰å¾…å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œå¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–çš„ä¸€äº›æ“ä½œã€‚</p><p>åœ¨ç°å®åœºæ™¯ä¸­ï¼Œå‡å¦‚æˆ‘è¦å‡†å¤‡ä»Šå¤©çš„æ™šé¤ï¼Œéœ€è¦åšå¾ˆå¤šé“èœï¼ˆè™½ç„¶æˆ‘å…¶å®ä¸€ç‚¹éƒ½ä¸ä¼šï¼‰ã€‚åŒæ­¥ä»»åŠ¡å°±æ˜¯éœ€è¦æ¯é“èœæŒ‰ç…§é¡ºåºåˆ¶ä½œï¼Œåšå®Œä¸€é“èœæ‰èƒ½åšä¸‹ä¸€é“ï¼›è€Œå¼‚æ­¥ä»»åŠ¡å°±æ˜¯æˆ‘å¯ä»¥åœ¨åšæŸäº›éœ€è¦é•¿æ—¶é—´ç‚–ç…®çš„èœæ—¶ï¼ŒåŒæ—¶å¯ä»¥å»ç‚’å‡ ä¸ªå…¶ä»–çš„èœï¼Œä¸éœ€è¦ç­‰å¾…ä¸€é“èœå®Œå…¨åšå¥½æ‰å¼€å§‹åšå…¶ä»–çš„èœã€‚</p><h2 id="2-std-async">2 std::async</h2><h3 id="2-1-åŸºæœ¬æ¦‚å¿µ">2.1 åŸºæœ¬æ¦‚å¿µ</h3><p><code>std::async</code> æ˜¯ C++ 11 å¼•å…¥çš„ä¸€ä¸ªå‡½æ•°æ¨¡æ¿ï¼Œç”¨äºå¼‚æ­¥åœ°å¯åŠ¨ä¸€ä¸ªå‡½æ•°ä»»åŠ¡ã€‚å®ƒä½äº <code>&lt;future&gt;</code>å¤´æ–‡ä»¶ä¸­ã€‚</p><p><code>std::async</code> å…è®¸ç¨‹åºåœ¨ä¸€ä¸ªå•ç‹¬çš„å­çº¿ç¨‹ä¸­æ‰§è¡ŒæŸä¸ªå‡½æ•°ï¼Œå¹¶å°†å‡½æ•°çš„ç»“æœè¿›è¡Œè¿”å›ï¼Œè€Œä¸”ä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹çš„æ‰§è¡Œã€‚<code>std::async</code> å¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ç§æ–°çš„ <code>std::thread</code>ï¼Œå¹¶ä¸”ç›¸æ¯”äºä¼ ç»Ÿçš„ <code>std::thread</code>ï¼Œå…¶ç®¡ç†æ›´åŠ ç®€å•ã€‚</p><p><code>std::async</code> çš„è¿”å›ç±»å‹æ˜¯ä¸€ä¸ª <code>std::future</code> ç±»å‹ã€‚<code>std::future</code> æ˜¯ C++ 11 ä¸­å¼•å…¥çš„ä¸€ä¸ªæ¨¡æ¿ç±»ï¼Œä½äº <code>&lt;future&gt;</code> å¤´æ–‡ä»¶ä¸­ï¼Œç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œçš„ç»“æœã€‚</p><p><a id='22'></a></p><h3 id="2-2-åŸºæœ¬ç”¨æ³•">2.2 åŸºæœ¬ç”¨æ³•</h3><p>åŸºæœ¬çš„è¯­æ³•ä¸º <code>std::future&lt;å‡½æ•°è¿”å›å€¼ç±»å‹&gt; async(å‡½æ•°è°ƒç”¨ç­–ç•¥, å‡½æ•°å, å‡½æ•°å‚æ•°åˆ—è¡¨);</code></p><p>ä¾‹å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„å‡½æ•° <code>foo()</code> å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>&#123;<br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>std::async</code> åˆ›å»ºä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c++">std::future&lt;<span class="hljs-type">int</span>&gt; res = std::<span class="hljs-built_in">async</span>(std::launch::async, foo, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>);<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ <code>std::launch::async</code> æ˜¯ <code>std::async</code> çš„æ‰§è¡Œç­–ç•¥ä¹‹ä¸€â€”â€”ç«‹å³æ‰§è¡Œå‡½æ•°ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨ <code>std::future::get()</code> æ¥è·å–å¼‚æ­¥ä»»åŠ¡è¿”å›çš„ç»“æœï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">auto</span> data = res.<span class="hljs-built_in">get</span>();<br></code></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç®€å•ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;future&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>&#123;<br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    std::future&lt;<span class="hljs-type">int</span>&gt; res = std::<span class="hljs-built_in">async</span>(std::launch::async, foo, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>);<br>    <span class="hljs-keyword">auto</span> data = res.<span class="hljs-built_in">get</span>();<br>    std::cout &lt;&lt; data &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ€ç»ˆçš„è¿”å›ç»“æœä¸º <code>3</code>ã€‚åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ <code>res</code>ï¼Œæ‰€æ‰§è¡Œçš„ç­–ç•¥ä¸º <code>std::launch::async</code>ï¼ˆè¡¨ç¤ºç«‹å³æ‰§è¡Œï¼‰ï¼Œæ‰§è¡Œçš„å‡½æ•°ä¸º <code>foo()</code>ã€‚ä¹‹åï¼Œè°ƒç”¨ <code>get()</code> å‡½æ•°è·å–å¼‚æ­¥ä»»åŠ¡çš„ç»“æœï¼Œå¹¶æœ€ç»ˆè¾“å‡ºç»“æœã€‚</p><h3 id="2-3-std-async-å‡½æ•°è°ƒç”¨ç­–ç•¥">2.3 std::async å‡½æ•°è°ƒç”¨ç­–ç•¥</h3><p><a id='231'></a></p><h4 id="2-3-1-std-launch-async">2.3.1 std::launch::async</h4><p><code>std::launch::async</code> ç­–ç•¥ä¼šä½¿å¾—å¼‚æ­¥ä»»åŠ¡ <strong>ç«‹å³</strong> åœ¨ <strong>ä¸€ä¸ªæ–°çš„å­çº¿ç¨‹</strong> ä¸­ <strong>å¼€å§‹æ‰§è¡Œ</strong>ã€‚åœ¨ <a href="#22">2.2 std::async åŸºæœ¬ç”¨æ³•</a> ä¸­çš„ç®€å•ä»£ç ç¤ºä¾‹ä¸­ï¼Œé‡‡ç”¨çš„å°±æ˜¯è¿™ä¸ªç­–ç•¥ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­å¢åŠ æ‰“å°çº¿ç¨‹ id çš„æ­¥éª¤ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;future&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::future&lt;<span class="hljs-type">int</span>&gt; res = std::<span class="hljs-built_in">async</span>(std::launch::async, foo, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>);<br>    <span class="hljs-keyword">auto</span> data = res.<span class="hljs-built_in">get</span>();    <br>    std::cout &lt;&lt; <span class="hljs-string">&quot;finally get the res = &quot;</span> &lt;&lt; data &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">main(): thread id = 0xb8<br>foo(): thread id = 0xbc<br>finally get the res = 3<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡º <code>foo()</code> åœ¨ä¸€ä¸ªæ–°çš„å­çº¿ç¨‹ä¸­ç«‹å³æ‰§è¡Œã€‚</p><p><a id='232'></a></p><h4 id="2-3-2-std-launch-deferred">2.3.2 std::launch::deferred</h4><p><code>std::launch::deferred</code> ç­–ç•¥ä¼šä½¿å¾—å¼‚æ­¥ä»»åŠ¡ <strong>å»¶è¿Ÿ</strong> æ‰§è¡Œå‡½æ•°ï¼Œç›´åˆ°æŸä¸ªåœ°æ–¹è°ƒç”¨äº† <code>std::future::get()</code> æˆ–è€… <code>std::future::wait()</code> å‡½æ•°ã€‚</p><p>å…¶ä¸­ <code>std::future::get()</code> å‡½æ•°è°ƒç”¨å <strong>ä¼šè·å–å¼‚æ­¥ä»»åŠ¡ç»“æœ</strong>ï¼›<code>std::future::wait()</code> å‡½æ•°è°ƒç”¨ååˆ™ <strong>ä¸ä¼šè·å–ç»“æœ</strong>ã€‚</p><p>å½“ä½¿ç”¨çš„æ˜¯ <code>std::launch::deferred</code> å»¶è¿Ÿæ‰§è¡Œçš„ç­–ç•¥æ—¶ï¼Œå¼‚æ­¥ä»»åŠ¡å»¶è¿Ÿåˆ°è°ƒç”¨ <code>get()</code> æˆ– <code>wait()</code> å†æ‰§è¡Œï¼Œæ­¤æ—¶ <strong>ä¸ä¼šå¼€å¯ä¸€ä¸ªæ–°çš„çº¿ç¨‹</strong> æ¥æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œå› æ­¤æ­¤æ—¶æœ¬è´¨ä¸Šå¹¶æ²¡æœ‰å¤šçº¿ç¨‹ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;future&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::future&lt;<span class="hljs-type">int</span>&gt; res = std::<span class="hljs-built_in">async</span>(std::launch::deferred, foo, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>);<br>    <span class="hljs-keyword">auto</span> data = res.<span class="hljs-built_in">get</span>();    <br>    std::cout &lt;&lt; <span class="hljs-string">&quot;finally get the res = &quot;</span> &lt;&lt; data &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œä»…æœ‰ <code>std::async</code> çš„æ‰§è¡Œç­–ç•¥æœ‰æ”¹åŠ¨ã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs txt">main(): thread id = 0xc4<br>foo(): thread id = 0xc4<br>finally get the res = 3<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œ<code>foo()</code> æ‰§è¡Œçš„çº¿ç¨‹å’Œä¸»çº¿ç¨‹ id ä¸€æ ·ï¼Œè¿™æ—¶å€™å¹¶æ²¡æœ‰å¼€å¯ä¸€ä¸ªæ–°çº¿ç¨‹æ¥æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ã€‚</p><h4 id="2-3-3-é»˜è®¤ç­–ç•¥">2.3.3 é»˜è®¤ç­–ç•¥</h4><p>å¦‚æœä¸æŒ‡å®šå‡½æ•°è°ƒç”¨ç­–ç•¥ï¼Œé»˜è®¤çš„ç­–ç•¥ä¸º <code>std::launch::async | std::launch::deferred</code>ã€‚</p><p>åœ¨ C++ 11 <code>std::future</code> çš„å®šä¹‰ä¸­ï¼Œ<code>std::async</code> çš„æ‰§è¡Œç­–ç•¥æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œ<code>std::launch::async</code> ä¸º <code>1</code>ï¼Œ<code>std::launch::deferred</code> ä¸º <code>2</code>ã€‚</p><p>å½“é‡‡ç”¨çš„æ˜¯é»˜è®¤çš„è°ƒç”¨ç­–ç•¥æ—¶ï¼Œç³»ç»Ÿè‡ªè¡Œå†³å®šä»¥å¼‚æ­¥æ–¹å¼è¿›è¡Œè¿˜æ˜¯åŒæ­¥æ–¹å¼è¿›è¡Œï¼š</p><ul><li>èµ„æºä¸ç´§å¼ æƒ…å†µä¸‹ï¼Œå¯èƒ½å°±åˆ›å»ºæ–°çº¿ç¨‹æ¥æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼ˆç›¸å½“äº <code>std::launch::async</code>ï¼‰</li><li>èµ„æºç´§å¼ ï¼Œå¯èƒ½ä¸åˆ›å»ºæ–°çº¿ç¨‹å¹¶å»¶è¿Ÿåˆ°è°ƒç”¨ <code>get()</code> æˆ– <code>wait()</code> æ‰æ‰§è¡Œçº¿ç¨‹å…¥å£å‡½æ•°ï¼ˆç›¸å½“äº <code>std::launch::deferred</code>ï¼‰ã€‚</li></ul><p>ä¸åŠ ç­–ç•¥å‚æ•°ä¹Ÿå°±æ˜¯å¦‚ä¸‹è¿™ç§å½¢å¼</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c++">std::future&lt;<span class="hljs-type">int</span>&gt; res = std::<span class="hljs-built_in">async</span>(foo, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">// ç³»ç»Ÿè‡ªè¡Œå†³å®šç­–ç•¥</span><br></code></pre></td></tr></table></figure><h3 id="2-4-std-future-ä¸åŒè·å–ç»“æœæœºåˆ¶">2.4 std::future ä¸åŒè·å–ç»“æœæœºåˆ¶</h3><h4 id="2-4-1-std-future-get">2.4.1 std::future::get()</h4><p><code>std::future::get()</code> è°ƒç”¨ä¹‹åï¼Œä¼šé˜»å¡å½“å‰çš„çº¿ç¨‹ï¼Œç›´åˆ°å¼‚æ­¥ä»»åŠ¡å®Œæˆå¹¶è¿”å›ç»“æœã€‚</p><p>è°ƒç”¨ <code>std::future::get()</code> è·å–ç»“æœä¹‹åï¼Œæ­¤æ—¶ç»“æœå·²ç»è¢«å–å‡ºï¼Œå°±ä¸èƒ½åœ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°äº†ã€‚</p><p>åœ¨ <a href="#231">2.3.1 std::launch::async</a> çš„ç¤ºä¾‹ä¸­ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨ <code>get()</code> å‡½æ•°åï¼Œæœ‰ä¸¤ç§æƒ…å†µï¼š</p><ul><li>å¯èƒ½å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œçš„æ¯”è¾ƒå¿«ï¼Œé‚£ä¹ˆä¼šç«‹å³è·å¾—ç»“æœï¼›</li><li>å¯èƒ½å¼‚æ­¥ä»»åŠ¡è¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œæ­¤æ—¶ <strong>ä¸»çº¿ç¨‹ä¼šè¿›å…¥é˜»å¡çŠ¶æ€</strong>ï¼Œç­‰å¾…å¼‚æ­¥ä»»åŠ¡å®Œæˆåï¼Œæ‰èƒ½ç»§ç»­è·å–ç»“æœã€‚</li></ul><p>ä¸åŒçš„æ˜¯ï¼Œåœ¨ <a href="#232">2.3.2 std::launch::deferred</a> çš„ç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨äº† <code>std::launch::deferred</code> çš„å»¶è¿Ÿè°ƒç”¨å‚æ•°ã€‚ä¸»çº¿ç¨‹è°ƒç”¨ <code>get()</code> ä¹‹åï¼Œç”±äºå¹¶æ²¡æœ‰åˆ›å»ºæ–°çš„çº¿ç¨‹æ‰§è¡Œ <code>foo()</code> å‡½æ•°ï¼Œå› æ­¤å®é™…ä¸Šè¿˜æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œæœ€ç»ˆè·å–ç»“æœã€‚</p><h4 id="2-4-2-std-future-wait">2.4.2 std::future::wait()</h4><p><code>std::future::wait()</code> è°ƒç”¨ä¹‹åï¼Œä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°å¼‚æ­¥ä»»åŠ¡å®Œæˆï¼Œ<strong>ä½†æ˜¯ä¸è¿”å›ç»“æœ</strong>ã€‚ä¸»è¦ç”¨äºéœ€è¦ç­‰å¾…ä»»åŠ¡å®Œæˆä½†ä¸éœ€è¦ç«‹å³è·å–ç»“æœçš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚</p><p>ä¸ <code>std::future::get()</code> ä¸åŒçš„æ˜¯ï¼Œ<code>std::future::wait()</code> æ˜¯å¯ä»¥é‡å¤è°ƒç”¨çš„ã€‚</p><p>åœ¨ <a href="#231">2.3.1 std::launch::async</a> çš„ç¤ºä¾‹ä¸­ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨ <code>wait()</code> å‡½æ•°åï¼Œå¯èƒ½å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œçš„æ¯”è¾ƒå¿«ï¼Œä¸»çº¿ç¨‹ä¸éœ€è¦ç­‰å¾…ï¼ˆä¸ä¼šè¢«é˜»å¡ï¼‰ï¼›ä¹Ÿå¯èƒ½å¼‚æ­¥ä»»åŠ¡è¿˜æœªæ‰§è¡Œå®Œã€‚ä¸»çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œç›´åˆ°å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œç»“æŸã€‚ä½†æ˜¯ï¼Œä¸¤ç§æƒ…å†µéƒ½ä¸ä¼šå³åˆ»è¿”å›ç»“æœã€‚</p><p>ä¸åŒçš„æ˜¯ï¼Œåœ¨ <a href="#232">2.3.2 std::launch::deferred</a> çš„ç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨äº† <code>std::launch::deferred</code> çš„å»¶è¿Ÿè°ƒç”¨å‚æ•°ã€‚ä¸»çº¿ç¨‹è°ƒç”¨ <code>wait()</code> ä¹‹åï¼Œå¹¶æ²¡æœ‰åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œå®é™…ä¸Šè¿˜æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œåªæ˜¯æœ€ç»ˆæš‚æ—¶ä¸è·å–ç»“æœã€‚</p><h2 id="3-std-async-å…·ä½“åˆ†æ">3 std::async å…·ä½“åˆ†æ</h2><p><a id='31'></a></p><h3 id="3-1-std-async-ç«‹å³æ‰§è¡Œåˆ†æ">3.1 std::async ç«‹å³æ‰§è¡Œåˆ†æ</h3><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ <code>std::async</code> <strong>ç«‹å³æ‰§è¡Œ</strong> çš„ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;future&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): starts calculating the res...&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">seconds</span>(<span class="hljs-number">4</span>));<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): ends calculating the res...&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œstd::launch::async ä¼šç«‹å³åœ¨ä¸€ä¸ªå­çº¿ç¨‹ä¸­å¼€å§‹æ‰§è¡Œ foo()</span><br>    std::future&lt;<span class="hljs-type">int</span>&gt; res = std::<span class="hljs-built_in">async</span>(std::launch::async, foo, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>);<br><br>    <span class="hljs-comment">// ä¸»çº¿ç¨‹ main() ä¸­åŒæ—¶å¯ä»¥åšä¸€äº›å…¶ä»–äº‹æƒ…</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): starts doing somethine else...&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">seconds</span>(<span class="hljs-number">2</span>));<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): ends doing something else...&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-comment">// (1) åœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨ get() è·å–ç»“æœï¼Œå¦‚æœ foo() è¿˜æœªæ‰§è¡Œå®Œï¼Œä¸»çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œç›´åˆ° foo() æ‰§è¡Œç»“æŸå¾—åˆ°ç»“æœ</span><br>    <span class="hljs-keyword">auto</span> data = res.<span class="hljs-built_in">get</span>();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;finally get the res = &quot;</span> &lt;&lt; data &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <span class="hljs-comment">// ç›´åˆ°è·å–ç»“æœæ‰ä¼šæ‰§è¡Œè¿™ä¸€å¥</span><br>    <span class="hljs-comment">// (2) å¦‚æœ foo() è¿˜æœªæ‰§è¡Œå®Œï¼Œä¸»çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œä½†æ˜¯ä¸è¿”å›ç»“æœ</span><br>    <span class="hljs-comment">// res.wait(); </span><br>    <span class="hljs-comment">// (3) å¦‚æœå‰é¢è°ƒç”¨ get() æˆ– wait()ï¼Œè¿™å¥ä¼šæœ€åæ‰§è¡Œï¼›å¦åˆ™ï¼Œè¿™å¥ä¼šå…ˆæ‰§è¡Œ</span><br>    <br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Kirisame Marisa.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>foo()</code> å‡½æ•°æ˜¯ä¸€ä¸ªéœ€è¦æ¶ˆè€—ä¸€å®šæ—¶é—´çš„å‡½æ•°ï¼ˆæ‰§è¡Œæ—¶é—´è®¾å®šä¸ºå¤§çº¦ <code>4</code> ç§’ï¼‰ã€‚</p><p>ä¸»çº¿ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸€å¼€å§‹åˆ›å»ºäº†ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ <code>res</code>ï¼Œè°ƒç”¨ç­–ç•¥å‚æ•°ä¸º <code>std::launch::async</code> å³ç«‹å³æ‰§è¡Œã€‚åœ¨åˆ›å»ºå¼‚æ­¥ä»»åŠ¡åç«‹å³æ‰§è¡Œï¼Œä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬åœ¨ä¸»çº¿ç¨‹ä¸­è¿˜æ¨¡æ‹Ÿåšäº†ä¸€äº›å…¶ä»–äº‹æƒ…ï¼ˆæ‰§è¡Œæ—¶é—´è®¾å®šä¸ºå¤§çº¦ <code>2</code> ç§’ï¼‰ã€‚</p><p>ä¹‹åæˆ‘ä»¬é‡‡ç”¨ä¸åŒçš„ç»“æœè·å–æœºåˆ¶è¿›è¡Œæµ‹è¯•ã€‚</p><p>æœ€åè¾“å‡ºä¸€ä¸ª <code>Kirisame Marisa</code> æç¤ºä¸»çº¿ç¨‹è¿›è¡Œçš„æ‰€æœ‰æ“ä½œç»“æŸâ­ã€‚</p><ol><li><p>å¦‚æœä¸»çº¿ç¨‹ä¸­è°ƒç”¨ <code>get()</code> è·å–ç»“æœã€‚ç”±äº <code>foo()</code> è¿˜æœªæ‰§è¡Œå®Œï¼Œä¸»çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œç›´åˆ° <code>foo()</code> æ‰§è¡Œç»“æŸæ‰å¾—åˆ°ç»“æœã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p> <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs txt">main(): thread id = 0xcc<br>main(): starts doing somethine else...<br>foo(): thread id = 0xd0<br>foo(): starts calculating the res...<br>main(): ends doing something else...<br>foo(): ends calculating the res...<br>finally get the res = 7<br>Kirisame Marisa.<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œä¸»çº¿ç¨‹åœ¨æ¨¡å‹æ‰§è¡Œå…¶ä»–æŸäº›æ“ä½œçš„åŒæ—¶ï¼Œå­çº¿ç¨‹ä¹Ÿåœ¨æ‰§è¡Œ <code>foo()</code> å‡½æ•°ï¼Œå½“ <code>main()</code> ä¸­æ¨¡æ‹Ÿå…¶ä»–æ“ä½œæ‰§è¡Œç»“æŸåç­‰å¾…äº†ä¸€æ®µæ—¶é—´ï¼ˆå¤§çº¦ <code>2</code> ç§’ï¼‰ï¼Œ<code>foo()</code> å‡½æ•°æ‰§è¡Œæ‰ç»“æŸï¼Œç„¶åè·å– <code>foo()</code> çš„è¿”å›ç»“æœã€‚</p></li><li><p>å¦‚æœä¸»çº¿ç¨‹ä¸­è°ƒç”¨ <code>wait()</code>ã€‚ç”±äº <code>foo()</code> æœªæ‰§è¡Œå®Œï¼Œä¸»çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œ<code>foo()</code> å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œå¹¶æ²¡æœ‰ç»“æœè·å–ã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p> <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs txt">main(): thread id = 0x5c<br>main(): starts doing somethine else...<br>foo(): thread id = 0xb4<br>foo(): starts calculating the res...<br>main(): ends doing something else...<br>foo(): ends calculating the res...<br>Kirisame Marisa.<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œä¸»çº¿ç¨‹ç¡®å®ä¹Ÿç­‰å¾…äº†å­çº¿ç¨‹æ‰§è¡Œ <code>foo()</code> å‡½æ•°ç»“æŸï¼ˆæœ€åæ‰è¾“å‡º <code>Kirisame Marisa</code>ï¼‰ã€‚ä¸è¿‡å¹¶æ²¡æœ‰è·å–ç»“æœã€‚</p></li><li><p>å¦‚æœä¸»çº¿ç¨‹ä¸­æ—¢æ²¡æœ‰è°ƒç”¨ <code>get()</code> æ–¹æ³•æˆ–è€… <code>wait()</code> æ–¹æ³•ã€‚ä¸»çº¿ç¨‹æ— è®ºå¦‚ä½•ä¹Ÿä¸ä¼šå»ç­‰å¾… <code>foo()</code> å‡½æ•°æ‰§è¡Œå®Œæ¯•ã€‚åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå¦‚æœä»€ä¹ˆä¹Ÿæ²¡æœ‰è°ƒç”¨ï¼Œé‚£ä¹ˆ <code>Kirisame Marisa</code> è¿™å¥è¯åœ¨ä¸»å‡½æ•°å‰é¢çš„å…¶ä»–æ“ä½œå®Œæˆä¹‹åå°±æ‰§è¡Œã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p> <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs txt">main(): thread id = 0xc4<br>main(): starts doing somethine else...<br>foo(): thread id = 0xc8<br>foo(): starts calculating the res...<br>main(): ends doing something else...<br>Kirisame Marisa.<br>foo(): ends calculating the res...<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œä¸»çº¿ç¨‹æ²¡æœ‰ç­‰å¾… <code>foo()</code> å‡½æ•°æ‰§è¡Œå®Œæ¯•å°±è¾“å‡ºäº† <code>Kirisame Marisa</code>ï¼Œè¿™è¡¨æ˜ä¸»çº¿ç¨‹æ²¡æœ‰è¢«é˜»å¡ã€‚</p></li></ol><h3 id="3-2-std-async-å»¶è¿Ÿæ‰§è¡Œåˆ†æ">3.2 std::async å»¶è¿Ÿæ‰§è¡Œåˆ†æ</h3><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ <code>std::async</code> <strong>å»¶è¿Ÿæ‰§è¡Œ</strong> çš„ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;future&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): starts calculating the res...&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">seconds</span>(<span class="hljs-number">4</span>));<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): ends calculating the res...&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œstd::launch::deferred ä¼šå»¶è¿Ÿæ‰§è¡Œ foo()ï¼Œç›´åˆ°æŸä¸ªè°ƒç”¨ get() æˆ– wait()</span><br>    std::future&lt;<span class="hljs-type">int</span>&gt; res = std::<span class="hljs-built_in">async</span>(std::launch::deferred, foo, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>);<br><br>    <span class="hljs-comment">// ä¸»çº¿ç¨‹ main() ä¸­åŒæ—¶å¯ä»¥åšä¸€äº›å…¶ä»–äº‹æƒ…</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): starts doing somethine else...&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">seconds</span>(<span class="hljs-number">2</span>));<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): ends doing something else...&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-comment">// (1) åœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨ get() æ‰å¼€å§‹æ‰§è¡Œ foo()ï¼Œå®é™…ä¸Šæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œæœ€åè·å–ç»“æœ</span><br>    <span class="hljs-keyword">auto</span> data = res.<span class="hljs-built_in">get</span>();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;finally get the res = &quot;</span> &lt;&lt; data &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <span class="hljs-comment">// ç›´åˆ°è·å–ç»“æœæ‰ä¼šæ‰§è¡Œè¿™ä¸€å¥</span><br>    <span class="hljs-comment">// (2) åœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨ get() æ‰å¼€å§‹æ‰§è¡Œ foo()ï¼Œä½†æœ€åä¸è·å–ç»“æœ</span><br>    <span class="hljs-comment">// res.wait(); </span><br>    <span class="hljs-comment">// (3) å¦‚æœå‰é¢ä¸è°ƒç”¨ get() æˆ– wait()ï¼Œfoo() å‹æ ¹ä¸ä¼šè¢«æ‰§è¡Œï¼Œä¼šç›´æ¥è¾“å‡ºè¿™ä¸€å¥</span><br>    <br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Kirisame Marisa.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸å‰é¢ <a href="#31">3.1 std::async ç«‹å³æ‰§è¡Œåˆ†æ</a> ä¸­çš„ä»£ç ä¸åŒçš„æ˜¯ï¼Œåˆ›å»ºå¼‚æ­¥ä»»åŠ¡æ—¶é‡‡ç”¨çš„è°ƒç”¨ç­–ç•¥ä¸º <code>std::launch::deferred</code>ã€‚</p><ol><li><p>å¦‚æœåœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨ <code>get()</code>ã€‚ç”±äºä½¿ç”¨äº† <code>std::launch::deferred</code> çš„å‚æ•°ï¼Œå¼‚æ­¥ä»»åŠ¡ä¼šåœ¨è°ƒç”¨ <code>get()</code> è¿™ä¸€è¡Œæ‰å¼€å§‹æ‰§è¡Œ <code>foo()</code>ï¼Œå®é™…ä¸Šæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œæœ€åè·å–ç»“æœã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p> <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs txt">main(): thread id = 0xc0<br>main(): starts doing somethine else...<br>main(): ends doing something else...<br>foo(): thread id = 0xc0<br>foo(): starts calculating the res...<br>foo(): ends calculating the res...<br>finally get the res = 7<br>Kirisame Marisa.<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œä¸»çº¿ç¨‹ id å’Œ æ‰§è¡Œ <code>foo()</code> çš„çº¿ç¨‹ id ä¸€æ ·ã€‚åœ¨ä¸»çº¿ç¨‹ä¸­æ¨¡æ‹Ÿçš„å…¶ä»–æ“ä½œç»“æŸä¹‹åï¼Œ<code>foo()</code> å‡½æ•°æ‰å¼€å§‹æ‰§è¡Œï¼Œç›¸å½“äºæ˜¯ä¸€ä¸ªä¸²è¡Œçš„ç¨‹åºã€‚æœ€ç»ˆè·å–ç»“æœï¼Œç»“å°¾è¾“å‡º <code>Kirisame Marisa</code> è¡¨ç¤ºç¨‹åºçš„ç»“æŸã€‚</p></li><li><p>å¦‚æœåœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨ <code>wait()</code>ã€‚ç”±äºä½¿ç”¨äº† <code>std::launch::deferred</code> çš„å‚æ•°ï¼Œå¼‚æ­¥ä»»åŠ¡ä¼šåœ¨è°ƒç”¨ <code>get()</code> è¿™ä¸€è¡Œæ‰å¼€å§‹æ‰§è¡Œ <code>foo()</code>ï¼Œä¸”åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œåªæ˜¯æœ€åä¸è·å–ç»“æœã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p> <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs txt">main(): thread id = 0xbc<br>main(): starts doing somethine else...<br>main(): ends doing something else...<br>foo(): thread id = 0xbc<br>foo(): starts calculating the res...<br>foo(): ends calculating the res...<br>Kirisame Marisa.<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œè¾“å‡ºçš„ç»“æœå’Œå‰é¢å·®ä¸å¤šï¼Œä¸è¿‡å°±æ˜¯æ²¡æœ‰è·å–ç»“æœè€Œå·²ã€‚</p></li><li><p>å¦‚æœä¸»çº¿ç¨‹ä¸­æ—¢æ²¡æœ‰è°ƒç”¨ <code>get()</code> æ–¹æ³•æˆ–è€… <code>wait()</code> æ–¹æ³•ã€‚ç”±äºä½¿ç”¨çš„æ—¶å»¶è¿Ÿè°ƒç”¨å‚æ•°ï¼ŒåŠ ä¸Šå‚æ•°åä¼šåœ¨è°ƒç”¨ <code>get()</code> æˆ–è€… <code>wait()</code> åæ‰§è¡Œ <code>foo()</code>ã€‚ä½†æ˜¯æˆ‘ä»¬ä»€ä¹ˆä¹Ÿæ²¡æœ‰åšï¼Œæ‰€ä»¥ <code>foo()</code> å‡½æ•°å‹æ ¹ä¸ä¼šæ‰§è¡Œã€‚ä¼šç›´æ¥è¾“å‡ºç»“å°¾çš„ <code>Kirisame Marisa</code>ã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p> <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">main(): thread id = 0xb4<br>main(): starts doing somethine else...<br>main(): ends doing something else...<br>Kirisame Marisa.<br></code></pre></td></tr></table></figure></li></ol><h3 id="3-3-std-async-å»¶è¿Ÿä¸€æ®µæ—¶é—´æ‰§è¡Œï¼ˆwait-for-ï¼‰">3.3 std::async å»¶è¿Ÿä¸€æ®µæ—¶é—´æ‰§è¡Œï¼ˆwait_for()ï¼‰</h3><p><code>std::future::wait_for()</code> æ˜¯ <code>std::future</code> ç±»ä¸­çš„ä¸€ä¸ªæˆå‘˜å‡½æ•°ï¼Œç”¨äºç­‰å¾…ä¸ <code>std::future</code> å¯¹è±¡å…³è”çš„å¼‚æ­¥ä»»åŠ¡å®Œæˆã€‚å®ƒä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€ï¼š</p><ul><li><strong>ç­‰å¾…æ—¶é—´è¶…æ—¶</strong>ï¼Œå‡½æ•°è¿”å›ï¼Œä¸ä¼šè·å–åˆ°ç»“æœã€‚çº¿ç¨‹ç»§ç»­æ‰§è¡Œå…¶ä»–æ“ä½œã€‚</li><li>åœ¨ <strong>ç­‰å¾…æ—¶é—´æœŸé™å†…</strong> å¼‚æ­¥ä»»åŠ¡å®Œæˆï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡ <code>std::future::get()</code> æ–¹æ³•è·å–ç»“æœã€‚</li></ul><p><strong>å‚æ•°</strong>ï¼š<code>std::future::wait_for()</code> æ¥å—çš„æ˜¯ä¸€ä¸ª <code>std::chrono::duration</code> ç±»å‹çš„æ—¶é—´é—´éš”å‚æ•°ã€‚</p><p><strong>è¿”å›å€¼</strong>ï¼šè¿”å› <code>std::future_status</code> ç±»å‹çš„æšä¸¾å€¼ï¼ˆæ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼‰ï¼Œè¯¥æšä¸¾æœ‰ä»¥ä¸‹ä¸‰ç§å¯èƒ½çš„å€¼ï¼š</p><ul><li><p><code>std::future_status::ready</code>ï¼šè¡¨ç¤ºä¸ <code>std::future</code> å…³è”çš„å¼‚æ­¥ä»»åŠ¡å·²ç»å®Œæˆï¼Œæ­¤æ—¶å¯ä»¥è°ƒç”¨ <code>get()</code> æ–¹æ³•è·å–ç»“æœã€‚</p></li><li><p><code>std::future_status::timeout</code>ï¼šè¡¨ç¤º <strong>ç­‰å¾…è¶…æ—¶</strong>ï¼Œå³è¶…è¿‡äº†æŒ‡å®šçš„ç­‰å¾…æ—¶é—´æœŸé™ï¼Œä½†å¼‚æ­¥ä»»åŠ¡è¿˜æ²¡æœ‰å®Œæˆã€‚</p></li><li><p><code>std::future_status::deferred</code>ï¼šå½“ <code>std::async</code> é‡‡ç”¨ <code>std::launch::deferred</code> è°ƒç”¨ç­–ç•¥å¯åŠ¨å¼‚æ­¥ä»»åŠ¡æ—¶ï¼Œå¼‚æ­¥ä»»åŠ¡ä¼šåœ¨è°ƒç”¨ <code>get()</code> æˆ– <code>wait()</code> æ–¹æ³•æ—¶æ‰æ‰§è¡Œã€‚<code>std::future_status::deferred</code> çš„æƒ…å†µæ„å‘³ç€ <strong>ä»»åŠ¡å°šæœªå¼€å§‹æ‰§è¡Œ</strong>ã€‚</p></li></ul><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ <code>wait_for()</code> çš„ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;future&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>&#123; <br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): starts caculating the res...&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">seconds</span>(<span class="hljs-number">2</span>)); <span class="hljs-comment">// foo() éœ€è¦æ‰§è¡Œå¤§æ¦‚ 2 ç§’</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): ends caculating the res...&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br><span class="hljs-comment">// (1) åˆ›å»ºä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡</span><br><span class="hljs-comment">// (1.1) std::launch::async ä¼šç«‹å³æ‰§è¡Œ foo()ï¼Œwait_for() å¯èƒ½è¶…æ—¶ï¼Œå¯èƒ½æˆåŠŸè·å–ç»“æœ</span><br>    std::future&lt;<span class="hljs-type">int</span>&gt; res = std::<span class="hljs-built_in">async</span>(std::launch::async, foo, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>);<br>    <span class="hljs-comment">// (1.2) std::launch::deferred ä¼šå»¶è¿Ÿæ‰§è¡Œ foo()ï¼Œç›´åˆ°æŸä¸ªè°ƒç”¨ get() æˆ– wait()ï¼Œwait_for() ä¸èµ·ä½œç”¨</span><br>    <span class="hljs-comment">// std::future&lt;int&gt; res = std::async(std::launch::deferred, foo, 3, 4);</span><br><span class="hljs-comment">// (1.3) é»˜è®¤æƒ…å†µï¼ˆstd::launch::async | std::launch::deferredï¼‰ï¼Œåˆ™ä¸ç¡®å®šä¸º (1.1) è¿˜æ˜¯ (1.2)</span><br><span class="hljs-comment">// std::future&lt;int&gt; res = std::async(foo, 3, 4);</span><br><br><span class="hljs-keyword">auto</span> get_data = [&amp;](std::future&lt;<span class="hljs-type">int</span>&gt;&amp; res)&#123;<br><span class="hljs-keyword">auto</span> data = res.<span class="hljs-built_in">get</span>();<br>std::cout &lt;&lt; <span class="hljs-string">&quot;finally get the res = &quot;</span> &lt;&lt; data &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;;<br><br><span class="hljs-comment">// (2) æšä¸¾ç±»å‹ï¼Œåˆ¤æ–­ res çš„çŠ¶æ€</span><br><span class="hljs-comment">// std::future_status status = res.wait_for(std::chrono::seconds(1)); // ç­‰å¾… 1 ç§’ï¼Œè¶…æ—¶</span><br>std::future_status status = res.<span class="hljs-built_in">wait_for</span>(std::chrono::<span class="hljs-built_in">seconds</span>(<span class="hljs-number">3</span>)); <span class="hljs-comment">// ç­‰å¾… 3 ç§’ï¼ŒæˆåŠŸè·å–ç»“æœ</span><br><span class="hljs-keyword">if</span>(status == std::future_status::timeout)&#123;<br><span class="hljs-comment">// (2.1) foo() è¿˜æœªæ‰§è¡Œå®Œæˆï¼Œè¶…è¿‡ç­‰å¾…æ—¶é—´ï¼Œæ²¡æœ‰è¿”å›ç»“æœï¼Œè¶…æ—¶</span><br>std::cout &lt;&lt; <span class="hljs-string">&quot;WARNING: time out&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(status == std::future_status::ready)&#123;<br><span class="hljs-comment">// (2.2) foo() åœ¨ç­‰å¾…æ—¶é—´å†…æ‰§è¡Œå®Œæ¯•ï¼Œå¯ä»¥è·å–ç»“æœï¼ˆå‚æ•°ä¸º std::launch::asyncï¼‰</span><br>std::cout &lt;&lt; <span class="hljs-string">&quot;successfully get result.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-built_in">get_data</span>(res);<br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(status == std::future_status::deferred)&#123;<br><span class="hljs-comment">// (2.3) å‚æ•°ä¸º std::launch::deferred å°±ä¼šå‡ºç°æ­¤æƒ…å†µ </span><br>std::cout &lt;&lt; <span class="hljs-string">&quot;thread is deferred.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-built_in">get_data</span>(res);<br>&#125;<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>foo()</code> éœ€è¦æ‰§è¡Œå¤§æ¦‚ <code>2</code> ç§’ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹© <code>wait_for()</code> ç­‰å¾… <code>1</code> ç§’æˆ–è€… <code>3</code> ç§’ã€‚</p><ol><li><p>å¦‚æœä½¿ç”¨ <code>std::launch::async</code> ä½œä¸ºè°ƒç”¨ç­–ç•¥ï¼š</p><ul><li><p>å¦‚æœé€‰æ‹©ç­‰å¾… <code>1</code> ç§’çš„æ—¶é—´ï¼Œè¿™ä¸ªæ—¶é—´æ˜¯å°äºå¼‚æ­¥ä»»åŠ¡æ‰§è¡Œ <code>foo()</code> æ‰€éœ€æ—¶é—´çš„ï¼Œæ•…æ­¤æ—¶ä¼šè¶…æ—¶ï¼Œè¿›å…¥ä»£ç ä¸­æ³¨é‡Š <code>(2.1)</code> çš„æƒ…å†µã€‚</p><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>  <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs txt">main(): thread id = 0xac<br>foo(): thread id = 0xbc<br>foo(): starts caculating the res...<br>WARNING: time out<br>foo(): ends caculating the res...<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œç­‰å¾…è¶…æ—¶äº†ï¼Œä¸è¿‡å¼‚æ­¥ä»»åŠ¡è¿˜æ˜¯ä¼šå°† <code>foo()</code> æ‰§è¡Œç»“æŸã€‚</p></li><li><p>å¦‚æœé€‰æ‹©ç­‰å¾… <code>3</code> ç§’çš„æ—¶é—´ï¼Œè¿™ä¸ªæ—¶é—´æ˜¯å¤§äºå¼‚æ­¥ä»»åŠ¡æ‰§è¡Œ <code>foo()</code> æ‰€éœ€æ—¶é—´çš„ï¼Œæ•…æ­¤æ—¶èƒ½å¤Ÿåœ¨ç­‰å¾…çš„æ—¶é—´æœŸé™å†…è·å–ç»“æœï¼ˆæƒ…å†µ <code>(2.2)</code>ï¼‰ã€‚</p><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>  <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs txt">main(): thread id = 0xc8<br>foo(): thread id = 0xcc<br>foo(): starts caculating the res...<br>foo(): ends caculating the res...<br>successfully get result.<br>finally get the res = 7<br></code></pre></td></tr></table></figure></li></ul></li><li><p>å¦‚æœä½¿ç”¨ <code>std::launch::deferred</code> ä½œä¸ºè°ƒç”¨ç­–ç•¥ï¼š</p><p>æ­¤æ—¶ç”±äºä¼šåœ¨è°ƒç”¨ <code>get()</code> æˆ– <code>wait()</code> æ‰å¼€å§‹æ‰§è¡Œï¼Œå› æ­¤æ— è®ºç­‰å¾…å¤šå°‘ç§’ï¼Œéƒ½ä¼šè¿›å…¥ <code>(2.3)</code> çš„æƒ…å†µï¼Œå³ <code>foo()</code> åœ¨è°ƒç”¨ <code>get()</code> æ—¶æ‰å¼€å§‹æ‰§è¡Œï¼Œæœ€ç»ˆè·å–ç»“æœã€‚</p><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p> <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs txt">main(): thread id = 0xc8<br>thread is deferred.<br>foo(): thread id = 0xc8<br>foo(): starts caculating the res...<br>foo(): ends caculating the res...<br>finally get the res = 7<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œåœ¨ <code>foo()</code> è¢«æ‰§è¡Œä¹‹å‰ï¼Œæ¡ä»¶åˆ¤æ–­è¾“å‡º <code>thread is deferred.</code>ï¼Œè¡¨æ˜è¿™ä¸ªæ—¶å€™æ˜¯å»¶è¿Ÿæ‰§è¡Œçš„ã€‚</p></li><li><p>å¦‚æœä¸å¢åŠ è°ƒç”¨ç­–ç•¥å‚æ•°ï¼š</p><p>é‚£ä¹ˆç³»ç»Ÿä¼šæ ¹æ®å®é™…æƒ…å†µé€‰æ‹©ç­–ç•¥ã€‚æ­¤æ—¶ç»“æœå°±ä¸ç¡®å®šäº†ã€‚</p></li></ol><h2 id="4-std-async-å’Œ-std-thread-åŒºåˆ«">4 std::async å’Œ std::thread åŒºåˆ«</h2><p>ç›¸æ¯”äº <code>std::thread</code>ï¼Œ<code>std::async</code> æä¾›äº†æ›´åŠ é«˜çº§çš„å¼‚æ­¥æ“ä½œæ¥å£ã€‚</p><ul><li><p>çº¿ç¨‹çš„ç®¡ç†</p><p><code>std::async</code> çš„å¦‚çº¿ç¨‹çš„åˆ›å»ºã€é”€æ¯ä»¥åŠèµ„æºå›æ”¶ç­‰æ“ä½œæ˜¯è¢«éšè—çš„ï¼Œè¿™ç§æŠ½è±¡ä½¿å¾—ç¨‹åºå‘˜å¯ä»¥æ›´ä¸“æ³¨äºä»»åŠ¡æœ¬èº«å’Œç»“æœçš„è·å–ï¼Œè€Œä¸éœ€è¦æ·±å…¥è€ƒè™‘çº¿ç¨‹çš„åº•å±‚æ“ä½œã€‚</p><p><code>std::thread</code> éœ€è¦åˆç†çš„ç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼Œéœ€è¦ç¡®ä¿çº¿ç¨‹åœ¨å¯¹è±¡é”€æ¯ä¹‹å‰å·²ç»æ­£ç¡®åœ°å®Œæˆï¼ˆ<code>std::thread::join()</code>ï¼‰æˆ–è€…åˆ†ç¦»ï¼ˆ<code>std::thread::detach()</code>ï¼‰ã€‚</p></li><li><p>è¿”å›å€¼çš„å¤„ç†</p><p><code>std::async</code> ä¸»è¦ç”¨äºæ‰§è¡Œä¸€ä¸ªæœ‰è¿”å›å€¼çš„ä»»åŠ¡ï¼Œå¹¶é€šè¿‡ <code>std::future</code> å¯¹è±¡æ–¹ä¾¿åœ°è·å–è¿”å›å€¼ã€‚</p><p><code>std::thread</code> æœ¬èº«æ²¡æœ‰å†…ç½®çš„æœºåˆ¶æ¥è·å–çº¿ç¨‹å‡½æ•°çš„è¿”å›å€¼ã€‚é€šå¸¸æˆ‘ä»¬éœ€è¦è®¾å®šä¸€ä¸ª <strong>å…±äº«æ•°æ®å˜é‡</strong>ï¼Œå¹¶ä¸”ä½¿ç”¨äº’æ–¥æ“ä½œç»´æŠ¤å˜é‡çš„å€¼ï¼ˆæˆ–è€…ç®€å•çš„æƒ…å†µä¸‹ä½¿ç”¨åŸå­æ“ä½œ <code>std::atomic</code>ï¼‰ã€‚</p></li><li><p>çº¿ç¨‹æ‰§è¡Œç­–ç•¥å’Œçµæ´»æ€§</p><p><code>std::async</code> æœ‰å¤šç§æ‰§è¡Œç­–ç•¥ï¼ˆä¸»è¦åˆ†ä¸º <code>std::launch::async</code> å’Œ<code>std::launch::deferred</code>ï¼‰ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚æ¥æ§åˆ¶ä»»åŠ¡çš„æ‰§è¡Œæ—¶æœºã€‚</p><p><code>std::thread</code> ä¸€æ—¦å¯åŠ¨å°±ä¼šç«‹å³æ‰§è¡Œä»»åŠ¡ã€‚</p></li></ul><p>æ€»çš„æ¥è¯´ï¼Œ<code>std::async</code> é€‚åˆç”¨äºæ‰§è¡Œä¸€äº›æœ‰è¿”å›å€¼çš„ä»»åŠ¡ï¼Œå¹¶ä¸”å¸Œæœ›æ–¹ä¾¿åœ°è·å–ç»“æœçš„æƒ…å†µï¼›<code>std::thread</code> é€‚åˆç”¨äºæ‰§è¡Œä¸€äº›ä¸éœ€è¦è¿”å›å€¼æˆ–è€…å¯¹è¿”å›å€¼è·å–æœºåˆ¶è¦æ±‚ä¸é«˜çš„ä»»åŠ¡ã€‚</p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ol><li><p><a href="https://en.cppreference.com/w/cpp/thread/async">std::async</a></p></li><li><p><a href="https://en.cppreference.com/w/cpp/thread/future/get">std::future::get()</a></p></li><li><p><a href="https://en.cppreference.com/w/cpp/thread/future/wait">std::future::wait()</a></p></li><li><p><a href="https://en.cppreference.com/w/cpp/thread/future/wait_for">std::future::wait_for()</a></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
      <tag>std::future</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜åŠ std::condition_variable</title>
    <link href="/2025/01/01/20250101/"/>
    <url>/2025/01/01/20250101/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æºï¼š<a href="https://www.pixiv.net/artworks/125244936">pixiv_id=125244936</a></p><h2 id="å…ƒæ—¦å¿«ä¹ï¼ğŸ‰ğŸ¤—">å…ƒæ—¦å¿«ä¹ï¼ğŸ‰ğŸ¤—</h2><h2 id="1-é—®é¢˜èƒŒæ™¯">1 é—®é¢˜èƒŒæ™¯</h2><h3 id="1-1-ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜">1.1 ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜</h3><p><a id='111'></a></p><h4 id="1-1-1-å®šä¹‰">1.1.1 å®šä¹‰</h4><p><strong>ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜</strong>ï¼ˆProducer - Consumer Problemï¼‰æ˜¯ä¸€ä¸ªç»å…¸çš„å¤šçº¿ç¨‹å¹¶å‘ç¼–ç¨‹é—®é¢˜ã€‚è¿™ä¸ªé—®é¢˜æè¿°äº†åœ¨ä¸€ä¸ªå…±äº«ç¼“å†²åŒºç¯å¢ƒä¸‹ï¼Œä¸¤ç±»çº¿ç¨‹ï¼ˆåˆ†åˆ«ä¸º <strong>ç”Ÿäº§è€…</strong> å’Œ <strong>æ¶ˆè´¹è€…</strong>ï¼‰ä¹‹é—´çš„åä½œå…³ç³»ã€‚</p><p><strong>ç”Ÿäº§è€…</strong>ï¼šè´Ÿè´£ç”Ÿæˆæ•°æ®ï¼Œå¹¶å°†æ•°æ®æ”¾å…¥å…±äº«ç¼“å†²åŒºï¼›</p><p><strong>æ¶ˆè´¹è€…</strong>ï¼šä»å…±äº«ç¼“å†²åŒºä¸­å–å‡ºæ•°æ®ï¼Œå¹¶è¿›è¡Œä¸€ç³»åˆ—æ“ä½œã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªç”œå“åº—ä¸­ï¼Œç”œç‚¹å¸ˆï¼ˆç”Ÿäº§è€…ï¼‰åˆ¶ä½œç”œç‚¹å¹¶ä¸”å°†å…¶æ”¾åœ¨å±•ç¤ºæ¶ï¼ˆç¼“å†²åŒºï¼‰ï¼Œé¡¾å®¢ï¼ˆæ¶ˆè´¹è€…ï¼‰ä»å±•ç¤ºæ¶ï¼ˆç¼“å†²åŒºï¼‰ä¸Šæ‹¿èµ°ç”œç‚¹å¹¶è´­ä¹°æ¶ˆè´¹ã€‚</p><h4 id="1-1-2-é—®é¢˜çº¦æŸ">1.1.2 é—®é¢˜çº¦æŸ</h4><ol><li><p>å…±äº«ç¼“å†²åŒºé€šå¸¸æœ‰ä¸€ä¸ªå›ºå®šçš„å¤§å°ï¼›</p></li><li><p>åŒæ­¥é—®é¢˜ï¼š</p><p>ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„é€Ÿåº¦å¯èƒ½ä¸åŒã€‚ç”Ÿäº§è€…å¯èƒ½ç”Ÿäº§æ•°æ®çš„é€Ÿåº¦æ¯”æ¶ˆè´¹è€…æ¶ˆè´¹æ•°æ®å¿«ï¼Œå¯¼è‡´ç¼“å†²åŒºè¢«å¡«æ»¡ï¼Œæ­¤æ—¶è¦ç­‰å¾…æ¶ˆè´¹è€…æ¶ˆè´¹ä¸€äº›æ•°æ®ï¼›åä¹‹ï¼Œæ¶ˆè´¹è€…å¯èƒ½æ¶ˆè´¹æ•°æ®çš„é€Ÿåº¦æ›´å¿«ï¼Œç¼“å†²åŒºå¯èƒ½å‡ºç°ç©ºçš„æƒ…å†µï¼Œé‚£ä¹ˆæ¶ˆè´¹è€…è¦ç­‰å¾…ç”Ÿäº§è€…æ”¾å…¥æ•°æ®ã€‚</p><ul><li><p>å½“ç¼“å†²åŒºå·²æ»¡æ—¶ï¼Œ<strong>ç”Ÿäº§è€…</strong> éœ€è¦ç­‰å¾… <strong>æ¶ˆè´¹è€…</strong> å–å‡ºæ•°æ®åï¼Œæ‰èƒ½ç»§ç»­æ”¾å…¥æ•°æ®ï¼›</p></li><li><p>å½“ç¼“å†²åŒºä¸ºç©ºæ—¶ï¼Œ<strong>æ¶ˆè´¹è€…</strong> éœ€è¦ç­‰å¾… <strong>ç”Ÿäº§è€…</strong> æ”¾å…¥æ•°æ®åï¼Œæ‰èƒ½ç»§ç»­å–å‡ºæ•°æ®ï¼›</p></li></ul></li><li><p>äº’æ–¥é—®é¢˜ï¼š</p><p>å…±äº«ç¼“å†²åŒºåŒä¸€æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è®¿é—®ã€‚ä¸¤ç±»çº¿ç¨‹å¯¹å…±äº«ç¼“å†²åŒºéœ€è¦äº’æ–¥è®¿é—®ã€‚å¦‚æœä¸è¿›è¡Œäº’æ–¥è®¿é—®ï¼Œä¼šé€ æˆæ•°æ®ç«äº‰ã€æ•°æ®ä¸ä¸€è‡´ç­‰é—®é¢˜ã€‚</p></li></ol><h3 id="1-2-ä»…ç”¨äº’æ–¥é”å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…">1.2 ä»…ç”¨äº’æ–¥é”å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…</h3><h4 id="1-2-1-å®ç°æ€è·¯å’Œä»£ç ">1.2.1 å®ç°æ€è·¯å’Œä»£ç </h4><p>å¯¹äºä¸Šé¢ <a href="#111">1.1.1 ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ å®šä¹‰</a> çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨ <strong>äº’æ–¥é”</strong> æ¥ç¡®ä¿ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å¯¹å…±äº«ç¼“å†²åŒºçš„äº’æ–¥è®¿é—®ã€‚</p><p>é‚£ä¹ˆï¼Œæ€ä¹ˆå¤„ç†ä¸¤ç±»çº¿ç¨‹çš„åŒæ­¥é—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å…ˆè€ƒè™‘ä¸€ç§æ¯”è¾ƒä½æ•ˆçš„æ–¹æ³•ï¼š</p><ul><li><p>å¦‚æœ <strong>ç”Ÿäº§è€…</strong> çº¿ç¨‹è·å¾—é”ä¹‹åï¼Œå‘ç°ç¼“å†²åŒºå·²æ»¡ï¼Œé‚£ä¹ˆå°±å…ˆé‡Šæ”¾é”ï¼Œä¼‘æ¯ä¸€æ®µæ—¶é—´ã€‚åœ¨ä¼‘æ¯çš„æ—¶é—´æ®µå†…ï¼Œ<strong>æ¶ˆè´¹è€…</strong> çº¿ç¨‹æœ‰æœºä¼šè·å¾—é”å¹¶æ¶ˆè´¹æ•°æ®ï¼›</p></li><li><p>å¦‚æœ <strong>æ¶ˆè´¹è€…</strong> çº¿ç¨‹è·å¾—é”ä¹‹åï¼Œå‘ç°ç¼“å†²åŒºä¸ºç©ºï¼Œé‚£ä¹ˆå°±å…ˆé‡Šæ”¾é”ï¼Œä¼‘æ¯ä¸€æ®µæ—¶é—´ã€‚åœ¨ä¼‘æ¯çš„æ—¶é—´æ®µå†…ï¼Œ<strong>ç”Ÿäº§è€…</strong> çº¿ç¨‹æœ‰æœºä¼šè·å¾—é”å¹¶ç”Ÿäº§æ•°æ®ã€‚</p></li></ul><p>ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªç®€æ˜“çš„ ç”Ÿäº§è€…-æ¶ˆè´¹è€… ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;condition_variable&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><br>std::mutex mtx;         <span class="hljs-comment">// äº’æ–¥é‡</span><br>std::queue&lt;<span class="hljs-type">int</span>&gt; buffer; <span class="hljs-comment">// å…±äº«ç¼“å†²åŒº</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> buffer_size = <span class="hljs-number">10</span>; <span class="hljs-comment">// ç¼“å†²åŒºå¤§å°é™åˆ¶</span><br><br><span class="hljs-comment">// ç”Ÿäº§è€…å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">producer</span><span class="hljs-params">(<span class="hljs-type">int</span> data_num)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= data_num; i ++ )&#123;<br>        <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>        <span class="hljs-keyword">if</span>(buffer.<span class="hljs-built_in">size</span>() &lt; buffer_size)&#123; <span class="hljs-comment">// å¯ä»¥æ”¾å…¥æ•°æ®</span><br>            buffer.<span class="hljs-built_in">push</span>(i);<br>            std::cout &lt;&lt; <span class="hljs-string">&quot;Produced: &quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123; <span class="hljs-comment">// ç¼“å†²åŒºå·²æ»¡</span><br>            lck.<span class="hljs-built_in">unlock</span>(); <span class="hljs-comment">// å…ˆè§£é”</span><br>            <span class="hljs-comment">// ä¼‘æ¯ä¸€æ®µæ—¶é—´å†å°è¯•</span><br>            std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>)); <br>            i -- ; <span class="hljs-comment">// å›é€€</span><br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// æ¶ˆè´¹è€…å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">consumer</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br>        <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>        <span class="hljs-keyword">if</span>(!buffer.<span class="hljs-built_in">empty</span>())&#123; <span class="hljs-comment">// å¯ä»¥æ¶ˆè´¹æ•°æ®</span><br>            <span class="hljs-type">int</span> data = buffer.<span class="hljs-built_in">front</span>();<br>            buffer.<span class="hljs-built_in">pop</span>();<br>            std::cout &lt;&lt; <span class="hljs-string">&quot;Consumed: &quot;</span> &lt;&lt; data &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>            lck.<span class="hljs-built_in">unlock</span>(); <span class="hljs-comment">// æå‰è§£é”</span><br>            <span class="hljs-comment">// æ¨¡æ‹Ÿä¸ cv æ— å…³çš„æ•°æ®æ“ä½œ</span><br>            std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            lck.<span class="hljs-built_in">unlock</span>(); <span class="hljs-comment">// å…ˆè§£é”</span><br>            <span class="hljs-comment">// ä¼‘æ¯ä¸€æ®µæ—¶é—´å†å°è¯•</span><br>            std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>)); <br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">producer_thread</span><span class="hljs-params">(producer, <span class="hljs-number">100</span>)</span></span>;<br>    <span class="hljs-function">std::thread <span class="hljs-title">consumer_thread</span><span class="hljs-params">(consumer)</span></span>;<br>    producer_thread.<span class="hljs-built_in">join</span>();<br>    consumer_thread.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„éƒ¨åˆ†è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2025/01/01/12xf5o.png" alt=""></p><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œä½¿ç”¨ <code>std::queue</code> æ¥æ¨¡æ‹Ÿå…±äº«ç¼“å†²åŒºï¼Œç¼“å†²åŒºçš„å¤§å°è®¾å®šä¸º <code>10</code>ã€‚</p><p>åœ¨ç”Ÿäº§è€…å‡½æ•°ä¸­ï¼Œè¿›è¡Œ <code>data_num</code> æ¬¡å¾ªç¯ï¼Œæ¯æ¬¡å¾ªç¯ç”Ÿäº§ä¸€ä¸ªæ•°æ®ã€‚ç”±äºéœ€è¦ä¸€äº›æå‰è§£é”ç„¶åä¼‘æ¯çš„æ“ä½œï¼Œå› æ­¤é‡‡ç”¨äº† <code>std::unique_lock</code> æ›´åŠ çµæ´»åœ°å¤„ç†åŠ é”ã€è§£é”ã€‚å¦‚æœç¼“å†²åŒºæœªæ»¡ï¼Œé‚£ä¹ˆå¯ä»¥æ”¾å…¥æ•°æ®ï¼›å¦åˆ™ï¼Œå…ˆè§£é”ï¼Œç„¶åä¼‘æ¯ä¸€æ®µæ—¶é—´ï¼Œä½¿å¾—æ¶ˆè´¹è€…çº¿ç¨‹æœ‰æœºä¼šè·å¾—é”ã€‚</p><p>åœ¨æ¶ˆè´¹è€…å‡½æ•°ä¸­ï¼Œæ¶ˆè´¹è€…ä¸æ–­æ¶ˆè´¹æ•°æ®ã€‚ä¹Ÿé‡‡ç”¨äº† <code>std::unique_lock</code> å¤„ç†åŠ é”ã€è§£é”ã€‚å¦‚æœç¼“å†²åŒºä¸ä¸ºç©ºï¼Œé‚£ä¹ˆå¯ä»¥å–å‡ºæ•°æ®ï¼Œå–å‡ºæ•°æ®åï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦å¯¹æ•°æ®è¿›è¡Œä¸€äº›å¤„ç†ç­‰æ“ä½œï¼Œå¹¶ä¸”è¿™äº›æ“ä½œä¸éœ€è¦äº’æ–¥é‡ç»´æŠ¤ï¼Œé‚£ä¹ˆå¯ä»¥å…ˆæå‰è§£é”ï¼Œç„¶åå†è¿›è¡Œå¯¹æ•°æ®çš„ä¸€ç³»åˆ—æ“ä½œï¼›å¦åˆ™ï¼Œå…ˆè§£é”ï¼Œç„¶åä¼‘æ¯ä¸€æ®µæ—¶é—´ï¼Œä½¿å¾—ç”Ÿäº§è€…çº¿ç¨‹æœ‰æœºä¼šè·å¾—é”ã€‚</p><h4 id="1-2-2-å­˜åœ¨çš„é—®é¢˜">1.2.2 å­˜åœ¨çš„é—®é¢˜</h4><p>å¯ä»¥çœ‹å‡ºï¼Œâ€œä¼‘æ¯ä¸€æ®µæ—¶é—´â€ çš„åšæ³•æ˜¾ç„¶æ˜¯æ¯”è¾ƒä½æ•ˆçš„ï¼Œä¸»è¦é—®é¢˜åœ¨äºï¼š</p><ul><li><p><strong>å¿™ç­‰å¾…</strong>ï¼šç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…åœ¨æ— æ³•ç»§ç»­æ“ä½œæ—¶é€šè¿‡ä¼‘çœ æ¥ç­‰å¾…ç¼“å†²åŒºçŠ¶æ€æ”¹å˜ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šä¼‘çœ å¾ˆå¤šæ¬¡ï¼Œè¿™å°±å¯¼è‡´äº†èµ„æºçš„æµªè´¹ã€‚</p></li><li><p><strong>ç¼ºå°‘åŒæ­¥æœºåˆ¶</strong>ï¼šç”Ÿäº§è€…å’Œæ¶ˆè´¹è€… <strong>ä¸çŸ¥é“ä½•æ—¶</strong> å» <strong>ç­‰å¾…</strong> æˆ– <strong>ç»§ç»­å·¥ä½œ</strong>ã€‚ç¼“å†²åŒºä¸­æœ‰æ•°æ®äº†ï¼Œæ— æ³•åŠæ—¶é€šçŸ¥æ¶ˆè´¹è€…å¯ä»¥æ¶ˆè´¹æ•°æ®ï¼›ç¼“å†²åŒºæœ‰ç©ºç¼ºäº†ï¼Œä¹Ÿæ— æ³•åŠæ—¶é€šçŸ¥ç”Ÿäº§è€…å¯ä»¥æ”¾å…¥æ•°æ®ã€‚</p></li></ul><p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼ŒC++11 å¼•å…¥äº† <strong>æ¡ä»¶å˜é‡</strong> std::condition_variableã€‚</p><p><a id='2'></a></p><h2 id="2-std-condition-variable">2 std::condition_variable</h2><h3 id="2-1-åŸºæœ¬æ¦‚å¿µ">2.1 åŸºæœ¬æ¦‚å¿µ</h3><p><code>std::condition_variable</code> æ˜¯ C++11 å¼•å…¥çš„ä¸€ä¸ªç±»ï¼Œåœ¨å¤´æ–‡ä»¶ <code>&lt;condition_variable&gt;</code> ä¸­ï¼Œä¸»è¦ç”¨äº <strong>çº¿ç¨‹é—´çš„åŒæ­¥</strong>ã€‚<code>std::condition_variable</code> åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­å®ç°çº¿ç¨‹ä¹‹é—´çš„ç­‰å¾…å’Œé€šçŸ¥æœºåˆ¶æœ‰ç€é‡è¦ä½œç”¨ã€‚</p><h3 id="2-2-æˆå‘˜å‡½æ•°å’ŒåŸºæœ¬ç”¨æ³•">2.2 æˆå‘˜å‡½æ•°å’ŒåŸºæœ¬ç”¨æ³•</h3><p><a id='221'></a></p><h4 id="2-2-1-wait">2.2.1 wait()</h4><p><code>std::condition_variable::wait()</code> å‡½æ•°æ˜¯ <code>std::condition_variable</code> ä¸­çš„ä¸€ä¸ªå…³é”®æˆå‘˜å‡½æ•°ï¼Œä¸»è¦ç”¨äºè®©çº¿ç¨‹ <strong>ç­‰å¾…æŸä¸ªæ¡ä»¶æˆç«‹</strong>ï¼Œé€šå¸¸é…åˆäº’æ–¥é‡ï¼ˆmutexï¼‰è¿›å’Œ <code>std::unique_lock</code> ä½¿ç”¨ï¼Œä»¥å®ç°çº¿ç¨‹çš„åŒæ­¥ã€‚</p><p>å…¶åŸºæœ¬çš„å‡½æ•°åŸå‹ä¸ºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">template</span>&lt; <span class="hljs-keyword">class</span> Predicate &gt;</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">wait</span><span class="hljs-params">( std::unique_lock&lt;std::mutex&gt;&amp; lock, Predicate pred )</span></span>;<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ <code>lock</code> æ˜¯äº’æ–¥é”ï¼›<code>pred</code> æ˜¯ä¸€ä¸ª <code>Predicate</code> ç±»å‹ï¼Œå¿…é¡»æ˜¯ä¸€ä¸ª <strong>å¯è°ƒç”¨å¯¹è±¡</strong>ï¼ˆä¾‹å¦‚å‡½æ•°ã€lambda è¡¨ç¤ºã€å‡½æ•°æŒ‡é’ˆç­‰ï¼‰ã€‚</p><p>åŸºæœ¬çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// æ¡ä»¶å˜é‡ å’Œ äº’æ–¥é‡</span><br>std::condition_variable cv;<br>std::mutex mtx;<br><br><span class="hljs-comment">// çº¿ç¨‹å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">wait_foo</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>    cv.<span class="hljs-built_in">wait</span>(lck, <span class="hljs-built_in">check</span>()); <span class="hljs-comment">// check() ä¸ºåˆ¤æ–­æ¡ä»¶æ˜¯å¦æˆç«‹çš„å‡½æ•°</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å½“ä¸€ä¸ªçº¿ç¨‹è·å¾—é”ä¹‹åï¼Œè°ƒç”¨ <code>wait()</code> å‡½æ•°æ—¶ï¼š</p><ul><li><p>å¦‚æœ <code>check()</code> å‡½æ•°åˆ¤æ–­æ¡ä»¶ä¸º <code>true</code>ï¼Œé‚£ä¹ˆçº¿ç¨‹ä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œï¼›</p></li><li><p>å¦‚æœ <code>check()</code> å‡½æ•°åˆ¤æ–­æ¡ä»¶ä¸º <code>false</code>ï¼Œé‚£ä¹ˆçº¿ç¨‹ä¼šé˜»å¡åœ¨ <code>cv.wait(lck, check());</code> è¿™ä¸€è¡Œï¼Œè¿›å…¥ç­‰å¾…ï¼ŒåŒæ—¶ <strong>çº¿ç¨‹ä¼šè‡ªåŠ¨åœ°æš‚æ—¶é‡Šæ”¾é”</strong>ã€‚</p><p>çº¿ç¨‹è¿›å…¥é˜»å¡ï¼ˆç­‰å¾…ï¼‰çŠ¶æ€ï¼Œç›´åˆ°åˆ¤æ–­æ¡ä»¶å˜ä¸º <code>true</code> æ—¶ï¼Œçº¿ç¨‹ä¼šè¢«å”¤é†’ï¼Œå¹¶é‡æ–°è·å¾—é”ç»§ç»­æ‰§è¡Œä¸‹å»ã€‚</p><p>è€Œæ¡ä»¶æˆç«‹åï¼Œçº¿ç¨‹çš„å”¤é†’éœ€è¦é…åˆå¦ä¸€ä¸ª <code>std::condition_variable</code> ä¸­çš„å‡½æ•°â€”â€” <code>std::condition_variable::notify_one()</code>ï¼ˆæˆ–è€… <code>std::condition_variable::notify_all()</code>ï¼‰ã€‚</p></li></ul><p>å¦‚æœ <code>wait()</code> å‡½æ•°ä¸åŠ  <strong>å¯è°ƒç”¨å¯¹è±¡</strong> è¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆ <code>std::condition_variable::wait()</code> <strong>é»˜è®¤æ¡ä»¶ä¸º <code>false</code></strong>ï¼Œçº¿ç¨‹ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// çº¿ç¨‹å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">wait_foo</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>    cv.<span class="hljs-built_in">wait</span>(lck); <span class="hljs-comment">// ä¸åŠ å¯è°ƒç”¨å¯¹è±¡å‚æ•°ï¼Œé»˜è®¤ä¸º falseï¼Œè¿›å…¥é˜»å¡çŠ¶æ€</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> åœ¨ä½¿ç”¨ <code>wait()</code> å‡½æ•°æ—¶ï¼Œåªèƒ½æ­é… <code>std::unique_lock</code> äº’æ–¥é”ä½¿ç”¨ï¼Œä¸èƒ½ä½¿ç”¨ <code>std::lock_guard</code>ã€‚<code>std::condition_variable::wait()</code> éœ€è¦åœ¨ç­‰å¾…æœŸé—´è‡ªåŠ¨é‡Šæ”¾äº’æ–¥é‡ï¼Œç„¶ååœ¨è¢«å”¤é†’åé‡æ–°è·å–äº’æ–¥é‡ã€‚ä½†æ˜¯ <code>std::lock_guard</code> æ²¡æœ‰æä¾›è¿™æ ·çš„åŠŸèƒ½ã€‚</p><h4 id="2-2-2-notify-one">2.2.2 notify_one()</h4><p><code>std::condition_variable::notify_one()</code> ä¸»è¦ç”¨äºå½“æŸä¸ªæ¡ä»¶æˆç«‹ï¼Œé€šçŸ¥ <strong>ä¸€ä¸ª</strong> å¤„äºé˜»å¡çŠ¶æ€ä¸‹ï¼ˆç­‰å¾…è¯¥æ¡ä»¶æˆç«‹ï¼‰çš„çº¿ç¨‹ï¼Œè¿›è€Œå”¤é†’è¿™ä¸ªçº¿ç¨‹ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;condition_variable&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><br>std::mutex mtx; <span class="hljs-comment">// äº’æ–¥é‡</span><br>std::condition_variable cv; <span class="hljs-comment">// æ¡ä»¶å˜é‡</span><br><span class="hljs-type">bool</span> flag; <span class="hljs-comment">// åˆ¤æ–­çš„æ¡ä»¶</span><br><br><span class="hljs-comment">// ç­‰å¾…æ¡ä»¶çº¿ç¨‹å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">wait_foo</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;wait_foo(): wating...&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    cv.<span class="hljs-built_in">wait</span>(lck, []&#123; <span class="hljs-keyword">return</span> flag; &#125;);<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;wait_foo(): waiting ends, flag = &quot;</span> &lt;&lt; flag &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-comment">// é€šçŸ¥å”¤é†’çº¿ç¨‹å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">notify_foo</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">// ç¬¬ä¸€æ¬¡å°è¯•å”¤é†’ã€‚ä½†æ˜¯ä¸æ»¡è¶³æ¡ä»¶ï¼Œå”¤é†’å¤±è´¥</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">seconds</span>(<span class="hljs-number">2</span>)); <br>    &#123;<br>        <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;notify_foo(): notifying...&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br>    cv.<span class="hljs-built_in">notify_one</span>(); <span class="hljs-comment">// ä½œç”¨åŸŸç»“æŸè§£é”åå†å”¤é†’æ›´å¥½</span><br><br>    <span class="hljs-comment">// ç¬¬äºŒæ¬¡å°è¯•å”¤é†’ã€‚æ»¡è¶³æ¡ä»¶ï¼ŒæˆåŠŸå”¤é†’ã€‚</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">seconds</span>(<span class="hljs-number">2</span>)); <br>    &#123;<br>        <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>        flag = <span class="hljs-literal">true</span>;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;notify_foo(): notifying again...&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br>    cv.<span class="hljs-built_in">notify_one</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">wait_t</span><span class="hljs-params">(wait_foo)</span></span>;<br>    <span class="hljs-function">std::thread <span class="hljs-title">notify_t</span><span class="hljs-params">(notify_foo)</span></span>;<br>    <span class="hljs-type">wait_t</span>.<span class="hljs-built_in">join</span>();<br>    <span class="hljs-type">notify_t</span>.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªç­‰å¾…æ¡ä»¶çš„çº¿ç¨‹å‡½æ•° <code>wait_foo()</code> å’Œä¸€ä¸ªé€šçŸ¥å”¤é†’çš„çº¿ç¨‹å‡½æ•° <code>notify_foo()</code>ã€‚æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹åˆ†åˆ«æ‰§è¡Œè¿™ä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªçº¿ç¨‹ <code>wait_t</code> ç­‰å¾…æ¡ä»¶æˆç«‹ï¼Œä¸€ä¸ªçº¿ç¨‹ <code>notify_t</code> ç”¨äºå”¤é†’è¿™ä¸ªç­‰å¾…æ¡ä»¶æˆç«‹çš„çº¿ç¨‹ã€‚</p><p>åœ¨ <code>wait_foo()</code> ä¸­ï¼Œå…ˆå°è¯•è·å¾—é”ï¼Œè·å¾—é”ä¹‹åï¼Œåˆ¤æ–­æ¡ä»¶ <code>flag</code> æ˜¯å¦ä¸º <code>true</code>ï¼Œæ˜¾ç„¶ä¸€å¼€å§‹ <code>flag</code> ä¸º <code>false</code>ï¼Œæ‰€ä»¥ä¸€å¼€å§‹ <code>wait_t</code> ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒåŒæ—¶æš‚æ—¶é‡Šæ”¾é”ã€‚</p><p><code>notify_foo()</code> ä¸­ï¼Œä¸€å¼€å§‹å…ˆå°è¯•å”¤é†’ï¼Œæ­¤æ—¶æ¡ä»¶ <code>flag</code> æ²¡æœ‰è¿›è¡Œæ”¹å˜ï¼Œæ‰€ä»¥è¿™æ¬¡å”¤é†’æ˜¯å¤±è´¥çš„ï¼›ç„¶åå°è¯•è¿›è¡Œç¬¬äºŒæ¬¡å”¤é†’ï¼Œè¿™æ¬¡ä¿®æ”¹æ¡ä»¶ <code>flag</code> ä¸º <code>true</code>ï¼Œä¹‹åé€šçŸ¥å”¤é†’é˜»å¡çŠ¶æ€çš„çº¿ç¨‹ <code>wait_t</code>ã€‚</p><p>å¤„äºé˜»å¡æ€çš„çº¿ç¨‹ <code>wait_t</code> åœ¨çº¿ç¨‹ <code>notify_t</code> ç¬¬äºŒæ¬¡è°ƒç”¨ <code>std::condition_variable::notify_one()</code> å‡½æ•°åï¼ˆæ­¤æ—¶æ¡ä»¶è¢«ä¿®æ”¹ä¸º <code>true</code>ï¼‰ï¼ŒæˆåŠŸè¢«å”¤é†’ï¼Œé‡æ–°è·å¾—é”ï¼Œç„¶åç»§ç»­æ‰§è¡Œä¸‹å»ã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2025/01/01/w2oa.png" alt=""></p><h4 id="2-2-3-notify-all">2.2.3 notify_all()</h4><p>ä¸ <code>std::condition_variable::notify_one()</code> ä¸åŒçš„æ˜¯ï¼Œ<code>std::condition_variable::notify_all()</code> å”¤é†’çš„æ˜¯ <strong>æ‰€æœ‰</strong> å¤„äºé˜»å¡çŠ¶æ€ä¸‹ï¼ˆç­‰å¾…æŸä¸ªæ¡ä»¶æˆç«‹ï¼‰ã€‚</p><p>åœ¨çº¿ç¨‹è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œ<code>std::condition_variable::notify_all()</code> é€šå¸¸æ¯”è¾ƒé«˜æ•ˆã€‚</p><p>ä½†æ˜¯ï¼Œ<code>std::condition_variable::notify_all()</code> åœ¨æœ‰å¤šç§è¿›è¡Œåˆ¤æ–­æ¡ä»¶æ˜¯å¦æˆç«‹çš„çº¿ç¨‹æ—¶ï¼Œä¼šå‡ºç°éƒ¨åˆ†å”¤é†’æ²¡æœ‰ç”¨çš„æƒ…å†µï¼š</p><p>ä¾‹å¦‚ï¼Œåœ¨å¤šç”Ÿäº§è€… - å¤šæ¶ˆè´¹è€…æ¨¡å‹ä¸­ï¼Œå½“ä¸€ä¸ªç”Ÿäº§è€…è°ƒç”¨ <code>std::condition_variable::notify_all()</code> å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°å”¤é†’å…¶ä»–ä¸€äº›å¤„äºé˜»å¡æ€çš„ç”Ÿäº§è€…çº¿ç¨‹ï¼Œé‚£ä¹ˆè¿™äº›å”¤é†’å¯èƒ½æš‚æ—¶æ˜¯æ²¡æœ‰ç”¨çš„ã€‚</p><p>ä¸è¿‡è¿™ç§å½±å“æ¯”è¾ƒå°ã€‚å½“ä¸€ç±»çº¿ç¨‹åªæœ‰ä¸€ä¸ªæ—¶ï¼Œæˆ‘ä»¬è€ƒè™‘ä½¿ç”¨ <code>notify_one()</code>ï¼ˆæ¯æ¬¡å”¤é†’ä¸€ä¸ªå¤„äºé˜»å¡æ€çš„çº¿ç¨‹ï¼‰è¿›è¡Œå”¤é†’ï¼›å½“ä¸€ç±»çº¿ç¨‹æœ‰å¾ˆå¤šä¸ªæ—¶ï¼Œæˆ‘ä»¬è€ƒè™‘ä½¿ç”¨ <code>notify_all()</code>ã€‚</p><h2 id="3-ä½¿ç”¨-condition-variable-å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…">3 ä½¿ç”¨ condition_variable å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…</h2><p><a id='31'></a></p><h3 id="3-1-å®ç°æ€è·¯å’Œä»£ç ">3.1 å®ç°æ€è·¯å’Œä»£ç </h3><p>åœ¨ <a href="#2">2 std::condition_variable</a> ä¸­ï¼Œå·²ç»ä»‹ç»äº† <code>std::condition_variable</code> çš„åŸºæœ¬ç”¨æ³•ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ¡ä»¶å˜é‡æ¥å®ç° <strong>ç”Ÿäº§è€…-æ¶ˆè´¹è€…</strong> é—®é¢˜ä¸­çš„åŒæ­¥æœºåˆ¶ã€‚</p><p>åœ¨ç”Ÿäº§è€…å‡½æ•° <code>producer</code> ä¸­ï¼Œæ¯æ¬¡ç”Ÿäº§å¹¶å‘ç¼“å†²åŒºæ”¾å…¥æ•°æ®å‰ï¼Œéœ€è¦ç­‰å¾…æ¡ä»¶ <code>buffer.size() &lt; BUFFER_SIZE</code> æˆç«‹ã€‚æ¡ä»¶æˆç«‹æ—¶ï¼Œçº¿ç¨‹ç»§ç»­æ‰§è¡Œä¸‹å»ã€‚ç¼“å†²åŒºä¸­å·²ç»æœ‰æ•°æ®äº†ï¼Œæ­¤æ—¶ç”Ÿäº§è€…çº¿ç¨‹éœ€è¦å°è¯•å”¤é†’æ¶ˆè´¹è€…çº¿ç¨‹ã€‚</p><p>åœ¨æ¶ˆè´¹è€…å‡½æ•° <code>consumer</code> ä¸­ï¼Œæ¯æ¬¡æ¶ˆè´¹ä¸€ä¸ªæ•°æ®ä¹‹å‰ï¼Œéœ€è¦ç­‰å¾…æ¡ä»¶ <code>!buffer.empty()</code> æˆç«‹ã€‚ æ¡ä»¶æˆç«‹åç»§ç»­æ‰§è¡Œã€‚æ­¤æ—¶ç¼“å†²åŒºå‡ºç°ç©ºä½ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹éœ€è¦å”¤é†’ç”Ÿäº§è€…çº¿ç¨‹ã€‚</p><p>å®ç°ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;condition_variable&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><br>std::mutex mtx; <span class="hljs-comment">// äº’æ–¥é‡</span><br>std::condition_variable cv; <span class="hljs-comment">// æ¡ä»¶å˜é‡</span><br>std::queue&lt;<span class="hljs-type">int</span>&gt; buffer; <span class="hljs-comment">// å…±äº«ç¼“å†²åŒº</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> BUFFER_SIZE = <span class="hljs-number">10</span>; <span class="hljs-comment">// ç¼“å†²åŒºå¤§å°</span><br><br><span class="hljs-comment">// ç”Ÿäº§è€…å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">producer</span><span class="hljs-params">(<span class="hljs-type">int</span> data_num)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= data_num; i ++ )&#123;<br>        <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>        <span class="hljs-comment">// ç­‰å¾… buffer æœ‰ç©ºé—´å¯æ”¾å…¥æ•°æ®</span><br>        cv.<span class="hljs-built_in">wait</span>(lck, [&amp;]()&#123; <span class="hljs-keyword">return</span> buffer.<span class="hljs-built_in">size</span>() &lt; BUFFER_SIZE; &#125;);<br>        buffer.<span class="hljs-built_in">push</span>(i);<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Produced: &quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        cv.<span class="hljs-built_in">notify_one</span>();  <span class="hljs-comment">// å”¤é†’ç­‰å¾…çŠ¶æ€çš„æ¶ˆè´¹è€…çº¿ç¨‹</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// æ¶ˆè´¹è€…å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">consumer</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br>        <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>        <span class="hljs-comment">// ç­‰å¾… buffer ä¸­æœ‰æ•°æ®å¯æ¶ˆè´¹</span><br>        cv.<span class="hljs-built_in">wait</span>(lck, [&amp;]()&#123; <span class="hljs-keyword">return</span> !buffer.<span class="hljs-built_in">empty</span>(); &#125;);<br>        <span class="hljs-type">int</span> data = buffer.<span class="hljs-built_in">front</span>();<br>        buffer.<span class="hljs-built_in">pop</span>();<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Consumed: &quot;</span> &lt;&lt; data &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        lck.<span class="hljs-built_in">unlock</span>();     <span class="hljs-comment">// æå‰è§£é”</span><br>        cv.<span class="hljs-built_in">notify_one</span>();  <span class="hljs-comment">// å”¤é†’ç­‰å¾…çŠ¶æ€çš„ç”Ÿäº§è€…çº¿ç¨‹</span><br>        <span class="hljs-comment">// æ¨¡æ‹Ÿä¸ cv æ— å…³çš„æ•°æ®æ“ä½œ</span><br>        std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">producer_thread</span><span class="hljs-params">(producer, <span class="hljs-number">100</span>)</span></span>;<br>    <span class="hljs-function">std::thread <span class="hljs-title">consumer_thread</span><span class="hljs-params">(consumer)</span></span>;<br>    producer_thread.<span class="hljs-built_in">join</span>();<br>    consumer_thread.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2025/01/01/3tzo.png" alt=""></p><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼Œæ‰€ä»¥æš‚æ—¶åªè¦ç”¨ <code>notify_one()</code> å°±å¥½äº†ã€‚</p><h3 id="3-2-å¤šç”Ÿäº§è€…ã€æ¶ˆè´¹è€…é—®é¢˜">3.2 å¤šç”Ÿäº§è€…ã€æ¶ˆè´¹è€…é—®é¢˜</h3><h4 id="3-2-1-å¤šç”Ÿäº§è€…ã€æ¶ˆè´¹è€…å®ç°">3.2.1 å¤šç”Ÿäº§è€…ã€æ¶ˆè´¹è€…å®ç°</h4><p>åœ¨ <a href="#31">3.1 condition_variable å®ç°æ¶ˆè´¹è€…-ç”Ÿäº§è€…ä»£ç </a> ä¸­ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªç”Ÿäº§è€…å’Œä¸€ä¸ªæ¶ˆè´¹è€…ã€‚</p><p>ä½†å®é™…åœºæ™¯ä¸­å¾€å¾€ä¼šæœ‰å¤šä¸ªç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼Œä¾‹å¦‚ <a href="#111">1.1.1 ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜å®šä¹‰</a> ä¸­çš„ç”œç‚¹å¸ˆ-é¡¾å®¢çš„ä¾‹å­ï¼Œä¸€ä¸ªåº—é“ºé‡Œå¯èƒ½æœ‰å¤šä¸ªç”œç‚¹å¸ˆåœ¨åˆ¶ä½œï¼Œä¼šæœ‰å¾ˆå¤šä¸ªé¡¾å®¢å…‰ä¸´è¿™ä¸ªç”œå“åº—ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ <a href="#31">3.1 ç”Ÿäº§è€…-æ¶ˆè´¹è€…å®ç°ä»£ç </a> ä¸­çš„ä»£ç ï¼Œåˆ›å»ºå¤šä¸ªç”Ÿäº§è€…çº¿ç¨‹å’Œå¤šä¸ªæ¶ˆè´¹è€…çº¿ç¨‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;condition_variable&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><br>std::mutex mtx; <span class="hljs-comment">// äº’æ–¥é‡</span><br>std::condition_variable cv; <span class="hljs-comment">// æ¡ä»¶å˜é‡</span><br>std::queue&lt;<span class="hljs-type">int</span>&gt; buffer; <span class="hljs-comment">// å…±äº«ç¼“å†²åŒº</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> BUFFER_SIZE = <span class="hljs-number">10</span>; <span class="hljs-comment">// ç¼“å†²åŒºå¤§å°</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> PRODUCER_NUM = <span class="hljs-number">2</span>; <span class="hljs-comment">// ç”Ÿäº§è€…ä¸ªæ•°</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> CONSUMER_NUM = <span class="hljs-number">5</span>; <span class="hljs-comment">// æ¶ˆè´¹è€…ä¸ªæ•°</span><br><br><span class="hljs-comment">// ç”Ÿäº§è€…å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">producer</span><span class="hljs-params">(<span class="hljs-type">int</span> id, <span class="hljs-type">int</span> data_num)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= data_num; i ++ )&#123;<br>        <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>        <span class="hljs-comment">// ç­‰å¾… buffer æœ‰ç©ºé—´å¯æ”¾å…¥æ•°æ®</span><br>        cv.<span class="hljs-built_in">wait</span>(lck, [&amp;]()&#123; <span class="hljs-keyword">return</span> buffer.<span class="hljs-built_in">size</span>() &lt; BUFFER_SIZE; &#125;);<br>        buffer.<span class="hljs-built_in">push</span>(i);<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;producer &quot;</span> &lt;&lt; id &lt;&lt; <span class="hljs-string">&quot; produced data: &quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        cv.<span class="hljs-built_in">notify_all</span>();  <span class="hljs-comment">// å”¤é†’ç­‰å¾…çŠ¶æ€çš„æ¶ˆè´¹è€…çº¿ç¨‹</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// æ¶ˆè´¹è€…å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">consumer</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span></span>&#123;<br>    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br>        <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>        <span class="hljs-comment">// ç­‰å¾… buffer ä¸­æœ‰æ•°æ®å¯æ¶ˆè´¹</span><br>        cv.<span class="hljs-built_in">wait</span>(lck, [&amp;]()&#123; <span class="hljs-keyword">return</span> !buffer.<span class="hljs-built_in">empty</span>(); &#125;);<br>        <span class="hljs-type">int</span> data = buffer.<span class="hljs-built_in">front</span>();<br>        buffer.<span class="hljs-built_in">pop</span>();<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;consumer &quot;</span> &lt;&lt; id &lt;&lt; <span class="hljs-string">&quot; consumed data: &quot;</span> &lt;&lt; data &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        lck.<span class="hljs-built_in">unlock</span>();     <span class="hljs-comment">// æå‰è§£é”</span><br>        cv.<span class="hljs-built_in">notify_all</span>();  <span class="hljs-comment">// å”¤é†’ç­‰å¾…çŠ¶æ€çš„ç”Ÿäº§è€…çº¿ç¨‹</span><br>        <span class="hljs-comment">// æ¨¡æ‹Ÿä¸ cv æ— å…³çš„æ•°æ®æ“ä½œï¼Œæ”¾åœ¨è§£é”å’Œé€šçŸ¥ä¹‹å</span><br>        std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">producers</span><span class="hljs-params">(PRODUCER_NUM)</span></span>;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">consumers</span><span class="hljs-params">(CONSUMER_NUM)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; producers.<span class="hljs-built_in">size</span>(); i ++ )&#123;<br>        producers[i] = std::<span class="hljs-built_in">thread</span>(producer, i + <span class="hljs-number">1</span>, <span class="hljs-number">100</span>);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; consumers.<span class="hljs-built_in">size</span>(); i ++ )&#123;<br>        consumers[i] = std::<span class="hljs-built_in">thread</span>(consumer, i + <span class="hljs-number">1</span>);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : producers) t.<span class="hljs-built_in">join</span>();<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : consumers) t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªç”Ÿäº§è€…ä¸ªæ•°å’Œä¸€ä¸ªæ¶ˆè´¹è€…ä¸ªæ•°ï¼Œåœ¨çº¿ç¨‹æ¥å£å‡½æ•°ä¸­ä¼ é€’äº†çº¿ç¨‹ç¼–å·æ ‡è®°çš„å‚æ•° <code>id</code>ï¼ˆä¾¿äºè¡¨ç¤ºä¸åŒçš„ç”Ÿäº§è€…/æ¶ˆè´¹è€…ï¼‰ã€‚</p><p>ç”±äºç°åœ¨æ˜¯å¤šä¸ªç”Ÿäº§è€…çº¿ç¨‹å’Œå¤šä¸ªæ¶ˆè´¹è€…çº¿ç¨‹ï¼Œå› æ­¤å°† <code>notify_one()</code> æ”¹ä¸ºäº† <code>notify_all()</code>ã€‚å…¶ä»–éƒ¨åˆ†ä»£ç å¤§è‡´ç›¸åŒã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2025/01/01/zh1i.png" alt=""></p><p>çœ‹ä¼¼è¿è¡Œèµ·æ¥å¥½åƒæ²¡æœ‰ä»€ä¹ˆæ¯›ç—…ï¼Œä½†å®é™…ä¸Šåœ¨ <strong>å¤šç”Ÿäº§è€…çº¿ç¨‹ã€å¤šæ¶ˆè´¹è€…çº¿ç¨‹</strong> æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå‡ºç° <strong>è™šå‡å”¤é†’</strong> çš„é—®é¢˜ã€‚</p><h4 id="3-2-2-è™šå‡å”¤é†’é—®é¢˜">3.2.2 è™šå‡å”¤é†’é—®é¢˜</h4><p><strong>è™šå‡å”¤é†’</strong> æ˜¯æŒ‡çº¿ç¨‹ä»ç­‰å¾…æ¡ä»¶å˜é‡ <code>std::condition_variable::wait()</code> å‡½æ•°ä¸­å”¤é†’ï¼Œä½†å®é™…ä¸Šç­‰å¾…çš„æ¡ä»¶å¹¶æ²¡æœ‰çœŸæ­£æ»¡è¶³ã€‚é€šå¸¸ <strong>è™šå‡å”¤é†’</strong> çš„é—®é¢˜æ˜¯ç”±äºå¤šçº¿ç¨‹ç¯å¢ƒä¸‹ <strong>ç³»ç»Ÿè°ƒåº¦ã€ä¿¡å·ä¼ è¾“</strong> ç­‰åŸå› å¯¼è‡´çš„ã€‚</p><p>ä¾‹å¦‚ï¼Œç¼“å†²åŒºä¸ºç©ºï¼Œå½“ä¸€ä¸ªç”Ÿäº§è€…çº¿ç¨‹æ”¾å…¥ä¸€ä¸ªæ•°æ®åï¼ˆæ”¾å…¥åç¼“å†²åŒºå°±è¿™ä¸€ä¸ªæ•°æ®ï¼‰ï¼Œé€šçŸ¥å”¤é†’äº†ä¸€ä¸ªç­‰å¾…çš„æ¶ˆè´¹è€…çº¿ç¨‹çš„æ—¶å€™ï¼Œæœ‰å¦ä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹æ¶ˆè´¹äº†è¿™ä¸ªå”¯ä¸€çš„æ•°æ®ã€‚è¿™æ˜¯çº¿ç¨‹è°ƒåº¦çš„ä¸ç¡®å®šæ€§æ‰€å¯¼è‡´çš„ã€‚</p><p>æ­¤æ—¶ï¼Œè¿™ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹æ”¶åˆ°è¢«å”¤é†’çš„é€šçŸ¥ï¼Œè¡¨é¢ä¸Šæ¡ä»¶æˆç«‹äº†ï¼Œä½†æ˜¯å®é™…ä¸Š <code>buffer</code> è¿˜æ˜¯ä¸ºç©ºã€‚è¿™å°±å‡ºç°äº† <strong>è™šå‡å”¤é†’</strong>ã€‚</p><p>åœ¨ç°å®åœºæ™¯ä¸­ï¼Œæˆ‘æƒ³è¦ä¹°è‰è“è›‹ç³•ä½†æ˜¯ç”œç‚¹å¸ˆæ­£åœ¨åˆ¶ä½œä¸­ï¼Œç­‰å¾…äº†ä¸€ä¼šï¼Œç”œç‚¹å¸ˆé€šçŸ¥æˆ‘å±•ç¤ºæ¶ä¸Šæœ‰æ–°çš„è‰è“è›‹ç³•äº†ï¼Œæˆ‘æ­£å‡†å¤‡å»æ‹¿çš„æ—¶å€™å´è¢«å¦ä¸€ä¸ªäººç»™æŠ¢å…ˆäº†ã€‚è¿™æ­£æ˜¯å¤ªå€’éœ‰äº†ï¼ğŸ“ğŸ°</p><p>è™šå‡å”¤é†’è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„æƒ…å†µï¼Œæ€»ä¹‹ç±»ä¼¼ä¸Šè¿°çš„æ¡ä»¶æ²¡æœ‰å®é™…æ»¡è¶³çš„æƒ…å†µéƒ½å±äºè™šå‡å”¤é†’ã€‚</p><p><a id='323'></a></p><h4 id="3-2-3-è™šå‡å”¤é†’çš„è§£å†³">3.2.3 è™šå‡å”¤é†’çš„è§£å†³</h4><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡çº¿ç¨‹è¢«å”¤é†’åï¼Œ<strong>å†æ¬¡æ£€æŸ¥æ˜¯å¦æ»¡è¶³æ¡ä»¶æˆç«‹</strong>ã€‚å†æ¬¡æ£€æŸ¥æ¡ä»¶å¦‚æœå‘ç°ä¸æˆç«‹ï¼Œé‚£ä¹ˆçº¿ç¨‹éœ€è¦åˆä¸€æ¬¡è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ª <strong>å¾ªç¯æ£€æŸ¥</strong>ã€‚</p><p>åœ¨ <a href="#221">2.2.1 std::condition_variable::wait()</a> ä¸­ï¼Œå¦‚æœ <code>wait()</code> å‡½æ•°ä¸æ¥å— <strong>å¯è°ƒç”¨å¯¹è±¡</strong> çš„å‚æ•°ï¼Œå‡½æ•°é»˜è®¤æ¡ä»¶ä¸º <code>false</code>ï¼Œçº¿ç¨‹ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ã€‚</p><p>åœ¨ç”Ÿäº§è€…çº¿ç¨‹å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ª <code>while</code> å¾ªç¯ï¼Œå¾ªç¯åˆ¤æ–­çš„æ¡ä»¶ä¸º <code>buffer.size() &gt;= BUFFER_SIZE</code>ï¼Œå¦‚æœæ¡ä»¶æ»¡è¶³ï¼Œé‚£ä¹ˆæ‰§è¡Œ <code>cv.wait(lck)</code>ï¼Œä½¿å¾—ç”Ÿäº§è€…çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒåŒæ—¶æš‚æ—¶é‡Šæ”¾äº’æ–¥é”ã€‚</p><p>ç”Ÿäº§è€…çº¿ç¨‹å¡åœ¨ <code>cv.wait(lck);</code> è¿™ä¸€è¡Œï¼Œå¦‚æœæŸä¸ªæ¶ˆè´¹è€…çº¿ç¨‹å”¤é†’äº†ç”Ÿäº§è€…çº¿ç¨‹ï¼Œé‚£ä¹ˆä¼šå†æ¬¡è¿›å…¥ <code>while</code> å¾ªç¯è¿›è¡Œæ¡ä»¶åˆ¤æ–­ã€‚å¦‚æœæ­¤æ—¶ <code>buffer.size() &lt; BUFFER_SIZE</code>ï¼Œé‚£ä¹ˆä¼šé€€å‡ºå¾ªç¯ï¼Œç„¶åç”Ÿäº§è€…çº¿ç¨‹ç»§ç»­æ‰§è¡Œä¸‹å»ï¼›å¦åˆ™ï¼Œç”Ÿäº§è€…çº¿ç¨‹ä¼šå†æ¬¡é™·å…¥é˜»å¡çŠ¶æ€ï¼ŒåŒæ—¶æš‚æ—¶é‡Šæ”¾äº’æ–¥é”ã€‚</p><p>è¿™æ ·å°±é€šè¿‡ <code>while</code> å¾ªç¯å®ç°äº†å†æ¬¡æ£€æŸ¥ä»¥åŠå¾ªç¯æ£€æŸ¥ã€‚ç±»ä¼¼çš„ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ä¸­ä¹Ÿå¯ä»¥å†™ä¸€ä¸ª <code>while</code> å¾ªç¯ï¼Œç¡®ä¿æ¶ˆè´¹è€…çº¿ç¨‹ä¸ä¼šè¢«è™šå‡å”¤é†’ã€‚</p><p>ä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;condition_variable&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><br>std::mutex mtx; <span class="hljs-comment">// äº’æ–¥é‡</span><br>std::condition_variable cv; <span class="hljs-comment">// æ¡ä»¶å˜é‡</span><br>std::queue&lt;<span class="hljs-type">int</span>&gt; buffer; <span class="hljs-comment">// å…±äº«ç¼“å†²åŒº</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> BUFFER_SIZE = <span class="hljs-number">10</span>; <span class="hljs-comment">// ç¼“å†²åŒºå¤§å°</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> PRODUCER_NUM = <span class="hljs-number">2</span>; <span class="hljs-comment">// ç”Ÿäº§è€…ä¸ªæ•°</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> CONSUMER_NUM = <span class="hljs-number">5</span>; <span class="hljs-comment">// æ¶ˆè´¹è€…ä¸ªæ•°</span><br><br><span class="hljs-comment">// ç”Ÿäº§è€…å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">producer</span><span class="hljs-params">(<span class="hljs-type">int</span> id, <span class="hljs-type">int</span> data_num)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= data_num; i ++ )&#123;<br>        <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>        <span class="hljs-comment">// ç­‰å¾… buffer æœ‰ç©ºé—´å¯æ”¾å…¥æ•°æ®ï¼ˆå¾ªç¯æ£€æŸ¥ï¼Œé˜²æ­¢è™šå‡å”¤é†’ï¼‰</span><br>        <span class="hljs-keyword">while</span>(buffer.<span class="hljs-built_in">size</span>() &gt;= BUFFER_SIZE)&#123;<br>            cv.<span class="hljs-built_in">wait</span>(lck); <span class="hljs-comment">// é»˜è®¤ falseï¼Œè§£é”å¹¶è¿›å…¥ç­‰å¾…</span><br>        &#125;<br>        buffer.<span class="hljs-built_in">push</span>(i);<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;producer &quot;</span> &lt;&lt; id &lt;&lt; <span class="hljs-string">&quot; produced data: &quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        cv.<span class="hljs-built_in">notify_all</span>();  <span class="hljs-comment">// å”¤é†’ç­‰å¾…çŠ¶æ€çš„æ¶ˆè´¹è€…çº¿ç¨‹</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// æ¶ˆè´¹è€…å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">consumer</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span></span>&#123;<br>    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br>        <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>        <span class="hljs-comment">// ç­‰å¾… buffer ä¸­æœ‰æ•°æ®å¯æ¶ˆè´¹ï¼ˆå¾ªç¯æ£€æŸ¥ï¼Œé˜²æ­¢è™šå‡å”¤é†’ï¼‰</span><br>        <span class="hljs-keyword">while</span>(buffer.<span class="hljs-built_in">empty</span>())&#123;<br>            cv.<span class="hljs-built_in">wait</span>(lck); <span class="hljs-comment">// é»˜è®¤ falseï¼Œè§£é”å¹¶è¿›å…¥ç­‰å¾…</span><br>        &#125;<br>        <span class="hljs-type">int</span> data = buffer.<span class="hljs-built_in">front</span>();<br>        buffer.<span class="hljs-built_in">pop</span>();<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;consumer &quot;</span> &lt;&lt; id &lt;&lt; <span class="hljs-string">&quot; consumed data: &quot;</span> &lt;&lt; data &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        lck.<span class="hljs-built_in">unlock</span>();     <span class="hljs-comment">// æå‰è§£é”</span><br>        cv.<span class="hljs-built_in">notify_all</span>();  <span class="hljs-comment">// å”¤é†’ç­‰å¾…çŠ¶æ€çš„ç”Ÿäº§è€…çº¿ç¨‹</span><br>        <span class="hljs-comment">// æ¨¡æ‹Ÿä¸ cv æ— å…³çš„æ•°æ®æ“ä½œï¼Œæ”¾åœ¨è§£é”å’Œé€šçŸ¥ä¹‹å</span><br>        std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">producers</span><span class="hljs-params">(PRODUCER_NUM)</span></span>;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">consumers</span><span class="hljs-params">(CONSUMER_NUM)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; producers.<span class="hljs-built_in">size</span>(); i ++ )&#123;<br>        producers[i] = std::<span class="hljs-built_in">thread</span>(producer, i + <span class="hljs-number">1</span>, <span class="hljs-number">100</span>);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; consumers.<span class="hljs-built_in">size</span>(); i ++ )&#123;<br>        consumers[i] = std::<span class="hljs-built_in">thread</span>(consumer, i + <span class="hljs-number">1</span>);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : producers) t.<span class="hljs-built_in">join</span>();<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : consumers) t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-3-æ¶ˆè´¹è€…é€€å‡ºæœºåˆ¶ç¼–å†™">3.3 æ¶ˆè´¹è€…é€€å‡ºæœºåˆ¶ç¼–å†™</h3><p>åœ¨ <a href="#323">3.2.3 è™šå‡å”¤é†’çš„è§£å†³</a> ä¸­ï¼Œæˆ‘ä»¬å·²ç»è§£å†³äº† <strong>è™šå‡å”¤é†’</strong> é—®é¢˜ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬è¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šæ¶ˆè´¹è€…ä¸€ç›´éƒ½åœ¨æ¶ˆè´¹æ•°æ®ï¼Œæ²¡æœ‰åœæ­¢çš„æ—¶å€™ã€‚ç”±äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬çš„ç¨‹åºåˆ°æœ€åä¹Ÿæ²¡æœ‰åœæ­¢ã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚ä½•å†™ä¸€ä¸ªåˆç†çš„æ¶ˆè´¹è€…é€€å‡ºæœºåˆ¶å‘¢ï¼Ÿä¸€ä¸ªæ¯”è¾ƒæ„šè ¢çš„åŠæ³•å°±æ˜¯ï¼Œè®°å½•æ•°æ®çš„æ•°é‡ï¼Œè¾¾åˆ°ç”Ÿäº§è€…ç”Ÿäº§æ•°æ®çš„æ•°é‡ä¸Šé™æ—¶ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹å‡½æ•°ä¸­é€€å‡ºå¾ªç¯ã€‚ä½†æ˜¯è¿™ç§å†™æ³•çš„å±€é™æ€§æ¯”è¾ƒé«˜ï¼Œå¦‚æœç”Ÿäº§è€…ç”Ÿäº§æ•°æ®çš„ä»£ç æœ‰ä¸€ç‚¹æ”¹åŠ¨å°±å¾—è·Ÿç€ä¸€èµ·ä¿®æ”¹ã€‚</p><p>æˆ‘ä»¬åŒæ ·å¯ä»¥å€ŸåŠ©æ¡ä»¶å˜é‡æ¥å®ç°ä¸€ä¸ªåˆç†çš„æ¶ˆè´¹è€…é€€å‡ºæœºåˆ¶ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç»´æŠ¤ä¸€ä¸ªå®Œæˆç”Ÿäº§å·¥ä½œçš„ç”Ÿäº§è€…è®¡æ•° <code>produce_finished_count</code>ï¼Œè¿™ä¸ªè®¡æ•° <strong>éœ€è¦äº’æ–¥è®¿é—®å’Œä¿®æ”¹</strong>ï¼š</p><ul><li><p>åœ¨ç”Ÿäº§è€…çº¿ç¨‹å‡½æ•°ç”Ÿäº§æ•°æ®å¾ªç¯ç»“æŸä¹‹åï¼Œç”Ÿäº§è€…çº¿ç¨‹å†æ¬¡è·å¾—é”ï¼Œç„¶åä¿®æ”¹ <code>produce_finished_count</code>ï¼ˆ<code>produce_finished_count ++ </code>ï¼‰ã€‚å¦‚æœä¿®æ”¹ä¹‹åï¼Œ<code>produce_finished_count</code> è¾¾åˆ°äº†ç”Ÿäº§è€…çº¿ç¨‹çš„æ€»æ•°ï¼Œé‚£ä¹ˆéœ€è¦å°è¯•å”¤é†’é˜»å¡çŠ¶æ€ä¸­çš„æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œé€šçŸ¥å®ƒä»¬ä¸ä¼šå†æœ‰æ–°çš„æ•°æ®äº†ï¼›</p></li><li><p>åœ¨æ¶ˆè´¹è€…çº¿ç¨‹å‡½æ•°ä¸­ï¼Œå¦‚æœ <code>buffer.empty() &amp;&amp; produce_finished_count &lt; PRODUCER_NUM</code>ï¼Œè¡¨æ˜ç¼“å†²åŒºä¸ºç©ºï¼Œä½†æ˜¯è¿˜ä¼šæœ‰æ–°çš„æ•°æ®ç”Ÿäº§ï¼Œå› æ­¤è¿™æ—¶æ¶ˆè´¹è€…çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œå½“ <code>!buffer.empty()</code> æˆç«‹æ—¶ï¼ˆæœ‰æ•°æ®äº†ï¼‰ï¼Œçº¿ç¨‹è¢«å”¤é†’ï¼Œç„¶åï¼ˆå¯èƒ½ï¼‰é€€å‡ºå¾ªç¯ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ç»§ç»­æ‰§è¡Œä¸‹å»ã€‚ä½†æ˜¯ï¼Œå¯èƒ½ä¼šåœ¨ <code>produce_finished_count == PRODUCER_NUM</code> æˆç«‹çš„æ—¶å€™ï¼Œçº¿ç¨‹è¢«é€šçŸ¥å”¤é†’ç„¶åé€€å‡ºå¾ªç¯ã€‚é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨åˆ¤æ–­ä¸€ä¸‹æ˜¯å¦æ˜¯è¿™ç§æƒ…å†µï¼Œå¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼ˆç¼“å†²åŒºä¸ºç©ºï¼Œä¸”ä¸ä¼šæœ‰æ–°çš„æ•°æ®å†ç”Ÿäº§ï¼‰ï¼Œé‚£ä¹ˆæ¶ˆè´¹è€…çº¿ç¨‹å‡½æ•°å°±ä» <code>while(true)</code> ä¸­ <code>break</code> é€€å‡ºã€‚</p><p>å½“ç„¶ï¼Œåœ¨ç”Ÿäº§è€…çº¿ç¨‹å‡½æ•°ä¸­ï¼Œå½“ <code>produce_finished_count == PRODUCER_NUM</code> æˆç«‹æ—¶å»å”¤é†’æ¶ˆè´¹è€…çº¿ç¨‹ä¹Ÿä¸ä¸€å®šè¡¨æ˜å°±æ˜¯å®Œå…¨æ²¡æ•°æ®äº†ï¼Œå¯èƒ½ç¼“å†²åŒºè¿˜æœ‰ä¸€äº›æ•°æ®ï¼Œåªä¸è¿‡ä¸ä¼šæœ‰æ–°æ•°æ®å†ç”Ÿäº§äº†ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹åœ¨ä¹‹ååˆ¤æ–­ <code>buffer.empty() &amp;&amp; produce_finished_count == PRODUCER_NUM</code> æ˜¯å¦æˆç«‹æ—¶ï¼Œ<code>buffer</code> å¹¶ä¸ä¸ºç©ºï¼Œé‚£ä¹ˆæ¶ˆè´¹è€…çº¿ç¨‹ä¼šç»§ç»­æ‰§è¡Œä¸‹å»å»æ¶ˆè´¹ç¼“å†²åŒºçš„æ•°æ®ã€‚</p></li></ul><p>æˆ‘ä»¬å¯ä»¥å°†ä¸Šé¢çš„é€€å‡ºæœºåˆ¶å®ç°å¸¦å…¥ç°å®åœºæ™¯ä¸­ï¼šç”œç‚¹å¸ˆä»Šå¤©å·¥ä½œé‡è¾¾åˆ°ä¸Šé™äº†ï¼Œä¸ä¼šå†åˆ¶ä½œæ–°çš„è‰è“è›‹ç³•äº†ï¼Œæˆ‘æ­£åœ¨ç­‰å¾…æ–°çš„è‰è“è›‹ç³•ï¼Œä½†æ˜¯è½®åˆ°æˆ‘çš„æ—¶å€™ï¼Œç”œç‚¹å¸ˆå‘Šè¯‰æˆ‘å·²ç»æ²¡æœ‰ä¸”ä¸å†åšäº†ï¼Œé‚£æˆ‘åªèƒ½é—æ†¾åœ°å›å®¶äº†ï¼Œåˆæ˜¯å€’éœ‰çš„ä¸€å¤©ã€‚ğŸ°ğŸ˜¢</p><p>ä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;atomic&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;condition_variable&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><br>std::mutex mtx; <span class="hljs-comment">// äº’æ–¥é‡</span><br>std::condition_variable cv; <span class="hljs-comment">// æ¡ä»¶å˜é‡</span><br>std::queue&lt;<span class="hljs-type">int</span>&gt; buffer; <span class="hljs-comment">// å…±äº«ç¼“å†²åŒº</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> BUFFER_SIZE = <span class="hljs-number">10</span>; <span class="hljs-comment">// ç¼“å†²åŒºå¤§å°</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> PRODUCER_NUM = <span class="hljs-number">2</span>; <span class="hljs-comment">// ç”Ÿäº§è€…ä¸ªæ•°</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> CONSUMER_NUM = <span class="hljs-number">5</span>; <span class="hljs-comment">// æ¶ˆè´¹è€…ä¸ªæ•°</span><br><span class="hljs-type">int</span> produce_finished_count; <span class="hljs-comment">// ç”Ÿäº§è€…å®Œæˆè®¡æ•°</span><br><span class="hljs-comment">// std::atomic&lt;int&gt; produce_finished_count; // ä¹Ÿå¯ä»¥ç”¨åŸå­æ“ä½œ</span><br><br><span class="hljs-comment">// ç”Ÿäº§è€…å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">producer</span><span class="hljs-params">(<span class="hljs-type">int</span> id, <span class="hljs-type">int</span> data_num)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= data_num; i ++ )&#123;<br>        <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>        <span class="hljs-comment">// ç­‰å¾… buffer æœ‰ç©ºé—´å¯æ”¾å…¥æ•°æ®ï¼ˆå¾ªç¯æ£€æŸ¥ï¼Œé˜²æ­¢è™šå‡å”¤é†’ï¼‰</span><br>        <span class="hljs-keyword">while</span>(buffer.<span class="hljs-built_in">size</span>() &gt;= BUFFER_SIZE)&#123;<br>            cv.<span class="hljs-built_in">wait</span>(lck); <span class="hljs-comment">// é»˜è®¤ falseï¼Œè§£é”å¹¶è¿›å…¥ç­‰å¾…</span><br>        &#125;<br>        buffer.<span class="hljs-built_in">push</span>(i);<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;producer &quot;</span> &lt;&lt; id &lt;&lt; <span class="hljs-string">&quot; produced data: &quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        cv.<span class="hljs-built_in">notify_all</span>();  <span class="hljs-comment">// å”¤é†’ç­‰å¾…çŠ¶æ€çš„æ¶ˆè´¹è€…çº¿ç¨‹</span><br>    &#125;<br>    &#123;<br>        <span class="hljs-comment">// å½“å‰ç”Ÿäº§è€…ç”Ÿæˆæ•°æ®å®Œæ¯•ï¼Œä¿®æ”¹å®Œæˆæ•°æ®ç”Ÿæˆçš„ç”Ÿäº§è€…è®°æ•°</span><br>        <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>        produce_finished_count ++ ;<br>        <span class="hljs-keyword">if</span>(produce_finished_count == PRODUCER_NUM)&#123; <br>            cv.<span class="hljs-built_in">notify_all</span>(); <span class="hljs-comment">// å”¤é†’ç­‰å¾…çš„æ¶ˆè´¹è€…çº¿ç¨‹</span><br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// æ¶ˆè´¹è€…å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">consumer</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span></span>&#123;<br>    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br>        <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>        <span class="hljs-comment">// ç­‰å¾… buffer ä¸­æœ‰æ•°æ®å¯æ¶ˆè´¹ï¼ˆå¾ªç¯æ£€æŸ¥ï¼Œé˜²æ­¢è™šå‡å”¤é†’ï¼‰</span><br>        <span class="hljs-keyword">while</span>(buffer.<span class="hljs-built_in">empty</span>() &amp;&amp; produce_finished_count &lt; PRODUCER_NUM)&#123;<br>            cv.<span class="hljs-built_in">wait</span>(lck); <span class="hljs-comment">// é»˜è®¤ falseï¼Œè§£é”å¹¶è¿›å…¥ç­‰å¾…</span><br>        &#125;<br>        <span class="hljs-comment">// ä¸Šé¢çš„æ£€æŸ¥ä¸­ï¼Œå¯èƒ½å› ä¸º produce_finished_count == PRODUCER_NUM è€Œé€€å‡º</span><br>        <span class="hljs-comment">// buffer å¯èƒ½ä¸ºç©ºï¼Œè¯´æ˜æ²¡æœ‰æ–°çš„æ•°æ®å†ç”Ÿäº§ï¼Œè¿™ä¸ªæ—¶å€™ä» while(true) é€€å‡º</span><br>        <span class="hljs-comment">// buffer ä¹Ÿå¯èƒ½è¿˜æœ‰æ•°æ®ï¼Œæ¶ˆè´¹è€…ç»§ç»­æ‰§è¡Œä¸‹å»æ¶ˆè´¹æ•°æ®ã€‚</span><br>        <span class="hljs-keyword">if</span>(buffer.<span class="hljs-built_in">empty</span>() &amp;&amp; produce_finished_count == PRODUCER_NUM)&#123;<br>            <span class="hljs-keyword">break</span>;  <span class="hljs-comment">// é€€å‡º</span><br>        &#125;<br>        <span class="hljs-type">int</span> data = buffer.<span class="hljs-built_in">front</span>();<br>        buffer.<span class="hljs-built_in">pop</span>();<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;consumer &quot;</span> &lt;&lt; id &lt;&lt; <span class="hljs-string">&quot; consumed data: &quot;</span> &lt;&lt; data &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        lck.<span class="hljs-built_in">unlock</span>();     <span class="hljs-comment">// æå‰è§£é”</span><br>        cv.<span class="hljs-built_in">notify_all</span>();  <span class="hljs-comment">// å”¤é†’ç­‰å¾…çŠ¶æ€çš„ç”Ÿäº§è€…çº¿ç¨‹</span><br>        <span class="hljs-comment">// æ¨¡æ‹Ÿä¸ cv æ— å…³çš„ã€æ— éœ€äº’æ–¥é‡çš„æ•°æ®æ“ä½œï¼Œæ”¾åœ¨è§£é”å’Œå”¤é†’ä¹‹å</span><br>        std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">producers</span><span class="hljs-params">(PRODUCER_NUM)</span></span>;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">consumers</span><span class="hljs-params">(CONSUMER_NUM)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; producers.<span class="hljs-built_in">size</span>(); i ++ )&#123;<br>        producers[i] = std::<span class="hljs-built_in">thread</span>(producer, i + <span class="hljs-number">1</span>, <span class="hljs-number">100</span>);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; consumers.<span class="hljs-built_in">size</span>(); i ++ )&#123;<br>        consumers[i] = std::<span class="hljs-built_in">thread</span>(consumer, i + <span class="hljs-number">1</span>);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : producers) t.<span class="hljs-built_in">join</span>();<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : consumers) t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2025/01/01/11usl.png" alt=""></p><p>å¯ä»¥çœ‹å‡ºï¼Œç”Ÿäº§è€…-æ¶ˆè´¹è€…é¡ºåˆ©çš„æ‰§è¡Œï¼Œå¹¶ä¸”æœ€åæ•°æ®å…¨éƒ¨æ¶ˆè´¹å®Œåç¨‹åºæ­£å¸¸åœ°é€€å‡ºäº†ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªå°å°çš„å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹å°±æ˜¯ï¼Œå¯¹å®Œæˆç”Ÿäº§å·¥ä½œçš„ç”Ÿäº§è€…è®¡æ•° <code>produce_finished_count</code> çš„äº’æ–¥è®¿é—®å’Œä¿®æ”¹åªæœ‰ç®€å•çš„è‡ªåŠ æ“ä½œï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ <code>std::atomic</code> åŸå­æ“ä½œæ¥å®ç°å¯¹ <code>produce_finished_count</code> äº’æ–¥ï¼Œä½¿å¾—ç¨‹åºæ›´åŠ é«˜æ•ˆã€‚ä¸è¿‡ï¼Œæš‚æ—¶è¿˜æ²¡æœ‰å†™åˆ°æœ‰å…³ <strong>åŸå­æ“ä½œ</strong> çš„éƒ¨åˆ†ï¼Œæ‰€ä»¥æš‚æ—¶ä¸å±•å¼€äº†ã€‚ğŸ˜‰</p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ol><li><p><a href="https://en.cppreference.com/w/cpp/thread/condition_variable/wait">std::condition_variable::wait</a></p></li><li><p><a href="https://en.cppreference.com/w/cpp/thread/condition_variable/notify_one">std::condition_variable::notify_one</a></p></li><li><p><a href="https://en.cppreference.com/w/cpp/thread/condition_variable/notify_all">std::condition_variable::notify_all</a></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
      <tag>std::mutex</tag>
      
      <tag>std::condition_variable</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€std::call_once, std::once_flag</title>
    <link href="/2024/12/30/20241230/"/>
    <url>/2024/12/30/20241230/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æºï¼š<a href="https://www.pixiv.net/artworks/104231610">pixiv_id=104231610</a></p><p><a id='1'></a></p><h2 id="1-é—®é¢˜èƒŒæ™¯">1 é—®é¢˜èƒŒæ™¯</h2><p>åœ¨ C++ å¤šçº¿ç¨‹ä¸­ï¼Œæˆ‘ä»¬æœ‰æ—¶ä¼šé‡åˆ°å…±äº«èµ„æºåˆå§‹åŒ–çš„æƒ…å†µã€‚å‡è®¾æœ‰ä¸€ä¸ªå…¨å±€å˜é‡ <code>val</code>ï¼Œæœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶å°è¯•åˆå§‹åŒ–è¿™ä¸ªå…¨å±€å˜é‡ï¼Œä¸€æ–¹é¢é‡å¤çš„åˆå§‹åŒ–ä¼šå¯¼è‡´èµ„æºçš„æµªè´¹ï¼Œå¦ä¸€æ–¹é¢å¤šä¸ªçº¿ç¨‹åŒæ—¶å¼€å§‹åˆå§‹åŒ–ï¼Œå¯èƒ½ä¼šå¯¼è‡´åˆå§‹åŒ–è¿‡ç¨‹äº’ç›¸å¹²æ‰°ï¼ˆä¸€ä¸ªçº¿ç¨‹åˆå§‹åŒ–è¿˜æœªå®Œæˆï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¹Ÿå¼€å§‹åˆå§‹åŒ–ï¼‰ã€‚</p><p>ä¸ºäº†å®ç°å¤šçº¿ç¨‹æ­£ç¡®äº’æ–¥åœ°è¿›è¡Œå…±äº«èµ„æºçš„åˆå§‹åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨ <strong>äº’æ–¥é”</strong> æ¥å®ç°å¤šçº¿ç¨‹å¹¶å‘äº’æ–¥åˆå§‹åŒ–å…±äº«æ•°æ®ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br>std::mutex mtx; <span class="hljs-comment">// äº’æ–¥é‡</span><br><span class="hljs-type">bool</span> flag;      <span class="hljs-comment">// æ ‡è®°æ˜¯å¦åˆå§‹åŒ–</span><br><span class="hljs-type">int</span> val;        <span class="hljs-comment">// å¾…åˆå§‹åŒ–æ•°æ®</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>; <span class="hljs-comment">// äº’æ–¥é”</span><br>    <span class="hljs-keyword">if</span>(!flag)&#123; <span class="hljs-comment">// è¿˜æœªåˆå§‹åŒ–</span><br>        std::cout &lt;&lt; <span class="hljs-string">&quot;value initializing ... &quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        val = <span class="hljs-number">1</span>;     <span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®ä¸º 1</span><br>        std::cout &lt;&lt; <span class="hljs-string">&quot;value initialized as: &quot;</span> &lt;&lt; val &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>        flag = <span class="hljs-literal">true</span>; <span class="hljs-comment">// æ ‡è®°ä¸ºå·²ç»åˆå§‹åŒ–</span><br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">threads</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : threads) t = std::<span class="hljs-built_in">thread</span>(init);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : threads) t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†å¾…åˆå§‹åŒ–æ•°æ® <code>val</code> å’Œä¸€ä¸ªè®°å½•æ•°æ®æ˜¯å¦è¢«åˆå§‹åŒ–çš„æ ‡è®° <code>flag</code>ï¼ˆè‹¥ <code>flag</code> ä¸º <code>false</code>ï¼Œè¡¨ç¤º <strong>æœªåˆå§‹åŒ–</strong>ï¼‰ã€‚</p><p>æˆ‘ä»¬åˆ›å»ºäº† <code>10</code> ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œåˆå§‹åŒ–å‡½æ•° <code>init()</code>ã€‚åœ¨å‡½æ•° <code>init()</code> ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ <code>std::lock_guard</code> å®ç°äº†å¤šä¸ªçº¿ç¨‹å¯¹åˆå§‹åŒ–æ ‡è®° <code>flag</code> å’Œ å…±äº«æ•°æ® <code>val</code> çš„äº’æ–¥è®¿é—®å’Œä¿®æ”¹ç­‰æ“ä½œã€‚å¦‚æœçº¿ç¨‹å°è¯•è·å¾—äº’æ–¥é”æˆåŠŸï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥åˆ¤æ–­æ•°æ®æ˜¯å¦åˆå§‹åŒ–è¿‡ï¼ˆ<code>flag</code> ä¸º <code>false</code>ï¼‰ï¼Œå¦‚æœæ²¡æœ‰åˆå§‹åŒ–ï¼Œåˆ™è¿›è¡Œæ•°æ®çš„åˆå§‹åŒ–ï¼Œå¹¶å°† <code>flag</code> æ ‡è®°ç½®ä¸º <code>true</code>ï¼›å¦åˆ™çº¿ç¨‹è¿”å›ã€‚å¦‚æœçº¿ç¨‹æ²¡æœ‰æˆåŠŸè·å¾—é”ï¼Œé‚£ä¹ˆå½“å‰çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹é‡Šæ”¾é”ï¼Œç„¶åå†è¿›è¡Œæ ‡è®° <code>flag</code> çš„åˆ¤æ–­ç­‰ä¸€ç³»åˆ—æ“ä½œã€‚</p><p>è™½ç„¶ä¸Šé¢çš„ä»£ç æˆåŠŸå®ç°äº†å¤šä¸ªçº¿ç¨‹å¹¶å‘äº’æ–¥åˆå§‹åŒ–å…±äº«æ•°æ®ï¼Œå¹¶ä¸”å…±äº«æ•°æ®ä¿è¯åªä¼šè¢«åˆå§‹åŒ–ä¸€æ¬¡ï¼Œä½†æ˜¯æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œåˆå§‹åŒ–å‡½æ•° <code>init()</code> æ—¶éƒ½éœ€è¦é€šè¿‡ <code>std::lock_guard</code> å°è¯•è·å¾—é”ï¼Œå¹¶ä¸”æœ€ç»ˆéƒ½éœ€è¦è·å¾—é”è¿›è¡Œ <code>flag</code> åˆå§‹åŒ–æ ‡è®°çš„åˆ¤æ–­ï¼ˆå³ä½¿åˆå§‹åŒ–å·²ç»å®Œæˆï¼‰ã€‚è¿™æ˜¾ç„¶é€ æˆäº†å¤šä½™çš„å¼€é”€ï¼Œæ•ˆç‡æ˜¯æ¯”è¾ƒä½çš„ã€‚</p><h2 id="2-åŒé‡æ£€æŸ¥é”å®š">2 åŒé‡æ£€æŸ¥é”å®š</h2><p>æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ä¸Šé¢ <a href="#1">é—®é¢˜èƒŒæ™¯</a> ä¸­çš„ä»£ç ï¼Œå¼•å…¥ä¸€ç§ç§°ä¸º â€œåŒé‡æ£€æŸ¥é”å®šæ¨¡å¼â€ï¼ˆDouble-Checked Locking Pattern, DCLPï¼‰çš„æŠ€æœ¯ã€‚è¿™ç§æ¨¡å¼å¯ä»¥å‡å°‘ä¸€å®šçš„å¼€é”€ï¼Œä½†æ˜¯å®é™…ä¸Šåœ¨ <a href="#1">é—®é¢˜èƒŒæ™¯</a> ä¸­çš„ä»£ç è¿˜æ˜¯ä¼šå­˜åœ¨é—®é¢˜ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br>std::mutex mtx; <span class="hljs-comment">// äº’æ–¥é‡</span><br><span class="hljs-type">bool</span> flag;      <span class="hljs-comment">// æ ‡è®°æ˜¯å¦åˆå§‹åŒ–</span><br><span class="hljs-type">int</span> val;        <span class="hljs-comment">// å¾…åˆå§‹åŒ–æ•°æ®</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(!flag)&#123; <span class="hljs-comment">// åŒé‡æ£€æŸ¥</span><br>        <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>; <span class="hljs-comment">// äº’æ–¥é”</span><br>        <span class="hljs-keyword">if</span>(!flag)&#123; <span class="hljs-comment">// è¿˜æœªåˆå§‹åŒ–</span><br>            std::cout &lt;&lt; <span class="hljs-string">&quot;value initializing ... &quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>            val = <span class="hljs-number">1</span>;     <span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®ä¸º 1</span><br>            std::cout &lt;&lt; <span class="hljs-string">&quot;value initialized as: &quot;</span> &lt;&lt; val &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>            flag = <span class="hljs-literal">true</span>; <span class="hljs-comment">// æ ‡è®°ä¸ºå·²ç»åˆå§‹åŒ–</span><br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">threads</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : threads) t = std::<span class="hljs-built_in">thread</span>(init);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : threads) t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åŸæœ¬ä»£ç å—çš„ä¸Šå¢åŠ ä¸€ä¸ªå¤–å±‚çš„ <code>flag</code> æ ‡è®°çš„åˆ¤æ–­ã€‚å¦‚æœ <code>flag</code> æ ‡è®°ä¸º <code>true</code>ï¼Œè¡¨æ˜æ•°æ®åˆå§‹åŒ–è¿‡äº†ï¼Œé‚£ä¹ˆåœ¨å¤–å±‚çš„åˆ¤æ–­ä¸­ï¼Œå‘ç° <code>flag</code> ä¸º <code>true</code>ï¼Œé‚£ä¹ˆå°±ä¼šç›´æ¥è¿”å›ï¼Œè€Œä¸ä¼šå†å°è¯•è·å¾—é”å¹¶ä¸”æœ€åéœ€è¦å»è·å¾—é”è¿›è¡Œå†…å±‚ <code>flag</code> æ ‡è®°çš„åˆ¤æ–­ï¼›å¦‚æœ <code>flag</code> æ ‡è®°ä¸º <code>false</code>ï¼Œé‚£ä¹ˆæ•°æ®æ²¡æœ‰åˆå§‹åŒ–è¿‡ï¼Œç„¶åä¼šå°è¯•è·å¾—é”ï¼Œè·å¾—é”ä¹‹åå†…å±‚è¿›è¡Œ <code>flag</code> æ ‡è®°çš„åˆ¤æ–­ï¼Œå†è¿›è¡Œä¸€ç³»åˆ—åˆå§‹åŒ–çš„æ“ä½œã€‚</p><p>ä¸Šé¢çš„ä»£ç çœ‹ä¼¼å¯ä»¥è§£å†³åŠ é”é€ æˆçš„å¤šä½™å¼€é”€çš„é—®é¢˜ï¼Œè¿è¡Œèµ·æ¥æœ‰æ—¶å€™çœ‹ä¼¼ä¹Ÿæ²¡é—®é¢˜ï¼Œä½†å®é™…ä¸Šæœ‰ç€æ¯”è¾ƒæ˜æ˜¾çš„ <strong>çº¿ç¨‹å®‰å…¨</strong> çš„é—®é¢˜ã€‚</p><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>flag</code> æ ‡è®°çš„è¯»å–å’Œå†™å…¥æ“ä½œå¯èƒ½é€šè¿‡ç³»ç»Ÿçš„è°ƒåº¦ã€æ’åºã€‚ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨è®¾ç½® <code>flag</code> æ ‡è®°ä¸º <code>true</code> æ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å¯èƒ½çœ‹åˆ°è¿˜æœªæ›´æ–°å®Œçš„çŠ¶æ€ï¼ˆå¯èƒ½å‡ºç°å¤šä¸ªçº¿ç¨‹åŒæ—¶åˆ¤æ–­ <code>flag</code> ä¸º <code>false</code> çš„æƒ…å†µï¼‰ã€‚è¿™é€ æˆäº†å†…éƒ¨çš„æ··ä¹±ï¼Œå‡ºç°äº†å¤šçº¿ç¨‹ <strong>æ•°æ®ç«äº‰</strong> ç­‰é—®é¢˜ï¼Œ<strong>ç ´åäº†å¹¶å‘å®‰å…¨</strong>ã€‚</p><p>å¦‚æœè¦ä¿æŒä¸Šé¢ä»£ç å½¢å¼çš„åŸºç¡€ä¸Šå»è¿›è¡Œä¿®æ”¹ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘å°† <code>flag</code> è®¾å®šä¸º <code>std::atomic</code> åŸå­å¸ƒå°”å€¼ç­‰ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æš‚æ—¶è¿˜æ²¡æœ‰å…·ä½“å­¦ä¹ è¿‡ <code>std::atomic</code> åŸå­æ“ä½œçš„çŸ¥è¯†ï¼Œä¹Ÿä¸æƒ³å¢åŠ å¤šä½™çš„åŠ é”çš„å¼€é”€ï¼Œè¯¥å¦‚ä½•å®ç°å¤šçº¿ç¨‹å¹¶å‘äº’æ–¥åˆå§‹åŒ–æ•°æ®ï¼Œå¹¶ä¸”ä¿è¯æ•°æ®åªè¢«åˆå§‹åŒ–ä¸€æ¬¡å‘¢ï¼Ÿ</p><h2 id="3-std-call-once-std-once-flag">3 std::call_once, std::once_flag</h2><h3 id="3-1-åŸºæœ¬æ¦‚å¿µ">3.1 åŸºæœ¬æ¦‚å¿µ</h3><p><code>std::call_once</code> æ˜¯ C++ 11 å¼•å…¥çš„ä¸€ä¸ªå‡½æ•°æ¨¡æ¿ï¼Œå®šä¹‰åœ¨ <code>&lt;mutex&gt;</code> å¤´æ–‡ä»¶ä¸­ã€‚è¿™ä¸ªå‡½æ•°æ¨¡æ¿ä¸»è¦ä½œç”¨æ˜¯ <strong>ä¿è¯ä¸€ä¸ªå‡½æ•°ï¼ˆå¯è°ƒç”¨å¯¹è±¡ï¼‰åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹åªè¢«è°ƒç”¨ä¸€æ¬¡</strong>ã€‚</p><p><code>std::call_once</code> çš„å‡½æ•°åŸå‹å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">class</span> Callable, <span class="hljs-keyword">class</span>... Args&gt; </span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">call_once</span><span class="hljs-params">( std::once_flag&amp; flag, Callable&amp;&amp; f, Args&amp;&amp;... args )</span></span>;<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ <code>flag</code> æ˜¯ä¸€ä¸ª <code>std::once_flag</code> ç±»å‹å¯¹è±¡ï¼Œç”¨äºæ ‡è®°å‡½æ•°ï¼ˆå¯è°ƒç”¨å¯¹è±¡ï¼‰ <code>f</code> æ˜¯å¦å·²ç»è¢«è°ƒç”¨è¿‡ã€‚<code>Callable</code> æ˜¯ä¸€ä¸ªå¯è°ƒç”¨ç±»å‹å¯¹è±¡ï¼ˆå¦‚å‡½æ•°ã€å‡½æ•°æŒ‡é’ˆã€lambda è¡¨è¾¾å¼ç­‰ï¼‰ï¼Œ<code>args</code> æ˜¯ä¼ é€’ç»™å‡½æ•°ï¼ˆå¯è°ƒç”¨å¯¹è±¡ï¼‰<code>Callable</code> çš„å‚æ•°ã€‚</p><h3 id="3-2-ä»£ç ç¤ºä¾‹">3.2 ä»£ç ç¤ºä¾‹</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>std::call_once</code> é…åˆ <code>std::once_flag</code> æ¥å®ç° <a href="#1">é—®é¢˜èƒŒæ™¯</a> ä¸­çš„ä»£ç æ‰€å®ç°çš„å¤šçº¿ç¨‹åˆå§‹åŒ–ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br>std::mutex mtx;       <span class="hljs-comment">// äº’æ–¥é‡</span><br>std::once_flag flag;  <span class="hljs-comment">// æ ‡è®°</span><br><span class="hljs-type">int</span> val;              <span class="hljs-comment">// å…±äº«æ•°æ®</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span>&#123;<br>    std::<span class="hljs-built_in">call_once</span>(flag, []()&#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;value initializing ... &quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        val = <span class="hljs-number">1</span>;  <span class="hljs-comment">// åˆå§‹åŒ–ä¸º 1</span><br>        std::cout &lt;&lt; <span class="hljs-string">&quot;value initialized as: &quot;</span> &lt;&lt; val &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">threads</span><span class="hljs-params">(<span class="hljs-number">5</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : threads) t = std::<span class="hljs-built_in">thread</span>(init);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : threads) t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª <code>std::once_flag</code> æ ‡è®°ï¼Œç”¨äºæ ‡è®° <code>std::call_once</code> ä¸­çš„ <code>lambda</code> åŒ¿åå‡½æ•°æ˜¯å¦è¢«è°ƒç”¨è¿‡ã€‚<code>std::call_once</code> ä¸­çš„ <code>lambda</code> åŒ¿åå‡½æ•°æ‰§è¡Œå°†å…±äº«æ•°æ® <code>val</code> åˆå§‹åŒ–ä¸º <code>1</code>ã€‚</p><p>å¦‚æœ <code>lambda</code> å‡½æ•°æœªè¢«è°ƒç”¨è¿‡ï¼Œ<code>flag</code> å¤„äºæœªè¢«è°ƒç”¨çŠ¶æ€ï¼Œæ­¤æ—¶ <code>std::call_once</code> ä¼šè°ƒç”¨è¿™ä¸ª <code>lambda</code> å‡½æ•°ï¼Œè¿›è¡Œæ•°æ®çš„åˆå§‹åŒ–ï¼Œç„¶å <code>flag</code> ä¼šæ ‡è®°ä¸ºå·²ç»è°ƒç”¨çŠ¶æ€ï¼›</p><p>å¦‚æœ <code>lambda</code> å‡½æ•°å·²ç»è°ƒç”¨è¿‡ï¼Œ<code>flag</code> å¤„äºå·²ç»è°ƒç”¨çŠ¶æ€ï¼Œé‚£ä¹ˆå‡½æ•°ä¸ä¼šè¢«æ‰§è¡Œï¼Œå‚æ•°ä¹Ÿä¸ä¼šè¢«æ‹·è´æˆ–ç§»åŠ¨ï¼ˆå‚æ•°ä¼ é€’ï¼‰ã€‚</p><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/30/3l8ra.png" alt=""></p><h3 id="3-3-å†…éƒ¨åŸç†">3.3 å†…éƒ¨åŸç†</h3><p><code>std::call_once</code> çš„å†…éƒ¨åŸç†ä¾èµ–äºåŸå­æ“ä½œå’Œå†…å­˜å±éšœï¼ˆmemory barriersï¼‰æ¥ç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸”åªè°ƒç”¨ä¸€æ¬¡æŒ‡å®šçš„å‡½æ•°ã€‚</p><p>ä»¥ä¸‹æ˜¯ <code>std::call_once</code> çš„éƒ¨åˆ†æºç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> _Callable, <span class="hljs-keyword">typename</span>... _Args&gt;</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">call_once</span><span class="hljs-params">(once_flag&amp; __once, _Callable&amp;&amp; __f, _Args&amp;&amp;... __args)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ __callableï¼Œè¯¥å¯¹è±¡è°ƒç”¨ __f å‡½æ•°å¹¶ä¼ é€’å‚æ•° __args...</span><br>  <span class="hljs-keyword">auto</span> __callable = [&amp;] &#123;<br>    std::__invoke(std::forward&lt;_Callable&gt;(__f), std::forward&lt;_Args&gt;(__args)...);<br>  &#125;;<br><br>  <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª __exec å¯¹è±¡ï¼Œå¹¶åœ¨å…¶ææ„æ—¶è°ƒç”¨ __callable</span><br>  once_flag::_Prepare_execution __exec(__callable);<br><br>  <span class="hljs-comment">// è°ƒç”¨ __gthread_once å‡½æ•°æ‰§è¡Œä¸€æ¬¡æ€§æ“ä½œ</span><br>  <span class="hljs-keyword">if</span> (<span class="hljs-type">int</span> __e = __gthread_once(&amp;__once._M_once, &amp;__once_proxy))<br>    __throw_system_error(__e);<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„æºç ä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ª <code>once_flag::_Prepare_execution</code> å¯¹è±¡ <code>__exec</code>ï¼Œè¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼Œå¹¶åœ¨å…¶ææ„æ—¶è°ƒç”¨è¯¥å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡çš„ä½œç”¨æ˜¯ç¡®ä¿åœ¨ <code>std::call_once</code> å‡½æ•°æ‰§è¡Œç»“æŸåï¼Œå¯è°ƒç”¨å¯¹è±¡ <code>__callable</code> è¢«æ­£ç¡®åœ°æ‰§è¡Œã€‚ï¼ˆ<code>__callable</code> ä¸­è°ƒç”¨ <code>std::invoke</code> å‡½æ•°æ¥æ‰§è¡Œå¯è°ƒç”¨å¯¹è±¡ <code>__f</code>ï¼‰</p><p>ç„¶åï¼Œè°ƒç”¨äº† <code>__gthread_once</code> å‡½æ•°æ¥æ‰§è¡Œä¸€æ¬¡æ€§æ“ä½œã€‚è¯¥å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ä¸­ï¼Œç¬¬ä¸€ä¸ªæ˜¯æŒ‡å‘ <code>__once._M_once</code> å˜é‡çš„æŒ‡é’ˆï¼Œç¬¬äºŒä¸ªæ˜¯æŒ‡å‘ <code>__once_proxy</code> å‡½æ•°çš„æŒ‡é’ˆã€‚<code>__once._M_once</code> æ˜¯ä¸€ä¸ª <strong>åŸå­ç±»å‹çš„å˜é‡</strong>ï¼Œç”¨äºè®°å½•ä¸€æ¬¡æ€§æ“ä½œæ˜¯å¦å·²ç»è¢«æ‰§è¡Œè¿‡ï¼›<code>__once_proxy</code> å‡½æ•°æ˜¯ä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼Œå…¶ä½œç”¨æ˜¯ <strong>è°ƒç”¨ <code>__exec</code> å¯¹è±¡çš„å¯è°ƒç”¨å¯¹è±¡</strong>ã€‚</p><h1>å‚è€ƒ</h1><ol><li><p><a href="https://blog.csdn.net/weixin_45030965/article/details/130813168">C++11 call_once å’Œ once_flag</a></p></li><li><p><a href="https://en.cppreference.com/w/cpp/thread/call_once">cppreference std::call_once</a></p></li><li><p><a href="https://en.cppreference.com/w/cpp/thread/once_flag">cppreference std::once_flag</a></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
      <tag>std::mutex</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€std::shared_mutexï¼Œstd::shared_lock</title>
    <link href="/2024/12/29/20241229/"/>
    <url>/2024/12/29/20241229/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æºï¼š<a href="https://www.pixiv.net/artworks/95319826">pixiv_id=95319826</a></p><h2 id="1-std-shared-mutex-åŸºæœ¬æ¦‚å¿µ">1 std::shared_mutex åŸºæœ¬æ¦‚å¿µ</h2><p><code>std::shared_mutex</code> åœ¨ C++ 17 è¢«æ­£å¼å¼•å…¥ï¼Œæ˜¯ä¸€ç§äº’æ–¥é‡ï¼ˆmutexï¼‰ç±»å‹ï¼ŒåŒ…å«åœ¨ <code>&lt;shared_mutex&gt;</code> å¤´æ–‡ä»¶ä¸­ã€‚<code>std::shared_mutex</code> ç”¨äºå¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„å¹¶å‘æ§åˆ¶ï¼Œå¯ä»¥å®ç°å¤šä¸ªçº¿ç¨‹ä¹‹é—´å¯¹å…±äº«æ•°æ®çš„äº’æ–¥æ“ä½œã€‚</p><p>ä¸ <code>std::mutex</code> ä¸åŒçš„æ˜¯ï¼Œ<code>std::shared_mutex</code> æä¾›äº†ä¸¤ç§ä¸åŒçš„é”æœºåˆ¶ï¼Œå…¶å¯ä»¥ä½œä¸º <strong>å…±äº«é”</strong> ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸º <strong>ç‹¬å é”</strong> ä½¿ç”¨ã€‚</p><p><strong>å…±äº«é”</strong> å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹å…±äº«æ•°æ®è¿›è¡Œè®¿é—®ï¼Œä¸€èˆ¬ç”¨äºå¤šä¸ªçº¿ç¨‹è¯»å–å…±äº«èµ„æºçš„æƒ…å†µã€‚åœ¨è¿™ç§æœºåˆ¶ä¸‹ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è·å¾—äº’æ–¥é‡çš„é”ï¼ˆå…±äº«é”ï¼‰ï¼Œåªè¦å¯¹æ•°æ®çš„æ“ä½œä»…é™äºè¯»å–ã€‚<strong>å…±äº«é”</strong> å¯ä»¥æé«˜å¤šçº¿ç¨‹è¯»å–æ•°æ®åœºæ™¯ä¸‹çš„å¹¶å‘æ€§èƒ½ã€‚</p><p><strong>ç‹¬å é”</strong> åªå…è®¸å•ä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»å¯¹å…±äº«æ•°æ®è¿›è¡Œæ“ä½œï¼Œä¸€èˆ¬ç”¨äºå¤šçº¿ç¨‹å¯¹å…±äº«æ•°æ®è¿›è¡Œä¿®æ”¹ç­‰æ“ä½œçš„æƒ…å†µã€‚<strong>ç‹¬å é”</strong> è¢«ä¸€ä¸ªçº¿ç¨‹å ç”¨æ—¶ï¼Œå…¶ä»–çº¿ç¨‹å°±æ— æ³•è·å¾—è¿™ä¸ªé”ï¼Œç›´åˆ°è¿™ä¸ªç‹¬å é”è¢«é‡Šæ”¾ï¼Œä»¥ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§ã€‚ä¾‹å¦‚ <code>std::mutex</code>ï¼Œ<code>std::timed_mutex</code> éƒ½å±äº <strong>ç‹¬å é”</strong>ï¼Œä¸”åªèƒ½ä½œä¸ºç‹¬å é”ä½¿ç”¨ã€‚</p><h2 id="2-std-shared-mutex-æ¼”å˜è¿‡ç¨‹">2 std::shared_mutex æ¼”å˜è¿‡ç¨‹</h2><p><code>std::shared_mutex</code> å…¶å®æœ€æ—©æ˜¯åœ¨ C++ 14 çš„æ—¶å€™è¢«å¼•å…¥ï¼Œä½†æ˜¯æ­¤æ—¶çš„ <code>std::shared_mutex</code> æ˜¯ <strong>å¸¦æœ‰å®šæ—¶åŠŸèƒ½</strong> çš„ <strong>å…±äº«äº’æ–¥é”</strong>ï¼Œç›¸å½“äºç°åœ¨çš„ <code>std::shared_timed_mutex</code>ã€‚</p><p>ä¸€æ–¹é¢ä¸ºäº†ä¿æŒå‘½åçš„ä¸€è‡´æ€§ï¼Œå¦ä¸€æ–¹é¢ä¸ºäº†ç©ºå‡ºäº†ç©ºå‡º <strong>ä¸å¸¦å®šæ—¶åŠŸèƒ½</strong> çš„ <strong>å…±äº«é”</strong> <code>std::shared_mutex</code> çš„å®šä¹‰ï¼Œè®¾å®šä¸€ä¸ªæ›´åŠ ç®€å•ã€æ›´åŠ é«˜æ•ˆçš„å…±äº«é”ï¼Œå°†è¿™ä¸¤ç§å…±äº«é”è¿›è¡ŒåŒºåˆ†ï¼Œåæ¥ C++ 14 å¼•å…¥çš„ <code>std::shared_mutex</code> å°±æ”¹åä¸º <code>std::shared_timed_mutex</code>ï¼Œå¹¶ä¸”åœ¨ä¹‹åçš„ C++ 17 ä¸­æ­£å¼å¼•å…¥äº†ä¸å¸¦æœ‰å®šæ—¶åŠŸèƒ½çš„ <code>std::shared_mutex</code>ã€‚</p><p><img src="https://sukicdn.com/wyx/i/2024/12/29/4yn1g.png" alt=""></p><p>std::shared_mutex æ¼”å˜è¿‡ç¨‹è¯¦æƒ…å¯è§ <a href="https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3891.htm">A proposal to rename shared_mutex to shared_timed_mutex</a></p><h2 id="3-std-shared-mutex-æˆå‘˜å‡½æ•°">3 std::shared_mutex æˆå‘˜å‡½æ•°</h2><h3 id="3-1-lock-try-lock-unlock">3.1 lock(), try_lock(), unlock()</h3><p>åœ¨ <code>std::shared_mutex</code> ä¸­çš„ lock(), try_lock(), unlock() å‡½æ•°ï¼Œç”¨äº <code>std::shared_mutex</code> ä½œä¸ºç‹¬å é”æ—¶çš„åŠ é”ã€å°è¯•åŠ é”å’Œè§£é”ã€‚åŸºæœ¬çš„ç”¨æ³•å’Œ <code>std::mutex</code> ç›¸åŒã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;shared_mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br>std::shared_mutex s_mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(id &amp; <span class="hljs-number">1</span>)&#123;<br>        s_mtx.<span class="hljs-built_in">lock</span>(); <span class="hljs-comment">// shared_mutex ä½œä¸ºç‹¬å é”ä½¿ç”¨</span><br>        count ++ ;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;thread id = &quot;</span> &lt;&lt; id;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        s_mtx.<span class="hljs-built_in">unlock</span>();<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">if</span>(s_mtx.<span class="hljs-built_in">try_lock</span>())&#123;<br>            count ++ ;<br>            std::cout &lt;&lt; <span class="hljs-string">&quot;thread id = &quot;</span> &lt;&lt; id;<br>            std::cout &lt;&lt; <span class="hljs-string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>            s_mtx.<span class="hljs-built_in">unlock</span>();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">threads</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; threads.<span class="hljs-built_in">size</span>(); i ++ )&#123;<br>        threads[i] = std::<span class="hljs-built_in">thread</span>(foo, i);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : threads) t.<span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;final count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå¦‚æœçº¿ç¨‹çš„æ ‡è®°ä¸ºå¥‡æ•°ï¼Œé‚£ä¹ˆè°ƒç”¨ <code>std::shared_mutex::lock()</code> å’Œ <code>std::shared_mutex::unlock()</code> è¿›è¡Œæ‰‹åŠ¨çš„å°è¯•åŠ é”è§£é”ã€‚å¦‚æœå°è¯•åŠ é”åæˆåŠŸè·å¾—äº†é”ï¼Œé‚£ä¹ˆçº¿ç¨‹ç»§ç»­æ‰§è¡Œä¸‹å»ï¼›å¦åˆ™å½“å‰çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹é‡Šæ”¾äº†é”ã€‚</p><p>å¦‚æœçº¿ç¨‹çš„æ ‡è®°ä¸ºå¶æ•°ï¼Œé‚£ä¹ˆè°ƒç”¨ <code>std::shared_mutex::try_lock()</code> å»è¿›è¡Œéé˜»å¡åœ°å°è¯•åŠ é”ã€‚å¦‚æœæˆåŠŸè·å¾—é”ï¼Œé‚£ä¹ˆçº¿ç¨‹ç»§ç»­æ‰§è¡Œä¸‹å»ï¼›å¦åˆ™å½“å‰çº¿ç¨‹æ”¾å¼ƒè·å¾—é”ï¼Œç›´æ¥è¿”å›ã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/29/1329g6.png" alt=""></p><p>å¯ä»¥çœ‹å‡ºï¼Œä¸Šé¢çš„ä»£ç ä¸­å®Œå…¨å½“ä½œ <strong>ç‹¬å é”</strong> è¿›è¡Œä½¿ç”¨ï¼Œå’Œ <code>std::mutex</code> çš„ä½œç”¨æ˜¯ä¸€æ ·çš„ã€‚</p><h3 id="3-2-lock-shared-try-lock-shared-unlock-shared">3.2 lock_shared(), try_lock_shared(), unlock_shared()</h3><p>åœ¨ <code>std::shared_mutex</code> ä¸­çš„ lock_shared(), try_lock_shared(), unlock_shared() å‡½æ•°ç”¨äºä½œä¸º <strong>å…±äº«é”</strong> çš„åŠ é”ã€å°è¯•åŠ é”å’Œè§£é”ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;shared_mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br>std::shared_mutex s_mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">read</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i ++ )&#123;<br>        <span class="hljs-keyword">if</span>(id &amp; <span class="hljs-number">1</span>)&#123;<br>            s_mtx.<span class="hljs-built_in">lock_shared</span>(); <span class="hljs-comment">// shared_mutex ä½œä¸ºå…±äº«é”ä½¿ç”¨</span><br>            std::cout &lt;&lt; <span class="hljs-string">&quot;read thread id = &quot;</span> &lt;&lt; id;<br>            std::cout &lt;&lt; <span class="hljs-string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>            s_mtx.<span class="hljs-built_in">unlock_shared</span>();<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">if</span>(s_mtx.<span class="hljs-built_in">try_lock_shared</span>())&#123;<br>                std::cout &lt;&lt; <span class="hljs-string">&quot;read thread id = &quot;</span> &lt;&lt; id;<br>                std::cout &lt;&lt; <span class="hljs-string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>                s_mtx.<span class="hljs-built_in">unlock_shared</span>();<br>            &#125;<br>        &#125;<br>        std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">write</span><span class="hljs-params">()</span></span>&#123;<br>    s_mtx.<span class="hljs-built_in">lock</span>(); <span class="hljs-comment">// shared_mutex ä½œä¸ºç‹¬å é”ä½¿ç”¨</span><br>    count ++ ;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;write thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">1000</span>));<br>    s_mtx.<span class="hljs-built_in">unlock</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">readers</span><span class="hljs-params">(<span class="hljs-number">5</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; readers.<span class="hljs-built_in">size</span>(); i ++ )&#123;<br>        readers[i] = std::<span class="hljs-built_in">thread</span>(read, i);<br>    &#125;<br>    <span class="hljs-function">std::thread <span class="hljs-title">writer</span><span class="hljs-params">(write)</span></span>;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : readers) t.<span class="hljs-built_in">join</span>();<br>    writer.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæœ‰ è¯»çº¿ç¨‹ å’Œ å†™çº¿ç¨‹ï¼Œå…¶ä¸­è¯»çº¿ç¨‹æ‰§è¡Œçš„æ˜¯ <code>read</code> å‡½æ•°ï¼Œå†™çº¿ç¨‹æ‰§è¡Œçš„æ˜¯ <code>write</code> å‡½æ•°ã€‚æ¯ä¸ªè¯»çº¿ç¨‹ä¼šå¾ªç¯è¿›è¡Œ <code>5</code> æ¬¡è¯»å–æ•°æ®çš„æ“ä½œã€‚</p><p>åœ¨è¯»çº¿ç¨‹ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨ lock_shared(), try_lock_shared(), unlock_shared() å‡½æ•° æ¥å®ç°å…±äº«è¯»çš„æœºåˆ¶ã€‚å†™çº¿ç¨‹ä¸­ï¼Œåˆ™é‡‡ç”¨ç‹¬å é”çš„æœºåˆ¶ã€‚</p><p>ä¸€å¼€å§‹æœ‰å¤šä¸ªè¯»çº¿ç¨‹å…±äº«äº† <code>std::shared_mutex</code> äº’æ–¥é‡ <code>s_mtx</code> çš„é”ï¼Œä¸æ­¤åŒæ—¶ï¼Œç”±äºè¿™äº›è¯»çº¿ç¨‹å…±äº«äº†é”ï¼Œå†™çº¿ç¨‹å°è¯•è·å¾—é”ï¼ˆç‹¬å è¿™ä¸ªé”ï¼‰è¢«é˜»å¡ã€‚</p><p>ä¹‹åï¼Œå½“è¿™å¤šä¸ªè¯»çº¿ç¨‹å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ï¼Œå¹¶ä¸”å…¨éƒ¨å°†å…±äº«é”é‡Šæ”¾ï¼Œå†™çº¿ç¨‹ <strong>ä¼˜å…ˆ</strong> è·å¾—é”ã€‚å½“å†™çº¿ç¨‹è·å¾—é”æ—¶ï¼Œå…¶ä»–æ–°çš„è¯»çº¿ç¨‹å°è¯•è·å¾—é”ä¼šè¢«é˜»å¡ï¼ˆè°ƒç”¨ <code>try_lock_shared()</code> å‡½æ•°çš„è¯»çº¿ç¨‹åˆ™ä¼šç›´æ¥è¿”å›ï¼‰ï¼Œç›´åˆ°å†™çº¿ç¨‹é‡Šæ”¾é”ã€‚</p><p>å†™çº¿ç¨‹æ‰§è¡Œå®Œæ•°æ®ä¿®æ”¹æ“ä½œå¹¶é‡Šæ”¾é”ä¹‹åï¼Œå…¶ä»–æ–°çš„è¯»çº¿ç¨‹æ‰èƒ½å¤ŸæˆåŠŸå…±äº«é”ã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/29/sp78.png" alt=""></p><p>å¯ä»¥çœ‹å‡ºï¼Œä¸€å¼€å§‹æœ‰å¤šä¸ªè¯»çº¿ç¨‹å…±äº«é”ï¼Œæ­¤æ—¶çš„æ•°æ®ä¸º <code>0</code>ï¼›ç„¶åå½“è¿™äº›è¯»çº¿ç¨‹é‡Šæ”¾å…±äº«é”ä¹‹åï¼Œå†™çº¿ç¨‹ä¼˜å…ˆè·å¾—é”ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œåœ¨æ­¤æœŸé—´ï¼Œæ–°çš„è¯»çº¿ç¨‹å°è¯•å…±äº«é”è¢«é˜»å¡ï¼ˆè°ƒç”¨ <code>try_lock_shared()</code> å‡½æ•°çš„è¯»çº¿ç¨‹åˆ™ä¼šç›´æ¥è¿”å›ï¼‰ï¼›å½“å†™çº¿ç¨‹æ“ä½œå®Œå¹¶é‡Šæ”¾é”ä¹‹åï¼Œæ–°çš„è¯»çº¿ç¨‹æˆåŠŸå…±äº«é”ï¼Œå¹¶è¯»å–æ•°æ®ï¼Œæ­¤æ—¶çš„æ•°æ®ä¸º <code>1</code>ã€‚</p><h3 id="3-3-std-shared-mutex-è¯»å†™çº¿ç¨‹ä¼˜å…ˆçº§">3.3 std::shared_mutex è¯»å†™çº¿ç¨‹ä¼˜å…ˆçº§</h3><ul><li><p>è¯»å¹¶å‘ä¸å†™é˜»å¡</p><p>å½“æœ‰å¤šä¸ªè¯»çº¿ç¨‹è·å¾—å…±äº«é”æ—¶ï¼Œè¿™äº›è¯»çº¿ç¨‹å¯ä»¥å¹¶å‘åœ°å¯¹å…±äº«èµ„æºè¿›è¡Œè¯»å–æ“ä½œã€‚æ­¤æ—¶å¦‚æœæœ‰å†™çº¿ç¨‹å°è¯•è·å–ç‹¬å é”ï¼Œè¿™ä¸ªå†™çº¿ç¨‹ä¼šè¢«é˜»å¡ã€‚</p><p>é˜»å¡ä¼šä¸€ç›´æŒç»­ï¼Œç›´åˆ°æ‰€æœ‰å½“å‰æŒæœ‰å…±äº«é”çš„è¯»çº¿ç¨‹éƒ½é‡Šæ”¾äº†å…±äº«é”ã€‚</p></li><li><p>å†™ç‹¬å ä¸è¯»é˜»å¡</p><p>å½“ä¸€ä¸ªå†™çº¿ç¨‹å æœ‰ç‹¬å é”æ—¶ï¼Œæ–°çš„è¯»çº¿ç¨‹å°è¯•è·å–å…±äº«é”ä¼šè¢«é˜»å¡ã€‚<strong>ç‹¬å é”çš„ä¼˜å…ˆçº§é«˜äºå…±äº«é”</strong>ã€‚</p><p>è¿™ç§è®¾è®¡æ˜¯ä¸ºäº†é˜²æ­¢å†™æ“ä½œé¥¥é¥¿ï¼ˆwrite - starvationï¼‰çš„æƒ…å†µã€‚å¦‚æœè¯»çº¿ç¨‹ä¸æ–­åœ°è·å–å…±äº«é”ï¼Œè€Œå†™çº¿ç¨‹ä¸€ç›´æ— æ³•è·å–ç‹¬å é”æ¥æ‰§è¡Œå†™å…¥æ“ä½œï¼Œè¿™ä¼šå¯¼è‡´æ•°æ®ä¸èƒ½åŠæ—¶æ›´æ–°ã€‚</p></li></ul><p>å®é™…çš„è°ƒåº¦é¡ºåºè¿˜å¯èƒ½å—åˆ°æ“ä½œç³»ç»Ÿè°ƒåº¦ç­–ç•¥ä»¥åŠçº¿ç¨‹ä¼˜å…ˆçº§ç­‰å› ç´ çš„å½±å“ã€‚åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œè™½ç„¶åŸåˆ™ä¸Šå†™çº¿ç¨‹ç­‰å¾…è¯»çº¿ç¨‹é‡Šæ”¾é”ï¼Œè¯»çº¿ç¨‹ç­‰å¾…å†™çº¿ç¨‹é‡Šæ”¾é”ï¼Œä½†å…·ä½“çš„æ‰§è¡Œé¡ºåºå¯èƒ½ä¼šå› ä¸ºå¤–éƒ¨å› ç´ è€Œæœ‰æ‰€ä¸åŒã€‚</p><h2 id="4-std-shared-mutex-é…åˆ-std-shared-lock">4 std::shared_mutex é…åˆ std::shared_lock</h2><p>ä¸ºäº†ä¿æŒä»£ç ç®€æ´ï¼Œä»¥åŠä¸ºäº†é˜²æ­¢å‡ºç°åŠ é”ã€è§£é”æ··ä¹±çš„æƒ…å†µå‘ç”Ÿï¼Œæˆ‘ä»¬é€šå¸¸å¾ˆå°‘å»ä½¿ç”¨ <code>std::shared_mutex</code> ä¸­çš„ <code>lock()</code> ç­‰æˆå‘˜å‡½æ•°å»æ‰‹åŠ¨çš„åŠ é”ã€‚åœ¨ <code>std::mutex</code> ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>std::unique_lock</code> å»å®ç°è‡ªåŠ¨åŠ é”ï¼Œæ›´å¥½åœ°ç»´æŠ¤é”çš„ç®¡ç†æƒã€‚å› æ­¤ï¼ŒC++ ä¸­å¼•å…¥äº† <code>std::shared_lock</code>ï¼Œä¸“é—¨ç”¨äº <code>std::shared_mutex</code> äº’æ–¥é‡çš„é”çš„ç®¡ç†ã€‚</p><ul><li><p><code>std::shared_lock</code> åŸºæœ¬æ¦‚å¿µ</p><p><code>std::shared_lock</code> æ˜¯ C++ 14 å¼•å…¥çš„ç”¨äºç®¡ç† <code>std::shared_mutex</code>ï¼ˆå…±äº«äº’æ–¥é”ï¼‰çš„å…±äº«é”çš„ç±»æ¨¡æ¿ï¼ˆä¸é€‚ç”¨äºå…¶ä»–ç±»å‹çš„äº’æ–¥é‡ï¼Œä¾‹å¦‚ <code>std::mutex</code>ï¼‰ã€‚</p><p><code>std::shared_lock</code> æä¾›äº†ä¸€ç§ RAIIï¼ˆResource Acquisition Is Initializationï¼Œèµ„æºè·å–å³åˆå§‹åŒ–ï¼‰æ–¹å¼æ¥è·å–å’Œé‡Šæ”¾å…±äº«é”ï¼Œç¡®ä¿åœ¨å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶è‡ªåŠ¨é‡Šæ”¾é”ï¼Œä»è€Œé¿å…äº†å› å¿˜è®°é‡Šæ”¾é”è€Œå¯¼è‡´çš„èµ„æºç«äº‰å’Œæ­»é”ç­‰é—®é¢˜ã€‚</p></li></ul><p>å½“ <code>std::shared_mutex</code> ä½œä¸ºç‹¬å é”æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>std::unique_lock</code> å»å®ç° <code>std::shared_mutex</code> çš„è‡ªåŠ¨åŠ é”ã€è§£é”ï¼ŒåŒæ ·å¯ä»¥æ›´åŠ çµæ´»åœ°è¿›è¡ŒåŠ é”è§£é”çš„å¤„ç†ã€‚</p><p>åŸºæœ¬çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c++">std::shared_mutex mtx;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">read</span><span class="hljs-params">()</span></span>&#123; <span class="hljs-comment">// è¯»çº¿ç¨‹</span><br>    <span class="hljs-function">std::shared_lock&lt;std::shared_mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>; <span class="hljs-comment">// å…±äº«</span><br>    <span class="hljs-comment">// è¿›è¡Œå¯¹å…±äº«èµ„æºçš„è¯»æ“ä½œ</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">write</span><span class="hljs-params">()</span></span>&#123; <span class="hljs-comment">// å†™çº¿ç¨‹</span><br>    <span class="hljs-function">std::unique_lock&lt;std::shared_mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;  <span class="hljs-comment">// ç‹¬å </span><br>    <span class="hljs-comment">// è¿›è¡Œå¯¹å…±äº«èµ„æºçš„å†™æ“ä½œ</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªè¯»è€…ã€å†™è€…é—®é¢˜çš„å¤šçº¿ç¨‹ä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;shared_mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Reader_Writer</span>&#123;<br>    std::shared_mutex s_mtx;  <span class="hljs-comment">// äº’æ–¥é‡</span><br>    <span class="hljs-type">int</span> val = <span class="hljs-number">0</span>;              <span class="hljs-comment">// å…±äº«æ•°æ®</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// è¯»æ“ä½œ</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">read_data</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span></span>&#123;<br>        <span class="hljs-function">std::shared_lock&lt;std::shared_mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(s_mtx)</span></span>; <span class="hljs-comment">// å…±äº«é”</span><br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Reader &quot;</span> &lt;&lt; id &lt;&lt; <span class="hljs-string">&quot; reads the value = &quot;</span> &lt;&lt; val &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br>    <span class="hljs-comment">// è¯»è€…ï¼Œè¿›è¡Œ 100 æ¬¡è¯»æ“ä½œ</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">reader</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span></span>&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i ++ )&#123;<br>            <span class="hljs-built_in">read_data</span>(id);<br>            std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// å†™æ“ä½œ</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">write_data</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span></span>&#123;<br>        <span class="hljs-function">std::unique_lock&lt;std::shared_mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(s_mtx)</span></span>; <span class="hljs-comment">// ç‹¬å é”</span><br>        val ++ ;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Writer &quot;</span> &lt;&lt; id &lt;&lt; <span class="hljs-string">&quot; writes the value = &quot;</span> &lt;&lt; val &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br>    <span class="hljs-comment">// å†™è€…ï¼Œè¿›è¡Œ 10 æ¬¡å†™æ“ä½œ</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">writer</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span></span>&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i ++ )&#123;<br>            <span class="hljs-built_in">write_data</span>(id);<br>            std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">1000</span>));<br>        &#125;<br>    &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    Reader_Writer obj;<br>    <span class="hljs-comment">// åˆ›å»º 10 ä¸ªè¯»è€…çº¿ç¨‹å’Œ 2 ä¸ªå†™è€…çº¿ç¨‹</span><br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">readers</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; readers.<span class="hljs-built_in">size</span>(); i ++ )&#123;<br>        readers[i] = std::<span class="hljs-built_in">thread</span>(&amp;Reader_Writer::reader, &amp;obj, i);<br>    &#125;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">writers</span><span class="hljs-params">(<span class="hljs-number">2</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; writers.<span class="hljs-built_in">size</span>(); i ++ )&#123;<br>        writers[i] = std::<span class="hljs-built_in">thread</span>(&amp;Reader_Writer::writer, &amp;obj, i);<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; reader : readers) reader.<span class="hljs-built_in">join</span>();<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; writer : writers) writer.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ª Reader_Writer ç±»ï¼ŒåŒ…å«ä¸€ä¸ªå…±äº«æ•°æ® <code>val</code> å’Œä¸€ä¸ªå…±äº«äº’æ–¥é‡ <code>s_mtx</code>ã€‚</p><p>Reader_Writer ç±»åŒ…å«äº†è¯»çº¿ç¨‹å‡½æ•° <code>reader</code>ï¼ˆå†…éƒ¨è°ƒç”¨è¯»æ“ä½œå‡½æ•° <code>read_data</code>ï¼‰ï¼ŒåŒæ—¶è¿˜æœ‰å†™çº¿ç¨‹å‡½æ•° <code>writer</code>ï¼ˆå†…éƒ¨è°ƒç”¨å†™æ“ä½œå‡½æ•° <code>write_data</code>ï¼Œæ¯æ¬¡å¯¹æ•°æ® <code>val</code> è¿›è¡Œ <code>+1</code>ï¼‰ã€‚</p><p>ä¸€å…±åˆ›å»ºäº† <code>10</code> ä¸ªè¯»è€…çº¿ç¨‹å’Œ <code>2</code> ä¸ªå†™è€…çº¿ç¨‹ï¼Œçº¿ç¨‹æ¥å£å‡½æ•°åˆ†åˆ«ä¸º <code>Reader_Writer::reader</code> å’Œ <code>Reader_Writer::writer</code>ã€‚åœ¨çº¿ç¨‹æ¥å£å‡½æ•°ä¸­ï¼Œ<code>Reader_Writer::reader</code> é‡‡ç”¨ <code>std::shared_lock</code> å®ç°äº†å¤šä¸ªè¯»çº¿ç¨‹å…±äº«é”çš„è‡ªåŠ¨åŠ é”è§£é”ï¼› <code>Reader_Writer::writer</code> é‡‡ç”¨ <code>std::unique_lock</code> å®ç°å†™è€…çº¿ç¨‹ä¹‹é—´äº’æ–¥è®¿é—®å…±äº«æ•°æ®ï¼ˆç‹¬å é”æœºåˆ¶ï¼‰ï¼Œä»¥åŠè‡ªåŠ¨çš„åŠ é”è§£é”ã€‚</p><p>è¯»è€…/å†™è€…çº¿ç¨‹åœ¨å¾ªç¯ä¸­æ¯æ¬¡è¯»/å†™æ“ä½œå®Œæˆå¹¶é‡Šæ”¾é”ä¹‹åï¼Œå½“å‰çº¿ç¨‹éƒ½è¿›è¡Œä¸€ä¸ªå°æ—¶é—´æ®µçš„ä¼‘æ¯ï¼Œé¿å…é¢‘ç¹åœ°è¯»/å†™æ•°æ®ã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/29/tw1j.png" alt=""></p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ol><li><p><a href="https://en.cppreference.com/w/cpp/thread/shared_mutex">cppreference std::share_mutex</a></p></li><li><p><a href="https://en.cppreference.com/w/cpp/thread/shared_lock">cppreference std::shared_lock</a></p></li><li><p><a href="https://stackoverflow.com/questions/40207171/why-shared-timed-mutex-is-defined-in-c14-but-shared-mutex-in-c17">Why shared_timed_mutex is defined in c++14, but shared_mutex in c++17?</a></p></li><li><p><a href="https://cloud.tencent.com/developer/ask/sof/113669065">ä¸ºä»€ä¹ˆshared_timed_mutexæ˜¯åœ¨c++14ä¸­å®šä¹‰çš„ï¼Œè€Œshared_mutexæ˜¯åœ¨c++17ä¸­å®šä¹‰çš„ï¼Ÿ</a></p></li><li><p><a href="https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3891.htm">A proposal to rename shared_mutex to shared_timed_mutex</a></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
      <tag>std::mutex</tag>
      
      <tag>std::shared_mutex</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€std::recursive_mutex åŸºæœ¬ç”¨æ³•</title>
    <link href="/2024/12/28/20241228_/"/>
    <url>/2024/12/28/20241228_/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æºï¼š<a href="https://www.pixiv.net/artworks/123093870">pixiv_id=123093870</a></p><h2 id="1-std-recursive-mutex-åŸºæœ¬æ¦‚å¿µ">1 std::recursive_mutex åŸºæœ¬æ¦‚å¿µ</h2><p><code>std::recursive_mutex</code> æ˜¯ C++ 11 å¼•å…¥çš„ä¸€ç§ <strong>ç‹¬å </strong> ä¸” <strong>é€’å½’</strong> çš„äº’æ–¥é‡ç±»å‹ï¼Œç”¨äºæ§åˆ¶å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºçš„å¹¶å‘äº’æ–¥è®¿é—®ã€‚</p><p><code>std::recursive_mutex</code> åŒ…å«äº† <code>std::mutex</code> çš„åŸºæœ¬åŠŸèƒ½ï¼ŒåŒ…æ‹¬ <code>lock()</code> å’Œ <code>unlock()</code> å‡½æ•°è¿›è¡ŒåŠ é”å’Œè§£é”ã€<code>try_lock()</code> ä»¥éé˜»å¡çš„æ–¹å¼å°è¯•è·å¾—é”ã€‚</p><p>ä¸ <code>std::mutex</code> ä¸åŒçš„æ˜¯ï¼Œ<code>std::recursive_mutex</code> å…è®¸çº¿ç¨‹æ‹¥æœ‰å½“å‰äº’æ–¥é”çš„æœŸé™å†…ï¼Œ<strong>å¯ä»¥é‡å¤è¿›è¡Œå°è¯•åŠ é”</strong>ï¼ˆè°ƒç”¨ <code>lock()</code> æˆ– <code>try_lock()</code> å‡½æ•°ï¼‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œçº¿ç¨‹ <strong>éœ€è¦è¿›è¡Œå¯¹åº”æ•°é‡æ¬¡æ•°çš„è§£é”</strong>ï¼ˆè°ƒç”¨ <code>unlock()</code>ï¼‰æ‰å¯ä»¥å®Œå…¨é‡Šæ”¾å½“å‰äº’æ–¥é‡çš„é”ã€‚</p><p><code>std::recursive_mutex</code> æä¾›äº†å¯ä»¥é‡å¤åŠ é”çš„æœºåˆ¶ï¼Œé€šå¸¸ä¹Ÿå¯ä»¥ç§°ä¹‹ä¸º <strong>é€’å½’é”</strong>ã€‚</p><p>ç”±äºæä¾›äº†é‡å¤ï¼ˆé€’å½’ï¼‰åŠ é”çš„ç‰¹æ€§ï¼Œ<code>std::recursive_mutex</code> çš„æ•ˆç‡æ˜¯æ¯”è¾ƒä½çš„ã€‚å½“ä½¿ç”¨äº†é€’å½’é”æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸è¦è€ƒè™‘ä»£ç æ˜¯å¦è¿˜æœ‰ä¼˜åŒ–ç©ºé—´ï¼Œå°½é‡é¿å…ä½¿ç”¨é€’å½’é”ã€‚é€’å½’æ¬¡æ•°é€šå¸¸æœ‰é™åˆ¶ï¼ˆçˆ†æ ˆï¼‰ï¼Œä½†åœ¨ C++ ä¸­ä¸€èˆ¬è¾ƒå°‘å‡ºç°æ­¤æƒ…å†µã€‚</p><p><a id="std_mutex"></a></p><h2 id="2-std-mutex-é‡å¤åŠ é”å‡ºé”™">2 std::mutex é‡å¤åŠ é”å‡ºé”™</h2><p>æˆ‘ä»¬å¦‚æœé‡‡ç”¨æ™®é€šçš„ <code>std::mutex</code>ï¼Œè¿›è¡Œé‡å¤å°è¯•åŠ é”ï¼Œä¸€èˆ¬ä¼šå‡ºç°æ­»é”çš„çŠ¶å†µï¼Œå‡ºç°æœªå®šä¹‰è¡Œä¸ºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br>std::mutex mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> k)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(k == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;<br>    mtx.<span class="hljs-built_in">lock</span>();     <span class="hljs-comment">// åŠ é”</span><br>    count ++ ;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-built_in">dfs</span>(k - <span class="hljs-number">1</span>);     <span class="hljs-comment">// é€’å½’</span><br>    mtx.<span class="hljs-built_in">unlock</span>();   <span class="hljs-comment">// è§£é”</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">threads</span><span class="hljs-params">(<span class="hljs-number">3</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : threads) t = std::<span class="hljs-built_in">thread</span>(dfs, <span class="hljs-number">5</span>);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : threads) t.<span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;final count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå†™äº†ä¸€ä¸ªé€’å½’å‡½æ•° <code>dfs()</code>ï¼Œå®ç°äº†åµŒå¥—çš„é‡å¤å°è¯•åŠ é”ã€‚åˆ›å»ºäº† <code>3</code> ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹é€’å½’ <code>5</code> å±‚ï¼Œé€’å½’çš„æ¯ä¸€å±‚éœ€è¦å…ˆè¿›è¡ŒåŠ é”ï¼Œç„¶åå¯¹å…±äº«æ•°æ® <code>count</code> è¿›è¡Œ <code>+1</code>ï¼Œå¹¶è¾“å‡ºæ•°æ®çš„å€¼ã€‚é€’å½’çš„æ¯ä¸€å±‚ç»“æŸè¿›è¡Œè§£é”ã€‚ç›´åˆ° <code>k</code> ä¸º <code>0</code> æ—¶é€€å‡ºé€’å½’ã€‚</p><p>åœ¨ Windows ç³»ç»Ÿä¸­è¿è¡Œå¯èƒ½çš„ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/28/s9ns.png" alt=""></p><p>åœ¨ Windows ç³»ç»Ÿä¸­ï¼Œç³»ç»Ÿå¯èƒ½ä¼šé€šè¿‡é‡‡å–ä¸€äº›ä¼˜åŒ–ç­–ç•¥ã€çº¿ç¨‹è°ƒåº¦ç­‰ï¼Œçœ‹ä¼¼æ­£ç¡®è¿è¡Œèµ·æ¥äº†ï¼Œä½†å®é™…ä¸Šä»£ç è¿˜æ˜¯é”™è¯¯çš„ã€‚</p><p>åœ¨ Linux ç³»ç»Ÿä¸­è¿è¡Œå¯èƒ½çš„ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/28/41er.png" alt=""></p><p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæ˜¾ç„¶ç¨‹åºè¿è¡Œä¸åŠ¨äº†ï¼Œè¡¨æ˜å‡ºç°äº†æ­»é”ã€‚</p><h2 id="3-std-recursive-mutex-å®ç°é‡å¤åŠ é”">3 std::recursive_mutex å®ç°é‡å¤åŠ é”</h2><p>æˆ‘ä»¬å¯ä»¥å°† <a href="#std_mutex">std::mutex é‡å¤åŠ é”å‡ºé”™</a> ä»£ç ä¸­çš„ <code>std::mutex</code> å…¨éƒ¨æ¢æˆ <code>std::recursive_mutex</code> å³å¯ã€‚ä¿®æ”¹åå°±å¯ä»¥ä½¿å¾—çº¿ç¨‹å¯¹ä¸€ä¸ªäº’æ–¥é‡è¿›è¡Œé‡å¤åŠ é”ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br>std::mutex r_mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> k)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(k == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;<br>    r_mtx.<span class="hljs-built_in">lock</span>();   <span class="hljs-comment">// åŠ é”</span><br>    count ++ ;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-built_in">dfs</span>(k - <span class="hljs-number">1</span>);     <span class="hljs-comment">// é€’å½’</span><br>    r_mtx.<span class="hljs-built_in">unlock</span>(); <span class="hljs-comment">// è§£é”</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">threads</span><span class="hljs-params">(<span class="hljs-number">3</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : threads) t = std::<span class="hljs-built_in">thread</span>(dfs, <span class="hljs-number">5</span>);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : threads) t.<span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;final count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/28/139648.png" alt=""></p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ol><li><a href="https://en.cppreference.com/w/cpp/thread/recursive_mutex">cppreference.com recursive_mutex</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
      <tag>std::mutex</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€std::timed_mutex åŸºæœ¬ç”¨æ³•</title>
    <link href="/2024/12/28/20241228/"/>
    <url>/2024/12/28/20241228/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æºï¼š<a href="https://www.pixiv.net/artworks/52826716">pixiv_id=52826716</a></p><h2 id="1-std-timed-mutex-åŸºæœ¬æ¦‚å¿µ">1 std::timed_mutex åŸºæœ¬æ¦‚å¿µ</h2><p><code>std::timed_mutex</code> æ˜¯è‡ª C++ 11 å¼•å…¥çš„äº’æ–¥é‡ï¼ˆmutexï¼‰ç±»å‹ï¼Œç”¨äº C++ å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­æ§åˆ¶å¯¹å…±äº«æ•°æ®èµ„æºçš„å¹¶å‘äº’æ–¥è®¿é—®ã€‚<code>std::timed_mutex</code> æ˜¯ç‹¬å ä¸”éé€’å½’çš„ã€‚</p><p><code>std::timed_mutex</code> åŒ…å«äº† <code>std::mutex</code> çš„åŸºæœ¬åŠŸèƒ½ï¼ŒåŒ…æ‹¬ <code>lock()</code> å’Œ <code>unlock()</code> å‡½æ•°è¿›è¡ŒåŠ é”å’Œè§£é”ã€<code>try_lock()</code> ä»¥éé˜»å¡çš„æ–¹å¼å°è¯•è·å¾—é”ç­‰ã€‚é™¤æ­¤ä»¥å¤–ï¼Œ<code>std::timed_mutex</code> è¿˜æä¾›äº†æˆå‘˜å‡½æ•° <code>try_lock_for()</code> å’Œ <code>try_lock_until</code>ï¼Œç”¨äºæ”¯æŒ <strong>è¶…æ—¶æ”¾å¼ƒ</strong> çš„å°è¯•è·å¾—é”çš„æœºåˆ¶ï¼Œåœ¨é¿å…æ— é™ç­‰å¾…ã€é¿å…å‡ºç°æ­»é”ç­‰æ–¹é¢æœ‰ç€ä¸­é‡è¦ä½œç”¨ã€‚</p><h2 id="2-std-timed-mutex-try-lock-for">2 std::timed_mutex::try_lock_for()</h2><p><code>std::timed_mutex::try_lock_for()</code> ç”¨äºå°è¯•åœ¨æŒ‡å®šçš„æ—¶é—´æœŸé™å†…è·å–äº’æ–¥é‡çš„é”ã€‚è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ª <code>std::chrono::duration</code> ç±»å‹çš„å‚æ•°ï¼Œè¡¨ç¤ºè·å–é”çš„æœ€é•¿ç­‰å¾…æ—¶é—´ã€‚å¦‚æœåœ¨è¿™ä¸ªæ—¶é—´æœŸé™å†…è·å¾—äº†é”ï¼Œå‡½æ•°è¿”å› <code>true</code>ï¼Œçº¿ç¨‹ç»§ç»­æ‰§è¡Œä¸‹å»ï¼›å¦åˆ™ï¼Œå‡½æ•°è¿”å› <code>false</code>ï¼Œçº¿ç¨‹ä¼šé‡‡å–è¶…æ—¶æ”¾å¼ƒçš„ç­–ç•¥ï¼Œç›´æ¥è¿”å›ã€‚</p><p>å½“ <code>std::timed_mutex::try_lock_for()</code> æ¥å—çš„å‚æ•°æ¥è¿‘ <code>0</code> æ—¶ï¼Œé‚£ä¹ˆå‡½æ•°çš„åŠŸèƒ½åŸºæœ¬å°±ç­‰äº <code>std::timed_mutex::try_lock()</code>ã€‚</p><p>è¿™ä¸ªå‡½æ•°æ‰€é€ æˆçš„ç­‰å¾…ï¼ˆé˜»å¡ï¼‰æ—¶é—´å¯èƒ½ä¼šç•¥å¾®è¶…è¿‡è®¾ç½®çš„æœ€é•¿ç­‰å¾…æ—¶é—´ï¼Œä¸»è¦åŸå› åœ¨äºä¼šæœ‰è°ƒåº¦æˆ–èµ„æºäº‰ç”¨çš„å»¶è¿Ÿã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><br>std::timed_mutex t_mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span></span>&#123;<br>    <span class="hljs-comment">// æœ€é•¿ç­‰å¾…æ—¶é—´æœŸé™è®¾ç½®ä¸º 100 ms </span><br>    std::<span class="hljs-function">chrono::milliseconds <span class="hljs-title">timeout</span><span class="hljs-params">(<span class="hljs-number">100</span>)</span></span>;<br>    <span class="hljs-keyword">auto</span> start = std::chrono::steady_clock::<span class="hljs-built_in">now</span>();<br>    <span class="hljs-keyword">if</span>(t_mtx.<span class="hljs-built_in">try_lock_for</span>(timeout))&#123; <span class="hljs-comment">// 100ms æœŸé™å†…æˆåŠŸè·å¾—é”</span><br>        <span class="hljs-comment">// æ‰“å°è·å¾—é”çš„ç­‰å¾…æ—¶é—´ï¼ˆå¯èƒ½ç•¥è¶… 100msï¼‰</span><br>        <span class="hljs-keyword">auto</span> end = std::chrono::steady_clock::<span class="hljs-built_in">now</span>();<br>        std::chrono::duration&lt;<span class="hljs-type">double</span>, std::milli&gt; dura = end - start;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;thread &quot;</span> &lt;&lt; id &lt;&lt; <span class="hljs-string">&quot;: Successfully get the lock. &quot;</span>;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;waiting duration = &quot;</span> &lt;&lt; dura.<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot;ms.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>        <span class="hljs-comment">// ä»¥ä¸‹æ¨¡æ‹Ÿä¸€äº›äº’æ–¥æ“ä½œ</span><br>        std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">15</span>));<br>        count ++ ;     <span class="hljs-comment">// å¯¹å…±äº«æ•°æ®å˜é‡è¿›è¡Œè®¿é—®å’Œä¿®æ”¹</span><br>        t_mtx.<span class="hljs-built_in">unlock</span>();  <span class="hljs-comment">// è§£é”</span><br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">threads</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; threads.<span class="hljs-built_in">size</span>(); i ++ )&#123;<br>        threads[i] = std::<span class="hljs-built_in">thread</span>(foo, i);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : threads) t.<span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;final count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåˆ›å»ºäº† <code>10</code> ä¸ªçº¿ç¨‹ã€‚åœ¨çº¿ç¨‹å‡½æ•° <code>foo()</code> ä¸­ï¼Œè®¾ç½®æœ€é•¿ç­‰å¾…æ—¶é—´ä¸º <code>100ms</code>ï¼Œå¹¶ä¸”å€ŸåŠ©äº† <code>std::chrono::steady_clock::now()</code> æ¥è¿›è¡Œçº¿ç¨‹é˜»å¡æ—¶é•¿çš„è®°å½•ã€‚å¦‚æœçº¿ç¨‹æˆåŠŸåœ¨ç­‰å¾…çš„æ—¶é—´æœŸé™å†…è·å¾—äº†é”ï¼Œé‚£ä¹ˆä¼šç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œæ¨¡æ‹Ÿä¸€äº›äº’æ–¥æ“ä½œï¼ˆä¼‘æ¯äº† <code>15ms</code>ï¼‰ï¼Œåœ¨ä½œç”¨åŸŸç»“æŸæ—¶æ‰‹åŠ¨è¿›è¡Œè§£é”ã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/28/i3sx.png" alt=""></p><p>å¯ä»¥çœ‹å‡ºï¼ŒæˆåŠŸè·å¾—é”çš„çº¿ç¨‹ç­‰å¾…æ—¶é•¿åŸºæœ¬éƒ½åœ¨æœŸé™ <code>100ms</code> å†…ï¼ˆä¹Ÿæœ‰å¯èƒ½è¿è¡Œå‡ºæ¥ä¼šæœ‰ä¸ªåˆ«çº¿ç¨‹ç­‰å¾…æ—¶é•¿ç•¥è¶… <code>100ms</code>ï¼‰ã€‚åœ¨æˆ‘çš„ç”µè„‘ä¸Šæœ€ç»ˆèƒ½å¤ŸæˆåŠŸè·å¾—é”çš„çº¿ç¨‹å¤§è‡´åœ¨ 5 ~ 7 ä¸ªï¼Œè¡¨æ˜æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œå‡½æ•°çš„æ—¶é—´å¤§è‡´åœ¨ <code>20ms</code> å·¦å³ï¼ˆæ¨¡æ‹Ÿä¸€äº›äº’æ–¥æ“ä½œçš„ <code>15ms</code> åŠ ä¸Šä¸€äº›å…¶ä»–æ“ä½œæ¶ˆè€—çš„æ—¶é—´ï¼‰ã€‚</p><h2 id="3-std-timed-mutex-try-lock-until">3 std::timed_mutex::try_lock_until()</h2><p><code>std::timed_mutex::try_lock_until()</code> ç”¨äºå°è¯•åœ¨æŒ‡å®šæ—¶é—´ä¹‹å‰è·å–äº’æ–¥é‡çš„é”ï¼Œå…¶æ¥å—çš„æ˜¯ä¸€ä¸ª <code>std::chrono::time_point</code> ç±»å‹çš„å‚æ•°ï¼Œè¡¨ç¤ºç­‰å¾…è·å–é”çš„æˆªæ­¢æ—¶é—´ã€‚</p><p>å’Œ <code>try_lock_for()</code> ä¸€æ ·ï¼Œå¦‚æœåœ¨è¿™ä¸ªæ—¶é—´æœŸé™å†…è·å¾—äº†é”ï¼Œ<code>std::timed_mutex::try_lock_until()</code> å‡½æ•°è¿”å› <code>true</code>ï¼Œçº¿ç¨‹ç»§ç»­æ‰§è¡Œä¸‹å»ï¼›å¦åˆ™ï¼Œå‡½æ•°è¿”å› <code>false</code>ï¼Œçº¿ç¨‹ä¼šé‡‡å–è¶…æ—¶æ”¾å¼ƒçš„ç­–ç•¥ï¼Œç›´æ¥è¿”å›ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><br>std::timed_mutex t_mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span></span>&#123;<br>    <span class="hljs-comment">// æœ€é•¿ç­‰å¾…æ—¶é—´æœŸé™è®¾ç½®ä¸º 100 ms </span><br>    std::<span class="hljs-function">chrono::milliseconds <span class="hljs-title">timeout</span><span class="hljs-params">(<span class="hljs-number">100</span>)</span></span>;<br>    <span class="hljs-keyword">auto</span> start = std::chrono::steady_clock::<span class="hljs-built_in">now</span>();<br>    <span class="hljs-comment">// æ­¤ if åˆ¤æ–­å’Œ if(t_mtx.try_lock_for(timeout)) æ•ˆæœå‡ ä¹ä¸€æ ·</span><br>    <span class="hljs-keyword">if</span>(t_mtx.<span class="hljs-built_in">try_lock_until</span>(start + timeout))&#123; <span class="hljs-comment">// 100ms æœŸé™å†…æˆåŠŸè·å¾—é”</span><br>        <span class="hljs-comment">// æ‰“å°è·å¾—é”çš„ç­‰å¾…æ—¶é—´ï¼ˆå¯èƒ½ç•¥è¶… 100msï¼‰</span><br>        <span class="hljs-keyword">auto</span> end = std::chrono::steady_clock::<span class="hljs-built_in">now</span>();<br>        std::chrono::duration&lt;<span class="hljs-type">double</span>, std::milli&gt; dura = end - start;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;thread &quot;</span> &lt;&lt; id &lt;&lt; <span class="hljs-string">&quot;: Successfully get the lock. &quot;</span>;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;waiting duration = &quot;</span> &lt;&lt; dura.<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot;ms.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        <br>        <span class="hljs-comment">// ä»¥ä¸‹æ¨¡æ‹Ÿä¸€äº›äº’æ–¥æ“ä½œ</span><br>        std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">15</span>));<br>        count ++ ;     <span class="hljs-comment">// å¯¹å…±äº«æ•°æ®å˜é‡è¿›è¡Œè®¿é—®å’Œä¿®æ”¹</span><br>        t_mtx.<span class="hljs-built_in">unlock</span>();  <span class="hljs-comment">// è§£é”</span><br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">threads</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; threads.<span class="hljs-built_in">size</span>(); i ++ )&#123;<br>        threads[i] = std::<span class="hljs-built_in">thread</span>(foo, i);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : threads) t.<span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;final count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç çš„çº¿ç¨‹å‡½æ•° <code>foo()</code> ä¸­ï¼Œè®¾ç½®ç­‰å¾…çš„æ—¶é—´æˆªæ­¢ç‚¹ä¸º <code>std::chrono::steady_clock::now()</code> åŠ ä¸Š <code>100ms</code> çš„æ—¶åˆ»ï¼ˆç›¸å½“äºè®¾ç½®æœ€é•¿ç­‰å¾…æ—¶é—´ä¸º <code>100ms</code>ï¼‰ã€‚å¹¶ä¸”æˆ‘ä»¬ç”¨ <code>std::chrono::steady_clock::now()</code> æ¥è¿›è¡Œçº¿ç¨‹é˜»å¡æ—¶é•¿çš„è®°å½•ã€‚å¦‚æœçº¿ç¨‹æˆåŠŸåœ¨ç­‰å¾…çš„æ—¶é—´æœŸé™å†…è·å¾—äº†é”ï¼Œé‚£ä¹ˆä¼šç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œæ¨¡æ‹Ÿä¸€äº›äº’æ–¥æ“ä½œï¼ˆä¼‘æ¯äº† <code>15ms</code>ï¼‰ï¼Œåœ¨ä½œç”¨åŸŸç»“æŸæ—¶æ‰‹åŠ¨è¿›è¡Œè§£é”ã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/28/q02z9.png" alt=""></p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ol><li><p><a href="https://en.cppreference.com/w/cpp/thread/timed_mutex/try_lock_for">cppreference.com std::timed_mutex::try_lock_for()</a></p></li><li><p><a href="https://en.cppreference.com/w/cpp/thread/timed_mutex/try_lock_until">cppreference.com std::timed_mutex::try_lock_until()</a></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
      <tag>std::mutex</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€æ­»é”åŠ C++ å¤šçº¿ç¨‹è§£å†³æ­»é”æ–¹æ³•</title>
    <link href="/2024/12/27/20241227/"/>
    <url>/2024/12/27/20241227/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æºï¼š<a href="https://www.pixiv.net/artworks/125531287">pixiv_id=125531287</a></p><h2 id="1-æ­»é”">1 æ­»é”</h2><h3 id="1-1-æ­»é”åŸºæœ¬æ¦‚å¿µ">1.1 æ­»é”åŸºæœ¬æ¦‚å¿µ</h3><p><strong>æ­»é”</strong>ï¼ˆdead lockï¼‰æ˜¯æŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§ <strong>äº’ç›¸ç­‰å¾…</strong> çš„ç°è±¡ã€‚è‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œè¿™äº›çº¿ç¨‹éƒ½å°†æ— æ³•å‘å‰æ¨è¿›ã€‚</p><h3 id="1-2-æ­»é”äº§ç”Ÿæ¡ä»¶">1.2 æ­»é”äº§ç”Ÿæ¡ä»¶</h3><ul><li><p><strong>äº’æ–¥æ¡ä»¶</strong>ï¼šå…±äº«èµ„æºåªèƒ½åŒä¸€æ—¶åˆ»è¢«ä¸€ä¸ªçº¿ç¨‹å ç”¨ã€‚</p><p>ä¾‹å¦‚ï¼Œä¸€ä¸ªæ–‡ä»¶åªèƒ½åŒä¸€æ—¶åˆ»è¢«ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå†™çš„æ“ä½œã€‚</p></li><li><p><strong>è¯·æ±‚ä¸ä¿æŒæ¡ä»¶</strong>ï¼šçº¿ç¨‹å·²ç»æŒæœ‰å¹¶ä¿æŒè‡³å°‘ä¸€ä¸ªèµ„æºï¼ŒåŒæ—¶åˆæå‡ºæ–°çš„èµ„æºè¯·æ±‚ã€‚</p><p>å½“æ–°è¯·æ±‚çš„èµ„æºè¢«å…¶ä»–çº¿ç¨‹å æœ‰ï¼Œé‚£ä¹ˆå½“å‰è¯·æ±‚çš„çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼ŒåŒæ—¶ä¿æŒè‡ªå·±å æœ‰çš„èµ„æºã€‚</p></li><li><p><strong>ä¸å¯å‰¥å¤ºæ¡ä»¶</strong>ï¼šçº¿ç¨‹æ‰€è·å¾—çš„èµ„æºåœ¨æœªä½¿ç”¨å®Œä¹‹å‰ï¼Œä¸èƒ½è¢«å…¶ä»–çº¿ç¨‹å¼ºè¡Œå¤ºèµ°ï¼Œåªèƒ½ç”±è‡ªå·±é‡Šæ”¾ã€‚</p></li><li><p><strong>å¾ªç¯ç­‰å¾…æ¡ä»¶</strong>ï¼šå¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œå­˜åœ¨ä¸€ä¸ªçº¿ç¨‹åºåˆ—ï¼Œå…¶ä¸­æ¯ä¸ªçº¿ç¨‹éƒ½åœ¨ç­‰å¾…ä¸‹ä¸€ä¸ªçº¿ç¨‹å æœ‰çš„èµ„æºè¢«é‡Šæ”¾ã€‚</p><p>ä¾‹å¦‚ï¼Œçº¿ç¨‹ <code>t1</code> ç­‰å¾…çº¿ç¨‹ <code>t2</code> å æœ‰çš„èµ„æºï¼Œçº¿ç¨‹ <code>t2</code> ç­‰å¾…çº¿ç¨‹ <code>t3</code> çš„èµ„æºï¼Œè€Œçº¿ç¨‹ <code>t3</code> åˆåœ¨ç­‰å¾…çº¿ç¨‹ <code>t1</code> çš„èµ„æºã€‚è¿™äº›çº¿ç¨‹ä¿æŒè‡ªå·±å æœ‰çš„èµ„æºï¼Œåˆæå‡ºæ–°çš„èµ„æºè¯·æ±‚ï¼Œå½¢æˆäº†ä¸€ä¸ªç¯è·¯ï¼Œä¹Ÿå°±æ˜¯ <strong>å¾ªç¯ç­‰å¾…</strong>ã€‚</p></li></ul><p>äº§ç”Ÿæ­»é”è¿™ 4 ä¸ªæ¡ä»¶ç¼ºä¸€ä¸å¯ã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªæ¡ä»¶è¢«ç ´åï¼Œé‚£ä¹ˆå°±å¯ä»¥é¿å…æ­»é”ã€‚</p><h2 id="2-C-å¤šçº¿ç¨‹æ­»é”ç¤ºä¾‹">2 C++ å¤šçº¿ç¨‹æ­»é”ç¤ºä¾‹</h2><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„æ­»é”çš„ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br>std::mutex mtx1, mtx2;<br><br><span class="hljs-comment">// å½“çº¿ç¨‹ 1 æŒæœ‰ mtx1ï¼Œç­‰å¾…è·å– mtx2ï¼›çº¿ç¨‹ 2 æŒæœ‰ mtx2ï¼Œç­‰å¾…è·å– mtx1 </span><br><span class="hljs-comment">// æ­¤æ—¶å½¢æˆäº†å¾ªç¯ç­‰å¾…ï¼Œå¯¼è‡´äº†æ­»é”</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo1</span><span class="hljs-params">()</span></span>&#123;<br>    mtx<span class="hljs-number">1.l</span>ock();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 get mtx1.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-comment">// å½“å‰çº¿ç¨‹æŒæœ‰ mtx1 çš„é”ï¼Œç­‰å¾…è·å– mtx2 çš„é”</span><br>    mtx<span class="hljs-number">2.l</span>ock();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 get mtx2.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br><br>    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›è¡Œä¸€äº›éœ€è¦åŒæ—¶æŒæœ‰ä¸¤ä¸ªäº’æ–¥é‡çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br><br>    mtx<span class="hljs-number">1.</span><span class="hljs-built_in">unlock</span>();<br>    mtx<span class="hljs-number">2.</span><span class="hljs-built_in">unlock</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo2</span><span class="hljs-params">()</span></span>&#123;<br>    mtx<span class="hljs-number">2.l</span>ock();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 get mtx2.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-comment">// å½“å‰çº¿ç¨‹æŒæœ‰ mtx2 çš„é”ï¼Œç­‰å¾…è·å– mtx1 çš„é”</span><br>    mtx<span class="hljs-number">1.l</span>ock();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 get mtx1.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br><br>    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›è¡Œä¸€äº›éœ€è¦åŒæ—¶æŒæœ‰ä¸¤ä¸ªäº’æ–¥é‡çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br><br>    mtx<span class="hljs-number">1.</span><span class="hljs-built_in">unlock</span>();<br>    mtx<span class="hljs-number">2.</span><span class="hljs-built_in">unlock</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">(foo1)</span></span>;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t2</span><span class="hljs-params">(foo2)</span></span>;<br>    t<span class="hljs-number">1.</span><span class="hljs-built_in">join</span>();<br>    t<span class="hljs-number">2.</span><span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;program ends.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå®šä¹‰äº†ä¸¤ä¸ªäº’æ–¥é‡ <code>mtx1</code> å’Œ <code>mtx2</code>ï¼Œçº¿ç¨‹ <code>t1</code> æ‰§è¡Œå‡½æ•° <code>foo1()</code>ï¼Œçº¿ç¨‹ <code>t2</code> æ‰§è¡Œå‡½æ•° <code>foo2()</code>ã€‚</p><p>çº¿ç¨‹ <code>t1</code> å…ˆå¯¹ <code>mtx1</code> è¿›è¡ŒåŠ é”ï¼Œç„¶ååœ¨æŒæœ‰ <code>mtx1</code> çš„é”çš„æƒ…å†µä¸‹ç­‰å¾…è·å– <code>mtx2</code> çš„é”ï¼›çº¿ç¨‹ <code>t2</code> å…ˆå¯¹ <code>mtx2</code> è¿›è¡ŒåŠ é”ï¼Œç„¶ååœ¨æŒæœ‰ <code>mtx2</code> çš„é”çš„æƒ…å†µä¸‹ç­‰å¾…è·å– <code>mtx1</code> çš„é”ã€‚æ­¤æ—¶ï¼Œä¸¤ä¸ªçº¿ç¨‹å°±å½¢æˆäº†å¾ªç¯ç­‰å¾…ï¼Œå¯¼è‡´äº† <strong>æ­»é”</strong> çš„å‘ç”Ÿã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/27/5x5bb.png" alt=""></p><p>å¯ä»¥çœ‹å‡ºï¼Œç¨‹åºè¿è¡Œåˆ°ä¸¤ä¸ªçº¿ç¨‹å„è‡ªè·å¾—æ‰€éœ€çš„ç¬¬ä¸€ä¸ªé”æ—¶å°±åœæ­¢ä¸åŠ¨äº†ï¼Œè¡¨æ˜å‘ç”Ÿäº†æ­»é”ã€‚</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ <code>std::lock_guard</code> å†™ä¸€ä¸ªæ­»é”ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br>std::mutex mtx1, mtx2;<br><br><span class="hljs-comment">// å½“çº¿ç¨‹ 1 æŒæœ‰ mtx1ï¼Œç­‰å¾…è·å– mtx2ã€‚åŒæ—¶çº¿ç¨‹ 2 æŒæœ‰ mtx2ï¼Œç­‰å¾…è·å– mtx1 æ—¶</span><br><span class="hljs-comment">// æ­¤æ—¶å½¢æˆäº†å¾ªç¯ç­‰å¾…ï¼Œå¯¼è‡´äº†æ­»é”</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo1</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck1</span><span class="hljs-params">(mtx1)</span></span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 get mtx1.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-comment">// å½“å‰çº¿ç¨‹æŒæœ‰ mtx1 çš„é”ï¼Œç­‰å¾…è·å– mtx2 çš„é”</span><br>    <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck2</span><span class="hljs-params">(mtx2)</span></span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 get mtx2.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›è¡Œä¸€äº›éœ€è¦åŒæ—¶æŒæœ‰ä¸¤ä¸ªäº’æ–¥é‡çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>)); <br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo2</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck1</span><span class="hljs-params">(mtx2)</span></span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 get mtx2.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-comment">// å½“å‰çº¿ç¨‹æŒæœ‰ mtx2 çš„é”ï¼Œç­‰å¾…è·å– mtx1 çš„é”</span><br>    <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck2</span><span class="hljs-params">(mtx1)</span></span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 get mtx1.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br><br>    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›è¡Œä¸€äº›éœ€è¦åŒæ—¶æŒæœ‰ä¸¤ä¸ªäº’æ–¥é‡çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">(foo1)</span></span>;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t2</span><span class="hljs-params">(foo2)</span></span>;<br>    t<span class="hljs-number">1.</span><span class="hljs-built_in">join</span>();<br>    t<span class="hljs-number">2.</span><span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;program ends.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/27/5vxrj.png" alt=""></p><p>å¯ä»¥å‘ç°ç¨‹åºè¿è¡Œåœæ­¢ä¸åŠ¨ï¼Œè¡¨æ˜å‡ºç°äº†æ­»é”ã€‚</p><h2 id="3-C-å¤šçº¿ç¨‹å‡å°‘æ­»é”æ–¹æ³•">3 C++ å¤šçº¿ç¨‹å‡å°‘æ­»é”æ–¹æ³•</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>std::unique_lock</code> ç»“åˆæš‚æ—¶è§£é”ã€é‡æ–°åŠ é”çš„æ“ä½œï¼Œä½¿å¾—å…¶ä»–çº¿ç¨‹å¯ä»¥åœ¨è¯·æ±‚èµ„æºè¢«æš‚æ—¶é‡Šæ”¾çš„æ—¶é—´æ®µæœ‰æœºä¼šè·å¾—é”ï¼Œå¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘æ­»é”çš„å‘ç”Ÿã€‚ä½†æ˜¯ï¼Œä¸èƒ½æ ¹æœ¬ä¸Šè§£å†³æ­»é”çš„å‘ç”Ÿã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><br><span class="hljs-comment">// å¯ä»¥ä½¿ç”¨ unique_lock æš‚æ—¶è§£é”ï¼Œä½¿å¾—å…¶ä»–çº¿ç¨‹æœ‰æœºä¼šè·å¾—é”</span><br><span class="hljs-comment">// å¯ä»¥å‡å°‘æ­»é”çš„å‘ç”Ÿï¼Œä½†æ˜¯æ— æ³•è§£å†³æ­»é”ã€‚</span><br><br>std::mutex mtx1, mtx2;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo1</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck1</span><span class="hljs-params">(mtx1)</span></span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 acquired mtx1&quot;</span> &lt;&lt; std::endl;<br><br>    <span class="hljs-comment">// æš‚æ—¶è§£é” mtx1</span><br>    lck<span class="hljs-number">1.</span><span class="hljs-built_in">unlock</span>();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 unlocked mtx1&quot;</span> &lt;&lt; std::endl;<br><br>    <span class="hljs-comment">// æš‚åœä¸€ä¼šä½¿å¾—å…¶ä»–çº¿ç¨‹æœ‰æœºä¼šè·å¾— mtx1 </span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">300</span>));<br><br>    <span class="hljs-comment">// å°è¯•è·å– mtx2</span><br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck2</span><span class="hljs-params">(mtx2)</span></span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 acquired mtx2&quot;</span> &lt;&lt; std::endl;<br><br>    <span class="hljs-comment">// é‡æ–°è·å– mtx1 çš„é”</span><br>    lck<span class="hljs-number">1.l</span>ock();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 reacquired mtx1&quot;</span> &lt;&lt; std::endl;<br><br>    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›è¡Œä¸€äº›éœ€è¦åŒæ—¶æŒæœ‰ä¸¤ä¸ªäº’æ–¥é‡çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo2</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck2</span><span class="hljs-params">(mtx2)</span></span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 acquired mtx2&quot;</span> &lt;&lt; std::endl;<br><br>    <span class="hljs-comment">// æš‚æ—¶è§£é” mtx2</span><br>    lck<span class="hljs-number">2.</span><span class="hljs-built_in">unlock</span>();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 unlocked mtx2&quot;</span> &lt;&lt; std::endl;<br><br>    <span class="hljs-comment">// æš‚åœä¸€ä¼šä½¿å¾—å…¶ä»–çº¿ç¨‹æœ‰æœºä¼šè·å¾— mtx2 </span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br><br>    <span class="hljs-comment">// å°è¯•è·å– mtx1</span><br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck1</span><span class="hljs-params">(mtx1)</span></span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 acquired mtx1&quot;</span> &lt;&lt; std::endl;<br><br>    <span class="hljs-comment">// é‡æ–°è·å– mtx2 çš„é”</span><br>    lck<span class="hljs-number">2.l</span>ock();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 reacquired mtx2&quot;</span> &lt;&lt; std::endl;<br><br>    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›è¡Œä¸€äº›éœ€è¦åŒæ—¶æŒæœ‰ä¸¤ä¸ªäº’æ–¥é‡çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">thread1</span><span class="hljs-params">(foo1)</span></span>;<br>    <span class="hljs-function">std::thread <span class="hljs-title">thread2</span><span class="hljs-params">(foo2)</span></span>;<br><br>    thread<span class="hljs-number">1.</span><span class="hljs-built_in">join</span>();<br>    thread<span class="hljs-number">2.</span><span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;program ends.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œçº¿ç¨‹ <code>t1</code> å…ˆå¯¹ <code>mtx1</code> è¿›è¡ŒåŠ é”ï¼Œï¼ˆä¹‹å‰å‡è®¾ä¹Ÿåšè¿‡äº†ä¸€äº›åªéœ€è¦ä¸€ä¸ªäº’æ–¥é‡çš„äº’æ–¥æ“ä½œï¼‰ç„¶åæš‚æ—¶é‡Šæ”¾å¹¶ä¼‘æ¯ä¸€æ®µæ—¶é—´ï¼Œåœ¨æš‚æ—¶é‡Šæ”¾ä¹‹åçš„ä¸€æ®µæ—¶é—´ä¸­ï¼Œçº¿ç¨‹ <code>t2</code> æœ‰æœºä¼šè·å¾— <code>mtx1</code> çš„é”ã€‚</p><p>æœ‰ä¸€ç§ä¸ä¼šå‡ºç°æ­»é”çš„æƒ…å†µå°±æ˜¯ï¼š</p><p>æ­¤æ—¶çº¿ç¨‹ <code>t2</code> åœ¨çº¿ç¨‹ <code>t1</code> æš‚æ—¶é‡Šæ”¾ <code>mtx1</code> çš„ä¸€æ®µæ—¶é—´å†…å°è¯•è·å¾— <code>mtx1</code> æˆåŠŸï¼ˆä¹‹å‰å·²ç»æš‚æ—¶é‡Šæ”¾äº† <code>mtx2</code> çš„é”ï¼‰ï¼Œç„¶åçº¿ç¨‹ <code>t2</code> åˆé‡æ–°å¯¹ <code>mtx2</code> åŠ é”ï¼Œæ­¤æ—¶çº¿ç¨‹ <code>t2</code> è·å¾—äº†ä¸¤ä¸ªäº’æ–¥é‡ï¼Œä¹‹åæ‰§è¡Œå‡½æ•° <code>foo2()</code> å®Œæ¯•ï¼Œå¹¶é‡Šæ”¾ä¸¤ä¸ªäº’æ–¥é‡ <code>mtx1</code> å’Œ <code>mtx2</code>ã€‚</p><p>çº¿ç¨‹ <code>t1</code> å°è¯•è·å¾— <code>mtx2</code> çš„é”ï¼Œç”±å°è¯•é‡æ–°å¯¹ <code>mtx1</code> è¿›è¡ŒåŠ é”ï¼Œæ­¤æ—¶ä¸¤ä¸ªäº’æ–¥é‡ <code>mtx1</code> å’Œ <code>mtx2</code> éƒ½å·²ç»è¢«é‡Šæ”¾äº†ï¼Œçº¿ç¨‹ <code>t1</code> å¯ä»¥é¡ºåˆ©æˆåŠŸè·å¾—å æœ‰ä¸¤ä¸ªäº’æ–¥é‡ã€‚ä¹‹åé¡ºåˆ©æ‰§è¡Œå‡½æ•° <code>foo1()</code> å®Œæ¯•ï¼Œå¹¶é‡Šæ”¾ä¸¤ä¸ªäº’æ–¥é‡ã€‚</p><p>ä½†è¿™ç±»æƒ…å†µå¹¶ä¸ä¼šä¿è¯å‘ç”Ÿï¼Œè¿˜æ˜¯æœ‰å¯èƒ½ä¼šå‡ºç°å¾ªç¯ç­‰å¾…ï¼Œå¯¼è‡´æ­»é”çš„æƒ…å†µã€‚</p><h2 id="4-C-å¤šçº¿ç¨‹è§£å†³æ­»é”æ–¹æ³•">4 C++ å¤šçº¿ç¨‹è§£å†³æ­»é”æ–¹æ³•</h2><h3 id="4-1-æœ‰åºåŠ é”">4.1 æœ‰åºåŠ é”</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¡®ä¿æ‰€æœ‰çº¿ç¨‹ <strong>æŒ‰ç…§ç›¸åŒçš„é¡ºåºè·å–å¤šä¸ªé”</strong>ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…å¾ªç¯ç­‰å¾…çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‰€æœ‰çº¿ç¨‹éƒ½æŒ‰ç…§ â€œå…ˆå°è¯•è·å– mtx1ï¼Œå†å°è¯•è·å– mtx2â€ çš„é¡ºåºåŠ é”ï¼Œé‚£ä¹ˆå°±ä¸ä¼šå‡ºç°æ­»é”ã€‚</p><p>è¿™ç§æœ‰åºåŠ é”çš„æ–¹æ³•ç ´åçš„æ˜¯æ­»é”äº§ç”Ÿæ¡ä»¶ä¸­çš„ <strong>å¾ªç¯ç­‰å¾…æ¡ä»¶</strong>ã€‚</p><ul><li>ä½¿ç”¨ std::mutex::lock</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br>std::mutex mtx1, mtx2;<br><br><span class="hljs-comment">// æ–¹æ³•1ï¼šä¸¤ä¸ªçº¿ç¨‹å¯¹äº’æ–¥é‡åŠ é”çš„é¡ºåºä¸€è‡´ï¼Œå¯ä»¥é¿å…æ­»é”</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo1</span><span class="hljs-params">()</span></span>&#123;<br>    mtx<span class="hljs-number">1.l</span>ock();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 get mtx1.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    mtx<span class="hljs-number">2.l</span>ock();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 get mtx2.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br>        <br>    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›è¡Œä¸€äº›éœ€è¦åŒæ—¶æŒæœ‰ä¸¤ä¸ªäº’æ–¥é‡çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br><br>    mtx<span class="hljs-number">1.</span><span class="hljs-built_in">unlock</span>();<br>    mtx<span class="hljs-number">2.</span><span class="hljs-built_in">unlock</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo2</span><span class="hljs-params">()</span></span>&#123;<br>    mtx<span class="hljs-number">1.l</span>ock();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 get mtx1.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    mtx<span class="hljs-number">2.l</span>ock();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 get mtx2.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br>        <br>    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›è¡Œä¸€äº›éœ€è¦åŒæ—¶æŒæœ‰ä¸¤ä¸ªäº’æ–¥é‡çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br><br>    mtx<span class="hljs-number">1.</span><span class="hljs-built_in">unlock</span>();<br>    mtx<span class="hljs-number">2.</span><span class="hljs-built_in">unlock</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">(foo1)</span></span>;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t2</span><span class="hljs-params">(foo2)</span></span>;<br>    t<span class="hljs-number">1.</span><span class="hljs-built_in">join</span>();<br>    t<span class="hljs-number">2.</span><span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;program ends.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ä½¿ç”¨ std::lock_guard</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br>std::mutex mtx1, mtx2;<br><br><span class="hljs-comment">// æ–¹æ³•1ï¼šä¸¤ä¸ªçº¿ç¨‹å¯¹äº’æ–¥é‡åŠ é”çš„é¡ºåºä¸€è‡´ï¼Œå¯ä»¥é¿å…æ­»é”</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo1</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck1</span><span class="hljs-params">(mtx1)</span></span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 get mtx1.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck2</span><span class="hljs-params">(mtx2)</span></span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 get mtx2.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br>        <br>    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›è¡Œä¸€äº›éœ€è¦åŒæ—¶æŒæœ‰ä¸¤ä¸ªäº’æ–¥é‡çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo2</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck1</span><span class="hljs-params">(mtx1)</span></span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 get mtx1.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck2</span><span class="hljs-params">(mtx2)</span></span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 get mtx2.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br>        <br>    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›è¡Œä¸€äº›éœ€è¦åŒæ—¶æŒæœ‰ä¸¤ä¸ªäº’æ–¥é‡çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">(foo1)</span></span>;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t2</span><span class="hljs-params">(foo2)</span></span>;<br>    t<span class="hljs-number">1.</span><span class="hljs-built_in">join</span>();<br>    t<span class="hljs-number">2.</span><span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;program ends.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä¸¤ä¸ªä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å°†æ‰€æœ‰çº¿ç¨‹éƒ½æŒ‰ç…§ç›¸åŒçš„é¡ºåºè¿›è¡ŒåŠ é”ï¼Œé¿å…äº†å¾ªç¯ç­‰å¾…ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…æ­»é”çš„å‘ç”Ÿã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/27/66rlh.png" alt=""></p><h3 id="4-2-ä¸€æ¬¡æ€§åŒæ—¶åŠ é”">4.2 ä¸€æ¬¡æ€§åŒæ—¶åŠ é”</h3><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¸€æ¬¡æ€§åˆ†é…æ‰€æœ‰èµ„æºï¼ˆä¸€æ¬¡æ€§åŒæ—¶å¯¹æ¯ä¸ªæ‰€éœ€äº’æ–¥é‡åŠ é”ï¼‰ï¼Œåœ¨ C++ å¤šçº¿ç¨‹ä¸­ï¼Œé€šå¸¸å¯ä»¥é‡‡ç”¨ <code>std::lock</code> å‡½æ•°æ¥å¯¹å¤šä¸ªäº’æ–¥é‡è¿›è¡ŒåŒæ—¶åŠ é”ã€‚</p><p>è¿™æ ·ä¸€æ¬¡æ€§åŒæ—¶åŠ é”çš„æ–¹å¼ç ´åäº†æ­»é”äº§ç”Ÿæ¡ä»¶ä¸­çš„ <strong>è¯·æ±‚å¹¶ä¿æŒæ¡ä»¶</strong>ã€‚ä¸€æ¬¡æ€§åœ°åˆ†é…æ‰€æœ‰èµ„æºç»™çº¿ç¨‹ï¼Œä½¿å¾—çº¿ç¨‹ä¸éœ€è¦å†è¿›è¡Œæ–°çš„èµ„æºè¯·æ±‚ï¼Œå› æ­¤é¿å…äº†æ­»é”çš„äº§ç”Ÿã€‚</p><ul><li><p>ä½¿ç”¨ std::lock</p><p><code>std::lock</code> å®šä¹‰åœ¨ <code>&lt;mutex&gt;</code> å¤´æ–‡ä»¶ä¸­ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å¯ä»¥ <strong>åŒæ—¶é”ä½å¤šä¸ªäº’æ–¥é‡</strong>ï¼ˆmutexï¼‰ï¼Œèƒ½å¤Ÿè‡ªåŠ¨é¿å…æ­»é”çš„å‘ç”Ÿã€‚</p><p><code>std::lock</code> æ˜¯ä¸€ä¸ªå¯å˜å‚æ•°æ¨¡æ¿ï¼Œå¯ä»¥æ¥å—ä¸¤ä¸ªæˆ–å¤šä¸ªäº’æ–¥é‡ä½œä¸ºå‚æ•°ã€‚ä¾‹å¦‚ï¼Œæœ‰ä¸¤ä¸ª <code>std::mutex</code> äº’æ–¥é‡ <code>mtx1</code> å’Œ <code>mtx2</code>ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡ <code>std::lock(mtx1, mtx2)</code> å°†ä¸¤ä¸ªäº’æ–¥é‡åŒæ—¶åŠ é”ã€‚</p><p><code>std::lock</code> å‡½æ•°èƒ½è‡ªåŠ¨é¿å…æ­»é”æƒ…å†µçš„å‘ç”Ÿï¼Œ<strong>å…¶å†…éƒ¨é‡‡ç”¨äº†åˆé€‚çš„ç®—æ³•æ¥è°ƒæ•´è·å–é”çš„é¡ºåº</strong>ï¼Œç¡®ä¿æ— è®ºæœ‰å¤šå°‘ä¸ªçº¿ç¨‹ä»¥ä½•ç§é¡ºåºè°ƒç”¨å®ƒå»è·å–è¿™ä¸¤ä¸ªäº’æ–¥é‡ï¼Œéƒ½ä¼šæŒ‰ç…§å†…éƒ¨è‡ªåŠ¨å¤„ç†çš„é¡ºåºè·å–äº’æ–¥é‡ï¼Œé¿å…å‡ºç°æ­»é”ã€‚</p><p>å¦‚æœçº¿ç¨‹èƒ½å¤Ÿé€šè¿‡ <code>std::lock</code> åŒæ—¶è·å–å¤šä¸ªé”æ—¶ï¼Œé‚£ä¹ˆçº¿ç¨‹é¡ºåˆ©æ‰§è¡Œï¼›å¦‚æœçº¿ç¨‹ä¸èƒ½é€šè¿‡ <code>std::lock</code> åŒæ—¶è·å–å¤šä¸ªé”ï¼Œé‚£ä¹ˆçº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°èƒ½å¤ŸæˆåŠŸåŒæ—¶è·å¾—é”ã€‚</p><p>æ³¨æ„ï¼š<code>std::lock</code> ä¸èƒ½ä¹‹ä¼ å…¥ä¸€ä¸ªäº’æ–¥é‡å‚æ•°ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä½¿ç”¨ <code>std::lock</code> è§£å†³æ­»é”çš„ç¤ºä¾‹ï¼š</p>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br>std::mutex mtx1, mtx2;<br><br><span class="hljs-comment">// æ–¹æ³•2ï¼šä¸¤ä¸ªçº¿ç¨‹å¯¹äº’æ–¥é‡åŠ é”æ—¶ï¼ŒåŒæ—¶å¯¹éœ€è¦çš„æ‰€æœ‰äº’æ–¥é‡ä¸€æ¬¡æ€§åŠ é” std::lock</span><br><span class="hljs-comment">// æœ€åæ¯ä¸ªé”éƒ½è¦é‡Šæ”¾ï¼Œè§£é”çš„é¡ºåºå¯ä»¥æ˜¯ä»»æ„çš„</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo1</span><span class="hljs-params">()</span></span>&#123;<br>    std::<span class="hljs-built_in">lock</span>(mtx1, mtx2);<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 get mtx1.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 get mtx2.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br><br>    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›è¡Œä¸€äº›éœ€è¦åŒæ—¶æŒæœ‰ä¸¤ä¸ªäº’æ–¥é‡çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br><br>    mtx<span class="hljs-number">1.</span><span class="hljs-built_in">unlock</span>();<br>    mtx<span class="hljs-number">2.</span><span class="hljs-built_in">unlock</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo2</span><span class="hljs-params">()</span></span>&#123;<br>    std::<span class="hljs-built_in">lock</span>(mtx1, mtx2);<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 get mtx1.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 get mtx2.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br><br>    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›è¡Œä¸€äº›éœ€è¦åŒæ—¶æŒæœ‰ä¸¤ä¸ªäº’æ–¥é‡çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>    <br>    mtx<span class="hljs-number">2.</span><span class="hljs-built_in">unlock</span>();<br>    mtx<span class="hljs-number">1.</span><span class="hljs-built_in">unlock</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">(foo1)</span></span>;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t2</span><span class="hljs-params">(foo2)</span></span>;<br>    t<span class="hljs-number">1.</span><span class="hljs-built_in">join</span>();<br>    t<span class="hljs-number">2.</span><span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;program ends.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œé€šè¿‡æ¯ä¸ªçº¿ç¨‹è°ƒç”¨ <code>std::lock</code> å‡½æ•°å°è¯•ä¸€æ¬¡æ€§åŒæ—¶è·å¾— <code>mtx1</code> å’Œ <code>mtx2</code> çš„é”ï¼Œç ´åäº†æ­»é”äº§ç”Ÿæ¡ä»¶ä¸­çš„ <strong>è¯·æ±‚å¹¶ä¿æŒæ¡ä»¶</strong>ï¼Œé¿å…äº†æ­»é”çš„å‘ç”Ÿã€‚</p><p>åœ¨è§£é”æ—¶ï¼Œé¡ºåºå¯ä»¥æ˜¯ä»»æ„çš„ï¼Œåªéœ€è¦ç¡®ä¿æœ€ç»ˆä¸¤ä¸ªé”éƒ½è¢«æ­£ç¡®é‡Šæ”¾å³å¯ã€‚</p></li><li><p>é…åˆ std::lock_guard</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ <code>std::lock</code> é…åˆ <code>std::lock::guard</code> åŠ ä¸Š <code>std::adopt_lock</code> å‚æ•°æ¥è§£å†³æ­»é”ã€‚</p>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br>std::mutex mtx1, mtx2;<br><br><span class="hljs-comment">// æ–¹æ³•2ï¼šä¸¤ä¸ªçº¿ç¨‹å¯¹äº’æ–¥é‡åŠ é”æ—¶ï¼ŒåŒæ—¶å¯¹éœ€è¦çš„æ‰€æœ‰äº’æ–¥é‡ä¸€æ¬¡æ€§åŠ é” std::lock</span><br><span class="hljs-comment">// å¯ä»¥é€šè¿‡ lock_guard è½¬ç§»é”çš„ç®¡ç†ï¼ŒåŠ ä¸Š std::adopt_lock å‚æ•°</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo1</span><span class="hljs-params">()</span></span>&#123;<br>    std::<span class="hljs-built_in">lock</span>(mtx1, mtx2);<br>    <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck1</span><span class="hljs-params">(mtx1, std::adopt_lock)</span></span>;<br>    <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck2</span><span class="hljs-params">(mtx2, std::adopt_lock)</span></span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 get mtx1.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 get mtx2.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br>        <br>    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›è¡Œä¸€äº›éœ€è¦åŒæ—¶æŒæœ‰ä¸¤ä¸ªäº’æ–¥é‡çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo2</span><span class="hljs-params">()</span></span>&#123;<br>    std::<span class="hljs-built_in">lock</span>(mtx1, mtx2);<br>    <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck1</span><span class="hljs-params">(mtx2, std::adopt_lock)</span></span>;<br>    <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck2</span><span class="hljs-params">(mtx1, std::adopt_lock)</span></span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 get mtx1.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 get mtx2.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br>        <br>    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›è¡Œä¸€äº›éœ€è¦åŒæ—¶æŒæœ‰ä¸¤ä¸ªäº’æ–¥é‡çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">(foo1)</span></span>;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t2</span><span class="hljs-params">(foo2)</span></span>;<br>    t<span class="hljs-number">1.</span><span class="hljs-built_in">join</span>();<br>    t<span class="hljs-number">2.</span><span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;program ends.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåœ¨è°ƒç”¨ <code>std::lock</code> å¯¹äº’æ–¥é‡åŒæ—¶åŠ é”åï¼Œå®šä¹‰ä¸¤ä¸ª <code>std::lock_guard</code> å°†äº’æ–¥é‡çš„ç®¡ç†æƒè¿›è¡Œäº†è½¬ç§»ï¼ˆåŠ ä¸Š <code>std::adopt_lock</code> å‚æ•°ï¼Œè¡¨æ˜ä¹‹å‰å·²ç»åŠ è¿‡é”ï¼‰ï¼Œä¹‹åå°±ä¸éœ€è¦å†æ‰‹åŠ¨è¿›è¡Œè§£é”äº†ã€‚</p></li><li><p>é…åˆ std::unique_lock</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ <code>std::unique_lock</code> åŠ ä¸Š <code>std::defer_lock</code> å»¶è¿ŸåŠ é”æ ‡è®°ï¼Œè¿™æ ·çš„è¯ï¼Œå¯ä»¥å»¶è¿Ÿè¿›è¡ŒåŒæ—¶è·å–å¤šä¸ªäº’æ–¥é‡çš„é”ï¼Œå¹¶ä¸”å¯ä»¥æ›´åŠ çµæ´»åœ°è§£é”å’Œé‡æ–°åŠ é”ã€‚</p>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br>std::mutex mtx1, mtx2;<br><br><span class="hljs-comment">// æ–¹æ³•2ï¼šä¸¤ä¸ªçº¿ç¨‹å¯¹äº’æ–¥é‡åŠ é”æ—¶ï¼ŒåŒæ—¶å¯¹éœ€è¦çš„æ‰€æœ‰äº’æ–¥é‡ä¸€æ¬¡æ€§åŠ é” std::lock</span><br><span class="hljs-comment">// æœ€åæ¯ä¸ªé”éƒ½è¦é‡Šæ”¾ï¼Œè§£é”çš„é¡ºåºå¯ä»¥æ˜¯ä»»æ„çš„</span><br><span class="hljs-comment">// å¯ä»¥é…åˆ unique_lock å»¶è¿ŸåŠ é”ï¼ŒåŠ ä¸Š std::defer_lock å‚æ•°</span><br><span class="hljs-comment">// å®šä¹‰ unique_lock å¯¹è±¡å¹¶åŠ ä¸Šå»¶è¿ŸåŠ é”å‚æ•°</span><br><span class="hljs-comment">// ç„¶åä¸€æ¬¡æ€§å¯¹æ‰€éœ€äº’æ–¥é‡åŒæ—¶è¿›è¡ŒåŠ é”</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo1</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck1</span><span class="hljs-params">(mtx1, std::defer_lock)</span></span>;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck2</span><span class="hljs-params">(mtx2, std::defer_lock)</span></span>;<br>    std::<span class="hljs-built_in">lock</span>(lck1, lck2);<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 get mtx1.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 1 get mtx2.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br><br>    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›è¡Œä¸€äº›éœ€è¦åŒæ—¶æŒæœ‰ä¸¤ä¸ªäº’æ–¥é‡çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo2</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck1</span><span class="hljs-params">(mtx1, std::defer_lock)</span></span>;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck2</span><span class="hljs-params">(mtx2, std::defer_lock)</span></span>;<br>    std::<span class="hljs-built_in">lock</span>(lck2, lck1);<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 get mtx1.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread 2 get mtx2.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br>        <br>    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›è¡Œä¸€äº›éœ€è¦åŒæ—¶æŒæœ‰ä¸¤ä¸ªäº’æ–¥é‡çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">100</span>));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">(foo1)</span></span>;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t2</span><span class="hljs-params">(foo2)</span></span>;<br>    t<span class="hljs-number">1.</span><span class="hljs-built_in">join</span>();<br>    t<span class="hljs-number">2.</span><span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;program ends.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåˆ›å»ºäº† <code>std::unique_lock</code> å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ <code>std::defer_lock</code> æ ‡è®°ä¸ç«‹å³è·å–é”ã€‚ä¹‹åå†é€šè¿‡ <code>std::lock</code> å‡½æ•°å°è¯•åŒæ—¶è·å–å¤šä¸ªäº’æ–¥é‡çš„é”ã€‚è¿™æ ·å¯ä»¥æ›´åŠ çµæ´»åœ°å¤„ç†åŠ é”è§£é”ï¼Œå¹¶ä¸”æœ€åä¹Ÿä¸éœ€è¦æ‰‹åŠ¨è¿›è¡Œè§£é”ã€‚</p></li></ul><p>ä¸Šé¢çš„ 3 ä¸ªä»£ç éƒ½å®ç°äº†ä¸€æ¬¡æ€§åŒæ—¶åŠ é”ï¼Œç ´åäº†æ­»é”äº§ç”Ÿæ¡ä»¶ä¸­çš„ <strong>è¯·æ±‚å¹¶ä¿æŒ</strong> æ¡ä»¶ï¼ŒæˆåŠŸé¿å…äº†æ­»é”çš„å‘ç”Ÿã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/27/6gc14.png" alt=""></p><h3 id="4-3-è¶…æ—¶æ”¾å¼ƒ">4.3 è¶…æ—¶æ”¾å¼ƒ</h3><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ <code>try_lock</code> æˆ–è€… <code>std::timed_mutex</code> ä¸­çš„ <code>try_lock_for</code> ç­‰ï¼Œé‡‡ç”¨ <strong>è¶…æ—¶æ”¾å¼ƒ</strong> çš„æœºåˆ¶æ¥é¿å…æ­»é”ã€‚å½“çº¿ç¨‹ï¼ˆåœ¨ç­‰å¾…çš„æ—¶é—´å†…ï¼‰æ— æ³•è·å–æ‰€éœ€äº’æ–¥é‡çš„é”æ—¶ï¼Œä¸ä¼šè¢«é˜»å¡å»ç­‰å¾…äº’æ–¥é‡ï¼Œè€Œæ˜¯æ”¾å¼ƒå°è¯•ï¼Œç›´æ¥è¿›è¡Œè¿”å›ã€‚</p><p>è¿™æ ·çš„æœºåˆ¶ç ´åçš„ä¸»è¦æ˜¯ <strong>å¾ªç¯ç­‰å¾…æ¡ä»¶</strong> å’Œ <strong>è¯·æ±‚ä¸ä¿æŒæ¡ä»¶</strong>ï¼Œé¿å…äº†æ­»é”ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦ç¡®ä¿æ¯ä¸ªçº¿ç¨‹èƒ½å¤Ÿå®Œæ•´æ‰§è¡Œï¼Œé‚£ä¹ˆ <strong>è¶…æ—¶æ”¾å¼ƒ</strong> çš„æœºåˆ¶å¹¶ä¸é€‚ç”¨ã€‚</p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ol><li><p><a href="https://blog.csdn.net/hd12370/article/details/82814348">æ­»é”é¢è¯•é¢˜ï¼ˆä»€ä¹ˆæ˜¯æ­»é”ï¼Œäº§ç”Ÿæ­»é”çš„åŸå› åŠå¿…è¦æ¡ä»¶ï¼‰</a></p></li><li><p><a href="https://en.cppreference.com/w/cpp/thread/lock">cppreference.com std::lock</a></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
      <tag>std::mutex</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€std::unique_lock åŸºæœ¬ç”¨æ³•</title>
    <link href="/2024/12/26/20241226_/"/>
    <url>/2024/12/26/20241226_/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æº: <a href="https://www.pixiv.net/artworks/114658725">pixiv_id=114658725</a></p><h2 id="1-unique-lock-ç®€ä»‹">1 unique_lock ç®€ä»‹</h2><h3 id="1-1-åŸºæœ¬æ¦‚å¿µ">1.1 åŸºæœ¬æ¦‚å¿µ</h3><p><code>std::unique_lock</code> æ˜¯ C++ æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªç±»æ¨¡æ¿ï¼Œå®šä¹‰åœ¨ <code>&lt;mutex&gt;</code> å¤´æ–‡ä»¶ä¸­ã€‚ç”¨äºç®¡ç†äº’æ–¥é‡ï¼ˆMutexï¼‰çš„åŠ é”ä¸è§£é”æ“ä½œï¼Œå¹¶ä¸”æä¾›äº†ä¸€ç§çµæ´»çš„ RAII ï¼ˆèµ„æºè·å–å³åˆå§‹åŒ–ï¼‰æœºåˆ¶æ¥æ›´å¥½åœ°å¤„ç†å¤šçº¿ç¨‹å¹¶å‘åŒæ­¥é—®é¢˜ã€‚</p><h3 id="1-2-å¯¹æ¯”-lock-guard">1.2 å¯¹æ¯” lock_guard</h3><p>ç›¸æ¯”äº <code>std::lock_guard</code>ï¼Œ<code>std::unique_lock</code> æ›´åŠ çµæ´»ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ <code>std::unique_lock</code> å’Œ <code>std::lock_guard</code> æ˜¯ä¸€æ ·çš„ï¼Œä¼šè‡ªåŠ¨åœ°è¿›è¡ŒåŠ é”å’Œè§£é”ã€‚</p><p>é™¤æ­¤ä»¥å¤–ï¼Œ<code>std::unique_lock</code> å…è®¸åœ¨å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå†…æ‰‹åŠ¨å¯¹äº’æ–¥é‡çš„åŠ é”å’Œè§£é”ã€‚å¯ä»¥åœ¨å®šä¹‰ <code>std::unique_lock</code> å¯¹è±¡ç¨åçš„æŸä¸ªæ—¶é—´ç‚¹æ˜¾å¼åœ°è°ƒç”¨ <code>lock()</code>ï¼ˆéœ€è¦é…åˆ <code>std::defer_lock</code>ï¼‰ï¼›å¯ä»¥åœ¨ä¹‹åçš„æŸä¸ªæ—¶é—´ç‚¹æ˜¾å¼åœ°è°ƒç”¨ <code>unlock()</code>ï¼Œç”¨äºæå‰æˆ–è€…æš‚æ—¶è§£é”ã€‚è€Œ <code>std::lock_guard</code> æ˜¯æ— æ³•æ‰§è¡Œè¿™äº›æ“ä½œçš„ã€‚</p><p>ä½†æ˜¯ï¼Œç”±äº <code>std::unique_lock</code> æ”¯æŒäº†å¤æ‚çš„æ“ä½œï¼Œç›¸å¯¹äº <code>std::lock_guard</code> æ¥è¯´ <strong>å¼€é”€</strong> æ˜¯ <strong>æ¯”è¾ƒå¤§</strong> çš„ã€‚å› æ­¤ï¼Œå¯¹äºæ¯”è¾ƒç®€å•çš„è‡ªåŠ¨åŠ é”è§£é”çš„æƒ…å½¢ï¼Œæˆ‘ä»¬å°½é‡ä¼˜å…ˆä½¿ç”¨ <code>std::lock_guard</code>ï¼›å¯¹äºæ¯”è¾ƒå¤æ‚çš„ï¼Œéœ€è¦æ”¯æŒæš‚æ—¶è§£é”ã€é‡æ–°åŠ é”ç­‰æ‰‹åŠ¨æ“ä½œçš„æƒ…å½¢ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>std::unque_lock</code>ã€‚</p><h2 id="2-unique-lock-æ„é€ ">2 unique_lock æ„é€ </h2><h3 id="2-1-æ„é€ -unique-lock-å¯¹è±¡">2.1 æ„é€  unique_lock å¯¹è±¡</h3><p>å‡å¦‚å½“å‰æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ <code>foo()</code> å‡½æ•°ï¼Œæœ‰ä¸€ä¸ªå…±äº«å˜é‡ <code>count</code> å’Œä¸€ä¸ª <code>std::mutex</code> äº’æ–¥é‡ <code>mtx</code>ï¼Œåœ¨å¯¹å…±äº«æ•°æ®è¿›è¡Œè®¿é—®å’Œä¿®æ”¹å‰ï¼Œæ„é€ ä¸€ä¸ª unique_lock å¯¹è±¡ï¼Œå°è¯•å¯¹äº’æ–¥é‡ <code>mtx</code> åŠ é”ã€‚å¦‚æœå½“å‰å¯ä»¥è·å¾—é”ï¼Œé‚£ä¹ˆè¿›è¡ŒåŠ é”ï¼Œç„¶åè®¿é—®å’Œä¿®æ”¹æ•°æ®ï¼Œæœ€åè¿›è¡Œè‡ªåŠ¨è§£é”ï¼›å¦‚æœå½“å‰æ— æ³•è·å¾—é”ï¼ˆè¢«å…¶ä»–çº¿ç¨‹å ç”¨ï¼‰ï¼Œé‚£ä¹ˆå½“å‰çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°å¯ä»¥è·å¾—é”ã€‚</p><p>ä¾‹å¦‚ä¸‹é¢è¿™ç§å½¢å¼:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c++">std::mutex mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>    count ++ ;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br>std::mutex mtx; <span class="hljs-comment">// äº’æ–¥é‡</span><br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">// é»˜è®¤æƒ…å†µä¸‹å’Œ lock_guard ä¸€æ ·ï¼Œè‡ªåŠ¨åŠ é”ã€è§£é”</span><br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>    count ++ ;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">v</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : v) t = std::<span class="hljs-built_in">thread</span>(foo);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : v) t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­åˆ›å»ºäº† 10 ä¸ªå­çº¿ç¨‹ï¼ˆç”¨ <code>std::vector</code> å­˜å‚¨ï¼‰ï¼Œæ¯ä¸ªçº¿ç¨‹æ‰§è¡Œ <code>foo()</code> å‡½æ•°ï¼Œå¯¹å…±äº«å˜é‡ <code>count</code> è¿›è¡Œ <code>+1</code>ï¼Œå¹¶è¾“å‡ºçº¿ç¨‹ id ä»¥åŠå½“å‰çº¿ç¨‹å¯¹æ•°æ®ä¿®æ”¹æ“ä½œåæ•°æ® <code>count</code> çš„å€¼ã€‚</p><p>å®šä¹‰äº†ä¸€ä¸ªäº’æ–¥é‡ <code>mtx</code>ï¼Œå¹¶é‡‡ç”¨ <code>std::unique_lock</code> å®ç°è‡ªåŠ¨åŠ é”è§£é”ï¼Œä¿è¯å¤šçº¿ç¨‹äº’æ–¥è®¿é—®å’Œä¿®æ”¹å…±äº«æ•°æ®ã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/26/3qia.png" alt=""></p><h3 id="2-2-unique-lock-lock-å’Œ-unique-lock-unlock">2.2 unique_lock::lock() å’Œ unique_lock::unlock()</h3><p><code>std::unique_lock</code> ä¹Ÿæœ‰è‡ªå·±çš„æˆå‘˜å‡½æ•° <code>lock()</code> å’Œ <code>unlock()</code>ã€‚åˆ†åˆ«ç”¨äºåœ¨æŸä¸ªæ—¶é—´ç‚¹æ‰‹åŠ¨åœ°åŠ é”å’Œè§£é”ã€‚</p><p>å¦‚æœéœ€è¦ <strong>æš‚æ—¶è§£é”</strong>ï¼Œæˆ–è€…éœ€è¦ <strong>æå‰è§£é”</strong>ï¼Œå¯ä»¥æ‰‹åŠ¨è°ƒç”¨ std::unique_lock æˆå‘˜å‡½æ•° <code>unlock()</code> è§£é”ã€‚æœ‰æ—¶æˆ‘ä»¬çº¿ç¨‹å‡½æ•°ä¸­çš„ä¸€äº›æ“ä½œæ˜¯ä¸éœ€è¦é”ä¿æŠ¤çš„ï¼Œè€Œä¸”èƒ½å¤Ÿ <strong>ä½¿å¾—å…¶ä»–çº¿ç¨‹åœ¨æ­¤æœŸé—´æœ‰æœºä¼šè·å¾—é”</strong>ï¼Œæ‰‹åŠ¨æš‚æ—¶è§£é”è¿™æ—¶å°±æ˜¾å¾—å¾ˆæœ‰ç”¨äº†ã€‚</p><p>ä¹‹åå¦‚æœè¦ <strong>å†è¿›è¡ŒåŠ é”</strong>ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ std::unique_lock æˆå‘˜å‡½æ•° <code>lock()</code> æ‰‹åŠ¨åŠ é”ã€‚</p><p>ä¾‹å¦‚ä¸‹é¢è¿™ç§å½¢å¼:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c++">std::mutex mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>    count ++ ;<br>    lck.<span class="hljs-built_in">unlock</span>();    <span class="hljs-comment">// æš‚æ—¶è§£é”</span><br><br>    <span class="hljs-built_in">do_something_else</span>(); <span class="hljs-comment">// æ‰§è¡Œä¸€äº›ä¸éœ€è¦é”ä¿æŠ¤çš„æ“ä½œ</span><br><br>    lck.<span class="hljs-built_in">lock</span>();  <span class="hljs-comment">// é‡æ–°åŠ é”ï¼Œè°ƒç”¨ std::unique_lock æˆå‘˜å‡½æ•° lock()</span><br>    count ++ ;<br>    <span class="hljs-comment">// ä¹‹åè‡ªåŠ¨è§£é”</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><br>std::mutex mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>    count ++ ;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    lck.<span class="hljs-built_in">unlock</span>(); <span class="hljs-comment">// æš‚æ—¶è§£é”</span><br><br>    <span class="hljs-comment">// æ¨¡æ‹Ÿåšä¸€äº›å…¶ä»–ä¸éœ€è¦é”ä¿æŠ¤çš„æ“ä½œ</span><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">milliseconds</span>(<span class="hljs-number">200</span>));<br><br>    lck.<span class="hljs-built_in">lock</span>();   <span class="hljs-comment">// é‡æ–°åŠ é”</span><br>    count ++ ;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-comment">// ä½œç”¨åŸŸç»“æŸ return æ—¶è‡ªåŠ¨è§£é”</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">v</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : v) t = std::<span class="hljs-built_in">thread</span>(foo);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : v) t.<span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;final value = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç çš„ <code>foo()</code> ä¸­ï¼Œå…ˆå®šä¹‰ä¸€ä¸ª <code>std::unique_lock</code> å®ç°è‡ªåŠ¨å°è¯•åŠ é”ï¼Œå¦‚æœè·å¾—äº†é”ï¼Œé‚£ä¹ˆå¯¹å…±äº«æ•°æ® <code>count</code> è¿›è¡Œ <code>+1</code> ä¿®æ”¹æ“ä½œï¼Œå¹¶è¾“å‡ºå½“å‰çº¿ç¨‹ id å’Œ <code>count</code> çš„å€¼ã€‚</p><p>ç„¶åæˆ‘ä»¬éœ€è¦åšä¸€äº›å…¶ä»–ä¸éœ€è¦é”ä¿æŠ¤çš„æ“ä½œï¼Œæ­¤æ—¶è°ƒç”¨ <code>std::unique_lock::unlock()</code> è¿›è¡Œæ‰‹åŠ¨è§£é”ï¼ˆå…¶ä»–ä¸éœ€è¦é”ä¿æŠ¤çš„æ“ä½œç”¨ <code>std::this_thread::sleep_for()</code> çº¿ç¨‹ä¼‘æ¯æ“ä½œè¿›è¡Œäº†æ¨¡æ‹Ÿï¼‰ã€‚</p><p>æ‰§è¡Œå®Œå…¶ä»–ä¸éœ€è¦é”ä¿æŠ¤çš„æ“ä½œæ—¶ï¼Œæˆ‘ä»¬è¦å†ä¸€æ¬¡å¯¹å…±äº«æ•°æ® <code>count</code> è¿›è¡Œ <code>+1</code> ä¿®æ”¹æ“ä½œï¼Œå› æ­¤éœ€è¦åœ¨ä¹‹å‰éœ€è¦è°ƒç”¨ <code>std::unique_lock::lock()</code> å†é‡æ–°åŠ é”ï¼Œç¡®ä¿çº¿ç¨‹äº’æ–¥è®¿é—®å’Œä¿®æ”¹æ•°æ®ã€‚</p><p>æœ€åå‡½æ•°ä½œç”¨åŸŸç»“æŸ return æ—¶è‡ªåŠ¨åœ°è§£é”ã€‚çº¿ç¨‹å‡½æ•°æ‰§è¡Œå®Œæ¯•ã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/26/r6fn.png" alt=""></p><p>å¯ä»¥çœ‹å‡ºï¼Œåˆ›å»ºçš„ 10 ä¸ªçº¿ç¨‹ä¸¤æ¬¡æ•°æ®è®¿é—®å’Œ <code>+1</code> ä¿®æ”¹æ“ä½œä¸­é—´æš‚æ—¶è§£é”ä¼‘æ¯çš„ä¸€æ®µæ—¶é—´ä¸­ï¼Œæœ‰å…¶ä»–çº¿ç¨‹è·å¾—äº†é”å¹¶æ‰§è¡Œè‡ªå·±çš„æ•°æ®æ•°æ®è®¿é—®å’Œ <code>+1</code> ä¿®æ”¹æ“ä½œï¼Œè¿™è¡¨æ˜æš‚æ—¶è§£é”ä½¿å¾—å…¶ä»–çº¿ç¨‹æœ‰æœºä¼šè·å¾—äº†é”ï¼Œæé«˜äº†è¿è¡Œçš„æ•ˆç‡ã€‚</p><p>æœ€ç»ˆè¿è¡Œçš„ç»“æœä¸º <code>20</code>ï¼Œè¿™ä¸ªç»“æœæ˜¯æ­£ç¡®çš„ï¼Œè¡¨æ˜è¿™ 10 ä¸ªçº¿ç¨‹äº’æ–¥åœ°å¯¹å…±äº«æ•°æ®è¿›è¡Œäº†ä¸¤æ¬¡ <code>+1</code> çš„æ“ä½œã€‚</p><h3 id="2-3-std-defer-lock">2.3 std::defer_lock</h3><p><code>std::defer_lock</code> æ˜¯ä¸€ä¸ªæ ‡è®°ç±»å‹ï¼Œç”¨äº <strong>å»¶è¿ŸåŠ é”</strong>ã€‚æˆ‘ä»¬å¯ä»¥åœ¨æ„é€  <code>std::unique_lock</code> æ—¶åŠ ä¸Šç¬¬äºŒä¸ªå‚æ•° <code>std::defer_lock</code> æ¥æ”¯æŒå»¶è¿ŸåŠ é”ã€‚ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥åœ¨å®šä¹‰å®Œ <code>std::unique_lock</code> å¯¹è±¡ä¹‹åï¼Œå…ˆè¿›è¡Œä¸€äº›å…¶ä»–æ“ä½œï¼Œç„¶åå†è°ƒç”¨ <code>std::unique_lock</code> çš„æˆå‘˜å‡½æ•° <code>lock()</code> è¿›è¡Œæ‰‹åŠ¨åŠ é”ã€‚</p><p>ä¾‹å¦‚ä¸‹é¢è¿™ç§å½¢å¼:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c++">std::mutex mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx, std::defer_lock)</span></span>;<br>    <span class="hljs-built_in">do_something_else</span>(); <span class="hljs-comment">// åšä¸€äº›å…¶ä»–äº‹æƒ…</span><br>    <span class="hljs-comment">// å†æ‰‹åŠ¨è¿›è¡ŒåŠ é”</span><br>    lck.<span class="hljs-built_in">lock</span>(); <span class="hljs-comment">// è°ƒç”¨ std::unique_lock æˆå‘˜å‡½æ•° lock()</span><br>    count ++ ;<br>    <span class="hljs-comment">// ä¹‹åè‡ªåŠ¨è§£é”</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br>std::mutex mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span></span>&#123;<br><span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx, std::defer_lock)</span></span>;<br><span class="hljs-keyword">if</span>(id &amp; <span class="hljs-number">1</span>)&#123;<br>lck.<span class="hljs-built_in">lock</span>(); <span class="hljs-comment">// æ‰‹åŠ¨åŠ é”</span><br>        count ++ ;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;thread &quot;</span> &lt;&lt; id &lt;&lt; <span class="hljs-string">&quot; acquired the lock.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;thread &quot;</span> &lt;&lt; id &lt;&lt; <span class="hljs-string">&quot; did not acquire the lock.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br><span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">v</span><span class="hljs-params">(<span class="hljs-number">20</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">20</span>; i ++ ) v[i] = std::<span class="hljs-built_in">thread</span>(foo, i);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : v) t.<span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;final count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­çš„ <code>foo()</code> å‡½æ•°ä¸­ï¼Œå®šä¹‰ <code>std::unique_lock</code> å¯¹è±¡æ—¶å¢åŠ äº† <code>std::defer_lock</code> å»¶è¿ŸåŠ é”æ ‡è®°å‚æ•°ï¼Œè¡¨ç¤ºç¨åå†è¿›è¡ŒåŠ é”ã€‚å½“çº¿ç¨‹çš„æ ‡è®°ä¸ºå¥‡æ•°æ—¶ï¼Œæˆ‘ä»¬æ‰‹åŠ¨åœ°è¿›è¡ŒåŠ é”ï¼ˆ <code>std::unique_lock</code> ä¹‹åä¼šè‡ªåŠ¨è¿›è¡Œè§£é”ï¼‰ï¼Œç„¶åå¯¹å…±äº«æ•°æ® <code>count</code> è¿›è¡Œ <code>+1</code> æ“ä½œï¼›å½“çº¿ç¨‹åœ°æ ‡è®°ä¸ºå¶æ•°æ—¶ï¼Œæˆ‘ä»¬ä¸è¿›è¡ŒåŠ é”ã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/26/41oi.png" alt=""></p><p>å¯ä»¥çœ‹å‡ºï¼Œåªæœ‰ä¼ å…¥çš„çº¿ç¨‹æ ‡è®°ä¸ºå¥‡æ•°æ—¶ï¼Œçº¿ç¨‹æ‰ä¼šè·å¾—é”å¹¶å¯¹å…±äº«å˜é‡ <code>count</code> è¿›è¡Œ <code>+1</code> æ“ä½œã€‚ä¸€å…± 20 ä¸ªçº¿ç¨‹ï¼Œæœ‰ 10 ä¸ªçº¿ç¨‹äº’æ–¥åœ°è·å¾—é”ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹æ“ä½œã€‚å› æ­¤æœ€ç»ˆ <code>count</code> ä¸º <code>10</code>ã€‚</p><h3 id="2-4-std-adopt-lock">2.4 std::adopt_lock</h3><p>å‡å¦‚ä¸€ä¸ªçº¿ç¨‹å·²ç»æ‹¥æœ‰äº†äº’æ–¥é‡çš„é”ï¼Œæ­¤æ—¶äº’æ–¥é‡å·²ç»è¢«é”å®šï¼Œæˆ‘ä»¬è‹¥è¦å°†é”çš„ç®¡ç†è½¬ç§»ç»™ <code>std::unique_lock</code> å¯¹è±¡ï¼Œéœ€è¦åœ¨æ„é€  <code>std::unique_lock</code> æ—¶åŠ ä¸Šç¬¬äºŒä¸ªå‚æ•° <code>std::adopt_lock</code>ã€‚</p><p>ä¾‹å¦‚ä¸‹é¢è¿™ç§å½¢å¼:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c++">std::mutex mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    mtx.<span class="hljs-built_in">lock</span>(); <span class="hljs-comment">// å·²ç»è·å¾—äº†é”</span><br>    <span class="hljs-comment">// å°†é”çš„ç®¡ç†è½¬ç§»ç»™ unique_lock å¯¹è±¡</span><br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx, std::adopt_lock)</span></span>;<br>    count ++ ;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br>std::mutex mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    mtx.<span class="hljs-built_in">lock</span>();<br>    <span class="hljs-comment">// é”çš„ç®¡ç†è½¬ç§»ç»™ unique_lockï¼ŒåŠ ä¸Š std::adopt_lock</span><br><span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx, std::adopt_lock)</span></span>;<br>    count ++ ;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br>    <span class="hljs-comment">// ä¸éœ€è¦å†è°ƒç”¨ mtx.unlock() è¿›è¡Œè§£é”ï¼Œä¼šè‡ªåŠ¨è§£é”</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br><span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">v</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : v) t = std::<span class="hljs-built_in">thread</span>(foo);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : v) t.<span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;final count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç çš„ <code>foo()</code> ä¸­ï¼Œä¸€å¼€å§‹å·²ç»è°ƒç”¨ <code>std::mutex::lock()</code> å‡½æ•°ä½¿çº¿ç¨‹è·å¾—äº†é”ï¼Œç„¶åå®šä¹‰ä¸€ä¸ª <code>std::unique_lock</code> å¯¹è±¡å¹¶åŠ ä¸Š <code>std::adopt_lock</code> å‚æ•°ï¼Œå°†é”çš„ç®¡ç†è½¬ç§»åˆ° <code>std::unique_lock</code> ä¸Šã€‚ä¹‹åï¼Œå°±å¯ä»¥è‡ªåŠ¨åœ°è¿›è¡Œè§£é”äº†ï¼Œä¸éœ€è¦å†è°ƒç”¨ <code>std::mutex::unlock()</code> è¿›è¡Œè§£é”ã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/26/ky2.png" alt=""></p><p>å¯ä»¥çœ‹å‡ºï¼Œå¤šä¸ªçº¿ç¨‹äº’æ–¥è®¿é—®å’Œä¿®æ”¹å…±äº«æ•°æ®ï¼Œæœ€ç»ˆçš„ç»“æœä¸º 10ã€‚</p><h3 id="2-5-std-try-to-lock">2.5 std::try_to_lock</h3><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å°è¯•æ„é€ ä¸€ä¸ª <code>std::unique_lock</code> å¯¹è±¡å¹¶å°è¯•éé˜»å¡åœ°é”å®šäº’æ–¥é‡ã€‚å¦‚æœäº’æ–¥é‡å½“å‰ä¸å¯ç”¨ï¼Œå®ƒä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›ã€‚æ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>std::unique_lock</code> æˆå‘˜å‡½æ•° <code>owns_lock()</code> æ¥åˆ¤æ–­æ˜¯å¦è·å¾—äº†é”ï¼Œå¦‚æœè·å¾—äº†é”ï¼Œæˆå‘˜å‡½æ•° <code>owns_lock()</code> è¿”å› <code>true</code>ï¼Œå¦åˆ™è¿”å› <code>false</code>ã€‚</p><p>ä¾‹å¦‚ä¸‹é¢è¿™ç§å½¢å¼:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c++">std::mutex mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx, std::try_to_lock)</span></span>;<br>    <span class="hljs-keyword">if</span>(lck.<span class="hljs-built_in">owns_lock</span>())&#123; <span class="hljs-comment">// æˆåŠŸè·å¾—é”</span><br>        count ++ ;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Successfully get the lock.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123; <span class="hljs-comment">// æœªèƒ½è·å¾—é”ï¼Œä¸ç­‰å¾…ï¼Œçº¿ç¨‹ç›´æ¥è¿”å›</span><br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Unsuccessfully get the lock.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br>std::mutex mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">// å®šä¹‰ unique_lockï¼ŒåŠ ä¸Š std::try_to_lock</span><br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx, std::try_to_lock)</span></span>;<br>    <span class="hljs-keyword">if</span>(lck.<span class="hljs-built_in">owns_lock</span>())&#123; <br>        <span class="hljs-comment">// æˆåŠŸè·å¾—é”</span><br>        count ++ ;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Successfully get the lock.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123; <br>        <span class="hljs-comment">// æœªèƒ½è·å¾—é”ï¼Œä¸ç­‰å¾…ï¼Œçº¿ç¨‹ç›´æ¥è¿”å›</span><br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Unsuccessfully get the lock.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">v</span><span class="hljs-params">(<span class="hljs-number">20</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : v) t = std::<span class="hljs-built_in">thread</span>(foo);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : v) t.<span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;final count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç çš„ <code>foo()</code> ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ª <code>std::unique_lock</code> å¯¹è±¡ï¼Œå¹¶åŠ ä¸Š <code>std::try_to_lock</code>ã€‚æˆ‘ä»¬ç”¨ <code>std::unique_lock::owns_lock()</code> å‡½æ•°åˆ¤æ–­çº¿ç¨‹æ˜¯å¦è·å¾—äº†é”ï¼Œå¦‚æœè·å¾—äº†é”ï¼Œé‚£ä¹ˆå¯¹å…±äº«æ•°æ®è¿›è¡Œè®¿é—®å’Œä¿®æ”¹ï¼›å¦åˆ™ï¼Œå½“å‰çº¿ç¨‹ä¼šç›´æ¥è¿”å›ï¼Œä¸ä¼šè¢«é˜»å¡å¹¶ç­‰å¾…å…¶ä»–çº¿ç¨‹é‡Šæ”¾é”ã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/26/14974r.png" alt=""></p><p>å¯ä»¥çœ‹å‡ºåªæœ‰å°‘é‡çš„çº¿ç¨‹å¯ä»¥é¡ºåˆ©è·å¾—é”ï¼Œè€Œå…¶ä»–æ²¡æœ‰æˆåŠŸè·å¾—é”çš„çº¿ç¨‹ç›´æ¥è¿”å›ã€‚</p><h2 id="3-unique-lock-å…¶ä»–æˆå‘˜å‡½æ•°">3 unique_lock å…¶ä»–æˆå‘˜å‡½æ•°</h2><p>ä¸Šé¢çš„ä»‹ç»ä¸­æœ‰äº† <code>std::unique_lock::lock()</code>ã€<code>std::unique_lock::unlock()</code> ä»¥åŠ <code>std::unique_lock::owns_lock()</code> æˆå‘˜å‡½æ•°ã€‚é™¤è¿™äº›å‡½æ•°ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–æˆå‘˜å‡½æ•°ã€‚</p><h3 id="3-1-try-lock">3.1 try_lock</h3><p><code>std::unique_lock</code> çš„ <code>try_lock</code> æˆå‘˜å‡½æ•°ç”¨äºå°è¯•ä»¥éé˜»å¡çš„æ–¹å¼è·å–äº’æ–¥é‡ï¼ˆmutexï¼‰çš„é”ï¼Œé€šå¸¸éœ€è¦æ­é…ç¬¬äºŒä¸ªå‚æ•° <code>std::defer_lock</code> å»¶è¿ŸåŠ é”æ ‡è®°ä½¿ç”¨ã€‚æœ‰ç‚¹ç±»ä¼¼äºå‰é¢æåˆ°çš„æ„é€ å‡½æ•°å‚æ•° <code>std::try_to_lock</code> çš„ä½œç”¨ã€‚</p><p>å¦‚æœ <code>std::unique_lock::try_lock()</code> è¿”å›å€¼ä¸º <code>true</code>ï¼Œè¡¨ç¤ºæˆåŠŸè·å¾—äº†é”ï¼Œæ¥ä¸‹æ¥è¿›è¡Œä¸€ç³»åˆ—æ“ä½œï¼›å¦åˆ™ï¼Œæ— æ³•æˆåŠŸè·å¾—é”ï¼Œä½†æ˜¯çº¿ç¨‹ä¸ä¼šè¢«é˜»å¡å¹¶ç­‰å¾…å…¶ä»–çº¿ç¨‹é‡Šæ”¾é”ï¼Œè€Œæ˜¯ä¼šç›´æ¥è¿”å›ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br>std::mutex mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx, std::defer_lock)</span></span>;<br>    <span class="hljs-keyword">if</span>(lck.<span class="hljs-built_in">try_lock</span>())&#123;<br>        <span class="hljs-comment">// æˆåŠŸè·å¾—é”</span><br>        count ++ ;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Successfully get the lock.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>();<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">// æ— æ³•è·å¾—é”ï¼Œç›´æ¥è¿”å›</span><br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Unsuccessfully get the lock.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">v</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : v) t = std::<span class="hljs-built_in">thread</span>(foo);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : v) t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/26/16inqk.png" alt=""></p><h3 id="3-2-release">3.2 release</h3><p><code>std::unique_lock::release</code> æ˜¯ <code>std::unique_lock</code> ç±»æ¨¡æ¿çš„ä¸€ä¸ªæˆå‘˜å‡½æ•°ã€‚å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯é‡Šæ”¾ <code>std::unique_lock</code> å¯¹è±¡å¯¹äº’æ–¥é‡ï¼ˆmutexï¼‰çš„æ‰€æœ‰æƒï¼Œè¿”å›å€¼æ˜¯ <strong>ä¸€ä¸ªæŒ‡å‘è¢«ç®¡ç†çš„äº’æ–¥é‡çš„æŒ‡é’ˆ</strong>ï¼Œå¹¶å°† <code>std::unique_lock</code> å¯¹è±¡ä¸äº’æ–¥é‡çš„å…³è”æ–­å¼€ã€‚</p><p>ä¹‹åä¾‹å¦‚è½¬ç§»ç»™æŸä¸ª <code>std::mutex</code> äº’æ–¥é‡ï¼Œé‚£ä¹ˆéœ€è¦å˜ä¸ºæ‰‹åŠ¨åœ°åŠ é”å’Œè§£é”ï¼Œç®¡ç†äº’æ–¥é‡ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><br>std::mutex mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>;<br>    <span class="hljs-comment">// å‡è®¾æˆ‘ä»¬éœ€è¦å°†é”çš„æ‰€æœ‰æƒè½¬ç§»ç»™å¦ä¸€ä¸ªå¯¹è±¡</span><br>    std::mutex *m = lck.<span class="hljs-built_in">release</span>(); <span class="hljs-comment">// é‡Šæ”¾é”æ‰€æœ‰æƒ</span><br>    <span class="hljs-comment">// æ­¤æ—¶ lck ä¸å†æŒæœ‰é”ï¼Œè½¬ç§»åˆ°äº† std::mutex äº’æ–¥é‡ m ä¸Š</span><br>    count ++ ;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    m-&gt;<span class="hljs-built_in">unlock</span>(); <span class="hljs-comment">// éœ€è¦æ‰‹åŠ¨é‡Šæ”¾é”</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">(foo)</span></span>;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t2</span><span class="hljs-params">(foo)</span></span>;<br><br>    t<span class="hljs-number">1.</span><span class="hljs-built_in">join</span>();<br>    t<span class="hljs-number">2.</span><span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç çš„ <code>foo()</code> ä¸­ï¼Œå…ˆåˆ›å»ºäº†ä¸€ä¸ª <code>std::unique_lock</code> å¯¹è±¡å¹¶é”å®šäº†äº’æ–¥é‡<code>mtx</code>ã€‚ç„¶åé€šè¿‡ <code>std::mutex* m = lck.release();</code> é‡Šæ”¾äº† <code>lck</code> å¯¹ <code>mtx</code> çš„æ‰€æœ‰æƒï¼ŒåŒæ—¶è·å–äº†æŒ‡å‘ <code>mtx</code> çš„æŒ‡é’ˆã€‚</p><p>ä¹‹åï¼Œ<code>std::unique_lock</code> å¯¹è±¡ä¸å†ç®¡ç†äº’æ–¥é‡ï¼Œå¿…é¡»æ‰‹åŠ¨è°ƒç”¨ <code>mtx-&gt;unlock()</code> è¿›è¡Œè§£é”äº’æ–¥é‡ã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/26/uqq9.png" alt=""></p><h2 id="4-ç®€å•åº”ç”¨å®ä¾‹">4 ç®€å•åº”ç”¨å®ä¾‹</h2><p>å’Œä¹‹å‰ <code>std::mutex</code> æ–‡ç«  <a href="https://marisamagic.github.io/2024/12/25/20241225/">ã€ŒC++ å¤šçº¿ç¨‹ã€std::mutexï¼Œlock(), unlock()</a> ä¸­çš„é—®é¢˜ç›¸åŒ:</p><ol><li>ä¸€ä¸ªçº¿ç¨‹ç”¨æ¥æ¥å—ç”¨æˆ·å‘½ä»¤ï¼ˆç”¨æ•°å­—è¡¨ç¤ºå‘½ä»¤ï¼‰ï¼Œå¹¶æŠŠå‘½ä»¤å†™å…¥ä¸€ä¸ªé˜Ÿåˆ—ä¸­</li><li>å¦ä¸€ä¸ªçº¿ç¨‹ä»é˜Ÿåˆ—ä¸­è¯»å–å‘½ä»¤ï¼Œè§£æå‘½ä»¤å¹¶æ‰§è¡Œä¸€ç³»åˆ—æ“ä½œ</li></ol><p>ç¨‹åºä¸­å…±äº«æ•°æ®ï¼ˆæ•°æ®ç»“æ„ï¼‰ msg_queï¼Œæ¶ˆæ¯é˜Ÿåˆ—åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œæ“ä½œï¼ˆè¯»å–æˆ–å†™å…¥ï¼‰ã€‚å› æ­¤ msg_que æ˜¯ä¸´ç•Œèµ„æºï¼Œæˆ‘ä»¬éœ€è¦å¯¹è®¿é—®ä¸´ç•Œèµ„æºçš„ä»£ç åŠ é”ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç”¨ <code>unique_lock</code> å¯¹éœ€è¦äº’æ–¥çš„éƒ¨åˆ†è¿›è¡Œæ”¹å†™ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>&#123;<br>std::queue&lt;<span class="hljs-type">int</span>&gt; msg_que; <span class="hljs-comment">// å­˜å‚¨ç”¨æˆ·å‘½ä»¤çš„æ¶ˆæ¯é˜Ÿåˆ—</span><br>std::mutex mtx; <span class="hljs-comment">// äº’æ–¥é‡</span><br><span class="hljs-keyword">public</span>:<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">in_msg_que</span><span class="hljs-params">(<span class="hljs-type">int</span> num)</span></span>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; num; i ++ )&#123;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;in_msg_que() running, push data: &quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-comment">// ä½¿ç”¨ try_to_lock å‚æ•°ï¼Œå°è¯•åŠ é”</span><br><span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx, std::try_to_lock)</span></span>;<br><span class="hljs-keyword">if</span>(lck.<span class="hljs-built_in">owns_lock</span>())&#123;<br><span class="hljs-comment">// å°è¯•åæˆåŠŸæ‹¿åˆ°äº†é”</span><br>msg_que.<span class="hljs-built_in">push</span>(i); <br>&#125;<span class="hljs-keyword">else</span>&#123;<br><span class="hljs-comment">// æ²¡æœ‰æˆåŠŸæ‹¿åˆ°é”ï¼Œç›´æ¥è¿”å›</span><br>std::cout &lt;&lt; <span class="hljs-string">&quot;in_msg_que() running, but cannot get lock: &quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">out_msg_que</span><span class="hljs-params">(<span class="hljs-type">int</span> num)</span></span>&#123;<br><span class="hljs-type">int</span> command = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; num; i ++ )&#123;<br><span class="hljs-keyword">if</span>(<span class="hljs-built_in">pop_command</span>(command))&#123;<br><span class="hljs-comment">// æ¶ˆæ¯é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œå¤„ç†å–å‡ºçš„æŒ‡ä»¤</span><br>std::cout &lt;&lt; <span class="hljs-string">&quot;out_msg_que() running, command is: &quot;</span> &lt;&lt; command &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br><span class="hljs-comment">// æ¶ˆæ¯é˜Ÿåˆ—ä¸ºç©º</span><br>std::cout &lt;&lt; <span class="hljs-string">&quot;out_msg_que() running, queue is empty: &quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">pop_command</span><span class="hljs-params">(<span class="hljs-type">int</span>&amp; command)</span></span>&#123;<br><span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>; <span class="hljs-comment">// ä½¿ç”¨ unique_lock å®ç°è‡ªåŠ¨åŠ é”ã€è§£é”</span><br><span class="hljs-keyword">if</span>(msg_que.<span class="hljs-built_in">empty</span>())&#123;<br>            <span class="hljs-comment">// å¦‚æœä¸ºç©ºï¼Œç›´æ¥è¿”å› false</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <br>        &#125;<br>        command = msg_que.<span class="hljs-built_in">front</span>(); <span class="hljs-comment">// ä»é˜Ÿé¦–å–å‡ºæŒ‡ä»¤</span><br>msg_que.<span class="hljs-built_in">pop</span>();<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>MyClass obj;<br><span class="hljs-function">std::thread <span class="hljs-title">out_msg_t</span><span class="hljs-params">(&amp;MyClass::out_msg_que, &amp;obj, <span class="hljs-number">10000</span>)</span></span>; <br><span class="hljs-function">std::thread <span class="hljs-title">in_msg_t</span><span class="hljs-params">(&amp;MyClass::in_msg_que, &amp;obj, <span class="hljs-number">10000</span>)</span></span>;<br><br><span class="hljs-type">out_msg_t</span>.<span class="hljs-built_in">join</span>();<br><span class="hljs-type">in_msg_t</span>.<span class="hljs-built_in">join</span>();<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/26/vmrx.png" alt=""></p>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
      <tag>std::mutex</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€std::lock_guard åŸºæœ¬ç”¨æ³•</title>
    <link href="/2024/12/26/20241226/"/>
    <url>/2024/12/26/20241226/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æº: <a href="https://www.pixiv.net/artworks/114384607">pixiv_id=114384607</a></p><h2 id="1-é—®é¢˜èƒŒæ™¯">1 é—®é¢˜èƒŒæ™¯</h2><p>é€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬æ‰‹åŠ¨ç®¡ç†çº¿ç¨‹çš„åŠ é”ä¸è§£é”ï¼Œä¼šåœ¨ä»£ç çš„å¤šä¸ªåœ°æ–¹æ­£ç¡®åˆç†åœ°ç¼–å†™ <code>lock()</code> å’Œ <code>unlock()</code> è¯­å¥ã€‚ä½†æ˜¯ï¼Œä¸‡ä¸€æˆ‘ä»¬å¿˜è®°äº†åŠ é”ã€è§£é”çš„æ“ä½œï¼Œæ­¤æ—¶ä¼šå¯¼è‡´å‡ºç°äº’æ–¥é‡æ²¡æœ‰åŠæ—¶é‡Šæ”¾è€Œå¯¼è‡´çš„ <strong>æ­»é”</strong> ç­‰é—®é¢˜ï¼Œè¿™ä¼šå¯¼è‡´ç¨‹åºæ— æ³•ç»§ç»­æ‰§è¡Œã€‚è€Œä¸”ï¼Œé¢‘ç¹åœ°æ‰‹åŠ¨è¿›è¡Œ <code>lock()</code> å’Œ <code>unlock()</code> æœ‰æ—¶ä¼šæ˜¾å¾—ä»£ç  <strong>ç»“æ„æ¯”è¾ƒå¤æ‚</strong>ã€‚</p><h2 id="2-std-lock-guard">2 std::lock_guard</h2><h3 id="2-1-åŸºæœ¬æ¦‚å¿µåŠä½œç”¨">2.1 åŸºæœ¬æ¦‚å¿µåŠä½œç”¨</h3><p>C++ 11 ä¸­å¼•å…¥äº† <code>std::lock_guard</code>ï¼ŒåŒ…å«åœ¨ <code>&lt;mutex&gt;</code> ä¸­ï¼Œå¯ä»¥ç›´æ¥å–ä»£ <code>lock()</code> å’Œ <code>unlock()</code> æ¥ç®¡ç†äº’æ–¥é‡ mutexï¼Œä½¿å¾—ä»£ç çš„ç»“æ„æ›´åŠ ç®€æ´ï¼Œæä¾›äº†ä¸€ç§ç®€å•è€Œå®‰å…¨çš„æ–¹å¼æ¥ç¡®ä¿åœ¨æŸä¸ªä½œç”¨åŸŸå†…äº’æ–¥é‡è¢«æ­£ç¡®åœ°åŠ é”å’Œè§£é”ã€‚</p><p><code>std::lock_guard</code> æ˜¯ä¸€ä¸ªç±»æ¨¡æ¿ï¼ŒåŸºæœ¬çš„å‡½æ•°åŸå‹ä¸º <code>template&lt;class Mutex&gt; class lock_guard</code>ï¼Œå…¶ä¸­ <code>class Mutex</code> æ˜¯ä¸€ä¸ªäº’æ–¥é‡ç±»å‹ï¼Œé€šå¸¸å°±æ˜¯ <code>std::mutex</code>ã€‚</p><h3 id="2-2-åŸºæœ¬ä½¿ç”¨æ–¹æ³•">2.2 åŸºæœ¬ä½¿ç”¨æ–¹æ³•</h3><p>åœ¨å®šä¹‰ <code>std::lock_guard</code> å¯¹è±¡çš„ä½ç½®ï¼Œ<code>std::lock_guard</code> å¯¹è±¡å¯¹äº’æ–¥é‡è¿›è¡ŒåŠ é” <code>lock()</code>ï¼›åœ¨å¯¹è±¡ææ„çš„ä½ç½®ï¼ˆ<strong>ä½œç”¨åŸŸç»“æŸ</strong>ï¼Œé€šå¸¸æ˜¯ return çš„ä½ç½®ï¼‰ï¼Œ<code>std::lock_guard</code> å¯¹è±¡å¯¹äº’æ–¥é‡è¿›è¡Œè§£é” <code>unlock()</code>ã€‚</p><p>å‡å¦‚æˆ‘ä»¬æˆ‘ä»¬æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œå¹¶ä¸”å®šä¹‰äº†ä¸€ä¸ªå…±äº«æ•°æ®å˜é‡ <code>count</code>ï¼Œä»¥åŠä¸€ä¸ª <code>std::mutex</code> äº’æ–¥é‡ã€‚åœ¨çº¿ç¨‹å‡½æ•° <code>foo()</code> ä¸­ï¼Œåœ¨ <strong>åŒä¸€ä½œç”¨åŸŸ</strong> ä¸­ï¼Œå¯¹å…±äº«å˜é‡è¿›è¡Œæ“ä½œä¹‹å‰ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ª <code>std::lock_guard</code> å¯¹è±¡ï¼Œæ­¤æ—¶ä¼šè‡ªåŠ¨è¿›è¡Œå¯¹äº’æ–¥é‡åŠ é”ï¼›å¯¹å…±äº«å˜é‡æ“ä½œå®Œï¼Œåœ¨ <strong>ä½œç”¨åŸŸç»“æŸ</strong> çš„ä½ç½®ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œè§£é”ã€‚</p><p>è¿™æ ·å°±å¯ä»¥ä»£æ›¿ <code>lock()</code> å’Œ <code>unlock()</code> çš„ä½œç”¨ï¼Œç¡®ä¿å¤šä¸ªçº¿ç¨‹äº’æ–¥è®¿é—®å…±äº«æ•°æ®ã€‚</p><p>ä¾‹å¦‚ä¸‹é¢è¿™ç§å½¢å¼:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">// å®šä¹‰ lock_guard å¯¹è±¡ï¼Œè‡ªåŠ¨è¿›è¡ŒåŠ é”</span><br>    <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>; <br>    count ++ ; <span class="hljs-comment">// å¯¹å…±äº«æ•°æ®è¿›è¡Œæ“ä½œ</span><br>    <span class="hljs-comment">// ä½œç”¨åŸŸç»“æŸä½ç½®ï¼ˆreturnï¼‰ï¼Œè‡ªåŠ¨è¿›è¡Œè§£é”</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> åŒä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œ<code>std::lock_guard</code> å’Œ <code>lock()/unlock()</code> ä¸èƒ½æ··ç”¨ï¼Œå¦‚æœç”¨äº† <code>std::lock_guard</code>ï¼Œå°±ç¦æ­¢æ‰‹åŠ¨å†è°ƒç”¨ <code>lock()</code> å’Œ <code>unlock()</code>ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ­»é”æˆ–è€…èµ„æºæ²¡æœ‰æ­£ç¡®é‡Šæ”¾ç­‰é—®é¢˜ã€‚</p><h3 id="2-3-ä»£ç ç¤ºä¾‹">2.3 ä»£ç ç¤ºä¾‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><br>std::mutex mtx; <span class="hljs-comment">// äº’æ–¥é‡</span><br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> num)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; num; i ++ )&#123;<br>        <span class="hljs-comment">// lock_guard ä»£æ›¿ lock å’Œ unlock</span><br>        <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>; <span class="hljs-comment">// è‡ªåŠ¨è¿›è¡Œ lock()  </span><br>        count ++ ;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>();<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        <span class="hljs-comment">// åœ¨å®šä¹‰åŸŸç»“æŸæ—¶ï¼Œè‡ªåŠ¨è¿›è¡Œ unlock()</span><br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">(foo, <span class="hljs-number">100000</span>)</span></span>;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t2</span><span class="hljs-params">(foo, <span class="hljs-number">100000</span>)</span></span>;<br>    t<span class="hljs-number">1.</span><span class="hljs-built_in">join</span>();<br>    t<span class="hljs-number">2.</span><span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;final count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå®šä¹‰äº†ä¸¤ä¸ªçº¿ç¨‹ <code>t1</code> å’Œ <code>t2</code>ï¼Œçº¿ç¨‹å‡½æ•°å‡ä¸º <code>foo()</code>ï¼Œä¼ é€’çš„å‚æ•°å‡ä¸º <code>100000</code>ï¼Œæ„ä¸ºå¯¹å…±äº«æ•°æ®å˜é‡ <code>count</code> è‡ªåŠ  <code>100000</code> æ¬¡ã€‚åœ¨å¾ªç¯æ¯æ¬¡è¿­ä»£ä¸­ï¼Œå®šä¹‰ä¸€ä¸ª <code>std::lock_guard</code> å¯¹è±¡ï¼Œå®ç°è‡ªåŠ¨åŠ é”å’Œä½œç”¨åŸŸç»“æŸåçš„è‡ªåŠ¨è§£é”ï¼Œç¡®ä¿å¯¹å…±äº«æ•°æ®çš„äº’æ–¥è®¿é—®ã€‚</p><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/26/jt.png" alt=""></p><p><img src="https://sukicdn.com/wyx/i/2024/12/26/154ap.png" alt=""></p><p>åœ¨å¯¹æ•°æ®æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œæ‰“å°çº¿ç¨‹çš„ id ä»¥åŠå½“å‰å˜é‡ <code>count</code> çš„å€¼ã€‚åœ¨è¾“å‡ºè¿‡ç¨‹ä¸­å¯ä»¥å‘ç°ï¼Œä¸¤ä¸ªçº¿ç¨‹æ¥å›åˆ‡æ¢è¿›è¡Œï¼Œè¡¨æ˜ä¸¤ä¸ªçº¿ç¨‹æ˜¯å¹¶å‘ï¼ˆå¹¶è¡Œï¼‰æ‰§è¡Œçš„ï¼›æ‰“å°çš„ <code>count</code> å€¼ä¿æŒä¸æ–­é€’å¢ï¼Œè¡¨æ˜æˆ‘ä»¬çš„ä¸¤ä¸ªå­çº¿ç¨‹äº’æ–¥è®¿é—®å’Œä¿®æ”¹å…±äº«æ•°æ®å˜é‡ã€‚</p><p>æœ€ç»ˆè¾“å‡ºçš„ç»“æœä¸º <code>200000</code>ï¼Œæˆ‘ä»¬çš„ç¨‹åºæ­£ç¡®æ‰§è¡Œäº†ä¸¤ä¸ªçº¿ç¨‹ <code>t1</code> å’Œ <code>t2</code> åŒæ—¶å¯¹ <code>count</code> è¿›è¡Œ <code>100000</code> æ¬¡è‡ªåŠ ä¿®æ”¹çš„æ“ä½œï¼Œå¯¹å…±äº«æ•°æ®çš„è®¿é—®ä¸ä¿®æ”¹æ˜¯äº’æ–¥çš„ã€‚</p><h2 id="3-adopt-lock-å‚æ•°">3 adopt_lock å‚æ•°</h2><p><code>std::adopt_lock</code> æ˜¯ä¸€ä¸ªæ ‡è®°ç±»å‹ï¼Œå¯ä»¥ç”¨äº <code>std::lock_guard</code> çš„æ„é€ å‡½æ•°ã€‚å½“ä¼ é€’è¿™ä¸ªå‚æ•°æ—¶ï¼Œè¡¨ç¤ºäº’æ–¥é‡å·²ç»è¢«é”ä½ï¼Œæ­¤æ—¶å¯¹äº’æ–¥é‡çš„é”çš„ç®¡ç†ç›´æ¥è½¬ç§»ç»™ <code>std::lock_guard</code>ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿åœ¨åˆé€‚çš„æ—¶å€™é‡Šæ”¾é”ï¼Œä¸éœ€è¦å†è°ƒç”¨ <code>std::mutex::unlock()</code> å»æ‰‹åŠ¨é‡Šæ”¾é”ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br>std::mutex mtx;<br><span class="hljs-type">int</span> count;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    mtx.<span class="hljs-built_in">lock</span>();<br>    <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx, std::adopt_lock)</span></span>;<br>    count ++ ;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>();<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">threads</span><span class="hljs-params">(<span class="hljs-number">15</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : threads) t = std::<span class="hljs-built_in">thread</span>(foo);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : threads) t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/12/27/55msg.png" alt=""></p><p>ä¸ <code>std::unique_lock</code> ï¼ˆ<a href="https://marisamagic.github.io/2024/12/26/20241226_/">ã€ŒC++ å¤šçº¿ç¨‹ã€std::unique_lock åŸºæœ¬ç”¨æ³•</a>ï¼‰ä¸åŒï¼Œ<code>std::lock_guard</code> çš„æ„é€ å‡½æ•°åªæ¥å—äº’æ–¥é‡å¯¹è±¡å’Œå¯é€‰çš„ <code>std::adopt_lock</code> å‚æ•°ã€‚å®ƒçš„è®¾è®¡ç›®çš„æ˜¯æä¾›ä¸€ç§ç®€å•ã€é«˜æ•ˆçš„æœºåˆ¶æ¥ç¡®ä¿äº’æ–¥é‡åœ¨ä½œç”¨åŸŸç»“æŸæ—¶è¢«æ­£ç¡®é‡Šæ”¾ã€‚è€Œå…¶å®ƒæ¯”å¦‚ <code>std::defer_lock</code> ç­‰å‚æ•° <code>std::lock_guard</code> æ˜¯ä¸å¯ä»¥ä½¿ç”¨çš„ã€‚</p><h2 id="4-ç®€å•åº”ç”¨å®ä¾‹">4 ç®€å•åº”ç”¨å®ä¾‹</h2><p>å’Œä¹‹å‰ <code>std::mutex</code> æ–‡ç«  <a href="https://marisamagic.github.io/2024/12/25/20241225/">ã€ŒC++ å¤šçº¿ç¨‹ã€std::mutexï¼Œlock(), unlock()</a> ä¸­çš„é—®é¢˜ç›¸åŒ:</p><ol><li>ä¸€ä¸ªçº¿ç¨‹ç”¨æ¥æ¥å—ç”¨æˆ·å‘½ä»¤ï¼ˆç”¨æ•°å­—è¡¨ç¤ºå‘½ä»¤ï¼‰ï¼Œå¹¶æŠŠå‘½ä»¤å†™å…¥ä¸€ä¸ªé˜Ÿåˆ—ä¸­</li><li>å¦ä¸€ä¸ªçº¿ç¨‹ä»é˜Ÿåˆ—ä¸­è¯»å–å‘½ä»¤ï¼Œè§£æå‘½ä»¤å¹¶æ‰§è¡Œä¸€ç³»åˆ—æ“ä½œ</li></ol><p>ç¨‹åºä¸­å…±äº«æ•°æ®ï¼ˆæ•°æ®ç»“æ„ï¼‰ msg_queï¼Œæ¶ˆæ¯é˜Ÿåˆ—åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œæ“ä½œï¼ˆè¯»å–æˆ–å†™å…¥ï¼‰ã€‚å› æ­¤ msg_que æ˜¯ä¸´ç•Œèµ„æºï¼Œæˆ‘ä»¬éœ€è¦å¯¹è®¿é—®ä¸´ç•Œèµ„æºçš„ä»£ç åŠ é”ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç”¨ <code>std::lock_guard</code> ä»£æ›¿åŸå…ˆä»£ç ä¸­çš„ <code>lock()</code> å’Œ <code>unlock()</code> éƒ¨åˆ†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>&#123;<br>std::queue&lt;<span class="hljs-type">int</span>&gt; msg_que; <span class="hljs-comment">// å­˜å‚¨ç”¨æˆ·å‘½ä»¤çš„æ¶ˆæ¯é˜Ÿåˆ—</span><br>std::mutex mtx;     <span class="hljs-comment">// äº’æ–¥é‡</span><br><span class="hljs-keyword">public</span>:<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">in_msg_que</span><span class="hljs-params">(<span class="hljs-type">int</span> num)</span></span>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; num; i ++ )&#123;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;in_msg_que() running, push data: &quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-comment">// ä»£æ›¿ lock(), unlock()</span><br><span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>; <br>msg_que.<span class="hljs-built_in">push</span>(i);  <span class="hljs-comment">// æ”¾å…¥æ¶ˆæ¯é˜Ÿåˆ—</span><br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">out_msg_que</span><span class="hljs-params">(<span class="hljs-type">int</span> num)</span></span>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; num; i ++ )&#123;<br><span class="hljs-type">int</span> command;  <span class="hljs-comment">// å–å‡ºçš„æŒ‡ä»¤</span><br><span class="hljs-keyword">if</span>(<span class="hljs-built_in">pop_command</span>(command))&#123;<br><span class="hljs-comment">// æ¶ˆæ¯é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œå¤„ç†å–å‡ºçš„æŒ‡ä»¤</span><br>std::cout &lt;&lt; <span class="hljs-string">&quot;out_msg_que() running, command is: &quot;</span> &lt;&lt; command &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br><span class="hljs-comment">// æ¶ˆæ¯é˜Ÿåˆ—ä¸ºç©º</span><br>std::cout &lt;&lt; <span class="hljs-string">&quot;out_msg_que() running, queue is empty: &quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">pop_command</span><span class="hljs-params">(<span class="hljs-type">int</span> &amp;command)</span></span>&#123;<br><span class="hljs-comment">// ä»£æ›¿ lock(), unlock()</span><br><span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lck</span><span class="hljs-params">(mtx)</span></span>; <br><span class="hljs-keyword">if</span>(msg_que.<span class="hljs-built_in">empty</span>())&#123;<br><span class="hljs-comment">// å¦‚æœä¸ºç©ºï¼Œç›´æ¥è¿”å›falseã€‚lck å¯¹è±¡ææ„ï¼Œè‡ªåŠ¨è¿›è¡Œ unlock()</span><br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <br>&#125;<br>command = msg_que.<span class="hljs-built_in">front</span>(); <span class="hljs-comment">// ä»é˜Ÿé¦–å–å‡ºæŒ‡ä»¤</span><br>msg_que.<span class="hljs-built_in">pop</span>();<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// è¿”å›trueï¼Œè‡ªåŠ¨ unlock()</span><br>&#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>MyClass obj;<br><span class="hljs-function">std::thread <span class="hljs-title">out_msg_t</span><span class="hljs-params">(&amp;MyClass::out_msg_que, &amp;obj, <span class="hljs-number">100000</span>)</span></span>; <br><span class="hljs-function">std::thread <span class="hljs-title">in_msg_t</span><span class="hljs-params">(&amp;MyClass::in_msg_que, &amp;obj, <span class="hljs-number">100000</span>)</span></span>;<br><br><span class="hljs-type">out_msg_t</span>.<span class="hljs-built_in">join</span>();<br><span class="hljs-type">in_msg_t</span>.<span class="hljs-built_in">join</span>();<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¿è¡Œç»“æœå¦‚ä¸‹:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/26/7mv.png" alt=""></p>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
      <tag>std::mutex</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€std::mutexï¼Œlock(), unlock()</title>
    <link href="/2024/12/25/20241225/"/>
    <url>/2024/12/25/20241225/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æº: <a href="https://www.pixiv.net/artworks/116700258">pixiv_id=116700258</a></p><h2 id="1-é—®é¢˜èƒŒæ™¯">1 é—®é¢˜èƒŒæ™¯</h2><p>åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ç¯å¢ƒä¸­ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶æ‰§è¡Œä¸åŒçš„ä»»åŠ¡ã€‚å½“çº¿ç¨‹éœ€è¦è®¿é—®å…±äº«èµ„æºï¼ˆä¾‹å¦‚å…¨å±€å˜é‡ã€å…±äº«çš„æ•°æ®ç»“æ„ç­‰ï¼‰ï¼Œä¼šäº§ç”Ÿä¸€äº›é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œæœ‰ä¸¤ä¸ªçº¿ç¨‹ <code>t1</code> å’Œ <code>t2</code>ï¼Œéƒ½éœ€è¦è®¿é—®å’Œä¿®æ”¹ä¸€ä¸ªå…±äº«çš„è®¡æ•°å™¨ <code>count</code>ã€‚</p><p>å¦‚æœæ²¡æœ‰é€‚å½“çš„åŒæ­¥æœºåˆ¶æ—¶ï¼Œå¯èƒ½ä¼šå­˜åœ¨ <strong>æ•°æ®ç«äº‰</strong>ã€‚è‹¥çº¿ç¨‹ <code>t1</code> å’Œ <code>t2</code> åŒæ—¶ä¿®æ”¹å…±äº«è®¡æ•°å™¨ <code>count</code>ï¼ˆå‡è®¾å½“å‰è®¡æ•°å™¨ <code>count</code> çš„å€¼ä¸º <code>7</code>ï¼‰ï¼Œå„è‡ªå¯¹å…¶è¿›è¡Œ <code>+1</code> æ“ä½œï¼Œæ­¤æ—¶ä¸¤ä¸ªçº¿ç¨‹å¯èƒ½ä¼š <strong>åŒæ—¶</strong> å°†ä¿®æ”¹çš„ç»“æœï¼ˆ<code>+1</code> åç»“æœä¸º <code>8</code>ï¼‰å†™å…¥ <code>count</code>ã€‚æœ€ç»ˆå¯¼è‡´ <code>count</code> ä¸º <code>8</code>ï¼Œç„¶è€Œé¢„æœŸåº”è¯¥æ˜¯ä¸¤ä¸ªçº¿ç¨‹éƒ½å¯¹è®¡æ•°å™¨è¿›è¡Œ <code>+1</code>ï¼Œå› æ­¤é¢„æœŸæœ€ç»ˆç»“æœä¸º <code>9</code>ã€‚è¿™å¯¼è‡´äº†æ•°æ®çš„ä¸ä¸€è‡´ã€‚</p><h2 id="2-äº’æ–¥é”">2 äº’æ–¥é”</h2><p>ä¸ºäº†è§£å†³å¤šçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«èµ„æºä¸­æ•°æ®ç«äº‰çš„é—®é¢˜ï¼Œæˆ‘ä»¬æœ‰äº†äº’æ–¥é”ï¼ˆMutexï¼‰ã€‚äº’æ–¥é”åŸºäºä¸€ç§äº’æ–¥çš„åŸåˆ™ï¼Œå³ <strong>åŒä¸€æ—¶åˆ»</strong> åªå…è®¸ <strong>ä¸€ä¸ªçº¿ç¨‹è®¿é—®è¢«ä¿æŠ¤çš„èµ„æº</strong>ã€‚</p><p>äº’æ–¥é”çš„å·¥ä½œåŸç†å°±ç±»ä¼¼äºä¸€ä¸ªé—¨é”ï¼Œåªæœ‰æŒæœ‰é’¥åŒ™ï¼ˆè·å–é”ï¼‰çš„çº¿ç¨‹æ‰èƒ½è®¿é—®æˆ¿é—´ï¼ˆå…±äº«èµ„æºï¼‰å†…çš„å†…å®¹ã€‚</p><p>å½“ä¸€ä¸ªçº¿ç¨‹è·å–äº’æ–¥é”ï¼Œå…¶ä»–è¯•å›¾è®¿é—®å…±äº«èµ„æºçš„çº¿ç¨‹ä¼šè¢« <strong>é˜»å¡</strong>ï¼Œç›´åˆ°å½“å‰è¿™ä¸ªè·å–é”çš„çº¿ç¨‹ <strong>é‡Šæ”¾é”</strong>ã€‚</p><p>åœ¨ä¹‹å‰çº¿ç¨‹ <code>t1</code> å’Œ <code>t2</code> çš„ä¾‹å­ä¸­ï¼Œå¦‚æœä½¿ç”¨äº†äº’æ–¥é”ï¼Œå¯ä»¥ä¿è¯ <code>t1</code> å’Œ <code>t2</code> å¯¹å…±äº«æ•°æ® <code>count</code> çš„ä¿®æ”¹è®¿é—®æ“ä½œæ˜¯äº’æ–¥çš„ã€‚å½“ <code>t1</code> å¯¹ <code>count</code> è¿›è¡Œä¿®æ”¹æ“ä½œï¼Œå…ˆè·å¾—äº†é”ï¼Œé‚£ä¹ˆ<code>t2</code> çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œç›´åˆ° <code>t1</code> é‡Šæ”¾é”ã€‚åä¹‹äº¦ç„¶ã€‚è¿™æ ·å°±ç¡®ä¿é¿å…äº†æ•°æ®ç«äº‰çš„é—®é¢˜ã€‚</p><h2 id="3-std-mutex">3 std::mutex</h2><h3 id="3-1-åŸºæœ¬æ¦‚å¿µ">3.1 åŸºæœ¬æ¦‚å¿µ</h3><p>std::mutexï¼ˆäº’æ–¥é‡ / äº’æ–¥é”ï¼‰æ˜¯ C++ æ ‡å‡†åº“ä¸­ç”¨äºå®ç°çº¿ç¨‹é—´äº’æ–¥è®¿é—®çš„åŒæ­¥åŸè¯­ã€‚ç”¨äºå¤šçº¿ç¨‹ä¸­ä¿æŠ¤å…±äº«èµ„æºï¼Œé˜²æ­¢å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å’Œä¿®æ”¹å¯¼è‡´çš„æ•°æ®ç«äº‰å’Œæ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p><p>std::mutex ä¸å…è®¸æ‹·è´æ„é€ ï¼Œä¹Ÿä¸å…è®¸ std::moveï¼Œæœ€åˆäº§ç”Ÿçš„ mutex å¯¹è±¡å¤„äº unlocked çŠ¶æ€ã€‚</p><h3 id="3-2-lock-å‡½æ•°">3.2 lock() å‡½æ•°</h3><p><code>std::mutex::lock()</code> çš„åŠŸèƒ½æ˜¯ <strong>å°è¯•è·å–äº’æ–¥é‡ mutex çš„é”</strong>ã€‚</p><p>å¦‚æœäº’æ–¥é‡å½“å‰æ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹é”å®šï¼Œé‚£ä¹ˆè°ƒç”¨ <code>std::mutex::lock()</code> çš„çº¿ç¨‹å°†æˆåŠŸè·å–é”å¹¶ç»§ç»­æ‰§è¡Œåç»­ä»£ç ã€‚</p><p>å¦‚æœäº’æ–¥é‡å·²ç»è¢«å…¶ä»–çº¿ç¨‹é”å®šï¼Œé‚£ä¹ˆè°ƒç”¨ <code>std::mutex::lock()</code> çš„çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°èƒ½å¤Ÿè·å–é”ä¸ºæ­¢ã€‚</p><h3 id="3-3-unlock-å‡½æ•°">3.3 unlock() å‡½æ•°</h3><p><code>std::mutex::unlock()</code> çš„åŠŸèƒ½æ˜¯ <strong>é‡Šæ”¾äº’æ–¥é‡çš„é”</strong>ï¼Œä½¿å¾—å…¶ä»–ç­‰å¾…è·å–é”çš„çº¿ç¨‹æœ‰æœºä¼šè·å–é”å¹¶è®¿é—®è¢«ä¿æŠ¤çš„å…±äº«èµ„æºã€‚</p><p>å¿…é¡»ç¡®ä¿ lock å’Œ unlock æˆå¯¹å‡ºç°ï¼Œå¹¶ä¸”åœ¨æ­£ç¡®çš„é€»è¾‘ä½ç½®è°ƒç”¨ unlockã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹åœ¨æ²¡æœ‰è·å–é”çš„æƒ…å†µä¸‹è°ƒç”¨ unlockï¼Œæˆ–è€…å¤šæ¬¡è°ƒç”¨ unlock è€Œæ²¡æœ‰ç›¸åº”æ¬¡æ•°çš„ lockï¼Œä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚</p><h3 id="3-4-try-lock-å‡½æ•°">3.4 try_lock() å‡½æ•°</h3><p><code>std::mutex::try_lock()</code> çš„åŠŸèƒ½æ˜¯ <strong>å°è¯•é”ä½äº’æ–¥é‡</strong>ã€‚</p><p>å¦‚æœè·å–æˆåŠŸï¼Œçº¿ç¨‹ä¼šæ‰§è¡Œéœ€è¦äº’æ–¥è®¿é—®çš„ä»£ç æ®µï¼Œç„¶åé€šè¿‡ unlock() é‡Šæ”¾é”ã€‚å¦‚æœè·å–å¤±è´¥ï¼Œçº¿ç¨‹ä¼šè¾“å‡ºä¸€æ¡æ¶ˆæ¯è¡¨ç¤ºæ— æ³•è·å–é”ã€‚</p><h2 id="4-std-mutex-ä»£ç ä¸æµ‹è¯•">4 std::mutex ä»£ç ä¸æµ‹è¯•</h2><h3 id="4-1-ç¤ºä¾‹">4.1 ç¤ºä¾‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><br>std::mutex mtx; <span class="hljs-comment">// äº’æ–¥é‡</span><br><span class="hljs-type">int</span> count; <br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> num)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; num; i ++ )&#123;<br>        mtx.<span class="hljs-built_in">lock</span>();<br>        count ++ ;<br>        mtx.<span class="hljs-built_in">unlock</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">(foo, <span class="hljs-number">100000</span>)</span></span>;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t2</span><span class="hljs-params">(foo, <span class="hljs-number">100000</span>)</span></span>;<br>    t<span class="hljs-number">1.</span><span class="hljs-built_in">join</span>();<br>    t<span class="hljs-number">2.</span><span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;final value: &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ç¨‹åºä¸­ï¼Œåˆ›å»ºäº†ä¸¤ä¸ªçº¿ç¨‹åˆ†åˆ«ä¸º <code>t1</code> å’Œ <code>t2</code>ï¼Œçº¿ç¨‹å‡½æ•°å‡ä¸º <code>foo()</code>ï¼Œä¼ å…¥çš„å‚æ•°å‡ä¸º <code>100000</code>ï¼Œä¸¤ä¸ªçº¿ç¨‹éƒ½å°†æ‰§è¡Œå¯¹å…¬å…±æ•°æ®æ‰§è¡Œ <code>count</code> è‡ªåŠ  <code>100000</code> æ¬¡çš„ä»»åŠ¡ã€‚</p><p>æˆ‘ä»¬åŒæ—¶è¿˜å®šä¹‰äº†ä¸€ä¸ª <code>std::mutex</code> äº’æ–¥é‡ <code>mtx</code>ï¼Œä¹Ÿå°±æ˜¯äº’æ–¥é”ã€‚ä¸ºäº†è®©ä¸¤ä¸ªçº¿ç¨‹äº’æ–¥è®¿é—®å’Œä¿®æ”¹æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ¯æ¬¡è¿›è¡Œ <code>count</code> è‡ªåŠ ä¿®æ”¹æ“ä½œä¹‹å‰è¿›è¡ŒåŠ é” <code>mtx.lock()</code>ï¼Œåœ¨æ‰§è¡Œå®Œä¸€æ¬¡ <code>count</code> è‡ªåŠ ä¿®æ”¹æ“ä½œåï¼Œè¿›è¡Œè§£é” <code>mtx.unlock()</code>ã€‚</p><p>æœ€ç»ˆæˆ‘ä»¬çš„ <code>count</code> å˜é‡ç­”æ¡ˆä¸º <code>200000</code>ã€‚</p><p>è¿è¡Œç»“æœå¦‚ä¸‹:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/25/5189z.png" alt=""></p><h3 id="4-2-åŠ é”ä¸è§£é”ä½ç½®åˆ†æ">4.2 åŠ é”ä¸è§£é”ä½ç½®åˆ†æ</h3><p>å¦‚æœä¸è¿›è¡ŒåŠ é”è§£é”çš„äº’æ–¥æ“ä½œï¼Œç”±äºæ•°æ®ç«äº‰å¯èƒ½å¯¼è‡´çš„é—®é¢˜ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½æœ€ç»ˆç­”æ¡ˆæ˜¯ä¸€ä¸ªä»‹äº 0 ~ 200000 çš„ä¸­é—´å€¼:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/25/518k0.png" alt=""></p><p>å¦‚æœåœ¨å¾ªç¯ä¹‹å¤–åŠ é”è§£é”ï¼Œé‚£ä¹ˆæœ¬è´¨ä¸Šå°±å˜æˆç¬¬ä¸€ä¸ªçº¿ç¨‹ <code>t1</code> å…ˆæ‰§è¡Œå®Œå¢åŠ  <code>100000</code> æ¬¡ï¼Œç„¶åç¬¬äºŒä¸ªçº¿ç¨‹ <code>t2</code> æ‰§è¡Œå¢åŠ  <code>100000</code> æ¬¡ï¼Œè€Œä¸æ˜¯å¹¶å‘ï¼ˆå¹¶è¡Œï¼‰æ‰§è¡Œçš„ã€‚å› æ­¤æœ¬è´¨ä¸Šå°±ä¸æ˜¯å¤šçº¿ç¨‹äº†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><br>std::mutex mtx; <span class="hljs-comment">// äº’æ–¥é‡</span><br><span class="hljs-type">int</span> count; <br><br><span class="hljs-comment">// é”™è¯¯çš„åŠ é”ã€è§£é”ä½ç½®ã€‚æœ¬è´¨ä¸Šä¸å†æ˜¯å¤šçº¿ç¨‹å¹¶å‘æ‰§è¡Œ</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> num)</span></span>&#123;<br>    mtx.<span class="hljs-built_in">lock</span>();<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; num; i ++ )&#123;<br>        count ++ ;<br>    &#125;<br>    mtx.<span class="hljs-built_in">unlock</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">(foo, <span class="hljs-number">100000</span>)</span></span>;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t2</span><span class="hljs-params">(foo, <span class="hljs-number">100000</span>)</span></span>;<br>    t<span class="hljs-number">1.</span><span class="hljs-built_in">join</span>();<br>    t<span class="hljs-number">2.</span><span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;final value: &quot;</span> &lt;&lt; count &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åœ¨çº¿ç¨‹å‡½æ•°çš„å¾ªç¯ä¹‹å¤–åŠ é”è§£é”ï¼Œé‚£ä¹ˆæœ¬è´¨ä¸Šä¸æ˜¯å¤šçº¿ç¨‹ï¼Œè™½ç„¶æœ€ç»ˆç»“æœä¹Ÿæ˜¯ <code>200000</code>ï¼Œä½†æ˜¯è„±ç¦»äº†æˆ‘ä»¬è¦å¹¶è¡Œæ‰§è¡Œçš„æœ¬æ„ã€‚</p><h2 id="5-ç®€å•åº”ç”¨å®ä¾‹">5 ç®€å•åº”ç”¨å®ä¾‹</h2><p>å‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹é—®é¢˜èƒŒæ™¯:</p><ol><li>ä¸€ä¸ªçº¿ç¨‹ç”¨æ¥æ¥å—ç”¨æˆ·å‘½ä»¤ï¼ˆç”¨æ•°å­—è¡¨ç¤ºå‘½ä»¤ï¼‰ï¼Œå¹¶æŠŠå‘½ä»¤å†™å…¥ä¸€ä¸ªé˜Ÿåˆ—ä¸­</li><li>å¦ä¸€ä¸ªçº¿ç¨‹ä»é˜Ÿåˆ—ä¸­è¯»å–å‘½ä»¤ï¼Œè§£æå‘½ä»¤å¹¶æ‰§è¡Œä¸€ç³»åˆ—æ“ä½œ</li></ol><p>ç¨‹åºä¸­å…±äº«æ•°æ®ï¼ˆæ•°æ®ç»“æ„ï¼‰ msg_queï¼Œä¹Ÿå°±æ˜¯æ¶ˆæ¯é˜Ÿåˆ—åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œæ“ä½œï¼ˆè¯»å–æˆ–å†™å…¥ï¼‰ã€‚å› æ­¤ msg_que æ˜¯ä¸´ç•Œèµ„æºï¼Œæˆ‘ä»¬éœ€è¦å¯¹è®¿é—®ä¸´ç•Œèµ„æºçš„ä»£ç åŠ é”ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mutex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>&#123;<br>std::queue&lt;<span class="hljs-type">int</span>&gt; msg_que; <span class="hljs-comment">// å­˜å‚¨ç”¨æˆ·å‘½ä»¤çš„æ¶ˆæ¯é˜Ÿåˆ—</span><br>std::mutex mtx;          <span class="hljs-comment">// äº’æ–¥é‡</span><br><span class="hljs-keyword">public</span>:<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">in_msg_que</span><span class="hljs-params">(<span class="hljs-type">int</span> num)</span></span>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; num; i ++ )&#123;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;in_msg_que() running, push data: &quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>mtx.<span class="hljs-built_in">lock</span>();    <span class="hljs-comment">// åŠ é”</span><br>msg_que.<span class="hljs-built_in">push</span>(i);    <span class="hljs-comment">// æ”¾å…¥æ¶ˆæ¯é˜Ÿåˆ—</span><br>mtx.<span class="hljs-built_in">unlock</span>();  <span class="hljs-comment">// è§£é”</span><br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">out_msg_que</span><span class="hljs-params">(<span class="hljs-type">int</span> num)</span></span>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; num; i ++ )&#123;<br><span class="hljs-type">int</span> command;  <span class="hljs-comment">// å–å‡ºçš„æŒ‡ä»¤</span><br><span class="hljs-keyword">if</span>(<span class="hljs-built_in">pop_command</span>(command))&#123;<br><span class="hljs-comment">// æ¶ˆæ¯é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œå¤„ç†å–å‡ºçš„æŒ‡ä»¤</span><br>std::cout &lt;&lt; <span class="hljs-string">&quot;out_msg_que() running, command is: &quot;</span> &lt;&lt; command &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br><span class="hljs-comment">// æ¶ˆæ¯é˜Ÿåˆ—ä¸ºç©º</span><br>std::cout &lt;&lt; <span class="hljs-string">&quot;out_msg_que() running, queue is empty: &quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">pop_command</span><span class="hljs-params">(<span class="hljs-type">int</span> &amp;command)</span></span>&#123;<br>mtx.<span class="hljs-built_in">lock</span>();<br><span class="hljs-keyword">if</span>(msg_que.<span class="hljs-built_in">empty</span>())&#123;   <span class="hljs-comment">// å¦‚æœä¸ºç©ºï¼Œç›´æ¥è§£é”è¿”å›false</span><br>mtx.<span class="hljs-built_in">unlock</span>();<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br>command = msg_que.<span class="hljs-built_in">front</span>(); <span class="hljs-comment">// ä»é˜Ÿé¦–å–å‡ºæŒ‡ä»¤</span><br>msg_que.<span class="hljs-built_in">pop</span>();<br>mtx.<span class="hljs-built_in">unlock</span>();<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>MyClass obj_a;<br><span class="hljs-function">std::thread <span class="hljs-title">out_msg_t</span><span class="hljs-params">(&amp;MyClass::out_msg_que, &amp;obj_a, <span class="hljs-number">7</span>)</span></span>; <span class="hljs-comment">// é€šè¿‡ç±»æˆå‘˜å‡½æ•°åˆ›å»ºçº¿ç¨‹</span><br><span class="hljs-function">std::thread <span class="hljs-title">in_msg_t</span><span class="hljs-params">(&amp;MyClass::in_msg_que, &amp;obj_a, <span class="hljs-number">5</span>)</span></span>;<br><br><span class="hljs-type">out_msg_t</span>.<span class="hljs-built_in">join</span>();<br><span class="hljs-type">in_msg_t</span>.<span class="hljs-built_in">join</span>();<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªåä¸º MyClass çš„ç±»ï¼Œç”¨äºç®¡ç†ä¸€ä¸ªå­˜å‚¨æ•´æ•°çš„ <code>std::queue&lt;int&gt;</code> æ¶ˆæ¯é˜Ÿåˆ— <code>msg_que</code>ï¼Œï¼Œå¹¶ä¸”é€šè¿‡äº’æ–¥é‡ï¼ˆ<code>std::mutex</code>ï¼‰æ¥ä¿è¯å¯¹æ¶ˆæ¯é˜Ÿåˆ—æ“ä½œçš„çº¿ç¨‹å®‰å…¨æ€§ã€‚åœ¨ main å‡½æ•°ä¸­åˆ›å»ºäº†ä¸¤ä¸ªçº¿ç¨‹ï¼Œåˆ†åˆ«ç”¨äºå‘æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ’å…¥æ•°æ®ï¼ˆ<code>in_msg_que</code> å‡½æ•°ï¼‰å’Œä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å‡ºæ•°æ®ï¼ˆ<code>out_msg_que</code> å‡½æ•°ï¼‰ã€‚</p><p>åœ¨æ¯æ¬¡ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å‡ºæ•°æ®æ—¶ï¼Œè°ƒç”¨ <code>pop_command</code> å‡½æ•°å°è¯•å»é™¤é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªæ•°æ®ã€‚å¦‚æœé˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œé‚£ä¹ˆæˆåŠŸå–å‡ºå¹¶è¾“å‡ºæ¶ˆæ¯æŒ‡ä»¤çš„å†…å®¹ï¼›å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œé‚£ä¹ˆæ— æ³•å–å‡ºæ•°æ®ã€‚</p><p>åœ¨ <code>pop_command</code> å‡½æ•°ä¸­ï¼Œå…ˆè¿›è¡ŒåŠ é”ï¼Œç„¶ååˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºåˆ™ç›´æ¥è§£é”äº’æ–¥é‡å¹¶è¿”å› <code>false</code>ï¼Œè¡¨ç¤ºæ— æ³•å–å‡ºæ•°æ®ï¼›å¦‚æœé˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œå°±å°†é˜Ÿé¦–çš„æ•°æ®èµ‹å€¼ç»™ä¼ å…¥çš„å¼•ç”¨å‚æ•° commandï¼Œæ¥ç€å°†é˜Ÿé¦–å…ƒç´ ä»é˜Ÿåˆ—ä¸­ç§»é™¤ï¼Œæœ€åå†è¿›è¡Œè§£é”ï¼Œè¿”å› <code>true</code>ï¼Œè¡¨ç¤ºæˆåŠŸå–å‡ºæ•°æ®ã€‚</p><p>è¿è¡Œç»“æœå¦‚ä¸‹:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/25/5ilu0.png" alt=""></p>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
      <tag>std::mutex</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€ç¡¬ä»¶æ”¯æŒçº¿ç¨‹æ•°ã€çº¿ç¨‹è¯†åˆ«</title>
    <link href="/2024/12/23/20241223/"/>
    <url>/2024/12/23/20241223/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æº: <a href="https://www.pixiv.net/artworks/104200866">pixiv_id=104200866</a></p><h2 id="1-CPUæ ¸å¿ƒæ•°å’Œæ”¯æŒçº¿ç¨‹æ•°">1 CPUæ ¸å¿ƒæ•°å’Œæ”¯æŒçº¿ç¨‹æ•°</h2><h3 id="1-1-ç‰©ç†æ ¸å¿ƒ">1.1 ç‰©ç†æ ¸å¿ƒ</h3><p><strong>ç‰©ç†æ ¸å¿ƒ</strong> æ˜¯ CPU ä¸­å®é™…å­˜åœ¨çš„å¤„ç†å•å…ƒï¼Œæ¯ä¸ªç‰©ç†æ ¸å¿ƒå¯ä»¥ç‹¬ç«‹åœ°æ‰§è¡ŒæŒ‡ä»¤ã€‚ä¾‹å¦‚ï¼Œæˆ‘çš„ç”µè„‘çš„ CPU æ˜¯ 24 æ ¸çš„ï¼Œé‚£ä¹ˆå°±æœ‰ 24 ä¸ªç‰©ç†æ ¸å¿ƒã€‚</p><h3 id="1-2-ç¡¬ä»¶æ”¯æŒçº¿ç¨‹æ•°é‡ï¼ˆé€»è¾‘æ ¸å¿ƒï¼‰">1.2 ç¡¬ä»¶æ”¯æŒçº¿ç¨‹æ•°é‡ï¼ˆé€»è¾‘æ ¸å¿ƒï¼‰</h3><p>å¦‚æœ <strong>ä¸æ”¯æŒè¶…çº¿ç¨‹æŠ€æœ¯</strong>ï¼Œä¸€ä¸ª 24 æ ¸çš„ CPUï¼Œç†æƒ³æƒ…å†µä¸‹å¯ä»¥æ”¯æŒ 24 ä¸ªçº¿ç¨‹å¹¶å‘ï¼ˆå¹¶è¡Œï¼‰æ‰§è¡Œã€‚</p><p>å¦‚æœ <strong>æ”¯æŒè¶…çº¿ç¨‹æŠ€æœ¯</strong>ï¼Œä¸€ä¸ªç‰©ç†æ ¸å¿ƒå¯ä»¥è¢«æ¨¡æ‹Ÿæˆä¸¤ä¸ªé€»è¾‘æ ¸å¿ƒæ¥å¤„ç†çº¿ç¨‹ï¼Œä»è€Œä½¿ CPU èƒ½å¤ŸåŒæ—¶å¤„ç†æ›´å¤šçš„çº¿ç¨‹ã€‚ä¾‹å¦‚ä¸€ä¸ª 32 æ ¸çš„ CPUï¼Œå¦‚æœæ”¯æŒè¶…çº¿ç¨‹æŠ€æœ¯ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œå¯ä»¥æ”¯æŒ 64 ä¸ªçº¿ç¨‹å¹¶å‘ï¼ˆå¹¶è¡Œï¼‰æ‰§è¡Œã€‚</p><h3 id="1-3-std-thread-hardware-concurrency">1.3 std::thread::hardware_concurrency()</h3><p><code>std::thread::hardware_concurrency()</code> æ˜¯ std::thread ä¸­çš„ä¸€ä¸ªæˆå‘˜å‡½æ•°ï¼Œç”¨äºç¡®å®šç³»ç»Ÿç¡¬ä»¶çš„å¹¶å‘åº¦ã€‚è¯¥å‡½æ•°è¿”å›ä¸€ä¸ª std::size_t ç±»å‹çš„å€¼ï¼Œè¡¨ç¤º <strong>ç¡¬ä»¶æ”¯æŒçš„å¹¶å‘çº¿ç¨‹æ•°</strong>ã€‚</p><p><code>std::thread::hardware_concurrency()</code> å‡½æ•°è¿”å›çš„å€¼å¯èƒ½ä¸æ˜¯ä¸€ä¸ªå‡†ç¡®çš„å€¼ï¼Œåªèƒ½ä½œä¸ºä¸€ä¸ªçº¿ç¨‹æ”¯æŒæ•°é‡çš„å‚è€ƒã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ƒå¯èƒ½è¿”å› 0ï¼Œæ­¤æ—¶å°±æ— æ³•ç¡®å®šç¡¬ä»¶çš„å¹¶å‘åº¦ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">size_t</span> n = std::thread::<span class="hljs-built_in">hardware_concurrency</span>();<br><br>    <span class="hljs-keyword">if</span>(n == <span class="hljs-number">0</span>)&#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;The number of threads cannot be determined.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;The system supports approximately &quot;</span> &lt;&lt; n &lt;&lt; <span class="hljs-string">&quot; threads.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨æˆ‘çš„ç”µè„‘ä¸Šè¿è¡Œå‡ºæ¥ç»“æœæ˜¯ <code>The system supports approximately 24 threads.</code>ï¼Œè¿™ä¸æˆ‘ç”µè„‘çš„ CPU æ ¸å¿ƒæ•°é‡ç›¸åŒï¼Œä¹Ÿè¡¨æ˜æˆ‘çš„ç”µè„‘æ˜¯ä¸æ”¯æŒè¶…çº¿ç¨‹æŠ€æœ¯çš„ã€‚</p><h2 id="2-çº¿ç¨‹è¯†åˆ«">2 çº¿ç¨‹è¯†åˆ«</h2><h3 id="2-1">2.1</h3><p>çº¿ç¨‹æ ‡è¯†ç¬¦ï¼ˆthread idï¼‰æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨äºåœ¨ç¨‹åºä¸­åŒºåˆ†ä¸åŒçš„çº¿ç¨‹ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„æ ‡è¯†ç¬¦ã€‚</p><h3 id="2-2-std-this-thread-get-id">2.2 std::this_thread::get_id()</h3><p>åœ¨ C++ å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œ<code>std::this_thread::get_id()</code> å¯ä»¥è·å–å½“å‰çº¿ç¨‹çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚</p><p><code>std::this_thread::get_id()</code> å‡½æ•°è¿”å›ä¸€ä¸ª <code>std::thread::id</code> ç±»å‹çš„å€¼ã€‚<code>std::thread::id</code> ç±»å‹æ˜¯ä¸€ä¸ªç±»ï¼Œç”¨äºè¡¨ç¤ºçº¿ç¨‹çš„æ ‡è¯†ç¬¦ã€‚</p><p>ä¸åŒçš„çº¿ç¨‹ä¼šè¿”å›ä¸åŒçš„ <code>std::thread::id</code> å€¼ã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹ç»“æŸåï¼Œå…¶ <code>std::thread::id</code> å¯èƒ½ä¼šè¢«ç³»ç»Ÿé‡æ–°åˆ†é…ç»™æ–°åˆ›å»ºçš„çº¿ç¨‹ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">std::vector&lt;std::thread&gt; <span class="hljs-title">pv</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : pv) t = std::<span class="hljs-built_in">thread</span>(foo);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span>&amp; t : pv)&#123;<br>        <span class="hljs-keyword">if</span>(t.<span class="hljs-built_in">joinable</span>())&#123;<br>            t.<span class="hljs-built_in">join</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/23/sxlh.png" alt=""></p><p>æ‰€æœ‰çº¿ç¨‹å¹¶å‘æ‰§è¡Œï¼Œä¸”çº¿ç¨‹ id å„ä¸ç›¸åŒã€‚</p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ol><li><a href="https://nj.gitbooks.io/c/content/content/chapter2/chapter2-chinese.html">C++ å¹¶å‘ç¼–ç¨‹å®æˆ˜ ç¬¬ 2 ç«  çº¿ç¨‹ç®¡ç†</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€std::thread scoped_thread å®ç°</title>
    <link href="/2024/12/22/20241222/"/>
    <url>/2024/12/22/20241222/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æºï¼š<a href="https://www.pixiv.net/artworks/104139863">pixiv_id=104139863</a></p><h2 id="scoped-thread-å®šä¹‰">scoped_thread å®šä¹‰</h2><p>scoped_thread æ˜¯ä¸€ç§èµ„æºç®¡ç†ç±»ï¼Œç”¨äºç¡®ä¿çº¿ç¨‹åœ¨é€‚å½“çš„æ—¶å€™è¢«æ­£ç¡®åœ°åŠ å…¥ï¼ˆjoinï¼‰æˆ–åˆ†ç¦»ï¼ˆdetachï¼‰ï¼Œæ›´å¥½åœ°ç®¡ç†çº¿ç¨‹èµ„æºã€‚scoped_thread åˆ©ç”¨äº† <strong>RAII</strong>ï¼ˆResource Acquisition Is Initializationï¼‰æœºåˆ¶ï¼Œä¹Ÿå¯ä»¥ç§°ä¸º <strong>èµ„æºè·å–å³åˆå§‹åŒ–</strong>ã€‚</p><h2 id="scoped-thread-å®ç°åŠä½œç”¨">scoped_thread å®ç°åŠä½œç”¨</h2><h3 id="std-thread-æˆå‘˜">std::thread æˆå‘˜</h3><p>é€šå¸¸æˆ‘ä»¬åœ¨ scoped_thread ç±»ä¸­å®šä¹‰ä¸€ä¸ªç§æœ‰ std::thread å¯¹è±¡æˆå‘˜å˜é‡ï¼Œç”¨äºå­˜å‚¨å®é™…çš„çº¿ç¨‹å¯¹è±¡ã€‚scoped_thread ç±»å¯ä»¥å¯¹è¿™ä¸ª std::thread çº¿ç¨‹è¿›è¡Œç®¡ç†ï¼Œæ§åˆ¶å…¶ç”Ÿå‘½å‘¨æœŸç­‰æ“ä½œã€‚</p><h3 id="æ„é€ å‡½æ•°çš„ç¼–å†™">æ„é€ å‡½æ•°çš„ç¼–å†™</h3><ul><li><p>explicit å…³é”®å­—</p><p>ä½¿ç”¨ explicit å…³é”®å­—ä¿®é¥°æ„é€ å‡½æ•°ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢éšå¼è½¬æ¢ã€‚è¿™æ„å‘³ç€è¯¥æ„é€ å‡½æ•°åªèƒ½é€šè¿‡æ˜¾å¼åœ°ä¼ å…¥ std::thread å¯¹è±¡æ¥è¿›è¡Œè°ƒç”¨ï¼Œè€Œä¸å¯ä»¥é€šè¿‡ä¸€äº›å…¶ä»–ç±»å‹éšå¼åœ°è½¬æ¢ä¸º std::thread å¯¹è±¡ä¼ å…¥æ„é€ å‡½æ•°ã€‚</p></li><li><p>std::move ç§»åŠ¨è¯­ä¹‰</p><p>å½“ scoped_thread å¯¹è±¡è¢«åˆ›å»ºæ—¶ï¼Œè·å–ä¸€ä¸ª std::thread çº¿ç¨‹å¯¹è±¡ <code>t_</code> ï¼Œå¹¶ä¸”é€šè¿‡ std::move ç§»åŠ¨è¯­ä¹‰å°†è¿™ä¸ª std::thread å¯¹è±¡çš„çº¿ç¨‹ <code>t_</code> å½’å±æƒè½¬ç§»åˆ° scoped_thread å¯¹è±¡çš„æˆå‘˜å˜é‡ <code>t</code> ä¸­ã€‚</p><p>é‡‡ç”¨ç§»åŠ¨è¯­ä¹‰ï¼Œä¹Ÿæ›´åŠ ç¬¦åˆçº¿ç¨‹çš„èµ„æºç®¡ç†æ–¹å¼ï¼Œç¬¦åˆçº¿ç¨‹å…·æœ‰ç‹¬å æ€§æ‰€æœ‰æƒçš„ç‰¹ç‚¹ï¼Œé«˜æ•ˆå®ç°çº¿ç¨‹å½’å±æƒçš„è½¬ç§»ï¼Œèƒ½å¤Ÿé¿å…ä¸å¿…è¦çš„æ‹·è´æ“ä½œã€‚</p></li><li><p>çº¿ç¨‹æ˜¯å¦æœ‰æ•ˆ</p><p>åœ¨æ„é€ å‡½æ•°ä½“ä¸­ï¼Œé€šè¿‡ <code>if(!t.joinable())&#123;...&#125;</code> è¯­å¥æ¥æ£€æŸ¥æ¥æ”¶åˆ°çš„çº¿ç¨‹å¯¹è±¡æ˜¯å¦å…³è”äº†å‡½æ•°ä¸”æœ‰æ•ˆï¼ˆjoinableï¼‰ã€‚</p><p>æœ‰å¯èƒ½ä¼ å…¥çš„ std::thread å¯¹è±¡æ˜¯ä¸€ä¸ªç©ºçº¿ç¨‹ï¼ˆæ²¡æœ‰å…³è”ä»»ä½•çº¿ç¨‹æ¥å£å‡½æ•°ï¼‰ï¼Œæˆ–è€…å·²ç» <code>join()</code> æˆ– <code>detach()</code> è¿‡äº†ã€‚å¦‚æœå‡ºç°è¿™äº›æƒ…å†µï¼Œéœ€è¦æŠ›å‡ºå¼‚å¸¸ã€‚</p></li></ul><h3 id="ææ„å‡½æ•°çš„ç¼–å†™">ææ„å‡½æ•°çš„ç¼–å†™</h3><p>åœ¨ææ„å‡½æ•°ä¸­ï¼Œé¦–å…ˆé€šè¿‡ <code>if(t.joinable())&#123;...&#125;</code> å†æ¬¡æ£€æŸ¥ std::thread æˆå‘˜å˜é‡ <code>t</code> æ‰€ä»£è¡¨çš„çº¿ç¨‹å¯¹è±¡æ˜¯å¦æ˜¯æœ‰æ•ˆå¯è¿æ¥çš„ã€‚å¦‚æœå·²ç» <code>join()</code> æˆ– <code>detach()</code> è¿‡äº†ï¼Œå°±ä¸éœ€è¦å†è¿›è¡Œåç»­çš„æ“ä½œäº†ã€‚</p><p>å¦‚æœçº¿ç¨‹ <code>t</code> ç¡®å®šæ˜¯ joinable çš„ï¼Œé‚£ä¹ˆè°ƒç”¨ <code>join()</code> å‡½æ•°ã€‚è¿™ä½¿å¾— scoped_thread å¯¹è±¡çš„çº¿ç¨‹ <code>t</code> åœ¨ä¸»çº¿ç¨‹ <code>main</code> æ‰§è¡Œç»“æŸæ—¶è°ƒç”¨ææ„å‡½æ•°ï¼Œè¿›è€Œè‡ªåŠ¨è°ƒç”¨ <code>join()</code>ï¼Œè®©ä¸»çº¿ç¨‹ç­‰å¾…  scoped_thread å¯¹è±¡çš„çº¿ç¨‹ <code>t</code>ï¼ˆä¹Ÿå³å­çº¿ç¨‹ï¼‰ç›´åˆ°å…¶æ‰§è¡Œå®Œæˆã€‚</p><p>é€šè¿‡åœ¨ææ„å‡½æ•°ä¸­æ‰§è¡Œ <code>join()</code> æ“ä½œï¼Œåˆ©ç”¨äº† <strong>RAII</strong> æœºåˆ¶ï¼Œä¿è¯äº†æ— è®ºåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ï¼Œçº¿ç¨‹éƒ½èƒ½è¢«æ­£ç¡®åœ°ç»“æŸï¼Œé¿å…äº†çº¿ç¨‹è¢«æ„å¤–ä¸­æ–­ç­‰ç»“æœã€‚</p><h3 id="ç¦ç”¨æ‹·è´ä¸æ‹·è´èµ‹å€¼">ç¦ç”¨æ‹·è´ä¸æ‹·è´èµ‹å€¼</h3><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œstd::thread æ˜¯ä¸å¯ä»¥æ‹·è´å’Œæ‹·è´èµ‹å€¼çš„ï¼Œå› æ­¤æˆ‘ä»¬å®šä¹‰çš„ scoped_thread ç±»ä¹Ÿéœ€è¦ç¦ç”¨æ‹·è´æ„é€ å‡½æ•°å’Œæ‹·è´èµ‹å€¼å‡½æ•°ï¼ˆå£°æ˜ä¸º <code>= delete</code>ï¼‰ï¼Œé¿å…å‡ºç°å¤šä¸ª scoped_thread å¯¹è±¡åŒæ—¶ç®¡ç†ä¸€ä¸ªçº¿ç¨‹çš„æ··ä¹±æƒ…å†µï¼ˆä¸€ä¸ª std::thread åŒä¸€æ—¶åˆ»åªèƒ½æ‹¥æœ‰ä¸€ä¸ªçº¿ç¨‹çš„å½’å±æƒï¼‰ã€‚</p><h2 id="scoped-thread-ç®€å•ä»£ç å®ç°">scoped_thread ç®€å•ä»£ç å®ç°</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">scoped_thread</span>&#123;<br>std::thread t;<br><span class="hljs-keyword">public</span>:<br><span class="hljs-comment">// æ„é€ å‡½æ•°ï¼Œé‡‡ç”¨ç§»åŠ¨è¯­ä¹‰ï¼ˆé˜²æ­¢éšå¼è½¬æ¢ï¼‰</span><br><span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-title">scoped_thread</span><span class="hljs-params">(std::thread t_)</span>: t(std::move(t_))&#123;</span><br><span class="hljs-keyword">if</span>(!t.<span class="hljs-built_in">joinable</span>())&#123; <span class="hljs-comment">// æ£€æŸ¥çº¿ç¨‹æ˜¯å¦æœ‰æ•ˆ</span><br><span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">logic_error</span>(<span class="hljs-string">&quot;thread is unjoinable.&quot;</span>);<br>&#125;<br>&#125;<br><span class="hljs-comment">// ææ„å‡½æ•°</span><br>~<span class="hljs-built_in">scoped_thread</span>()&#123;<br><span class="hljs-keyword">if</span>(t.<span class="hljs-built_in">joinable</span>())&#123;<br>t.<span class="hljs-built_in">join</span>();  <span class="hljs-comment">// ææ„æ—¶è‡ªåŠ¨ join</span><br>&#125;<br>&#125;<br><span class="hljs-comment">// ç¦ç”¨æ‹·è´æ„é€ å‡½æ•°</span><br><span class="hljs-built_in">scoped_thread</span>(scoped_thread <span class="hljs-type">const</span>&amp;) = <span class="hljs-keyword">delete</span>;<br><span class="hljs-comment">// ç¦ç”¨æ‹·è´èµ‹å€¼å‡½æ•°</span><br>scoped_thread&amp; <span class="hljs-keyword">operator</span>=(scoped_thread <span class="hljs-type">const</span>&amp;) = <span class="hljs-keyword">delete</span>;<br>&#125;;<br><br><span class="hljs-comment">// çº¿ç¨‹æ¥å£å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> cnt)</span></span>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= cnt; i ++ )&#123;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;Kirisame Marisa.&quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br><span class="hljs-function">scoped_thread <span class="hljs-title">st</span><span class="hljs-params">(std::thread(foo, <span class="hljs-number">10</span>))</span></span>;<br><br><span class="hljs-comment">// ä¸»çº¿ç¨‹ä¸­æ¨¡æ‹Ÿåšäº›å…¶ä»–äº‹æƒ…</span><br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">3</span>; i ++ )&#123;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;Alice Margatroid. &quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/22/483fe.png" alt=""></p><p>å¯ä»¥çœ‹å‡ºï¼Œscoped_thread å¯¹è±¡çš„å­çº¿ç¨‹æ­£å¸¸æ‰§è¡Œå®Œæ¯•ã€‚</p><p>å½“ä¸»çº¿ç¨‹ç»“æŸæ—¶ï¼Œæˆ‘ä»¬å®šä¹‰çš„ scoped_thread å¯¹è±¡ st ä¹Ÿè¶…å‡ºäº†ä½œç”¨åŸŸï¼Œæ­¤æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°ã€‚åœ¨æˆ‘ä»¬å®ç°çš„ scoped_thread ç±»çš„ææ„å‡½æ•°ä¸­ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œ <code>join()</code> æ“ä½œï¼Œç­‰å¾…å…³è”çš„çº¿ç¨‹ï¼ˆå…³è”å‡½æ•° <code>foo()</code>ï¼‰æ‰§è¡Œå®Œæˆï¼Œç¡®ä¿çº¿ç¨‹èµ„æºè¢«æ­£ç¡®å¤„ç†ã€‚ä¹‹å <code>main</code> å‡½æ•°æ‰ä¼šçœŸæ­£ç»“æŸï¼Œæ•´ä¸ªç¨‹åºæ­£å¸¸é€€å‡ºã€‚</p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ol><li><a href="https://nj.gitbooks.io/c/content/content/chapter2/chapter2-chinese.html">C++ å¹¶å‘ç¼–ç¨‹å®æˆ˜ ç¬¬ 2 ç«  çº¿ç¨‹ç®¡ç†</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€çº¿ç¨‹å½’å±æƒåŠå…¶è½¬ç§»</title>
    <link href="/2024/12/21/20241221/"/>
    <url>/2024/12/21/20241221/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æº: <a href="https://www.pixiv.net/artworks/77108212">pixiv_id=77108212</a></p><h2 id="çº¿ç¨‹å½’å±æƒ">çº¿ç¨‹å½’å±æƒ</h2><h3 id="åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</h3><p>åœ¨ C++ ä¸­ï¼Œçº¿ç¨‹å½’å±æƒæ˜¯æŒ‡å¯¹çº¿ç¨‹å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„æ§åˆ¶ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è¢«åˆ›å»ºåï¼Œéœ€è¦ç¡®ä¿å®ƒè¢«æ­£ç¡®åœ°ç®¡ç†ã€‚</p><p>å½“æˆ‘ä»¬ç”¨ std::thread ç±»åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ <code>t</code>ï¼Œé‚£ä¹ˆ <code>t</code> å¯¹è±¡å°±æ‹¥æœ‰å¯¹æ‰€åˆ›å»ºçš„æ–°çš„å­çº¿ç¨‹çš„å½’å±æƒã€‚åœ¨ä¹‹åæˆ‘ä»¬å¯ä»¥è°ƒç”¨ <code>join()</code> æ¥ç­‰å¾…å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼›ä¹Ÿå¯ä»¥è°ƒç”¨ <code>detach()</code> å°†ç°åœºåˆ†ç¦»ï¼Œåœ¨åå°ç‹¬ç«‹è¿è¡Œï¼Œæ­¤æ—¶ <code>t</code> å¯¹å­çº¿ç¨‹çš„å½’å±æƒè¢«è½¬ç§»ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;Kirisame Marisa&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br><span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo)</span></span>;<br>    t.<span class="hljs-built_in">join</span>();   <span class="hljs-comment">// ç­‰å¾…çº¿ç¨‹æ‰§è¡Œå®Œæ¯•</span><br>    <span class="hljs-comment">// t.detach(); // ä¸ç­‰å¾…ï¼Œæ”¾åˆ°åå°è¿è¡Œï¼Œtçš„çº¿ç¨‹å½’å±æƒè¢«è½¬ç§»</span><br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="çº¿ç¨‹å½’å±æƒçš„è½¬ç§»">çº¿ç¨‹å½’å±æƒçš„è½¬ç§»</h3><p>C++11 å¼•å…¥çš„ç§»åŠ¨è¯­ä¹‰åœ¨çº¿ç¨‹å½’å±æƒè½¬ç§»ä¸Šæœ‰ç€é‡è¦çš„ä½œç”¨ã€‚std::thread çº¿ç¨‹å¯¹è±¡æ˜¯å¯ç§»åŠ¨çš„ï¼Œä½†ä¸å¯æ‹·è´ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span> </span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Kirisame Marisa&quot;</span> &lt;&lt; std::endl;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">(foo)</span></span>;<br>    std::thread t2 = std::<span class="hljs-built_in">move</span>(t1);  <span class="hljs-comment">// t1çš„çº¿ç¨‹å½’å±æƒä»è½¬ç§»åˆ°t2</span><br>    <span class="hljs-comment">// t1 å˜æˆç©ºçº¿ç¨‹ï¼Œä¸å…³è”ä»»ä½•çº¿ç¨‹å‡½æ•°ï¼›t2 å…³è”çº¿ç¨‹å‡½æ•° foo</span><br>    <span class="hljs-comment">// t1 æ˜¯ unjoinable çš„</span><br>    t<span class="hljs-number">2.</span><span class="hljs-built_in">join</span>();<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>t2 = std::move(t1)</code> å°† <code>t1</code> æ‰€ä»£è¡¨çš„çº¿ç¨‹çš„å½’å±æƒè½¬ç§»åˆ°äº† <code>t2</code>ã€‚ç„¶åï¼Œ<code>t1</code> ä¸å†æ‹¥æœ‰çº¿ç¨‹çš„å½’å±æƒï¼Œè€Œ <code>t2</code> è´Ÿè´£ç®¡ç†çº¿ç¨‹çš„æ‰§è¡Œå’Œç”Ÿå‘½å‘¨æœŸï¼Œå…³è”çš„æ˜¯å‡½æ•° <code>foo()</code>ï¼Œä¹‹åæˆ‘ä»¬é€‰æ‹©è°ƒç”¨ <code>join()</code> ç­‰å¾…çº¿ç¨‹ <code>t2</code> æ‰§è¡Œå®Œæ¯•ã€‚</p><p>è¿è¡Œç»“æœå¦‚ä¸‹:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/21/4yof.png" alt=""></p><p>æ¥ä¸‹æ¥å†çœ‹ä¸€ä¸ªå¤æ‚ä¸€ç‚¹çš„ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo1</span><span class="hljs-params">()</span></span>&#123;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;Kirisame Marisa&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo2</span><span class="hljs-params">()</span></span>&#123;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;Alice Margatroid&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br><span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">(foo1)</span></span>;    <span class="hljs-comment">// t1 å…³è”çº¿ç¨‹å‡½æ•° foo1</span><br><span class="hljs-function">std::thread <span class="hljs-title">t2</span><span class="hljs-params">(std::move(t1))</span></span>; <span class="hljs-comment">// t1 çš„çº¿ç¨‹å½’å±æƒè½¬ç§»ç»™ t2ï¼Œt1 å˜æˆç©ºçº¿ç¨‹ï¼Œt2 å…³è” foo1</span><br>t1 = std::<span class="hljs-built_in">thread</span>(foo2);        <span class="hljs-comment">// t1 å…³è”çº¿ç¨‹å‡½æ•° foo2</span><br><br><span class="hljs-comment">// æ­¤æ—¶ä¸¤ä¸ªçº¿ç¨‹éƒ½æ˜¯ joinable çš„</span><br>std::cout &lt;&lt; <span class="hljs-string">&quot;t1 is joinable: &quot;</span> &lt;&lt; t<span class="hljs-number">1.</span><span class="hljs-built_in">joinable</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;t2 is joinable: &quot;</span> &lt;&lt; t<span class="hljs-number">2.</span><span class="hljs-built_in">joinable</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>std::thread t3;<br>t3 = std::<span class="hljs-built_in">move</span>(t2);   <span class="hljs-comment">// t2 çš„çº¿ç¨‹å½’å±æƒè½¬ç§»ç»™ t3ï¼Œt2 å˜æˆç©ºçº¿ç¨‹ï¼Œt3 å…³è” foo1</span><br><span class="hljs-comment">// t1 = std::move(t3);  // ERROR</span><br><span class="hljs-comment">// t1 æ‹¥æœ‰ä¸€ä¸ªçº¿ç¨‹çš„å½’å±æƒï¼ˆå…³è” foo2ï¼‰ä¸”è¿˜æœªæ‰§è¡Œç»“æŸï¼ˆè¿˜æœª join æˆ– detachï¼‰</span><br><span class="hljs-comment">// ä¸€ä¸ª std::thread åŒä¸€æ—¶é—´åªèƒ½æ‹¥æœ‰ä¸€ä¸ªçº¿ç¨‹çš„å½’å±æƒ</span><br><br><span class="hljs-comment">// t2 æ²¡æœ‰å…³è”ä»»ä½•å‡½æ•°ï¼Œæ˜¯ unjoinable çš„</span><br>t<span class="hljs-number">1.</span><span class="hljs-built_in">join</span>();<br>t<span class="hljs-number">3.</span><span class="hljs-built_in">join</span>();<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ª std::thread å¯¹è±¡ <code>t1</code>ï¼Œå¹¶å°†å‡½æ•° <code>foo1</code> ä½œä¸ºçº¿ç¨‹æ¥å£å‡½æ•°ã€‚ç„¶åé€šè¿‡ <code>std::thread t2(std::move(t1))</code> å°† <code>t1</code> æ‰€æ‹¥æœ‰çš„çº¿ç¨‹å½’å±æƒè½¬ç§»ç»™äº† <code>t2</code>ã€‚æ­¤æ—¶ï¼Œ<code>t1</code> å˜æˆç©ºçº¿ç¨‹ï¼Œ<code>t2</code> å…³è” <code>foo1</code>ã€‚</p><p>ä¹‹åï¼Œé€šè¿‡ <code>t1 = std::thread(foo2)</code> ä½¿å¾— <code>t1</code> é‡æ–°å…³è”äº†å¦ä¸€ä¸ªå‡½æ•° <code>foo2</code>ã€‚</p><p>é€šè¿‡ <code>t3 = std::move(t2)</code> å°† <code>t2</code> çš„çº¿ç¨‹å½’å±æƒè½¬ç§»ç»™ <code>t3</code>ã€‚æ­¤æ—¶ <code>t2</code> å˜æˆç©ºçº¿ç¨‹ï¼Œ<code>t3</code> å…³è”å‡½æ•° <code>foo1</code>ã€‚</p><p>åœ¨æ³¨é‡Šçš„ä»£ç ä¸­çš„ <code>t1 = std::move(t3);</code> æ“ä½œæ˜¯ä¸å¯è¡Œçš„ã€‚<code>t1</code> æ‹¥æœ‰ä¸€ä¸ªçº¿ç¨‹çš„å½’å±æƒï¼ˆå…³è”ç€ <code>foo2</code> å¯¹åº”çš„çº¿ç¨‹ï¼‰ä¸”è¿˜æœªæ‰§è¡Œç»“æŸï¼ˆè¿˜æœª <code>join</code> æˆ– <code>detach</code>ï¼‰ã€‚</p><p>ä¸€ä¸ª std::thread å¯¹è±¡åŒä¸€æ—¶é—´åªèƒ½æ‹¥æœ‰ä¸€ä¸ªçº¿ç¨‹çš„å½’å±æƒã€‚</p><p>è¿è¡Œç»“æœå¦‚ä¸‹:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/21/iqph.png" alt=""></p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ol><li><a href="https://nj.gitbooks.io/c/content/content/chapter2/chapter2-chinese.html">C++ å¹¶å‘ç¼–ç¨‹å®æˆ˜ ç¬¬2ç«  çº¿ç¨‹ç®¡ç†</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€std::thread çº¿ç¨‹åˆ›å»ºæ–¹æ³•</title>
    <link href="/2024/12/20/20241220/"/>
    <url>/2024/12/20/20241220/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æºï¼š<a href="https://www.pixiv.net/artworks/105375867">pixiv_id=105375867</a></p><h2 id="1-æ™®é€šå‡½æ•°è°ƒç”¨åˆ›å»ºçº¿ç¨‹">1 æ™®é€šå‡½æ•°è°ƒç”¨åˆ›å»ºçº¿ç¨‹</h2><h3 id="1-1-åŸºæœ¬æ–¹å¼">1.1 åŸºæœ¬æ–¹å¼</h3><p>å®šä¹‰ä¸€ä¸ªå‡½æ•°ä½œä¸ºçº¿ç¨‹æ¥å£å‡½æ•°ï¼Œä¾‹å¦‚ <code>foo()</code>ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>std::thread t(foo)</code> æ¥åˆ›å»ºçº¿ç¨‹ <code>t</code>ã€‚çº¿ç¨‹ <code>t</code> å°†æ‰§è¡Œ <code>foo()</code> å‡½æ•°ï¼Œä¸ä¸»çº¿ç¨‹å¹¶å‘æ‰§è¡Œã€‚</p><p>çº¿ç¨‹æ„é€ å‡½æ•° <code>std::thread</code> éœ€è¦ä¼ å…¥çš„æ˜¯ <strong>å‡½æ•°æŒ‡é’ˆ</strong>ï¼Œå…¶æŒ‡å‘çš„æ˜¯å‡½æ•°æ‰€åœ¨çš„åœ°å€ã€‚æˆ‘ä»¬åªéœ€è¦ä¼ å…¥å®šä¹‰çš„å‡½æ•°çš„åç§° <code>foo</code> å³å¯ã€‚</p><p>å¦‚æœå‡½æ•°å¸¦æœ‰å‚æ•°ï¼Œæ¯”å¦‚å®šä¹‰çš„å‡½æ•°ä¸º <code>void foo(int a, std::string s)</code> ä¹‹ç±»çš„ï¼Œé‚£ä¹ˆåœ¨ä¼ å…¥çš„å‡½æ•°æŒ‡é’ˆå‚æ•°åé¢ä¾æ¬¡è·Ÿä¸Šå¯¹åº”çš„å‡½æ•°å‚æ•°å³å¯ã€‚å‡å¦‚æˆ‘ä»¬æœ‰å®šä¹‰å¥½çš„ <code>int</code> ç±»å‹å˜é‡ <code>num</code> å’Œ <code>std::string</code> ç±»å‹å˜é‡ <code>str</code>ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼æ¥åˆ›å»ºçº¿ç¨‹:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo, num, str)</span></span>;<br></code></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨ä¸´æ—¶å˜é‡ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ç§æ–¹å¼:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo, <span class="hljs-number">1</span>, <span class="hljs-string">&quot;abc&quot;</span>)</span></span>;<br></code></pre></td></tr></table></figure><h3 id="1-2-ç¤ºä¾‹">1.2 ç¤ºä¾‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> a, std::string s)</span></span>&#123;<br>    std::cout &lt;&lt; a &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; s &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> num = <span class="hljs-number">520</span>;<br>    std::string str = <span class="hljs-string">&quot;Marisa&quot;</span>;<br><br>    <span class="hljs-comment">// ä¼ å…¥å‡½æ•°æŒ‡é’ˆ fooï¼Œä»¥åŠå‡½æ•°å‚æ•°</span><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo, num, str)</span></span>;   <br>    t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-comment">// ä¹Ÿå¯ä»¥æ˜¯ä¸´æ—¶å˜é‡</span><br>    <span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">(foo, <span class="hljs-number">521</span>, <span class="hljs-string">&quot;Alice&quot;</span>)</span></span>;<br>    t<span class="hljs-number">1.</span><span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/20/6ootf.png" alt=""></p><h2 id="2-lambda-è¡¨è¾¾å¼åˆ›å»ºçº¿ç¨‹">2 lambda è¡¨è¾¾å¼åˆ›å»ºçº¿ç¨‹</h2><h3 id="2-1-åŸºæœ¬æ–¹å¼">2.1 åŸºæœ¬æ–¹å¼</h3><p>lambda è¡¨è¾¾å¼æ˜¯ C++ 11 å¼•å…¥çš„ä¸€ä¸ªå¼ºå¤§çš„ç‰¹æ€§ï¼Œä¹Ÿå³åŒ¿åå‡½æ•°ã€‚lambda è¡¨è¾¾å¼çš„åŸºæœ¬å½¢å¼ä¸º <code>[](int a, int b, ...) &#123;... &#125;</code>ï¼Œ<code>[]</code> éƒ¨åˆ†è¡¨ç¤ºæ•è·åˆ—è¡¨ï¼ˆæ­¤å¤„æ•è·åˆ—è¡¨ä¸ºç©ºï¼Œå¦‚æœè¦ç›´æ¥ä½¿ç”¨ä½œç”¨åŸŸå†…å˜é‡å¯ä»¥ä½¿ç”¨æŒ‰å¼•ç”¨æ•è·åŠ ä¸Š <code>&amp;</code> ç­‰ï¼‰ï¼Œ<code>(int a, int b, ...)</code> éƒ¨åˆ†è¡¨ç¤ºå‚æ•°åˆ—è¡¨ã€‚</p><p>å‡å¦‚å®šä¹‰ lambda è¡¨è¾¾å¼å¦‚ä¸‹:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c++">[](<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)&#123;<br>    std::cout &lt;&lt; a &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; b &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹æ–¹å¼å¯ä»¥ä½¿ç”¨ lambda è¡¨è¾¾å¼åˆ›å»ºçº¿ç¨‹:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">([](<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)&#123;</span></span><br><span class="hljs-params"><span class="hljs-function">    std::cout &lt;&lt; a &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; b &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;</span></span><br><span class="hljs-params"><span class="hljs-function">&#125;, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>)</span></span>;   <span class="hljs-comment">// åé¢åŠ ä¸Šä¼ é€’çš„å‚æ•°</span><br></code></pre></td></tr></table></figure><p>æˆ–è€…åœ¨åˆ«å¤„å®šä¹‰ä¸€ä¸ª lambda è¡¨è¾¾å¼ <code>foo</code>ï¼Œåˆ›å»ºçº¿ç¨‹å†è°ƒç”¨è¯¥ lambda è¡¨è¾¾å¼:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">auto</span> foo = [](<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)&#123;<br>    std::cout &lt;&lt; a &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; b &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;;<br><br><span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>)</span></span>;   <span class="hljs-comment">// åé¢åŠ ä¸Šä¼ é€’çš„å‚æ•°</span><br></code></pre></td></tr></table></figure><h3 id="2-2-ç¤ºä¾‹">2.2 ç¤ºä¾‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br><span class="hljs-comment">// (1)</span><br><span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">([](<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)&#123;</span></span><br><span class="hljs-params"><span class="hljs-function">std::cout &lt;&lt; <span class="hljs-string">&quot;Marisa &quot;</span> &lt;&lt; a &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;</span></span><br><span class="hljs-params"><span class="hljs-function">std::cout &lt;&lt; <span class="hljs-string">&quot;Alice &quot;</span> &lt;&lt; b &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;</span></span><br><span class="hljs-params"><span class="hljs-function">&#125;, <span class="hljs-number">1314</span>, <span class="hljs-number">520</span>)</span></span>;<br>t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-comment">// (2)</span><br><span class="hljs-keyword">auto</span> foo = [](<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)&#123;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;Marisa &quot;</span> &lt;&lt; a &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;Alice &quot;</span> &lt;&lt; b &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;;<br><br><span class="hljs-function">std::thread <span class="hljs-title">t2</span><span class="hljs-params">(foo, <span class="hljs-number">520</span>, <span class="hljs-number">1314</span>)</span></span>;<br>t<span class="hljs-number">2.</span><span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/20/ikal.png" alt=""></p><h2 id="3-ä»¿å‡½æ•°ï¼ˆå‡½æ•°å¯¹è±¡ï¼‰åˆ›å»ºçº¿ç¨‹">3 ä»¿å‡½æ•°ï¼ˆå‡½æ•°å¯¹è±¡ï¼‰åˆ›å»ºçº¿ç¨‹</h2><h3 id="3-1-åŸºæœ¬æ–¹å¼">3.1 åŸºæœ¬æ–¹å¼</h3><p>å®šä¹‰ä¸€ä¸ªç±» MyClassï¼ˆæˆ–è€…ç»“æ„ä½“ï¼‰ï¼Œåœ¨ç±» MyClass ä¸­é‡è½½ <code>()</code> è¿ç®—ç¬¦ï¼Œä½¿å¾—ç±»çš„å¯¹è±¡å¯ä»¥åƒå‡½æ•°ä¸€æ ·è¢«è°ƒç”¨ï¼Œå³ <strong>ä»¿å‡½æ•°</strong>ã€‚</p><p>åœ¨ä¸»å‡½æ•°ä¸­ï¼Œåˆ›å»ºä¸€ä¸ª MyClass ç±»çš„å¯¹è±¡ objï¼Œæˆ‘ä»¬å¯ä»¥å°†ç±»å¯¹è±¡ obj ä½œä¸ºçº¿ç¨‹æ¥å£å‡½æ•°ï¼Œä»¥ <code>std::thread t(obj)</code> çš„å½¢å¼åˆ›å»ºçº¿ç¨‹ã€‚å¦‚æœé‡è½½è¿ç®—ç¬¦å‡½æ•°æœ‰å‚æ•°ï¼ŒåŠ ä¸Šåé¢å†åŠ ä¸Šä¼ é€’çš„å‚æ•°å³å¯ã€‚</p><h3 id="3-2-ç¤ºä¾‹">3.2 ç¤ºä¾‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>&#123;<br><span class="hljs-type">int</span> val;<br><span class="hljs-keyword">public</span>:<br><span class="hljs-built_in">MyClass</span>(<span class="hljs-type">int</span> n): <span class="hljs-built_in">val</span>(n) &#123;&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">operator</span><span class="hljs-params">()</span> <span class="hljs-params">(<span class="hljs-type">int</span> a)</span> </span>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= val; i ++ )&#123;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;Alice Margatroid &quot;</span> &lt;&lt; a &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br>&#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123; <br><span class="hljs-function">MyClass <span class="hljs-title">obj</span><span class="hljs-params">(<span class="hljs-number">5</span>)</span></span>;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(obj, <span class="hljs-number">520</span>)</span></span>;<br>t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://sukicdn.com/wyx/i/2024/12/20/3j4h.png" alt=""></p><h2 id="4-ç±»æˆå‘˜å‡½æ•°åˆ›å»ºçº¿ç¨‹">4 ç±»æˆå‘˜å‡½æ•°åˆ›å»ºçº¿ç¨‹</h2><h3 id="4-1-åŸºæœ¬æ–¹å¼">4.1 åŸºæœ¬æ–¹å¼</h3><p>å®šä¹‰ä¸€ä¸ªç±» MyClassï¼ŒåŒ…å«ä¸€ä¸ªæˆå‘˜å‡½æ•° <code>foo()</code>ã€‚åœ¨åˆ›å»ºçº¿ç¨‹æ—¶ï¼Œéœ€è¦ä¼ é€’ç±»æˆå‘˜å‡½æ•°æŒ‡é’ˆã€ç±»å¯¹è±¡ï¼ˆä¸€èˆ¬ä¼šä½¿ç”¨å¯¹è±¡çš„å¼•ç”¨ï¼‰ä»¥åŠç±»æˆå‘˜å‡½æ•°æ‰€éœ€å‚æ•°ä½œä¸ºå‚æ•°ã€‚</p><p>å‡å¦‚åˆ›å»ºäº†ä¸€ä¸ª MyClass ç±»å¯¹è±¡ <code>obj</code>ï¼Œç±»ä¸­æœ‰ä¸€ä¸ªæˆå‘˜å‡½æ•°ä¸º <code>void foo(int a)</code>ï¼Œé‚£ä¹ˆç”¨å¦‚ä¸‹å½¢å¼åˆ›å»ºçº¿ç¨‹:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(&amp;MyClass::foo, &amp;obj, <span class="hljs-number">5</span>)</span></span>;<br></code></pre></td></tr></table></figure><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é‡‡ç”¨åŠ ä¸Šå¼•ç”¨æ“ä½œç¬¦ &amp; ä¼ é€’å¯¹è±¡çš„å¼•ç”¨ï¼Œè¿™æ ·å¯ä»¥é¿å…å¯¹è±¡çš„æ‹·è´ï¼ˆè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼‰ï¼Œä»¥æå‡æ•ˆç‡ã€‚ä¹Ÿå¯ä»¥é‡‡ç”¨åŠ ä¸Š <code>std::ref</code> è¾¾åˆ°å‡ ä¹åŒæ ·çš„æ•ˆæœ</p><p><code>&amp;obj</code> æœ¬è´¨ä¸Šå°±æ˜¯è·å– obj çš„åœ°å€ã€‚C++ è¯­æ³•è§„åˆ™è§„å®šå¯ä»¥åœ¨ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°åˆ›å»ºçº¿ç¨‹æ—¶ï¼Œç›´æ¥ <strong>åŠ ä¸Š &amp; æ¥ä¼ é€’æˆå‘˜å‡½æ•°æŒ‡é’ˆä»¥åŠå¯¹è±¡çš„å¼•ç”¨</strong>ã€‚è¿™å’Œçº¿ç¨‹æ¥å£å‡½æ•°ä¼ é€’å¼•ç”¨æ˜¯ä¸ä¸€æ ·çš„ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ï¼Œçº¿ç¨‹æ¥å£å‡½æ•°ä¼ é€’æ™®é€šå˜é‡çš„å¼•ç”¨å¿…é¡»ç”¨ <code>std::ref</code>ï¼‰ã€‚</p><h3 id="4-2-ç¤ºä¾‹">4.2 ç¤ºä¾‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span>&#123;<br><span class="hljs-type">int</span> val;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// æ„é€ å‡½æ•°</span><br><span class="hljs-built_in">MyClass</span>(<span class="hljs-type">int</span> n): <span class="hljs-built_in">val</span>(n)&#123;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;build function thread id: &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br>    <span class="hljs-comment">// æ‹·è´æ„é€ å‡½æ•°</span><br><span class="hljs-built_in">MyClass</span>(<span class="hljs-type">const</span> MyClass&amp; other)&#123;<br>val = other.val;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;copy build function thread id: &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br>    <span class="hljs-comment">// ææ„å‡½æ•°</span><br>~<span class="hljs-built_in">MyClass</span>()&#123;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;~function thread id: &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> a)</span></span>&#123; <br>std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): thread starts, thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= val; i ++ )&#123;<br>            std::cout &lt;&lt; <span class="hljs-string">&quot;Marisa &quot;</span> &lt;&lt; a &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        &#125;<br>&#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">MyClass <span class="hljs-title">obj</span><span class="hljs-params">(<span class="hljs-number">5</span>)</span></span>;<br>    <span class="hljs-comment">// ä¼ é€’ç±»æˆå‘˜å‡½æ•°å’Œå¯¹è±¡çš„å¼•ç”¨</span><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(&amp;MyClass::foo, &amp;obj, <span class="hljs-number">520</span>)</span></span>; <br>    t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/20/vxl8.png" alt=""></p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p><a href="https://en.cppreference.com/w/cpp/thread/thread">std::thread cppreference</a></p>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€std::thread çº¿ç¨‹å‡½æ•°å‚æ•°ä¼ é€’</title>
    <link href="/2024/12/19/20241219/"/>
    <url>/2024/12/19/20241219/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æº: <a href="https://www.pixiv.net/artworks/122153784">pixiv_id=122153784</a></p><h2 id="1-å‚æ•°ä¼ é€’åŸºæœ¬å½¢å¼">1 å‚æ•°ä¼ é€’åŸºæœ¬å½¢å¼</h2><p>åœ¨ C++ å¤šçº¿ç¨‹ä¸­åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ‘ä»¬éœ€è¦è®© std::thread æ„é€ å‡½æ•°æ¥æ”¶ä¸€ä¸ªçº¿ç¨‹æ¥å£å‡½æ•°çš„ <strong>å‡½æ•°æŒ‡é’ˆ</strong> ä»¥åŠè¯¥çº¿ç¨‹æ¥å£å‡½æ•°éœ€è¦çš„å¤šä¸ªå‚æ•°ã€‚å¤§è‡´å½¢å¼å¦‚ä¸‹:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// ä¼ªä»£ç ã€‚ç¬¬ä¸€ä¸ªå‚æ•° foo å³å‡½æ•°æŒ‡é’ˆï¼Œåé¢çš„a,b,...å‚æ•°ä¾æ¬¡ä¸ºçº¿ç¨‹æ¥å£å‡½æ•°æ‰€éœ€å‚æ•°</span><br><span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo, a, b, ...)</span></span>; <br></code></pre></td></tr></table></figure><h2 id="2-æŒ‰å€¼ä¼ é€’å‚æ•°">2 æŒ‰å€¼ä¼ é€’å‚æ•°</h2><h3 id="2-1-åŸºæœ¬åŸç†">2.1 åŸºæœ¬åŸç†</h3><p>ä½¿ç”¨æŒ‰å€¼ä¼ é€’å‚æ•°ä¼ é€’ç»™çº¿ç¨‹æ¥å£å‡½æ•°æ—¶ï¼Œçº¿ç¨‹æ¥å£å‡½æ•°æ”¶åˆ°çš„æ˜¯ <strong>æ‹·è´çš„å‚æ•°çš„å‰¯æœ¬</strong>ã€‚</p><p>æŒ‰å€¼ä¼ é€’çš„æ–¹å¼éå¸¸ç®€å•ç›´è§‚ï¼Œè€Œä¸”è¿™ç§å‚æ•°ä¼ é€’æ–¹å¼çš„å®‰å…¨æ€§æ˜¯æ¯”è¾ƒé«˜çš„ï¼Œçº¿ç¨‹å‡½æ•°å†…éƒ¨å¯¹å‚æ•°çš„æ“ä½œä¸ä¼šå½±å“åŸå§‹æ•°æ®ã€‚</p><p>ä½†å¯¹äºå¤§å‹çš„æ•°æ®ç»“æ„ï¼Œæ‹·è´çš„æ“ä½œå¾€å¾€ä¼šæ¶ˆè€—è¾ƒå¤šçš„æ—¶é—´å’Œç©ºé—´ã€‚</p><h3 id="2-2-ç¤ºä¾‹">2.2 ç¤ºä¾‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-comment">// çº¿ç¨‹æ¥å£å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> a, std::string s)</span></span>&#123; <br>    std::cout &lt;&lt; a &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; s &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> num = <span class="hljs-number">520</span>;<br>    std::string str = <span class="hljs-string">&quot;Marisa&quot;</span>;<br><br>    <span class="hljs-comment">// æŒ‰å€¼ä¼ é€’å‚æ•°</span><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo, num, str)</span></span>; <br>    t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://sukicdn.com/wyx/i/2024/12/19/t6l7.png" alt=""></p><h2 id="3-æŒ‰å¼•ç”¨ä¼ é€’å‚æ•°ï¼ˆstd-refï¼‰">3 æŒ‰å¼•ç”¨ä¼ é€’å‚æ•°ï¼ˆstd::refï¼‰</h2><h3 id="3-1-åŸºæœ¬åŸç†">3.1 åŸºæœ¬åŸç†</h3><p>åœ¨ C++ å¤šçº¿ç¨‹ä¸­ï¼Œstd::thread æ„é€ å‡½æ•°åœ¨ä¼ é€’å‚æ•°æ—¶ <strong>é»˜è®¤æ˜¯æŒ‰å€¼ä¼ é€’çš„</strong>ã€‚è¿™æ ·è®¾å®šçš„åŸå› æ˜¯ä¸ºäº†é¿å…ä¸€äº›æ½œåœ¨çš„é—®é¢˜ï¼Œæ¯”å¦‚çº¿ç¨‹å‡½æ•°æ„å¤–åœ°ä¿®æ”¹å¤–éƒ¨å˜é‡å¯¼è‡´éš¾ä»¥è¿½è¸ªçš„é”™è¯¯ï¼Œä»¥åŠæ•°æ®ç«äº‰ç­‰é—®é¢˜ã€‚</p><p>å› æ­¤ï¼Œåœ¨ C++ å¤šçº¿ç¨‹ä¸­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨çº¿ç¨‹å‡½æ•°å†…éƒ¨å»ä¿®æ”¹åŸå§‹å˜é‡çš„å€¼ï¼Œ<strong>ä¼ ç»Ÿçš„ä¼ é€’å¼•ç”¨æ–¹å¼æ˜¯ä¸å¥æ•ˆçš„</strong>ã€‚æ•…åœ¨çº¿ç¨‹å‡½æ•°ä¸­æ“ä½œåŸå§‹å˜é‡ï¼ˆé€šè¿‡å¼•ç”¨ï¼‰æ—¶ï¼Œå°± <strong>éœ€è¦ä½¿ç”¨</strong> <a href="https://en.cppreference.com/w/cpp/utility/functional/ref">std::ref</a></p><p>ä½¿ç”¨ std::ref ä¹‹åï¼Œæˆ‘ä»¬ç¡®å®èƒ½å¤Ÿå¯¹åŸå±æ•°æ®è¿›è¡Œä¿®æ”¹ç­‰æ“ä½œï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿæ”¹å˜äº† C++ å¤šçº¿ç¨‹é»˜è®¤çš„å‡½æ•°ä¼ é€’å‚æ•°æœºåˆ¶ã€‚å¾ˆå¤šæ—¶å€™ï¼Œå¤šä¸ªçº¿ç¨‹ï¼ˆåŒ…æ‹¬ä¸»çº¿ç¨‹å’Œå­çº¿ç¨‹ï¼‰å¯èƒ½åŒæ—¶è®¿é—®å’Œä¿®æ”¹åŒä¸€ä¸ªå˜é‡æˆ–å¯¹è±¡ï¼Œè¿™æ ·çš„ä¼ é€’æ–¹å¼ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†æ•°æ®ç«äº‰çš„é£é™©ã€‚</p><h3 id="3-2-ç¤ºä¾‹">3.2 ç¤ºä¾‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-comment">// çº¿ç¨‹æ¥å£å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span>&amp; a, std::string&amp; s)</span></span>&#123; <br>    a ++ ;<br>    s += <span class="hljs-string">&quot;Magic&quot;</span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): &quot;</span> &lt;&lt; a &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; s &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> num = <span class="hljs-number">520</span>;<br>    std::string str = <span class="hljs-string">&quot;Marisa&quot;</span>;<br><br>    <span class="hljs-comment">// æŒ‰å¼•ç”¨ä¼ é€’å‚æ•°</span><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo, std::ref(num), std::ref(str))</span></span>; <br>    t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-comment">// æˆåŠŸä¿®æ”¹äº†åŸå§‹æ•°æ®</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): &quot;</span> &lt;&lt; num &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; str &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://sukicdn.com/wyx/i/2024/12/19/5svex.png" alt=""></p><h2 id="4-ä¼ é€’æŒ‡é’ˆä½œä¸ºå‚æ•°">4 ä¼ é€’æŒ‡é’ˆä½œä¸ºå‚æ•°</h2><h3 id="4-1-åŸºæœ¬åŸç†">4.1 åŸºæœ¬åŸç†</h3><p>åœ¨ C++ å¤šçº¿ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å‘æ•°æ®çš„æŒ‡é’ˆä¼ é€’ç»™çº¿ç¨‹å‡½æ•°ã€‚åœ¨çº¿ç¨‹å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‡é’ˆæ¥è®¿é—®å’Œä¿®æ”¹æ•°æ®ï¼ˆæœ‰ç‚¹ç±»ä¼¼äºæŒ‰å¼•ç”¨ä¼ é€’ï¼‰ã€‚</p><p>ä¸æŒ‰å¼•ç”¨ä¼ é€’åŒæ ·çš„ï¼Œè¿™ä¹Ÿå­˜åœ¨ç€ä¸€å®šçš„æ•°æ®ç«äº‰é£é™©ã€‚</p><h3 id="4-2-æ™®é€šæŒ‡é’ˆç¤ºä¾‹">4.2 æ™®é€šæŒ‡é’ˆç¤ºä¾‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-comment">// çº¿ç¨‹æ¥å£å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span>* p)</span></span>&#123; <br>    *p += <span class="hljs-number">1</span>; <span class="hljs-comment">// æ³¨æ„ *p ++ æ˜¯å…ˆ p ++ å†å–å€¼ã€‚*p += 1 æ˜¯å…ˆå–å€¼å† += 1</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): &quot;</span> &lt;&lt; *p &lt;&lt; <span class="hljs-string">&quot; Marisa&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> num = <span class="hljs-number">520</span>;<br><br>    <span class="hljs-comment">// ä¼ é€’æŒ‡é’ˆä½œä¸ºå‚æ•°</span><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo, &amp;num)</span></span>; <br>    t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-comment">// æˆåŠŸä¿®æ”¹äº†åŸå§‹æ•°æ®</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): &quot;</span> &lt;&lt; num &lt;&lt; <span class="hljs-string">&quot; Marisa&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://sukicdn.com/wyx/i/2024/12/19/15pz9r.png" alt=""></p><h3 id="4-3-æ™ºèƒ½æŒ‡é’ˆç¤ºä¾‹">4.3 æ™ºèƒ½æŒ‡é’ˆç¤ºä¾‹</h3><h4 id="4-3-1-std-shared-ptr">4.3.1 std::shared_ptr</h4><p><a href="https://en.cppreference.com/w/cpp/memory/shared_ptr">std::shared_ptr</a> æ˜¯ä¸€ç§ <strong>å¼•ç”¨è®¡æ•°çš„æ™ºèƒ½æŒ‡é’ˆ</strong>ã€‚å½“ä¼ é€’ std::shared_ptr ç»™çº¿ç¨‹å‡½æ•°æ—¶ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«åŒä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰æƒã€‚è¿™æ ·çš„æœºåˆ¶èƒ½å¤Ÿç¡®ä¿å¯¹è±¡åœ¨æ‰€æœ‰å¼•ç”¨ï¼ˆåŒ…æ‹¬çº¿ç¨‹ä¸­çš„å¼•ç”¨ï¼‰éƒ½é‡Šæ”¾åæ‰è¢«é”€æ¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(std::shared_ptr&lt;<span class="hljs-type">int</span>&gt; p)</span> </span>&#123;<br>    *p += <span class="hljs-number">1</span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): &quot;</span> &lt;&lt; *p &lt;&lt; <span class="hljs-string">&quot; Marisa&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// shared_ptr æ™ºèƒ½æŒ‡é’ˆ</span><br>    std::shared_ptr&lt;<span class="hljs-type">int</span>&gt; ptr = std::<span class="hljs-built_in">make_shared</span>&lt;<span class="hljs-type">int</span>&gt;(<span class="hljs-number">520</span>);<br><br>    <span class="hljs-comment">// ä¼ é€’ shared_ptr æ™ºèƒ½æŒ‡é’ˆ</span><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo, ptr)</span></span>;<br>    t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-comment">// æˆåŠŸä¿®æ”¹äº†åŸå§‹æ•°æ®</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): &quot;</span> &lt;&lt; *ptr &lt;&lt; <span class="hljs-string">&quot; Marisa&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://sukicdn.com/wyx/i/2024/12/19/4fyg.png" alt=""></p><h4 id="4-3-2-std-unique-ptr">4.3.2 std::unique_ptr</h4><p><a href="https://en.cppreference.com/w/cpp/memory/unique_ptr">std::unique_ptr</a> æ˜¯ä¸€ç§ç‹¬å å¼çš„æ™ºèƒ½æŒ‡é’ˆã€‚å®ƒå¼ºè°ƒå¯¹è±¡çš„æ‰€æœ‰æƒæ˜¯å”¯ä¸€çš„ï¼Œä¸èƒ½è¢«å¤åˆ¶ã€‚åªèƒ½è°ƒç”¨ç§»åŠ¨è¯­ä¹‰ï¼Œå³ <a href="https://en.cppreference.com/w/cpp/utility/move">std::move</a></p><p>æ³¨æ„åœ¨è°ƒç”¨äº† std::move ä¹‹åï¼Œä¸»çº¿ç¨‹ä¸­çš„æ™ºèƒ½æŒ‡é’ˆ ptr å°±å¤±å»äº†æ‰€æœ‰æƒï¼Œæ‰€ä»¥ä¸èƒ½å†åœ¨ä¸»å‡½æ•°ä¸­è®¿é—®æ•°æ®äº†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(std::unique_ptr&lt;<span class="hljs-type">int</span>&gt; p)</span> </span>&#123;<br>    *p += <span class="hljs-number">1</span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): &quot;</span> &lt;&lt; *p &lt;&lt; <span class="hljs-string">&quot; Marisa&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// unique_ptr æ™ºèƒ½æŒ‡é’ˆ</span><br>    std::unique_ptr&lt;<span class="hljs-type">int</span>&gt; ptr = std::<span class="hljs-built_in">make_unique</span>&lt;<span class="hljs-type">int</span>&gt;(<span class="hljs-number">520</span>);<br><br>    <span class="hljs-comment">// ä¼ é€’ unique_ptr æ™ºèƒ½æŒ‡é’ˆ</span><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo, std::move(ptr))</span></span>;<br>    t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-comment">// è°ƒç”¨ std::move åï¼Œptr å¤±å»äº†æ‰€æœ‰æƒï¼Œå› æ­¤ä¸èƒ½å†è®¿é—®</span><br>    <span class="hljs-comment">// std::cout &lt;&lt; &quot;main(): &quot; &lt;&lt; *ptr &lt;&lt; &quot; Marisa&quot; &lt;&lt; &quot;\n&quot;;</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://sukicdn.com/wyx/i/2024/12/19/n60.png" alt=""></p><h3 id="4-4-ä½¿ç”¨-detach-çš„é£é™©">4.4 ä½¿ç”¨ detach çš„é£é™©</h3><p>å½“è°ƒç”¨ std::thread::detach æ—¶ï¼Œå­çº¿ç¨‹ä¼šåœ¨åå°ç‹¬ç«‹è¿è¡Œï¼Œä¸åˆ›å»ºå®ƒçš„ä¸»çº¿ç¨‹åˆ†ç¦»ã€‚ä½†åœ¨å‡½æ•°å‚æ•°è½¬é€’æŒ‡é’ˆçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ <code>detach()</code> å¾€å¾€ä¼šé€ æˆå¾ˆå¤šé—®é¢˜ã€‚</p><ul><li><p>æ™®é€šæŒ‡é’ˆ</p><p>åœ¨ä½¿ç”¨ <code>detach()</code> æƒ…å†µä¸‹ï¼Œä¸»çº¿ç¨‹å¯èƒ½å…ˆäºå­çº¿ç¨‹ç»“æŸï¼Œé‚£ä¹ˆå­çº¿ç¨‹ä¼šå°è¯•è®¿é—®å·²ç»é”€æ¯çš„å†…å­˜ï¼Œè¿›è€Œå¯¼è‡´ç¨‹åºå´©æºƒã€‚</p></li><li><p>std::shared_ptr</p><p>å‡å¦‚ä¸»çº¿ç¨‹åˆ›å»ºäº†ä¸€ä¸ª std::shared_ptr å¹¶ä¼ é€’ç»™ä¸€ä¸ªè¢« detach çš„çº¿ç¨‹ã€‚ä¸»çº¿ç¨‹å…ˆäºå­çº¿ç¨‹ç»“æŸï¼Œå¹¶ä¸”ä¸»çº¿ç¨‹æ˜¯æœ€åä¸€ä¸ªæŒæœ‰è¯¥æ™ºèƒ½æŒ‡é’ˆ std::shared_ptr çš„åœ°æ–¹ï¼Œé‚£ä¹ˆåœ¨ä¸»çº¿ç¨‹ç»“æŸæ—¶ï¼Œå¼•ç”¨è®¡æ•°å‡å°‘åˆ°é›¶ï¼Œè¿™æ—¶å€™å…±äº«å¯¹è±¡è¢«é”€æ¯äº†ã€‚æ­¤æ—¶åˆ†ç¦»çš„å­çº¿ç¨‹ä¹Ÿä¼šå°è¯•è®¿é—®å·²é”€æ¯çš„å†…å­˜ï¼Œè¿›è€Œå¯¼è‡´ç¨‹åºå´©æºƒã€‚</p></li><li><p>std::unique_ptr</p><p>std::unique_ptr ç‹¬å æ‰€æœ‰æƒï¼Œå½“ä¼ é€’ std::unique_ptr ç»™ä¸€ä¸ª detach çš„çº¿ç¨‹æ—¶ï¼Œå®é™…ä¸Šæ˜¯å°†å¯¹è±¡çš„æ‰€æœ‰æƒè½¬ç§»åˆ°äº†å­çº¿ç¨‹ã€‚å¦‚æœä¸»çº¿ç¨‹åœ¨å­çº¿ç¨‹å®Œæˆä¹‹å‰å°±ç»“æŸäº†ï¼Œè¿™æ—¶å€™ä¹Ÿä¼šå‡ºç°é”™è¯¯ï¼ˆå¯èƒ½ä¸¢å¤±å¯¹å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„è·Ÿè¸ªï¼Œè¿›è€Œäº§ç”Ÿå†…å­˜æ³„æ¼ç­‰å¤æ‚é—®é¢˜ï¼‰</p></li></ul><h2 id="5-ä¼ é€’ä¸´æ—¶å˜é‡ä½œä¸ºå‚æ•°">5 ä¼ é€’ä¸´æ—¶å˜é‡ä½œä¸ºå‚æ•°</h2><h3 id="5-1-æŒ‰å€¼ä¼ é€’ä¸´æ—¶å˜é‡ç¤ºä¾‹">5.1 æŒ‰å€¼ä¼ é€’ä¸´æ—¶å˜é‡ç¤ºä¾‹</h3><p>å½“æŒ‰å€¼ä¼ é€’ä¸´æ—¶å˜é‡ç»™çº¿ç¨‹å‡½æ•°æ—¶ï¼Œç¼–è¯‘å™¨ä¼šä¸ºçº¿ç¨‹å‡½æ•° <strong>åˆ›å»ºä¸€ä¸ªä¸´æ—¶å˜é‡çš„å‰¯æœ¬</strong>ã€‚çº¿ç¨‹å‡½æ•°å¯ä»¥å¯¹è¿™ä¸ªå‰¯æœ¬è¿›è¡Œå„ç§æ“ä½œï¼Œè€Œ <strong>åŸå§‹çš„ä¸´æ—¶å˜é‡åœ¨ä¼ é€’åå°±è¢«é”€æ¯</strong>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-comment">// çº¿ç¨‹æ¥å£å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> a, std::string s)</span></span>&#123; <br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): &quot;</span> &lt;&lt; a &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; s &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">// æŒ‰å€¼ä¼ é€’ä¸´æ—¶å˜é‡</span><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo, <span class="hljs-number">520</span>, <span class="hljs-string">&quot;Marisa&quot;</span>)</span></span>; <br>    t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://sukicdn.com/wyx/i/2024/12/19/4w6i.png" alt=""></p><h3 id="5-2-æŒ‰å¼•ç”¨ä¼ é€’ä¸´æ—¶å˜é‡ç¤ºä¾‹ï¼ˆstd-refï¼‰">5.2 æŒ‰å¼•ç”¨ä¼ é€’ä¸´æ—¶å˜é‡ç¤ºä¾‹ï¼ˆstd::refï¼‰</h3><p>ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬æ— æ³•é€šè¿‡ std::ref æ¥ä¼ é€’ä¸´æ—¶å˜é‡çš„å¼•ç”¨ï¼Œå³ä¾¿æ˜¯ä¸´æ—¶å˜é‡æ˜¯ä¸ªè¡¨è¾¾å¼ï¼Œè¿˜æ˜¯ä¼šå¯¼è‡´æŠ¥é”™ã€‚å› æ­¤ï¼Œ<strong>é€šå¸¸æˆ‘ä»¬ä¸æŒ‰å¼•ç”¨ä¼ é€’ä¸´æ—¶å˜é‡</strong>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-comment">// çº¿ç¨‹æ¥å£å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span>&amp; a, std::string s)</span></span>&#123; <br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): &quot;</span> &lt;&lt; a &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; s &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">// æŒ‰å¼•ç”¨ä¼ é€’ä¸´æ—¶å˜é‡ </span><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo, std::ref(<span class="hljs-number">520</span> + <span class="hljs-number">1</span>), <span class="hljs-string">&quot;Marisa&quot;</span>)</span></span>; <span class="hljs-comment">// ERROR</span><br>    t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://sukicdn.com/wyx/i/2024/12/19/yce3.png" alt=""></p><h3 id="5-3-ä¼ é€’ä¸´æ—¶å¯¹è±¡ç¤ºä¾‹">5.3 ä¼ é€’ä¸´æ—¶å¯¹è±¡ç¤ºä¾‹</h3><p>å½“ä¼ é€’ä¸´æ—¶ç±»å¯¹è±¡ç»™çº¿ç¨‹å‡½æ•°æ—¶ï¼Œä¼šæ¶‰åŠåˆ° <strong>å¯¹è±¡çš„æ‹·è´</strong> æˆ–è€… <strong>å¯¹è±¡çš„ç§»åŠ¨</strong>:</p><ul><li><p>å¦‚æœçº¿ç¨‹å‡½æ•° <strong>æŒ‰å€¼ä¼ é€’å¯¹è±¡</strong>ï¼Œå¹¶ä¸” <strong>æ²¡æœ‰ç§»åŠ¨æ„é€ å‡½æ•°</strong> æˆ–è€… <strong>ä¸é€‚åˆè°ƒç”¨ç§»åŠ¨è¯­ä¹‰</strong> æ—¶ï¼Œé‚£ä¹ˆä¼šè°ƒç”¨å¯¹è±¡çš„ <strong>æ‹·è´æ„é€ å‡½æ•°</strong> æ¥æ‹·è´åˆ›å»ºä¸€ä¸ªå‰¯æœ¬ã€‚</p></li><li><p>å¦‚æœå¯¹è±¡æ”¯æŒ <strong>ç§»åŠ¨è¯­ä¹‰</strong>ï¼Œæˆ–è€…è¿™ä¸ªå¯¹è±¡ä¸­æ˜¾å¼åœ°å£°æ˜äº†ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆä¼šé€šè¿‡è°ƒç”¨ <strong>ç§»åŠ¨è¯­ä¹‰ std::move</strong> æ¥ä¼ é€’å¯¹è±¡ã€‚è¿™æ ·é¿å…äº†ä¸å¿…è¦åœ°æ‹·è´ã€‚</p></li></ul><p><strong>ç§»åŠ¨è¯­ä¹‰ std::move</strong> çš„ç›®çš„æ˜¯å°†èµ„æºä»ä¸€ä¸ªå¯¹è±¡ï¼ˆé€šå¸¸æ˜¯å³å°†é”€æ¯çš„ä¸´æ—¶å¯¹è±¡ï¼Œå³ <strong>å³å€¼</strong>ï¼‰é«˜æ•ˆåœ°è½¬ç§»åˆ°å¦ä¸€ä¸ªæ–°å¯¹è±¡ä¸­ï¼Œé€šè¿‡å³å€¼å¼•ç”¨å‚æ•°ï¼ˆ&amp;&amp;ï¼‰æ¥è¯†åˆ«å¯ä»¥è¢«ç§»åŠ¨çš„å¯¹è±¡ã€‚å½“ç¼–è¯‘å™¨ç¡®å®šä¸€ä¸ªå¯¹è±¡æ˜¯å³å€¼æ—¶ï¼Œå°±æ¯”å¦‚ä¸´æ—¶å¯¹è±¡ï¼Œä¼šä¼˜å…ˆè€ƒè™‘è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œä»¥é¿å…ä¸å¿…è¦çš„æ‹·è´æ“ä½œã€‚</p><h4 id="5-3-1-è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ä¼ é€’">5.3.1 è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ä¼ é€’</h4><p>åœ¨ä¸‹é¢çš„ç¨‹åºä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªç±»ï¼ˆClassï¼‰ï¼Œæ˜¾å¼åœ°å®šä¹‰ç±»ä¸­çš„æ„é€ å‡½æ•°ã€ææ„å‡½æ•°ä»¥åŠæ‹·è´æ„é€ å‡½æ•°ã€‚åœ¨å„ä¸ªå‡½æ•°ä¸­ï¼Œä½¿ç”¨ <code>std::this_thread::get_id()</code> æ¥æ‰“å°çº¿ç¨‹çš„ idï¼Œä»¥è¾…åŠ©ç†è§£ç¨‹åºã€‚<a href="https://en.cppreference.com/w/cpp/thread/get_id">std::this_thread::get_id()</a></p><p>åˆ›å»ºçº¿ç¨‹é‡‡ç”¨äº†é€šè¿‡ <strong>ç±»æˆå‘˜å‡½æ•°æŒ‡é’ˆåˆ›å»ºçº¿ç¨‹</strong> çš„æ–¹å¼ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> &#123;<br>    <span class="hljs-type">int</span> val;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// æ„é€ å‡½æ•°</span><br>    <span class="hljs-built_in">MyClass</span>(<span class="hljs-type">int</span> n) : <span class="hljs-built_in">val</span>(n)&#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Build():&quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Build function called&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125; <br><br>    <span class="hljs-comment">// ææ„å‡½æ•°</span><br>    ~<span class="hljs-built_in">MyClass</span>()&#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;~():&quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;~ function called&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// æ‹·è´æ„é€ å‡½æ•°</span><br>    <span class="hljs-built_in">MyClass</span>(<span class="hljs-type">const</span> MyClass&amp; other)&#123; <br>        val = other.val;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Copy():&quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Copy function called&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// çº¿ç¨‹æ¥å£å‡½æ•°</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">print_val</span><span class="hljs-params">()</span></span>&#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;print_val():&quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        std::cout &lt;&lt; val &lt;&lt; <span class="hljs-string">&quot; Marisa&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main():&quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-comment">// ä¼ é€’ä¸€ä¸ªä¸´æ—¶ MyClass å¯¹è±¡ï¼ˆé€šè¿‡ç±»æˆå‘˜å‡½æ•°æŒ‡é’ˆåˆ›å»ºçº¿ç¨‹ï¼‰</span><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(&amp;MyClass::print_val, MyClass(<span class="hljs-number">520</span>))</span></span>; <br>    t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/19/ds.png" alt=""></p><p>å‘ç°ï¼Œä¸»çº¿ç¨‹ idã€æ„é€ å‡½æ•° id ä»¥åŠæ‹·è´æ„é€ å‡½æ•° id å‡ä¸º <code>0x58</code>ï¼›ä¸€æ¬¡ææ„å‡½æ•° id ä¸º <code>0x58</code>ã€‚è€Œå­çº¿ç¨‹ id å’Œ å¦ä¸€æ¬¡ææ„å‡½æ•° id ä¸º <code>0xb4</code>ã€‚</p><p>åˆ›å»ºçº¿ç¨‹è°ƒç”¨äº†ä¸€æ¬¡æ„é€ å‡½æ•°ï¼Œå¹¶è°ƒç”¨äº†ä¸€æ¬¡æ‹·è´æ„é€ å‡½æ•°ã€‚<strong>ä¸¤ä¸ªä¸åŒæ„é€ å‡½æ•°çš„è°ƒç”¨éƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­å°±æ‰§è¡Œçš„</strong>ï¼Œå› æ­¤ä¸¤ä¸ªå‡½æ•°ä¸­çš„çº¿ç¨‹ id ä¸€æ ·ä¸”å’Œä¸»çº¿ç¨‹ id ä¹Ÿä¸€æ ·ã€‚</p><p><strong>æ„é€ å‡½æ•°å¯¹åº”åœ°è°ƒç”¨ä¸€æ¬¡ææ„å‡½æ•°</strong>ï¼Œè¿™ä¸€æ¬¡è°ƒç”¨ææ„å‡½æ•°ä¹Ÿæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œå› æ­¤ <strong>çº¿ç¨‹ id å’Œä¸»çº¿ç¨‹ä¸€æ ·</strong>ã€‚</p><p><strong>æ‹·è´æ„é€ å‡½æ•°å¯¹åº”åœ°è°ƒç”¨ä¸€æ¬¡ææ„å‡½æ•°</strong>ï¼Œè€Œæ­¤æ¬¡è°ƒç”¨ææ„å‡½æ•°æ˜¯åœ¨çº¿ç¨‹æ¥å£å‡½æ•°è®¿é—®å®Œ <strong>æ‹·è´çš„ Myclass å¯¹è±¡</strong> ä¹‹åè¿›è¡Œè°ƒç”¨çš„ï¼Œå› æ­¤ï¼Œæ­¤æ—¶çš„ææ„å‡½æ•° <strong>çº¿ç¨‹ id å’Œçº¿ç¨‹æ¥å£å‡½æ•°çš„çº¿ç¨‹ id ä¸€æ ·</strong>ã€‚</p><h4 id="5-3-2-è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ä¼ é€’">5.3.2 è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ä¼ é€’</h4><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨ MyClass å¯¹è±¡ä¸­æ˜¾å¼å£°æ˜ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œè¿™æ ·å°± <strong>ä¼šä¼˜å…ˆå»è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°</strong>ï¼Œè€Œ <strong>ä¸ä¼šå»è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°</strong>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;chrono&gt;</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> &#123;<br>    <span class="hljs-type">int</span> val;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// æ„é€ å‡½æ•°</span><br>    <span class="hljs-built_in">MyClass</span>(<span class="hljs-type">int</span> n) : <span class="hljs-built_in">val</span>(n)&#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Build() thread id: &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Build function called&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125; <br><br>    <span class="hljs-comment">// ææ„å‡½æ•°</span><br>    ~<span class="hljs-built_in">MyClass</span>()&#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;~() thread id: &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;~ function called&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// æ‹·è´æ„é€ å‡½æ•°</span><br>    <span class="hljs-built_in">MyClass</span>(<span class="hljs-type">const</span> MyClass&amp; other)&#123; <br>        val = other.val;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Copy() thread id: &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Copy function called&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// ç§»åŠ¨æ„é€ å‡½æ•°ï¼ˆ&amp;&amp; ä¼ é€’ä¸€ä¸ªå³å€¼å¼•ç”¨ï¼‰</span><br>    <span class="hljs-built_in">MyClass</span>(MyClass&amp;&amp; other)&#123;<br>        val = other.val;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Move() thread id: &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Move funtion called&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// çº¿ç¨‹æ¥å£å‡½æ•°</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">print_val</span><span class="hljs-params">()</span></span>&#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;print_val() thread id: &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">seconds</span>(<span class="hljs-number">1</span>));<br>        std::cout &lt;&lt; val &lt;&lt; <span class="hljs-string">&quot; Marisa&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main() thread id: &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-comment">// ä¼ é€’ä¸€ä¸ªä¸´æ—¶ MyClass å¯¹è±¡ï¼ˆé€šè¿‡ç±»æˆå‘˜å‡½æ•°æŒ‡é’ˆåˆ›å»ºçº¿ç¨‹ï¼‰</span><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(&amp;MyClass::print_val, MyClass(<span class="hljs-number">520</span>))</span></span>; <br>    t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/19/470p.png" alt=""></p><p>å‘ç°ï¼Œä¸»çº¿ç¨‹ idã€æ„é€ å‡½æ•° id ä»¥åŠæ‹·è´æ„é€ å‡½æ•° id å‡ä¸º <code>0xd0</code>ï¼›ä¸€æ¬¡ææ„å‡½æ•° id ä¸º <code>0xd0</code>ã€‚è€Œå­çº¿ç¨‹ id å’Œ å¦ä¸€æ¬¡ææ„å‡½æ•° id ä¸º <code>0xd4</code>ã€‚</p><p>å’Œè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°çš„æƒ…å†µéƒ¨åˆ†åœ°æ–¹ç±»ä¼¼ã€‚</p><p><strong>æ„é€ å‡½æ•°å¯¹åº”åœ°è°ƒç”¨ä¸€æ¬¡ææ„å‡½æ•°</strong>ï¼Œè¿™ä¸€æ¬¡è°ƒç”¨ææ„å‡½æ•°ä¹Ÿæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œå› æ­¤ <strong>çº¿ç¨‹ id å’Œä¸»çº¿ç¨‹ä¸€æ ·</strong>ã€‚</p><p><strong>ç§»åŠ¨æ„é€ å‡½æ•°å¯¹åº”åœ°è°ƒç”¨ä¸€æ¬¡ææ„å‡½æ•°</strong>ï¼Œæ­¤æ¬¡è°ƒç”¨ææ„å‡½æ•°æ˜¯åœ¨çº¿ç¨‹æ¥å£å‡½æ•°è®¿é—®å®Œ <strong>ç§»åŠ¨è¿‡æ¥çš„ Myclass å¯¹è±¡</strong> ä¹‹åè¿›è¡Œè°ƒç”¨çš„ï¼Œå› æ­¤ï¼Œæ­¤æ—¶çš„ææ„å‡½æ•° <strong>çº¿ç¨‹ id å’Œçº¿ç¨‹æ¥å£å‡½æ•°çš„çº¿ç¨‹ id ä¸€æ ·</strong>ã€‚</p><p>æœ‰æ‰€åŒºåˆ«çš„æ˜¯ï¼Œåœ¨ç§»åŠ¨æ„é€ å‡½æ•°è¢«è°ƒç”¨åï¼Œè¿™ä¸ªä¸´æ—¶å¯¹è±¡å°±ä¼šè¢«ææ„ï¼ˆæ„é€ å‡½æ•°å¯¹åº”åœ°ä¸€æ¬¡ææ„å‡½æ•°è°ƒç”¨ï¼‰ï¼Œå› ä¸ºå®ƒçš„èµ„æºå·²ç»è¢«ç§»åŠ¨åˆ°äº†å¦ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œçš„å¯¹è±¡ä¸­ã€‚</p><h4 id="5-3-3-ä¼ é€’-STL-ä¸´æ—¶å¯¹è±¡">5.3.3 ä¼ é€’ STL ä¸´æ—¶å¯¹è±¡</h4><p>åœ¨ C++ æ ‡å‡†æ¨¡æ¿åº“ï¼ˆSTLï¼‰ä¸­ï¼Œè®¸å¤šå®¹å™¨å’Œç±»éƒ½å®šä¹‰äº†ç§»åŠ¨æ„é€ å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œstd::vectorã€std::string ç­‰å¸¸è§çš„ STL ç±»å‹éƒ½æœ‰ç§»åŠ¨æ„é€ å‡½æ•°ã€‚å¯è§ç§»åŠ¨è¯­ä¹‰åœ¨æé«˜æ€§èƒ½æ–¹é¢æœ‰é‡è¦ä½œç”¨ã€‚</p><p>å› æ­¤ï¼Œå½“ä¼ é€’ä¸´æ—¶ STL å¯¹è±¡ç»™åˆ›å»ºçš„ std::thread çº¿ç¨‹çš„æ¥å£å‡½æ•°æ—¶ï¼Œä¼šä¼˜å…ˆè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ä»£ç ä¸­ std::string å¯¹è±¡ï¼Œå¦‚æœä½¿ç”¨ <code>std::string(&quot;Marisa&quot;)</code> è¿™ç§å½¢å¼ä¼ é€’å‚æ•°æ—¶ï¼Œä¼š <strong>è‡ªåŠ¨è§¦å‘ç§»åŠ¨è¯­ä¹‰</strong>ï¼›</p><p>ä½†æ˜¯å¦‚æœå•çº¯å†™æˆ <code>&quot;Marisa&quot;</code> çš„å½¢å¼ï¼Œé‚£ä¹ˆä¼šä¼šè¢« <strong>éšå¼åœ°è½¬æ¢ä¸ºstd::stringç±»å‹</strong>ï¼Œä½†è¿™ä¸ªè¿‡ç¨‹é€šå¸¸ä¼š <strong>è°ƒç”¨ std::string çš„æ„é€ å‡½æ•°</strong> æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„std::stringå¯¹è±¡ï¼Œ<strong>è€Œä¸æ˜¯ç§»åŠ¨è¯­ä¹‰</strong>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(std::vector&lt;<span class="hljs-type">int</span>&gt; v, std::string s)</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;I love &quot;</span> &lt;&lt; s &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;x : v) std::cout &lt;&lt; x &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">// ä¼ é€’ stl ä¸´æ—¶å¯¹è±¡ï¼ˆä¼˜å…ˆè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼‰</span><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo, std::vector&lt;<span class="hljs-type">int</span>&gt;&#123;<span class="hljs-number">520</span>, <span class="hljs-number">1314</span>&#125;, std::string(<span class="hljs-string">&quot;Marisa&quot;</span>))</span></span>;<br>    t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://sukicdn.com/wyx/i/2024/12/19/3e8.png" alt=""></p>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€join(), detach(), joinable()</title>
    <link href="/2024/12/18/20241218/"/>
    <url>/2024/12/18/20241218/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æº: <a href="https://www.pixiv.net/artworks/82332929">pixiv_id=82332929</a></p><h2 id="1-ä¸»çº¿ç¨‹ä¸å­çº¿ç¨‹">1 ä¸»çº¿ç¨‹ä¸å­çº¿ç¨‹</h2><p>åœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­ï¼Œé€šå¸¸æƒ…å†µä¸‹æœ‰ä¸€ä¸ªä¸»çº¿ç¨‹ä»¥åŠè‹¥å¹²ä¸ªå­çº¿ç¨‹ã€‚ä¸»çº¿ç¨‹å°±æ˜¯æˆ‘ä»¬æ‰§è¡Œä¸»å‡½æ•° <code>main()</code> çš„çº¿ç¨‹ï¼Œå­çº¿ç¨‹æ˜¯æˆ‘ä»¬åœ¨ä¸»çº¿ç¨‹çš„å‡½æ•° <code>main()</code> ä¸­ï¼ˆæˆ–è€…å¯ä»¥åœ¨å…¶ä»–ç°æœ‰çº¿ç¨‹çš„å‡½æ•°ä¸­ä¸­ï¼‰åˆ›å»ºçš„çº¿ç¨‹ã€‚</p><p>ä¸»çº¿ç¨‹å’Œå­çº¿ç¨‹åœ¨åŒä¸€æ—¶é—´æ®µå†…åŒæ—¶è¿›è¡Œï¼Œæ˜¯å¹¶å‘ï¼ˆå¹¶è¡Œï¼‰è¿è¡Œçš„ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¼šæœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µ:</p><ul><li><p>ä¸»çº¿ç¨‹å…ˆè¿è¡Œç»“æŸ</p></li><li><p>å­çº¿ç¨‹å…ˆè¿è¡Œç»“æŸ</p></li><li><p>ä¸»çº¿ç¨‹ä¸å­çº¿ç¨‹åŒæ—¶ç»“æŸ</p></li></ul><p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦è®©å­çº¿ç¨‹è¿è¡Œç»“æŸï¼Œä¸»çº¿ç¨‹æ‰èƒ½ç»“æŸï¼›æœ‰æ—¶æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸ç­‰å¾…å­çº¿ç¨‹è¿è¡Œç»“æŸï¼Œä¸»çº¿ç¨‹è¿è¡Œå®Œåæ•´ä¸ªç¨‹åºå°±å¯ä»¥ç»“æŸäº†ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¸ç­‰å¾…å­çº¿ç¨‹è¿è¡Œç»“æŸçš„æƒ…å†µä¸‹ï¼Œ<strong>ä¸»çº¿ç¨‹è¿è¡Œç»“æŸåå­çº¿ç¨‹å¹¶ä¸ä¼šç«‹å³åœæ­¢</strong>ï¼Œè€Œæ˜¯ <strong>ä¼šè¿›å…¥åå°è¿è¡Œ</strong>ã€‚å¦‚æœå­çº¿ç¨‹æ‰€éœ€èµ„æºï¼ˆå¦‚å†…å­˜ï¼‰ä»ç„¶æœ‰æ•ˆï¼Œå¹¶ä¸”æ²¡æœ‰è¢«å¤–éƒ¨å› ç´ ï¼ˆå¦‚å…¶ä»–çº¿ç¨‹å‘é€ç»ˆæ­¢ä¿¡å·ç­‰ï¼‰å¼ºåˆ¶ç»ˆæ­¢ï¼Œå­çº¿ç¨‹è¿˜æ˜¯ä¼šç»§ç»­è¿è¡Œã€‚åªä¸è¿‡æ˜¯åœ¨åå°è¿è¡Œã€‚</p><h2 id="2-std-thread-join">2 std::thread::join</h2><p><code>join()</code> æ˜¯ std::thread ç±»çš„ä¸€ä¸ªæˆå‘˜å‡½æ•°ï¼Œä½œç”¨æ˜¯ç­‰å¾…çº¿ç¨‹å®Œæˆã€‚æˆ‘ä»¬åœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹ <code>t</code>ï¼Œå¹¶åœ¨è¿™ä¸ªçº¿ç¨‹å¯¹è±¡ä¸Šè°ƒç”¨ <code>join()</code> å‡½æ•°ï¼Œæ­¤æ—¶ä¸»çº¿ç¨‹ä¼šè¢« <strong>é˜»å¡</strong>ï¼Œç›´åˆ°è°ƒç”¨ <code>join()</code> å‡½æ•°çš„å­çº¿ç¨‹ <code>t</code> æ‰§è¡Œå®Œã€‚</p><p>æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªç®€å•çš„çº¿ç¨‹æ¥å£å‡½æ•° <code>foo()</code>ï¼Œå¹¶åœ¨å…¶ä¸­æ¨¡æ‹Ÿåšäº†ä¸€äº›äº‹æƒ…ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): thread starts.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-comment">// æ¨¡æ‹Ÿåšä¸€äº›äº‹æƒ…</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): MarisaMagic is doing sth.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">seconds</span>(<span class="hljs-number">1</span>)); <br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): thread ends.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): thread starts.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo)</span></span>;<br>    t.<span class="hljs-built_in">join</span>(); <span class="hljs-comment">// ä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹è¿è¡Œç»“æŸ</span><br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): thread ends.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ã€‚å¯ä»¥çœ‹å‡ºï¼Œ<code>foo()</code> å­çº¿ç¨‹è¿è¡Œç»“æŸåï¼Œ<code>main()</code> ä¸»çº¿ç¨‹æ‰ç»“æŸã€‚é‡å¤å¤šæ¬¡è¿è¡Œåç»“æœä¾æ—§å¦‚æ­¤ã€‚</p><p><img src="https://sukicdn.com/wyx/i/2024/12/18/60pc3.png" alt=""></p><p>åœ¨ä¸Šé¢çš„ç¨‹åºä¸­ï¼Œä¸ºäº†è®©å­çº¿ç¨‹è¿è¡Œæ—¶é—´é•¿ä¸€äº›ï¼Œæ–¹ä¾¿ä¹‹åæ›´å¥½æ¼”ç¤ºï¼Œå­çº¿ç¨‹æ¥å£å‡½æ•°ä¸­ä½¿ç”¨äº† <code>std::this_thread::sleep_for()</code> å‡½æ•°ï¼Œä½œç”¨æ˜¯è®©å½“å‰çº¿ç¨‹ä¼‘æ¯ä¸€æ®µæ—¶é—´ã€‚<code>std::this_thread::sleep_for()</code> æ¥æ”¶çš„æ˜¯ä¸€ä¸ª std::chrono::duration ç±»å‹çš„å‚æ•°ï¼ˆé€šå¸¸ä¸ºç§’ï¼ˆstd::chrono::secondsï¼‰ã€æ¯«ç§’ï¼ˆstd::chrono::millisecondsï¼‰ç­‰ï¼‰ã€‚æ­¤å¤„ï¼Œæˆ‘è®©å­çº¿ç¨‹ä¼‘æ¯äº† 1 ç§’é’Ÿã€‚</p><h2 id="3-std-thread-detach">3 std::thread::detach</h2><p><code>detach()</code> ä¹Ÿæ˜¯ std::thread ç±»çš„ä¸€ä¸ªæˆå‘˜å‡½æ•°ï¼Œç§°ä¸º <strong>åˆ†ç¦»çº¿ç¨‹å‡½æ•°</strong>ã€‚æˆ‘ä»¬åœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹ <code>t</code>ï¼Œå¹¶åœ¨è¿™ä¸ªçº¿ç¨‹å¯¹è±¡ä¸Šè°ƒç”¨ <code>detach()</code> å‡½æ•°åï¼Œ<code>main()</code> ä¸»çº¿ç¨‹ä¸ä¼šç­‰å¾…å­çº¿ç¨‹ <code>t</code> è¿è¡Œç»“æŸã€‚</p><p>ä¸»çº¿ç¨‹æ‰§è¡Œå¯èƒ½æ˜¯æ¯”è¾ƒå¿«çš„ï¼Œä¼šå…ˆäºå­çº¿ç¨‹ç»“æŸï¼Œè€Œåˆ†ç¦»çš„å­çº¿ç¨‹ <code>t</code> å¯ä»¥åœ¨åå°ç‹¬ç«‹è¿è¡Œï¼Œå’Œä¸»çº¿ç¨‹ç›¸äº’ç‹¬ç«‹ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): thread starts.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-comment">// æ¨¡æ‹Ÿåšä¸€äº›äº‹æƒ…</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): MarisaMagic is doing sth.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">seconds</span>(<span class="hljs-number">1</span>)); <br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): thread ends.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): thread starts.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo)</span></span>;<br>    t.<span class="hljs-built_in">detach</span>();  <span class="hljs-comment">// ä¸»çº¿ç¨‹ä¸ç­‰å¾…å­çº¿ç¨‹è¿è¡Œç»“æŸ </span><br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): thread ends.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ã€‚å¯ä»¥çœ‹å‡ºï¼Œä¸»çº¿ç¨‹è¿è¡Œå¾—æ¯”è¾ƒå¿«ï¼Œè€Œå­çº¿ç¨‹éœ€è¦ 1 ç§’å¤šçš„è¿è¡Œæ—¶é—´ï¼Œä¸»çº¿ç¨‹å¹¶æ²¡æœ‰ç­‰å¾…å­çº¿ç¨‹è¿è¡Œç»“æŸå°±å·²ç»å…ˆç»“æŸäº†ã€‚</p><p><img src="https://sukicdn.com/wyx/i/2024/12/18/618mu.png" alt=""></p><h2 id="4-join-å’Œ-detach-ä¸å¯å¤šæ¬¡è°ƒç”¨">4 join() å’Œ detach() ä¸å¯å¤šæ¬¡è°ƒç”¨</h2><p>å½“ä¸€ä¸ªå­çº¿ç¨‹è°ƒç”¨äº†ä¸€æ¬¡ <code>join()</code> åï¼Œå°±ä¸èƒ½å†æ¬¡è°ƒç”¨ <code>join()</code> äº†ã€‚<code>join()</code> æ˜¯ç­‰å¾…çº¿ç¨‹æ‰§è¡Œå®Œæˆï¼Œæ‰§è¡Œå®Œä¹‹åï¼Œå­çº¿ç¨‹ä¹Ÿè‡ªç„¶ç»“æŸï¼Œå†æ¬¡è°ƒç”¨ <code>join()</code> æ˜¯ä¸å¯è¡Œçš„ï¼Œå½“ç„¶è°ƒç”¨ <code>detach()</code> ä¹Ÿæ²¡æœ‰æ„ä¹‰ï¼Œä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): thread starts.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-comment">// æ¨¡æ‹Ÿåšä¸€äº›äº‹æƒ…</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): MarisaMagic is doing sth.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">seconds</span>(<span class="hljs-number">1</span>)); <br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): thread ends.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): thread starts.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo)</span></span>;<br>    t.<span class="hljs-built_in">join</span>();<br><br>    <span class="hljs-keyword">try</span>&#123;<br>        t.<span class="hljs-built_in">join</span>(); <span class="hljs-comment">// ä¸å¯å¤šæ¬¡join()ï¼ˆå†æ¬¡detach()ä¹Ÿä¸è¡Œï¼‰</span><br>    &#125;<span class="hljs-built_in">catch</span>(...)&#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;ERROR: multiple join.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): thread ends.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://sukicdn.com/wyx/i/2024/12/18/vgc2.png" alt=""></p><p>åŒç†ï¼Œä¸€ä¸ªå­çº¿ç¨‹è°ƒç”¨äº†ä¸€æ¬¡ <code>detach()</code> è¢«åˆ†ç¦»åï¼Œä¹Ÿä¸èƒ½å†é€šè¿‡ std::thread å¯¹è±¡æ¥å¯¹è¯¥çº¿ç¨‹è¿›è¡Œæ§åˆ¶ï¼ˆä¸èƒ½å†æ¬¡è°ƒç”¨ <code>join()</code> æˆ– <code>detach()</code>ï¼‰ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): thread starts.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-comment">// æ¨¡æ‹Ÿåšä¸€äº›äº‹æƒ…</span><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): MarisaMagic is doing sth.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">seconds</span>(<span class="hljs-number">1</span>)); <br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo(): thread ends.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): thread starts.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo)</span></span>;<br>    t.<span class="hljs-built_in">detach</span>();<br><br>    <span class="hljs-keyword">try</span>&#123;<br>        t.<span class="hljs-built_in">detach</span>(); <span class="hljs-comment">// ä¸å¯å¤šæ¬¡detach()ï¼ˆå†æ¬¡join()ä¹Ÿä¸å¯è¡Œï¼‰</span><br>    &#125;<span class="hljs-built_in">catch</span>(...)&#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;ERROR: multiple detach.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(): thread ends.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://sukicdn.com/wyx/i/2024/12/18/vhbd.png" alt=""></p><h2 id="5-std-thread-joinable">5 std::thread::joinable</h2><p><code>joinable()</code> æ˜¯ std::thread ç±»çš„ä¸€ä¸ªæˆå‘˜å‡½æ•°ï¼Œç”¨äºæ£€æŸ¥çº¿ç¨‹æ˜¯å¦å¯ä»¥è¢« <code>join</code> æˆ–è€… <code>detach</code>ã€‚å¦‚æœçº¿ç¨‹æ˜¯å¯ä»¥è°ƒç”¨ <code>join</code> æˆ–è€… <code>detach</code> çš„ï¼Œé‚£ä¹ˆ <code>joinable()</code> å‡½æ•°è¿”å›å€¼ä¸º <code>true</code>ï¼›å¦åˆ™ä¸º <code>false</code>ã€‚</p><p>ä¸€ä¸ªçº¿ç¨‹æ˜¯ä¸å¯ <code>join</code> ä¹Ÿä¸å¯ <code>detach</code> çš„ï¼ˆ<code>joinable()</code> å‡½æ•°è¿”å›å€¼ä¸º <code>false</code>ï¼ŒçŠ¶æ€ä¸º <code>nonjoinable</code>ï¼‰ï¼Œå¤§è‡´åˆ†ä¸ºä¸‰ç§æƒ…å†µ:</p><ul><li><p>çº¿ç¨‹è¿˜æ²¡æœ‰å¼€å§‹æ‰§è¡Œã€‚ï¼ˆä¾‹å¦‚é»˜è®¤æ„é€ çš„ std::thread å¯¹è±¡ï¼Œæ²¡æœ‰å…³è”ä»»ä½•æ¥å£å‡½æ•°ï¼‰</p></li><li><p>çº¿ç¨‹å·²ç»è¢« <code>join</code>ï¼ˆç­‰å¾…å¹¶æ‰§è¡Œå®Œæ¯•ï¼‰</p></li><li><p>çº¿ç¨‹å·²ç»è¢« <code>detach</code>ï¼ˆå·²ç»è¢«åˆ†ç¦»äº†ï¼‰</p></li></ul><p>æˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹ç¨‹åºè¿›è¡Œæµ‹è¯•:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123; <span class="hljs-keyword">return</span>; &#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123; <br>    std::thread t1; <span class="hljs-comment">// æœªå…³è”ä»»ä½•å‡½æ•°</span><br>    std::cout &lt;&lt; t<span class="hljs-number">1.</span><span class="hljs-built_in">joinable</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-function">std::thread <span class="hljs-title">t2</span><span class="hljs-params">(foo)</span></span>;<br>    t<span class="hljs-number">2.</span><span class="hljs-built_in">join</span>(); <span class="hljs-comment">// å·²ç»join</span><br>    std::cout &lt;&lt; t<span class="hljs-number">2.</span><span class="hljs-built_in">joinable</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-function">std::thread <span class="hljs-title">t3</span><span class="hljs-params">(foo)</span></span>;<br>    t<span class="hljs-number">3.</span><span class="hljs-built_in">detach</span>(); <span class="hljs-comment">// å·²ç»detach</span><br>    std::cout &lt;&lt; t<span class="hljs-number">3.</span><span class="hljs-built_in">joinable</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºä¸‰ä¸ª <code>0</code>ï¼Œè¿”å›å€¼å‡ä¸º <code>false</code>ï¼Œè¡¨ç¤ºä¸‰ç§æƒ…å†µä¸‹çº¿ç¨‹éƒ½æ˜¯ä¸å¯ <code>join</code> ä¹Ÿä¸å¯ <code>detach</code> çš„ã€‚</p><p><img src="https://sukicdn.com/wyx/i/2024/12/18/68psr.png" alt=""></p><p>åœ¨å®é™…è¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†ä¿é™©èµ·è§ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™å¯ä»¥åœ¨å¯¹çº¿ç¨‹è¿›è¡Œ <code>join</code> æˆ–è€…<code>detach</code> æ“ä½œä¹‹å‰å…ˆæ£€æŸ¥æ˜¯å¦ <code>joinable</code>ï¼Œé¿å…å‡ºç°æœªå®šä¹‰è¡Œä¸ºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo)</span></span>;<br><span class="hljs-keyword">if</span>(t.<span class="hljs-built_in">joinable</span>())&#123; <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å¯ä»¥è¿›è¡Œjoinæˆ–detach</span><br>    t.<span class="hljs-built_in">join</span>(); <br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ol><li><p><a href="https://cplusplus.com/reference/thread/thread/">cplusplus reference std::thread</a></p></li><li><p><a href="https://blog.csdn.net/qq_36784975/article/details/87699113">C++11å¤šçº¿ç¨‹join()å’Œdetach()çš„ç†è§£</a></p></li><li><p><a href="https://blog.csdn.net/xp178171640/article/details/118548150">C++11 çº¿ç¨‹å¯¹è±¡åˆ›å»ºåæ—¢ä¸join()ä¹Ÿä¸detach()çš„åæœ</a></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŒC++ å¤šçº¿ç¨‹ã€å¹¶å‘ä¸å¤šçº¿ç¨‹</title>
    <link href="/2024/12/17/20241217/"/>
    <url>/2024/12/17/20241217/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æº: <a href="https://www.pixiv.net/artworks/122609228">pixiv_id=122609228</a></p><h2 id="1-è¿›ç¨‹ä¸çº¿ç¨‹">1 è¿›ç¨‹ä¸çº¿ç¨‹</h2><h3 id="1-1-è¿›ç¨‹">1.1 è¿›ç¨‹</h3><p>è¿›ç¨‹ï¼ˆProcessï¼‰æ˜¯è®¡ç®—æœºä¸­ç¨‹åºå…³äºæŸæ•°æ®é›†åˆä¸Šçš„ä¸€æ¬¡è¿è¡Œæ´»åŠ¨ï¼Œæ˜¯ <strong>ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½</strong>ã€‚å¯ä»¥æŠŠè¿›ç¨‹çœ‹ä½œæ˜¯ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åºçš„å®ä¾‹ã€‚ä¾‹å¦‚æˆ‘æ‰“å¼€äº† Edge æµè§ˆå™¨ï¼Œæ“ä½œç³»ç»Ÿä¼šä¸ºå…¶åˆ›å»ºä¸€ä¸ªè¿›ç¨‹ï¼Œè¿›ç¨‹ä¸­åŒ…å«äº†è¿è¡Œç¨‹åºçš„ä»£ç ã€æ‰€ä½¿ç”¨çš„æ•°æ®ã€ä»¥åŠå†…å­˜ç©ºé—´ç­‰å„ç§ç³»ç»Ÿèµ„æºã€‚</p><p>ä»å¾®è§‚ä¸Šæ¥çœ‹ï¼Œ<strong>ä¸€ä¸ªä¼ ç»Ÿå•æ ¸ CPU åœ¨æŸä¸€ä¸ªç‰¹å®šæ—¶åˆ»åªèƒ½å¤„ç†ä¸€ä¸ªè¿›ç¨‹</strong>ã€‚</p><h3 id="1-2-çº¿ç¨‹">1.2 çº¿ç¨‹</h3><p>çº¿ç¨‹æ˜¯è¿›ç¨‹ä¸­çš„ä¸€ä¸ªå°çš„æ‰§è¡Œå•å…ƒï¼Œæ˜¯ <strong>CPU è°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½</strong>ã€‚<strong>ä¸€ä¸ªè¿›ç¨‹å¯ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹</strong>ï¼Œè¿™äº›çº¿ç¨‹ <strong>å…±äº«è¿›ç¨‹çš„èµ„æº</strong>ï¼ˆå¦‚ä»£ç æ®µã€æ•°æ®æ®µã€æ–‡ä»¶èµ„æºç­‰ï¼‰</p><h3 id="1-3-è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«">1.3 è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«</h3><h4 id="1-3-1-èµ„æºåˆ†é…">1.3.1 èµ„æºåˆ†é…</h4><ul><li><p><strong>è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„åŸºæœ¬å•ä½</strong>ã€‚æ¯ä¸ªè¿›ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ã€æ–‡ä»¶ç­‰èµ„æºã€‚ä¸€ä¸ªè¿›ç¨‹æ— æ³•ç›´æ¥è®¿é—®å…¶ä»–è¿›ç¨‹çš„èµ„æºï¼Œæ­¤æ—¶éœ€è¦å€ŸåŠ©è¿›ç¨‹é€šä¿¡ã€‚</p></li><li><p><strong>çº¿ç¨‹æ˜¯å…±äº«è¿›ç¨‹èµ„æºçš„æ‰§è¡Œå•ä½</strong>ã€‚çº¿ç¨‹é™¤äº†æ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„æ ˆç©ºé—´ã€ç¨‹åºè®¡æ•°å™¨ç­‰å°‘é‡èµ„æºå¤–ï¼Œè¿˜å…±äº«è¿›ç¨‹çš„å¤§éƒ¨åˆ†èµ„æºã€‚çº¿ç¨‹ä¹‹é—´å¯ä»¥æ–¹ä¾¿åœ°å…±äº«æ•°æ®ã€‚</p></li></ul><h4 id="1-3-2-è°ƒåº¦å¼€é”€">1.3.2 è°ƒåº¦å¼€é”€</h4><ul><li><p><strong>è¿›ç¨‹çš„è°ƒåº¦å¼€é”€è¾ƒå¤§</strong>ã€‚éœ€è¦åˆ‡æ¢æ•´ä¸ªåœ°å€ç©ºé—´ï¼Œä¿å­˜å’Œæ¢å¤å¤§é‡çš„å¯„å­˜å™¨å’Œå…¶ä»–ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p></li><li><p><strong>çº¿ç¨‹çš„è°ƒåº¦å¼€é”€è¾ƒå°</strong>ã€‚ç”±äºçº¿ç¨‹å…±äº«è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œçº¿ç¨‹åˆ‡æ¢æ—¶åªéœ€è¦ä¿å­˜å’Œæ¢å¤å°‘é‡çš„å¯„å­˜å™¨å’Œæ ˆæŒ‡é’ˆç­‰ä¿¡æ¯ã€‚</p></li></ul><h4 id="1-3-3-ç‹¬ç«‹æ€§å’Œå¥å£®æ€§">1.3.3 ç‹¬ç«‹æ€§å’Œå¥å£®æ€§</h4><ul><li><p><strong>è¿›ç¨‹å…·æœ‰è¾ƒé«˜çš„ç‹¬ç«‹æ€§</strong>ã€‚ä¸€ä¸ªè¿›ç¨‹çš„å´©æºƒé€šå¸¸ä¸ä¼šå½±å“å…¶ä»–è¿›ç¨‹çš„è¿è¡Œï¼Œæ¯”è¾ƒå®‰å…¨ã€‚</p></li><li><p><strong>çº¿ç¨‹çš„ç‹¬ç«‹æ€§ç›¸å¯¹è¾ƒå¼±</strong>ã€‚ç”±äºçº¿ç¨‹å…±äº«è¿›ç¨‹çš„èµ„æºï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹å‡ºç°é”™è¯¯ï¼ˆå¦‚è®¿é—®éæ³•å†…å­˜åœ°å€ï¼‰ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ªè¿›ç¨‹å´©æºƒã€‚</p></li></ul><h2 id="2-ä»€ä¹ˆæ˜¯å¹¶å‘">2 ä»€ä¹ˆæ˜¯å¹¶å‘</h2><h3 id="2-1-å¹¶å‘çš„å«ä¹‰">2.1 å¹¶å‘çš„å«ä¹‰</h3><p>å¹¶å‘ï¼ˆConcurrencyï¼‰æ˜¯æŒ‡è®¡ç®—æœºç³»ç»Ÿä¸­å¤šä¸ªè®¡ç®—æˆ–å¤„ç†è¿‡ç¨‹åŒæ—¶è¿›è¡Œçš„èƒ½åŠ›ã€‚å¹¶å‘ç°è±¡åœ¨æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­ä¹Ÿå¾ˆå¸¸è§ï¼Œæˆ‘å¯ä»¥è¾¹å¬ä¸œæ–¹åŒäººéŸ³ä¹è¾¹å†™åšå®¢ï¼Œä¹Ÿå¯ä»¥è¾¹ä¸Šè¯¾è¾¹çœ‹ç¯®çƒæ¯”èµ›ï¼ˆ</p><h3 id="2-2-å¹¶å‘çš„æ–¹å¼">2.2 å¹¶å‘çš„æ–¹å¼</h3><h4 id="2-2-1-å¤šæ ¸æœºçš„å¹¶å‘æ‰§è¡Œ">2.2.1 å¤šæ ¸æœºçš„å¹¶å‘æ‰§è¡Œ</h4><p>åœ¨å¤šæ ¸æœºä¸Šï¼Œ<strong>æ¯ä¸ªæ ¸å¿ƒéƒ½å¯ä»¥ç‹¬ç«‹åœ°æ‰§è¡Œä¸åŒçš„çº¿ç¨‹æˆ–è¿›ç¨‹</strong>ï¼Œä»è€ŒçœŸæ­£åœ°åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ï¼Œå®ç°çœŸæ­£çš„ <strong>å¹¶è¡Œ</strong>ã€‚</p><h4 id="2-2-2-å•æ ¸æœºçš„ä»»åŠ¡åˆ‡æ¢">2.2.2 å•æ ¸æœºçš„ä»»åŠ¡åˆ‡æ¢</h4><p>å•æ ¸æœºä¸Šå¾€å¾€é€šè¿‡ <strong>æ—¶é—´åˆ†ç‰‡</strong> å’Œ <strong>ä¸Šä¸‹æ–‡åˆ‡æ¢</strong> å®ç°ä»»åŠ¡çš„åˆ‡æ¢ï¼Œæ¯ä¸ªä»»åŠ¡è¢«åˆ†é…ä¸€ä¸ªå°çš„æ—¶é—´æ®µæ‰§è¡Œï¼Œä»»åŠ¡æ‰§è¡Œç»“æŸåï¼Œä¼šä»å½“å‰ä»»åŠ¡åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚å¯ä»¥å®ç°å®è§‚ä¸Šçš„åŒæ—¶å¤„ç†ä»»åŠ¡ã€‚</p><p><img src="https://sukicdn.com/wyx/i/2024/12/17/tt9u.png" alt=""></p><p>ç°åœ¨å¤§éƒ¨åˆ†çš„ç”µè„‘ CPU éƒ½æ˜¯å¤šæ ¸çš„ï¼Œä½†å³ä½¿åœ¨å¤šæ ¸ç¯å¢ƒä¸­ï¼Œå½“çº¿ç¨‹æ•°è¶…è¿‡æ ¸å¿ƒæ•°æ—¶ï¼ˆç”µè„‘éƒ½ä¼šæœ‰çº¿ç¨‹é™åˆ¶æ•°é‡ï¼Œæœ‰æ—¶ä¼šå¤§äºæ ¸å¿ƒæ•°é‡ï¼Œä¸€åˆ‡ä»¥å®é™…æµ‹è¯•ç»“æœä¸ºå‡†ï¼‰ï¼Œä¹Ÿéœ€è¦åœ¨æ¯ä¸ªå•æ ¸ä¸Šè¿›è¡Œæ—¶é—´ç‰‡è½®è½¬å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚æ­¤æ—¶ä¸¤ç§å¹¶å‘çš„æ–¹å¼æ˜¯æ··åˆè¿›è¡Œçš„ã€‚</p><p><img src="https://sukicdn.com/wyx/i/2024/12/17/tt94.png" alt=""></p><h3 id="2-3-å¹¶å‘çš„é€”å¾„">2.3 å¹¶å‘çš„é€”å¾„</h3><h4 id="2-3-1-å¤šè¿›ç¨‹å¹¶å‘">2.3.1 å¤šè¿›ç¨‹å¹¶å‘</h4><p>è¿ç”¨ç‹¬ç«‹çš„è¿›ç¨‹å®ç°å¹¶å‘ã€‚</p><p><img src="https://sukicdn.com/wyx/i/2024/12/17/4c73.png" alt=""></p><h4 id="2-3-2-ä¸€ä¸ªè¿›ç¨‹å†…å¤šçº¿ç¨‹å¹¶å‘">2.3.2 ä¸€ä¸ªè¿›ç¨‹å†…å¤šçº¿ç¨‹å¹¶å‘</h4><p>åŒä¸€ä¸ªè¿›ç¨‹å†…çš„æ‰€æœ‰çº¿ç¨‹å…±äº«è¿›ç¨‹çš„å¤§éƒ¨åˆ†èµ„æºï¼Œä½†æ˜¯è¿™ç§æ–¹å¼å¾€å¾€æ¯”è¾ƒå¤æ‚ã€‚</p><p><img src="https://sukicdn.com/wyx/i/2024/12/17/mbb.png" alt=""></p><h2 id="3-å¹¶å‘çš„æ„ä¹‰">3 å¹¶å‘çš„æ„ä¹‰</h2><p>å¹¶å‘æŠ€æœ¯é€šå¸¸èƒ½å¤Ÿ <strong>æé«˜èµ„æºåˆ©ç”¨ç‡ã€å¢å¼ºç³»ç»Ÿçš„å“åº”èƒ½åŠ›ã€æ”¯æŒå¤æ‚ä»»åŠ¡çš„åˆ†è§£ä¸å¤„ç†</strong>ï¼Œé€‚ç”¨äºå¤šç”¨æˆ·äº¤äº’ã€è®¡ç®—è¾ƒä¸ºå¯†é›†çš„ä»»åŠ¡ç­‰åœºæ™¯ã€‚</p><p>å½“ç„¶ï¼Œæœ‰æ—¶å€™ä¹Ÿä¸é€‚åˆä½¿ç”¨å¹¶å‘æŠ€æœ¯ã€‚å½“å¯¹äº <strong>ä¸€äº›ç®€å•çš„ã€é¡ºåºä¾èµ–å¾ˆå¼ºçš„</strong> ç¨‹åºï¼Œæˆ–è€… <strong>å¯¹æ‰§è¡Œé¡ºåºæœ‰ä¸¥æ ¼è¦æ±‚</strong> çš„ä»»åŠ¡ï¼Œå¹¶å‘å¯èƒ½ä¼šå¼•å…¥ä¸å¿…è¦çš„å¤æ‚æ€§åè€Œé€ æˆå¤šä½™çš„å¼€é”€ï¼Œæ­¤æ—¶å°±ä¸å¦‚ä½¿ç”¨ä¼ ç»Ÿçš„ä¸²è¡Œç¼–ç¨‹æ–¹å¼äº†ã€‚</p><h2 id="4-ç®€å•C-å¤šçº¿ç¨‹ç¨‹åº">4 ç®€å•C++å¤šçº¿ç¨‹ç¨‹åº</h2><p>æˆ‘ä»¬æœ‰ä¸€ä¸ªéå¸¸ç®€å•çš„å•çº¿ç¨‹C++ç¨‹åºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123; <br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Hello, this is MarisaMagic.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥å°†å…¶æ”¹å†™å¤šçº¿ç¨‹ç¨‹åºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;Hello, this is MarisaMagic.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;  <span class="hljs-comment">// ä¸»çº¿ç¨‹ä» main() å¼€å§‹æ‰§è¡Œ</span><br><span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo)</span></span>; <span class="hljs-comment">// æ–°çš„å­çº¿ç¨‹ t ä» foo() å¼€å§‹æ‰§è¡Œ</span><br>t.<span class="hljs-built_in">join</span>();           <span class="hljs-comment">// ç­‰å¾… t çº¿ç¨‹æ‰§è¡Œå®Œæˆ</span><br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://sukicdn.com/wyx/i/2024/12/17/vol3.png" alt=""></p><p>æ¯ä¸ªçº¿ç¨‹éœ€è¦ä¸€ä¸ª <strong>çº¿ç¨‹æ¥å£å‡½æ•°</strong>ï¼Œä¾‹å¦‚ä¸Šé¢ä»£ç ä¸­çš„ <code>foo()</code>ã€‚å®é™…ä¸Šï¼Œä¸»å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä½œæ˜¯ä¸»çº¿ç¨‹ã€‚ä¸ºäº†è¾“å‡º <code>Hello, this is MarisaMagic.</code> ï¼Œæˆ‘ä»¬å¯åŠ¨äº†ä¸€ä¸ªæ–°çš„çº¿ç¨‹ <code>t</code>ï¼ˆé€šè¿‡ <code>std::thread</code> åˆ›å»ºï¼‰æ¥æ‰§è¡Œè¾“å‡ºï¼Œæ­¤æ—¶è¯¥ç¨‹åºå°±æœ‰ä¸¤ä¸ªçº¿ç¨‹å­˜åœ¨ï¼Œä¸€ä¸ªæ˜¯ä¸»çº¿ç¨‹ä» <code>main()</code> å¼€å§‹æ‰§è¡Œï¼Œå¦ä¸€ä¸ªå°±æ˜¯æ–°çš„å­çº¿ç¨‹ä» <code>foo()</code> å¼€å§‹æ‰§è¡Œã€‚</p><p>å½“æ–°çº¿ç¨‹å¯åŠ¨ä¹‹åï¼Œä¸»çº¿ç¨‹ä¹Ÿåœ¨åŒæ­¥æ‰§è¡Œã€‚ä¸»çº¿ç¨‹æœ‰å¯èƒ½æ‰§è¡Œåœ°æ¯”è¾ƒå¿«ï¼Œå¦‚æœä¸ç­‰å¾…å­çº¿ç¨‹æ‰§è¡Œå®Œï¼Œä¼šç›´æ¥æ‰§è¡Œåˆ° <code>main()</code> ç»“æŸï¼Œå¯èƒ½ä¼šåœ¨å­çº¿ç¨‹ <code>foo()</code> è¿˜æœªæ‰§è¡Œç»“æŸå°±ç»“æŸæ•´ä¸ªç¨‹åºã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨ <code>join()</code> ä½¿å¾—ä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹ã€‚</p><p>è¿™æ˜¯ä¸ªå¾ˆç®€ç­”çš„ç¨‹åºï¼Œå®é™…ä¸Šä½¿ç”¨å¤šçº¿ç¨‹æ˜¯æ¯”è¾ƒå¤šä½™çš„ã€‚ä½†æ˜¯åé¢ä¼šé‡åˆ°å¾ˆå¤šæ¯”è¾ƒç»å…¸ã€å¤æ‚çš„ç¨‹åºã€‚å…·ä½“çš„åŸºæœ¬ C++ å¤šçº¿ç¨‹ï¼ˆstd::threadï¼‰å·¥å…·çš„ç”¨æ³•ï¼Œè¿›é˜¶çš„å¹¶å‘ç¨‹åºä»¥åŠé«˜çº§çº¿ç¨‹ç®¡ç†ç­‰çŸ¥è¯†éƒ½ä¼šåœ¨åç»­æ…¢æ…¢æ›´æ–° DAâ­ZE ~</p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ol><li><a href="https://nj.gitbooks.io/c/content/content/chapter1/chapter1-chinese.html">ã€ŠC++å¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ç¬¬1ç«  ä½ å¥½ï¼ŒC++çš„å¹¶å‘ä¸–ç•Œ!</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å¤šçº¿ç¨‹å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
      <tag>std::thread</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 æ‰¬å·å¤§å­¦ç™¾åº¦ä¹‹æ˜Ÿã€ç è¹„æ¯æ ¡å†…é€‰æ‹”èµ›é¢˜è§£</title>
    <link href="/2024/12/16/2024YZUastar/"/>
    <url>/2024/12/16/2024YZUastar/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æº: <a href="https://www.pixiv.net/artworks/89088195">pixiv_id=89088195</a></p><h2 id="A-ç‰©ç†å­¦å®¶çš„ä¼ è¯´"><strong>A. ç‰©ç†å­¦å®¶çš„ä¼ è¯´</strong></h2><h3 id="é¢˜ç›®æè¿°"><strong>é¢˜ç›®æè¿°</strong></h3><p>å®šä¹‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> ä¸ºæ­£æ•´æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> æ¯ä¸€ä½æ•°å­—çš„ä¹˜ç§¯ã€‚ç»™å®šä¸¤ä¸ªæ•´æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>ï¼Œè®¡ç®—ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mi>l</mi></mrow><mi>r</mi></munderover><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mo stretchy="false">(</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup><mo>+</mo><mn>7</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\prod_{i=l}^r f(i)) \mod (10^9+7)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.9535em;vertical-align:-1.3021em;"></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">))</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">7</span><span class="mclose">)</span></span></span></span></span></p><p><a href="https://www.luogu.com.cn/problem/T454241">ã€Œ2024 ç™¾åº¦ä¹‹æ˜Ÿé€‰æ‹”èµ›ã€ç‰©ç†å­¦å®¶çš„ä¼ è¯´</a></p><h3 id="è§£é¢˜æ€è·¯-æ¨¡æ‹Ÿ-æ•°å­¦"><strong>è§£é¢˜æ€è·¯</strong> æ¨¡æ‹Ÿ + æ•°å­¦</h3><p>ç”±äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>l</mi><mo>â‰¤</mo><mi>r</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding="application/x-tex">1 \le l \le r \le 10^9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span>ï¼Œæ•…ç›´æ¥æš´åŠ›è®¡ç®—è‚¯å®šä¼šè¶…æ—¶ã€‚</p><p>æ˜¾ç„¶ï¼Œå½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>âˆ’</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo>&gt;</mo><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">r - l + 1 &gt;= 10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span> æ—¶ï¼Œåœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> åŒºé—´å†…ä¸€å®šä¼šå‡ºç°è‡³å°‘ä¸€ä¸ªæ•°å­—å…¶æ•°ä½ä¸­å­˜åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ã€‚å› æ­¤ï¼Œåœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>âˆ’</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo>â‰¤</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">r - l + 1 \le 10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span> çš„æƒ…å†µä¸‹ï¼Œè¿ä¹˜åç­”æ¡ˆä¸€å®šä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œæ­¤æ—¶ç›´æ¥è¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> å³å¯ï¼›å‰©ä½™çš„æƒ…å†µä¸‹ï¼Œç›´æ¥æš´åŠ›æ¨¡æ‹Ÿè®¡ç®—è¿ä¹˜è¾“å‡ºç­”æ¡ˆã€‚æ³¨æ„éœ€è¦å¼€ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>longÂ long</mtext></mrow><annotation encoding="application/x-tex">\text{long long}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">longÂ long</span></span></span></span></span>ã€‚æ¯æ¬¡æ¨¡æ‹Ÿè®¡ç®—é¡¶å¤šå¤§æ¦‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>80</mn></mrow><annotation encoding="application/x-tex">80</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">80</span></span></span></span> æ¬¡ï¼Œæ—¶é—´å¤æ‚åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> ll <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123;<br>    ll res = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span>(x) res = (res * (x % <span class="hljs-number">10</span>)) % mod, x /= <span class="hljs-number">10</span>;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        <span class="hljs-type">int</span> l, r; cin &gt;&gt; l &gt;&gt; r;<br>        <span class="hljs-keyword">if</span>(r - l + <span class="hljs-number">1</span> &gt;= <span class="hljs-number">10</span>) cout &lt;&lt; <span class="hljs-number">0</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        <span class="hljs-keyword">else</span>&#123;<br>            ll ans = <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = l; i &lt;= r; i ++ ) ans = (ans * <span class="hljs-built_in">f</span>(i)) % mod;<br>            cout &lt;&lt; ans &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="B-æœªçŸ¥ä¹‹èŠ±ã€é­…çŸ¥ä¹‹æ—…"><strong>B. æœªçŸ¥ä¹‹èŠ±ã€é­…çŸ¥ä¹‹æ—…</strong></h2><h3 id="é¢˜ç›®æè¿°-2"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>01</mn></mrow><annotation encoding="application/x-tex">01</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">01</span></span></span></span> çŸ©é˜µã€‚ å®šä¹‰åˆæ³•è·¯å¾„ä¸ºï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> ä¸ºèµ·ç‚¹ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(n, m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> ä¸ºç»ˆç‚¹ï¼Œæ¯æ¬¡ç§»åŠ¨åªèƒ½å‘å³æˆ–å‘ä¸‹ã€‚ä¸”è·¯å¾„ä¸­è‡³å°‘æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> ä¸ªå…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼ŒåŒæ—¶è‡³å°‘æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> ä¸ªå…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ã€‚</p><p>ä¸¤æ¡è·¯å¾„ä¸åŒå½“ä¸”ä»…å½“ä¸¤æ¡è·¯å¾„ä¸­è‡³å°‘æœ‰ä¸€ä¸ªé€šè¿‡çš„ä½ç½®ä¸åŒã€‚æ±‚ç»™å®šçŸ©é˜µä¸­ä¸€å…±æœ‰å¤šå°‘æ¡åˆæ³•è·¯å¾„ã€‚ç­”æ¡ˆå¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>998244353</mn></mrow><annotation encoding="application/x-tex">998244353</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">998244353</span></span></span></span> å–æ¨¡ã€‚</p><p><a href="https://www.luogu.com.cn/problem/T454249">ã€Œ2024 ç™¾åº¦ä¹‹æ˜Ÿé€‰æ‹”èµ›ã€æœªçŸ¥ä¹‹èŠ±ã€é­…çŸ¥ä¹‹æ—…</a></p><h3 id="è§£é¢˜æ€è·¯-çŠ¶æ€æœºDP-æ»šåŠ¨æ•°ç»„"><strong>è§£é¢˜æ€è·¯</strong> çŠ¶æ€æœºDP + æ»šåŠ¨æ•°ç»„</h3><p>æ­¤é¢˜å¯ä»¥ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³ã€‚å®šä¹‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i][j][k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span> ä¸ºåˆ°è¾¾ä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> ä¸”ç»è¿‡äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä¸ªå…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> çš„è·¯å¾„æ¡æ•°ã€‚çŠ¶æ€è¿™æ ·å®šä¹‰çš„å¦™å¤„åœ¨äºï¼Œç»™å®šçŸ©é˜µæ˜¯ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>01</mn></mrow><annotation encoding="application/x-tex">01</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">01</span></span></span></span> çŸ©é˜µï¼Œæ•…æˆ‘ä»¬åªéœ€è¦ç”¨ä¸€ä¸ªç»´åº¦æ¥è®°å½• <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> æˆ– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> çš„ä¸ªæ•°ï¼ˆæ­¤å¤„è®°å½•çš„æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> çš„ä¸ªæ•°ï¼‰ï¼Œå‡è®¾åˆ°è¾¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> ç»è¿‡äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œæ˜¾ç„¶å¯ä»¥çŸ¥é“ç»è¿‡äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>+</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo>âˆ’</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">i + j - 1 - k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ã€‚</p><p>åˆå§‹çŠ¶æ€ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>g</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">dp[1][1][g[1][1]] = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ã€‚ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo>+</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>g</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>g</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mn>1</mn><mtext>Â andÂ </mtext><mi>k</mi><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases}dp[i][j][k] = dp[i - 1][j][k] + dp[i][j - 1][k], &amp; g[i][j] = 0\\\\dp[i][j][k] = dp[i - 1][j][k - 1] + dp[i][j - 1][k - 1], &amp; g[i][j] = 1 \ \text{and} \ k &gt; 0\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â©</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â¨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â§</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mpunct">,</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span><span class="mspace">Â </span><span class="mord text"><span class="mord">and</span></span><span class="mspace">Â </span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>ä½†æ˜¯ï¼Œç”±äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo>â‰¤</mo><mn>300</mn></mrow><annotation encoding="application/x-tex">1 \le n, m \le 300</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">300</span></span></span></span>ï¼ŒæŒ‰ç…§ä¸Šé¢çš„çŠ¶æ€å®šä¹‰æˆ‘ä»¬éœ€è¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>300</mn><mo>Ã—</mo><mn>300</mn><mo>Ã—</mo><mn>600</mn></mrow><annotation encoding="application/x-tex">300 \times 300 \times 600</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">300</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">300</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">600</span></span></span></span> çš„ç©ºé—´ï¼Œä¼šå¯¼è‡´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>MLE</mtext></mrow><annotation encoding="application/x-tex">\text{MLE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">MLE</span></span></span></span></span>ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦è¿›è¡Œç©ºé—´ä¼˜åŒ–ã€‚</p><p>å¯ä»¥å‘ç°ï¼Œç¬¬ä¸€ä¸ªç»´åº¦æ¯ä¸ªçŠ¶æ€ä¹‹å’Œä¸Šä¸€å±‚æœ‰å…³ï¼Œå› æ­¤å¯ä»¥ç”¨æ»šåŠ¨æ•°ç»„æŠŠç¬¬ä¸€ä¸ªç»´åº¦çš„ç©ºé—´ç›´æ¥ä¼˜åŒ–æ‰ï¼Œæœ€ååªéœ€è¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><mn>300</mn><mo>Ã—</mo><mn>600</mn></mrow><annotation encoding="application/x-tex">2\times 300 \times 600</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">300</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">600</span></span></span></span> çš„ç©ºé—´å¼€é”€ã€‚æ»šåŠ¨æ•°ç»„åœ¨è¿›è¡Œä¸Šé¢çš„çŠ¶æ€è½¬ç§»æ—¶ï¼Œæ¯æ¬¡åœ¨æ›´æ–° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span> æ—¶ç”¨å®Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> è¿™ä¸€å±‚çš„çŠ¶æ€åéƒ½éœ€è¦å°†å…¶è¿›è¡Œæ¸…ç©ºï¼Œå¦åˆ™ä¼šå¯¼è‡´åœ¨ä¸‹ä¸€å±‚æ›´æ–° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i + 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> æ—¶çŠ¶æ€é‡å è€Œå‡ºé”™ã€‚</p><p>æœ€åæšä¸¾ç¬¬ä¸‰ä¸ªç»´åº¦ä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mi>m</mi><mo>âˆ’</mo><mn>1</mn><mo>âˆ’</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">n + m - 1 - p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> ç´¯åŠ ç»ˆç‚¹çŠ¶æ€å³ä¸ºç­”æ¡ˆã€‚ï¼ˆæ³¨æ„éœ€è¦åŒæ—¶ä¿è¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼‰ã€‚æ—¶é—´å¤æ‚åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>Ã—</mo><mi>m</mi><mo>Ã—</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \times m \times (n + m))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mclose">))</span></span></span></span>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">310</span>, mod = <span class="hljs-number">998244353</span>;<br><br><span class="hljs-type">int</span> n, m, p, q, g[N][N];<br>ll dp[<span class="hljs-number">2</span>][N][N &lt;&lt; <span class="hljs-number">1</span>];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m &gt;&gt; p &gt;&gt; q;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j ++ ) cin &gt;&gt; g[i][j];<br><br>    dp[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>][g[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j ++ )<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt;= i + j - <span class="hljs-number">1</span>; k ++ )&#123;<br>                <span class="hljs-keyword">if</span>(!g[i][j])&#123;<br>                    dp[i&amp;<span class="hljs-number">1</span>][j][k]=(dp[i&amp;<span class="hljs-number">1</span>][j][k]+dp[(i<span class="hljs-number">-1</span>)&amp;<span class="hljs-number">1</span>][j][k])%mod;<br>                    dp[i&amp;<span class="hljs-number">1</span>][j][k]=(dp[i&amp;<span class="hljs-number">1</span>][j][k]+dp[i&amp;<span class="hljs-number">1</span>][j<span class="hljs-number">-1</span>][k])%mod;<br>                &#125;<br>                <span class="hljs-keyword">if</span>(g[i][j] &amp;&amp; k)&#123;<br>                    dp[i&amp;<span class="hljs-number">1</span>][j][k]=(dp[i&amp;<span class="hljs-number">1</span>][j][k]+dp[(i<span class="hljs-number">-1</span>)&amp;<span class="hljs-number">1</span>][j][k<span class="hljs-number">-1</span>])%mod;<br>                    dp[i&amp;<span class="hljs-number">1</span>][j][k]=(dp[i&amp;<span class="hljs-number">1</span>][j][k]+dp[i&amp;<span class="hljs-number">1</span>][j<span class="hljs-number">-1</span>][k<span class="hljs-number">-1</span>])%mod;<br>                &#125;<br>            &#125;<br>        <span class="hljs-built_in">memset</span>(dp[(i<span class="hljs-number">-1</span>)&amp;<span class="hljs-number">1</span>], <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> dp[(i<span class="hljs-number">-1</span>)&amp;<span class="hljs-number">1</span>]); <span class="hljs-comment">// æ¸…ç©ºä¸Šä¸€å±‚</span><br>    &#125;<br><br>    ll ans = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = q; i &lt;= n + m - <span class="hljs-number">1</span> - p; i ++ ) ans = (ans+dp[n&amp;<span class="hljs-number">1</span>][m][i])%mod;<br>    cout &lt;&lt; ans &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;    <br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="C-ä¼ç“¦é²é­”æ³•å›¾ä¹¦é¦†"><strong>C. ä¼ç“¦é²é­”æ³•å›¾ä¹¦é¦†</strong></h2><h3 id="é¢˜ç›®æè¿°-3"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„æ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>ï¼Œå…± <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> æ¬¡è¯¢é—®ã€‚æ¯æ¬¡è¯¢é—®ä¸€ä¸ªåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>ï¼Œä»»é€‰ä¸€ä¸ªå¤§äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> çš„æ­£æ•´æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>ï¼Œæ±‚è¯¥åŒºé—´å†…æœ€å¤šæœ‰å¤šå°‘ä¸ªæ•°èƒ½è¢« <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> æ•´é™¤ã€‚<a href="https://www.luogu.com.cn/problem/T454251">ã€Œ2024 ç™¾åº¦ä¹‹æ˜Ÿé€‰æ‹”èµ›ã€ä¼ç“¦é²é­”æ³•å›¾ä¹¦é¦†</a></p><h3 id="è§£é¢˜æ€è·¯-è«é˜Ÿ-è´¨å› æ•°åˆ†è§£"><strong>è§£é¢˜æ€è·¯</strong> è«é˜Ÿ + è´¨å› æ•°åˆ†è§£</h3><p>æ˜¾ç„¶ï¼Œå½“é€‰æ‹© <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> ä¸ºè´¨å› æ•°æ—¶ï¼Œç­”æ¡ˆä¸€å®šæ›´ä¼˜ã€‚æ‰€ä»¥æˆ‘ä»¬è¦æ±‚åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> å†…ï¼Œæœ€å¤šæœ‰å¤šå°‘ä¸ªæ•°æœ‰è´¨å› å­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>ã€‚</p><p>ç”±äºä¸æ¶‰åŠä¿®æ”¹æ“ä½œï¼Œæ•…è€ƒè™‘ç”¨ç¦»çº¿è«é˜Ÿç»´æŠ¤ç­”æ¡ˆã€‚è®° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">mx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">x</span></span></span></span> ä¸ºæ¯ä¸ªè¯¢é—®åŒºé—´çš„ç­”æ¡ˆã€‚å¯¹äºæ¯ä¸ªè´¨æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>ï¼Œæˆ‘ä»¬éœ€è¦ç»´æŠ¤å½“å‰åŒºé—´å†…æœ‰å¤šå°‘å…ƒç´ å¯ä»¥è¢«è¿™ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> æ•´é™¤ï¼Œè®°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">cnt[p]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span></span></span></span>ï¼›åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç»´æŠ¤æœ‰å¤šå°‘ç§è´¨æ•° æ»¡è¶³ å½“å‰åŒºé—´å†…å¯ä»¥è¢«è¿™ä¸ªè´¨æ•°æ•´é™¤å…ƒç´ ä¸ªæ•°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>ï¼Œè®°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>c</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">num[c]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal">c</span><span class="mclose">]</span></span></span></span>ã€‚</p><p>åœ¨è«é˜Ÿè¿›è¡Œåˆ é™¤æ“ä½œæ—¶ï¼Œå¦‚æœå½“å‰æšä¸¾è´¨å› æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> å‡ºç°äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">mx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">x</span></span></span></span> ç­‰äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">cnt[p]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span></span></span></span>ï¼Œè€Œå·²ç»æ²¡æœ‰å¯ä»¥ æ»¡è¶³ å½“å‰åŒºé—´å¯ä»¥è¢«æŸä¸ªè´¨æ•°æ•´é™¤å…ƒç´ ä¸ªæ•°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> çš„è´¨å› æ•°äº†ï¼Œæ­¤æ—¶éœ€è¦è¿›è¡Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">mx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">x</span></span></span></span> éœ€è¦å‡ä¸€ï¼ˆåˆ é™¤æ¯æ¬¡åªèµ°ä¸€æ­¥ï¼‰ã€‚</p><p>å…¶ä»–éƒ¨åˆ†å°±æ˜¯è«é˜Ÿçš„æ¨¡æ¿ã€‚ï¼ˆ<a href="https://oi-wiki.org/misc/mo-algo/">è«é˜Ÿ OI Wiki</a>ï¼‰ã€‚åŸƒå¼ç­›å¤æ‚åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mi>log</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>m</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m \log (\log m))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">))</span></span></span></span>ï¼Œæ¯ä¸ªæ•°å­—è´¨å› å­éƒ½åªæœ‰å‡ ä¸ªï¼Œå¯è§†ä½œå¸¸æ•°ï¼Œæ•…æ­¤é¢˜è«é˜Ÿå¤æ‚åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><msqrt><mi>n</mi></msqrt><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \sqrt n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0503em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8003em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="padding-left:0.833em;">n</span></span><span style="top:-2.7603em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2397em;"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">5e4</span> + <span class="hljs-number">10</span>, M = <span class="hljs-number">1e6</span> + <span class="hljs-number">10</span>;<br><br>vector&lt;<span class="hljs-type">int</span>&gt; fac[M];<br><span class="hljs-type">bool</span> vis[M];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">work</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span></span>&#123; <span class="hljs-comment">// è´¨å› æ•°åˆ†è§£(åŸƒå¼ç­›)</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-keyword">if</span>(vis[i]) <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = i; j &lt;= n; j += i)&#123;<br>            vis[j] = <span class="hljs-literal">true</span>;<br>            fac[j].<span class="hljs-built_in">emplace_back</span>(i);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> n, m, len, a[N];<br><span class="hljs-type">int</span> mx, ans[N];  <span class="hljs-comment">// è®°å½•ç­”æ¡ˆ</span><br><span class="hljs-type">int</span> cnt[M]; <span class="hljs-comment">// cnt[p]: å½“å‰åŒºé—´å†…æœ‰ç›¸åŒè´¨å› å­pçš„å…ƒç´ ä¸ªæ•°</span><br><span class="hljs-type">int</span> num[M]; <span class="hljs-comment">// num[c]: å½“å‰åŒºé—´å†…æœ‰ç›¸åŒè´¨å› å­çš„å…ƒç´ ä¸ªæ•°ä¸ºcçš„è´¨å› æ•°ç§ç±»æ•°</span><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123;<br>    <span class="hljs-type">int</span> l, r, id;<br>    <span class="hljs-type">bool</span> <span class="hljs-keyword">operator</span> &lt; (<span class="hljs-type">const</span> node &amp;b) <span class="hljs-type">const</span> &#123;<br>        <span class="hljs-keyword">if</span>(l / len != b.l / len) <span class="hljs-keyword">return</span> l &lt; b.l;<br>        <span class="hljs-keyword">return</span> (l / len) &amp; <span class="hljs-number">1</span> ? r &lt; b.r : r &gt; b.r;<br>    &#125;<br>&#125;q[N];<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;p : fac[x])&#123;<br>        num[cnt[p]] -- ; <br>        cnt[p] ++ ; <br>        num[cnt[p]] ++ ; <br>        mx = <span class="hljs-built_in">max</span>(mx, cnt[p]);<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">del</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;p : fac[x])&#123;<br>        num[cnt[p]] -- ;<br>        <span class="hljs-comment">// æ²¡æœ‰å¯ä»¥ä½¿å¾—å½“å‰åŒºé—´è¢«æŸä¸ªè´¨æ•°æ•´é™¤å…ƒç´ ä¸ªæ•°ä¸º $c$ çš„è´¨å› æ•°</span><br>        <span class="hljs-keyword">if</span>(mx == cnt[p] &amp;&amp; !num[cnt[p]]) mx -- ;<br>        cnt[p] -- ;<br>        num[cnt[p]] ++ ;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-built_in">work</span>(M - <span class="hljs-number">7</span>);<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        cin &gt;&gt; n &gt;&gt; m;<br>        mx = <span class="hljs-number">0</span>, len = (<span class="hljs-type">int</span>)<span class="hljs-built_in">sqrt</span>(n);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, l, r; i &lt;= m; i ++ )&#123;<br>            cin &gt;&gt; l &gt;&gt; r;<br>            q[i] = node&#123;l, r, i&#125;;<br>        &#125;<br>        <span class="hljs-built_in">sort</span>(q + <span class="hljs-number">1</span>, q + m + <span class="hljs-number">1</span>);<br><br>        <span class="hljs-type">int</span> l = <span class="hljs-number">1</span>, r = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i ++ )&#123;<br>            <span class="hljs-keyword">while</span>(l &gt; q[i].l) <span class="hljs-built_in">add</span>(a[ -- l]);<br>            <span class="hljs-keyword">while</span>(r &lt; q[i].r) <span class="hljs-built_in">add</span>(a[ ++ r]);<br>            <span class="hljs-keyword">while</span>(l &lt; q[i].l) <span class="hljs-built_in">del</span>(a[l ++ ]);<br>            <span class="hljs-keyword">while</span>(r &gt; q[i].r) <span class="hljs-built_in">del</span>(a[r -- ]);<br>            ans[q[i].id] = mx;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i ++ ) cout &lt;&lt; ans[i] &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        <span class="hljs-keyword">while</span>(l &lt;= r) <span class="hljs-built_in">del</span>(a[l ++ ]); <span class="hljs-comment">// æ¸…ç©º</span><br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="D-æ˜æ—¥ä¹‹ç››ã€æ˜¨æ—¥ä¹‹ä¿—"><strong>D. æ˜æ—¥ä¹‹ç››ã€æ˜¨æ—¥ä¹‹ä¿—</strong></h2><h3 id="é¢˜ç›®æè¿°-4"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> æ¡è¾¹çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>DAG</mtext></mrow><annotation encoding="application/x-tex">\text{DAG}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">DAG</span></span></span></span></span>ï¼Œè¾¹æƒéƒ½ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œå¯èƒ½æœ‰é‡è¾¹ã€‚ä»»æ„é€‰æ‹©ä¸€æ¡è·¯å¾„ï¼Œæ‰€æœ‰è·¯å¾„é€‰æ‹©ç­‰æ¦‚ç‡ï¼Œè·¯å¾„çš„èµ·ç‚¹å’Œç»ˆç‚¹å¯ä»¥ç›¸åŒã€‚æ±‚é€‰æ‹©çš„è·¯å¾„é•¿åº¦çš„æœŸæœ›ã€‚ç­”æ¡ˆå¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>998244353</mn></mrow><annotation encoding="application/x-tex">998244353</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">998244353</span></span></span></span> å–æ¨¡ã€‚<a href="https://www.luogu.com.cn/problem/T454242">ã€Œ2024 ç™¾åº¦ä¹‹æ˜Ÿé€‰æ‹”èµ›ã€æ˜æ—¥ä¹‹ç››ã€æ˜¨æ—¥ä¹‹</a></p><h3 id="è§£é¢˜æ€è·¯-æ‹“æ‰‘æ’åº-DP-æœŸæœ›-é€†å…ƒ"><strong>è§£é¢˜æ€è·¯</strong> æ‹“æ‰‘æ’åº + DP + æœŸæœ› + é€†å…ƒ</h3><p>æ­¤é¢˜æ¯”è¾ƒç»å…¸ã€‚ç”±äºä»»æ„è·¯å¾„é€‰æ‹©ç­‰æ¦‚ç‡ï¼Œå› æ­¤ä¸€æ¡è·¯å¾„çš„æœŸæœ›å¯ä»¥ç”±å¦‚ä¸‹å…¬å¼è¡¨ç¤ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mo>=</mo><mfrac><mrow><mi>s</mi><mi>u</mi><mi>m</mi></mrow><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">E = \frac{sum}{tot}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7936em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>å…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span> ä¸ºæ‰€æœ‰è·¯å¾„çš„é•¿åº¦ä¹‹å’Œï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">tot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span></span></span></span> ä¸ºæ‰€æœ‰ä¸åŒè·¯å¾„çš„æ¡æ•°ã€‚</p><p>ç”±äºæ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>DAG</mtext></mrow><annotation encoding="application/x-tex">\text{DAG}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">DAG</span></span></span></span></span>ï¼Œè€ƒè™‘ç”¨æ‹“æ‰‘æ’åºDPè§£å†³æ­¤é¢˜ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[v]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span> è¡¨ç¤ºä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> ç‚¹ä¸ºç»“å°¾çš„æ‰€æœ‰è·¯å¾„çš„é•¿åº¦ä¹‹å’Œï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">cnt[v]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span> ä¸ºä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> ç‚¹ä¸ºç»“å°¾çš„æ‰€æœ‰ä¸åŒè·¯å¾„æ¡æ•°ã€‚æ˜¾ç„¶ï¼Œåªæœ‰ç›´æ¥è¿æ¥åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> ç‚¹çš„æœ‰å‘è¾¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> ä¼šå¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[v]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span> äº§ç”Ÿå½±å“ï¼Œå› æ­¤å¯ä»¥ç›´æ¥åœ¨æ‹“æ‰‘æ’åºè¿‡ç¨‹ä¸­è¿›è¡ŒDPçŠ¶æ€è½¬ç§»ã€‚</p><p>ç”±äºè·¯å¾„çš„èµ·ç‚¹å’Œç»ˆç‚¹å¯ä»¥ç›¸åŒï¼Œå› æ­¤å¯¹äºæ‰€æœ‰ç‚¹ï¼Œåˆå§‹æƒ…å†µä¸‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">dp[v] = 0, cnt[v] = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ã€‚æ‹“æ‰‘æ’åºè¿‡ç¨‹ä¸­çš„çŠ¶æ€è½¬ç§»å¦‚ä¸‹ï¼ˆå½“å‰ç‚¹ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span>ï¼Œå¯è¾¾ç‚¹ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span>ï¼‰ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo>+</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo>+</mo><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo>+</mo><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}dp[v] &amp;= dp[v] + dp[u] + cnt[u]\\\\cnt[v] &amp;= cnt[v] + cnt[u]\end{split}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">cnt[v]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span> éƒ¨åˆ†çš„è½¬ç§»æ¯”è¾ƒå¥½ç†è§£ã€‚æ¯”è¾ƒå®¹æ˜“å¿½è§†çš„æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[v]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span> çŠ¶æ€è½¬ç§»éƒ¨åˆ†ï¼Œéœ€è¦åŠ ä¸Š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">cnt[u]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span>ã€‚ç”±äºåˆ°è¾¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">cnt[u]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span> ç§ä¸åŒçš„è·¯å¾„ï¼Œè¾¹æƒä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œå› æ­¤æœ‰å‘è¾¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[v]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span> çš„è´¡çŒ®æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">cnt[u]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span>ï¼Œè€Œé <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ã€‚</p><p>æœ€åç­”æ¡ˆåªéœ€è¦åˆ†åˆ«ç´¯åŠ æ‰€æœ‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[v]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">cnt[v]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span>ï¼Œç„¶åç”¨å¿«é€Ÿå¹‚æ±‚è·¯å¾„æ¡æ•°çš„é€†å…ƒå³å¯å¾—åˆ°ç­”æ¡ˆã€‚æ—¶é—´å¤æ‚åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>, mod = <span class="hljs-number">998244353</span>;<br><br>ll dp[N], cnt[N];<br><span class="hljs-type">int</span> n, m, ind[N];<br>vector&lt;<span class="hljs-type">int</span>&gt; e[N];<br><br><span class="hljs-function">ll <span class="hljs-title">qmi</span><span class="hljs-params">(ll a, ll b, <span class="hljs-type">int</span> mod)</span></span>&#123;<br>    ll res = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span>(b)&#123;<br>        <span class="hljs-keyword">if</span>(b &amp; <span class="hljs-number">1</span>) res = (res * a) % mod;<br>        a = (a * a) % mod;<br>        b &gt;&gt;= <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">topo</span><span class="hljs-params">()</span></span>&#123;<br>    queue&lt;<span class="hljs-type">int</span>&gt; q;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        cnt[i] = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span>(!ind[i]) q.<span class="hljs-built_in">emplace</span>(i);<br>    &#125;<br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-type">int</span> u = q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;v : e[u])&#123;<br>            dp[v] = (dp[v] + dp[u] + cnt[u]) % mod;<br>            cnt[v] = (cnt[v] + cnt[u]) % mod;<br>            <span class="hljs-keyword">if</span>(!( -- ind[v])) q.<span class="hljs-built_in">emplace</span>(v);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, u, v; i &lt;= m; i ++ )&#123;<br>        cin &gt;&gt; u &gt;&gt; v;<br>        e[u].<span class="hljs-built_in">emplace_back</span>(v);<br>        ind[v] ++ ;<br>    &#125;<br><br>    <span class="hljs-built_in">topo</span>();<br><br>    ll sum = <span class="hljs-number">0</span>, tot = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        sum = (sum + dp[i]) % mod;<br>        tot = (tot + cnt[i]) % mod;<br>    &#125;<br>    cout &lt;&lt; (sum * <span class="hljs-built_in">qmi</span>(tot, mod - <span class="hljs-number">2</span>, mod) % mod) &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="E-é­”å¥³ä»¬çš„èˆè¸ä¼š"><strong>E. é­”å¥³ä»¬çš„èˆè¸ä¼š</strong></h2><h3 id="é¢˜ç›®æè¿°-5"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªæ— å‘å›¾ï¼Œæ¯æ¬¡å¯ä»¥æ‰§è¡Œä¸€æ¬¡å¦‚ä¸‹æ“ä½œï¼š</p><ul><li>ä»»æ„é€‰æ‹©ä¸€æ¡è¾¹ã€‚å°†é™¤è¿™æ¡è¾¹ä»¥å¤–çš„å…¶ä»–è¾¹çš„è¾¹æƒéƒ½å‡å» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ã€‚</li></ul><p>æ±‚æœ€å°‘å¤šå°‘æ¬¡æ“ä½œå¯ä»¥ä½¿å¾—ç¼–å·ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> çš„è¾¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S, T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span> $ç¡®ä¿åœ¨æ­¤æ— å‘å›¾çš„æœ€å°ç”Ÿæˆæ ‘ä¸­ã€‚</p><p><a href="https://www.luogu.com.cn/problem/T454244">ã€Œ2024 ç™¾åº¦ä¹‹æ˜Ÿé€‰æ‹”èµ›ã€é­”å¥³ä»¬çš„èˆè¸ä¼š</a></p><h3 id="è§£é¢˜æ€è·¯-æœ€å¤§æµï¼ˆæœ€å°å‰²ï¼‰"><strong>è§£é¢˜æ€è·¯</strong> æœ€å¤§æµï¼ˆæœ€å°å‰²ï¼‰</h3><p>ç”± <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mi>r</mi><mi>u</mi><mi>s</mi><mi>k</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">Kruskal</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">Kr</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">ka</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> ç®—æ³•å¯ä»¥çŸ¥é“ï¼Œå¦‚æœè¾¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S, T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span> æ˜¯å¿…é¡»è¾¹ï¼Œé‚£ä¹ˆåœ¨åŠ å…¥æ‰€æœ‰æƒå€¼å°äºç­‰äºè¾¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S, T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span> çš„è¾¹ä¹‹å‰ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> ä¸€å®šæ˜¯ä¸è¿é€šçš„ï¼Œç›´åˆ°åŠ å…¥äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S, T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span> æ‰ä¼šä½¿å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> è¿é€šï¼ˆå¦åˆ™å°±ä¼šå½¢æˆç¯ï¼Œè¯´æ˜ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S, T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span> ä¸æ˜¯å¿…é¡»è¾¹ï¼‰ã€‚</p><p>å¯¹äºé¢˜ä¸­æ‰€ç»™çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥é€†å‘æ€è€ƒè¿™ä¸ªæ“ä½œå¯¹å›¾çš„å½±å“ã€‚é€‰æ‹©ä¸€æ¡è¾¹ä¸åŠ¨ï¼Œå…¶ä»–è¾¹éƒ½å‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œæ ¹æ®ç›¸å¯¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä½œæ˜¯é€‰æ‹©äº†ä¸€æ¡è¾¹åŠ  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œå…¶ä»–è¾¹éƒ½ä¸åŠ¨ã€‚</p><p>æˆ‘ä»¬åªéœ€è¦è€ƒè™‘è¾¹æƒå°äºç­‰äºè¾¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S, T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span> çš„è¾¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>ï¼Œç”¨è¿™äº›è¾¹å»ºä¸€å¼ æ–°å›¾ã€‚å› æ­¤ï¼Œé—®é¢˜è½¬æ¢ä¸ºï¼Œæœ€å°‘éœ€è¦å¤šå°‘æ¬¡ä»»é€‰æ–°å›¾ä¸­çš„ä¸€æ¡è¾¹ä½¿å…¶åŠ  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> çš„æ“ä½œï¼Œæ‰èƒ½ä½¿å¾—æ–°å›¾ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> ä¸è¿é€šï¼Œä»è€Œä½¿å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S, T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span> ä¸ºä½¿å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> è¿é€šçš„å¿…é¡»è¾¹ã€‚</p><p>æ•…æˆ‘ä»¬å¯ä»¥è€ƒè™‘ç”¨æœ€å¤§æµæ¥è§£å†³æ­¤é—®é¢˜ã€‚æºç‚¹è®¾ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>ï¼Œæ±‡ç‚¹è®¾ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>ã€‚å»ºç«‹çš„æ–°å›¾ä¸­è¾¹çš„å®¹é‡è®¾ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>S</mi><mo separator="true">,</mo><mi>T</mi></mrow></msub><mo>âˆ’</mo><mi>w</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">w_{S, T} - w + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œæ„ä¸ºé€‰æ‹©è¿™æ¡è¾¹æœ€å°‘éœ€è¦æ“ä½œå¤šå°‘æ¬¡æ‰ä¼šä½¿å¾—è¾¹æƒè¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>S</mi><mo separator="true">,</mo><mi>T</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{S, T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ã€‚æˆ‘ä»¬éœ€è¦æ±‚çš„å°±æ˜¯æ±‚ä¸€ä¸ªå‰²è¾¹é›†ä½¿å¾—å›¾ä¸è¿é€šï¼ˆè¿›è€Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> è‚¯å®šä¸è¿é€šï¼‰ï¼Œä¸”è¿™ä¸ªè¾¹é›†çš„å®¹é‡ä¹‹å’Œæœ€å°ã€‚ ç”±æœ€å¤§æµæœ€å°å‰²å®šç†ï¼Œè·‘ä¸€è¾¹æœ€å¤§æµå³ä¸ºç­”æ¡ˆã€‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">dinic</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">ini</span><span class="mord mathnormal">c</span></span></span></span> ç®—æ³•æ—¶é—´å¤æ‚åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo>Ã—</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2 \times m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>ï¼Œä½†ç”±äºå»ºæ¨¡åå›¾çš„ç‰¹æ€§ï¼Œå¾€å¾€ä¸ä¼šè¿™ä¹ˆæ…¢ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">510</span>, M = <span class="hljs-number">4010</span>, inf = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-type">int</span> n, m, k, src, des;<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123; <span class="hljs-type">int</span> u, v, w; &#125;edge[M];<br><span class="hljs-type">int</span> h[N], e[M], ne[M], w[M], idx;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">int</span> c)</span></span>&#123;<br>    e[idx] = b, ne[idx] = h[a], w[idx] = c, h[a] = idx ++ ;<br>    e[idx] = a, ne[idx] = h[b], w[idx] = <span class="hljs-number">0</span>, h[b] = idx ++ ;<br>&#125;<br><br><span class="hljs-type">int</span> d[N], now[M];<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">memset</span>(d, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> d);<br>    queue&lt;<span class="hljs-type">int</span>&gt; q;<br>    q.<span class="hljs-built_in">emplace</span>(src);<br>    d[src] = <span class="hljs-number">0</span>, now[src] = h[src];<br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-type">int</span> u = q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; ~i; i = ne[i])&#123;<br>            <span class="hljs-type">int</span> v = e[i], c = w[i];<br>            <span class="hljs-keyword">if</span>(!c || ~d[v]) <span class="hljs-keyword">continue</span>;<br>            <br>            q.<span class="hljs-built_in">emplace</span>(v);<br>            d[v] = d[u] + <span class="hljs-number">1</span>, now[v] = h[v];<br><br>            <span class="hljs-keyword">if</span>(v == des) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> flow)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(u == des) <span class="hljs-keyword">return</span> flow;<br>    <span class="hljs-type">int</span> used = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = now[u]; ~i &amp;&amp; used &lt; flow; i = ne[i])&#123;<br>        now[u] = i;<br>        <span class="hljs-type">int</span> v = e[i], c = w[i];<br>        <span class="hljs-keyword">if</span>(c &amp;&amp; d[v] == d[u] + <span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-type">int</span> f = <span class="hljs-built_in">dfs</span>(v, <span class="hljs-built_in">min</span>(c, flow - used));<br>            w[i] -= f, w[i ^ <span class="hljs-number">1</span>] += f;<br>            used += f;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> used;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">dinic</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">bfs</span>()) res += <span class="hljs-built_in">dfs</span>(src, inf);<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, u, v, w; i &lt;= m; i ++ )&#123;<br>        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;<br>        edge[i] = node&#123;u, v, w&#125;;<br>    &#125;<br><br>    src = edge[k].u, des = edge[k].v;<br>    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i ++ )&#123;<br>        <span class="hljs-keyword">if</span>(i == k) <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-keyword">auto</span> [u, v, w] = edge[i];<br>        <span class="hljs-keyword">if</span>(w &lt;= edge[k].w)&#123;<br>            <span class="hljs-built_in">add</span>(u, v, edge[k].w - w + <span class="hljs-number">1</span>);<br>            <span class="hljs-built_in">add</span>(v, u, edge[k].w - w + <span class="hljs-number">1</span>);<br>        &#125;<br>    &#125;<br><br>    cout &lt;&lt; <span class="hljs-built_in">dinic</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="F-çŒ«çŒ«å·«å¥³çµæ¢¦"><strong>F. çŒ«çŒ«å·«å¥³çµæ¢¦</strong></h2><h3 id="é¢˜ç›®æè¿°-6"><strong>é¢˜ç›®æè¿°</strong></h3><p>ä¸€å…±æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªèŠ‚ç‚¹ï¼Œç¼–å· <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>âˆ¼</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1 \sim n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">h_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">h_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>âˆ¼</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1 \sim n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„äº’ä¸ç›¸åŒçš„æ•´æ•°ã€‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªèŠ‚ç‚¹æ„æˆä¸€æ£µæ ‘ï¼ŒçŒ«çŒ«åˆå§‹åœ¨é«˜åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„èŠ‚ç‚¹ä¸Šã€‚å¯ä»¥è¿›è¡Œè‹¥å¹²æ¬¡åœ¨èŠ‚ç‚¹ä¸Šæ”¾éšœç¢ç‰©çš„æ“ä½œï¼Œå¦‚æœå½“å‰æ”¾ç½®éšœç¢ç‰©çš„èŠ‚ç‚¹ä¸ºçŒ«çŒ«å¤„äºä½ç½®çš„èŠ‚ç‚¹ï¼ŒçŒ«çŒ«ä¼šç§»åŠ¨åˆ°å¯è¾¾çš„èŠ‚ç‚¹ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">h_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æœ€å¤§çš„èŠ‚ç‚¹ä¸Šã€‚ç§»åŠ¨åˆ°ç›¸é‚»çš„èŠ‚ç‚¹è®°ä¸ºä¸€æ¬¡ç§»åŠ¨ï¼Œæ±‚åœ¨æŸç§æ”¾ç½®æ–¹æ¡ˆä¸‹ï¼ŒçŒ«çŒ«æœ€å¤šå¯èƒ½ç§»åŠ¨çš„æ¬¡æ•°ã€‚<a href="https://www.luogu.com.cn/problem/T454243">ã€Œ2024 ç™¾åº¦ä¹‹æ˜Ÿé€‰æ‹”èµ›ã€çŒ«çŒ«å·«å¥³çµæ¢¦</a></p><h3 id="è§£é¢˜æ€è·¯-å€å¢æ±‚LCA-DP-å¹¶æŸ¥é›†"><strong>è§£é¢˜æ€è·¯</strong> å€å¢æ±‚LCA + DP + å¹¶æŸ¥é›†</h3><p>å¯ä»¥å‘ç°ï¼Œå‡è®¾å½“å‰çŒ«åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> ç‚¹ï¼Œæ”¾ä¸‹éšœç¢ç‰©åï¼ŒçŒ«ä¼šç§»åŠ¨åˆ°å¯è¾¾çš„æœ€é«˜ç‚¹ï¼Œç”±äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> ç‚¹è¢«å µä½ï¼Œæ­¤æ—¶çŒ«å†ä¹Ÿæ— æ³•è¿”å›åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> çš„å…¶ä»–å­æ ‘ã€‚ç”±æ­¤å¯çŸ¥ï¼Œæ¯æ¬¡çŒ«åªèƒ½ç§»åŠ¨åˆ°ä¸€ä¸ªå­æ ‘ä¸­ï¼Œå…¶è¡ŒåŠ¨è½¨è¿¹æ˜¯å›ºå®šçš„ï¼Œæ¯æ¬¡åªéœ€è¦æ‰¾åˆ°å¯ä»¥ç§»åŠ¨æœ€é•¿è·ç¦»çš„å­æ ‘è½¬ç§»è¿‡å»å³å¯ã€‚</p><p>è€ƒè™‘ç”¨ DP è§£å†³æ­¤é—®é¢˜ã€‚è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[u]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span> è¡¨ç¤ºä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘ï¼Œä¸”çŒ«åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> ç‚¹å¯ä»¥ç§»åŠ¨çš„æœ€é•¿è·ç¦»ã€‚ä»¤ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘ä¸­çš„æœ€é«˜ç‚¹ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>o</mi><msub><mi>s</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">pos_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œæ•…æœ‰å¦‚ä¸‹çŠ¶æ€è½¬ç§»ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo>=</mo><mi>max</mi><mo>â¡</mo><mo stretchy="false">{</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>p</mi><mi>o</mi><msub><mi>s</mi><mi>v</mi></msub><mo stretchy="false">]</mo><mo>+</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">dp[u] = \max \{dp[pos_v] + dist(u, v)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)}</span></span></span></span></span></p><p>å…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dist(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> ä¸ºæ ‘ä¸Šç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> ä¹‹é—´çš„è·ç¦»ã€‚</p><p>ç”±äºçŒ«æ˜¯ä»æœ€é«˜ç‚¹å¼€å§‹å‡ºå‘çš„ï¼Œå®¹æ˜“å‘ç°çŒ«çš„è¡ŒåŠ¨è½¨è¿¹ä¸€å®šæ˜¯ä¸€ä¸ªé«˜åº¦å•è°ƒé€’å‡çš„ç‚¹åˆ—ã€‚å› æ­¤ï¼Œåœ¨çŠ¶æ€è½¬ç§»è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä»é«˜åº¦æœ€ä½çš„ç‚¹å¼€å§‹æšä¸¾ï¼Œå¾—åˆ°è¾ƒä½ç‚¹çš„çŠ¶æ€æ‰èƒ½å¾—åˆ°æ›´é«˜ç‚¹çš„çŠ¶æ€ã€‚æ•…çŠ¶æ€è½¬ç§»æ—¶è¿˜éœ€æ»¡è¶³æ¡ä»¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mrow><mi>p</mi><mi>o</mi><msub><mi>s</mi><mi>v</mi></msub></mrow></msub><mo>&lt;</mo><msub><mi>h</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">h_{pos_v} &lt; h_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">o</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿çŠ¶æ€è½¬ç§»ï¼Œæˆ‘ä»¬è€ƒè™‘ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(h[u], h[v])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">])</span></span></span></span> çš„æ–¹å¼å»ºè¾¹ã€‚å¯¹äºæ ‘ä¸Šä¸¤ç‚¹è·ç¦»ï¼Œé‡‡ç”¨å€å¢æ±‚ LCA å³å¯ï¼›å¯¹äºç»´æŠ¤å­æ ‘ä¸­çš„æœ€é«˜å¯è¾¾ç‚¹ï¼Œé‡‡ç”¨å¹¶æŸ¥é›†ç»´æŠ¤å³å¯ã€‚æ³¨æ„å¼€ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>longÂ long</mtext></mrow><annotation encoding="application/x-tex">\text{long long}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">longÂ long</span></span></span></span></span>ã€‚æ—¶é—´å¤æ‚åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">2e5</span> + <span class="hljs-number">10</span>;<br><br>vector&lt;<span class="hljs-type">int</span>&gt; e[N];<br><span class="hljs-type">int</span> n, h[N], d[N], f[N][<span class="hljs-number">22</span>];<br>ll dp[N];  <span class="hljs-comment">// dp[u]ä»¥uä¸ºæ ¹èŠ‚ç‚¹å­æ ‘ï¼ŒçŒ«åœ¨uç‚¹ï¼Œå¯ä»¥èµ°çš„æœ€é•¿è·ç¦»</span><br><span class="hljs-type">int</span> fa[N]; <span class="hljs-comment">// fa[u]ç»´æŠ¤uä¸ºæ ¹èŠ‚ç‚¹å­æ ‘ä¸­æœ€é«˜çš„ç‚¹</span><br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123; <span class="hljs-keyword">return</span> fa[x] == x ? x : fa[x] = <span class="hljs-built_in">find</span>(fa[x]); &#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">bfs</span><span class="hljs-params">(<span class="hljs-type">int</span> src)</span></span>&#123;<br>    queue&lt;<span class="hljs-type">int</span>&gt; q;<br>    q.<span class="hljs-built_in">emplace</span>(src);<br>    d[src] = <span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-type">int</span> u = q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;v : e[u])&#123;<br>            <span class="hljs-keyword">if</span>(!d[v])&#123;<br>                d[v] = d[u] + <span class="hljs-number">1</span>, f[v][<span class="hljs-number">0</span>] = u;<br>                q.<span class="hljs-built_in">emplace</span>(v);<br>                <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>; k &lt;= <span class="hljs-number">20</span>; k ++ ) <br>                    f[v][k] = f[f[v][k - <span class="hljs-number">1</span>]][k - <span class="hljs-number">1</span>];<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">lca</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(d[a] &lt; d[b]) <span class="hljs-built_in">swap</span>(a, b);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">20</span>; ~k; k -- ) <br>        <span class="hljs-keyword">if</span>(d[f[a][k]] &gt;= d[b]) a = f[a][k];<br>    <span class="hljs-keyword">if</span>(a == b) <span class="hljs-keyword">return</span> a;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">20</span>; ~k; k -- )<br>        <span class="hljs-keyword">if</span>(f[a][k] != f[b][k]) a = f[a][k], b = f[b][k];<br>    <span class="hljs-keyword">return</span> f[a][<span class="hljs-number">0</span>]; <br>&#125;<br><span class="hljs-comment">// lcaæ±‚æ ‘ä¸Šä¸¤ç‚¹è·ç¦»</span><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">getd</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>&#123; <span class="hljs-keyword">return</span> d[x] + d[y] - <span class="hljs-number">2</span> * d[<span class="hljs-built_in">lca</span>(x, y)]; &#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; h[i];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, u, v; i &lt; n; i ++ )&#123;<br>        cin &gt;&gt; u &gt;&gt; v;<br>        u = h[u], v = h[v];<br>        e[u].<span class="hljs-built_in">emplace_back</span>(v);<br>        e[v].<span class="hljs-built_in">emplace_back</span>(u);<br>    &#125;<br><br>    <span class="hljs-built_in">bfs</span>(<span class="hljs-number">1</span>);<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) fa[i] = i;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> u = <span class="hljs-number">1</span>; u &lt;= n; u ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> v : e[u])&#123;<br>            v = <span class="hljs-built_in">find</span>(v);<br>            <span class="hljs-keyword">if</span>(v &lt; u) fa[v] = u, dp[u] = <span class="hljs-built_in">max</span>(dp[u], dp[v] + <span class="hljs-built_in">getd</span>(u, v));<br>        &#125;<br><br>    cout &lt;&lt; dp[n] &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="G-ç¥åœ£åº„ä¸¥çš„å¤§èµŒåœº"><strong>G. ç¥åœ£åº„ä¸¥çš„å¤§èµŒåœº</strong></h2><h3 id="é¢˜ç›®æè¿°-7"><strong>é¢˜ç›®æè¿°</strong></h3><p>æŠ•æ·ä¸‰ä¸ªéª°å­ï¼Œéª°å­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span> ç‚¹çš„é¢æ˜¯çº¢è‰²çš„ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>5</mn><mo separator="true">,</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">2, 3, 5, 6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">6</span></span></span></span> ç‚¹çš„é¢æ˜¯é»‘è‰²çš„ã€‚åˆ¤æ–­ä¸‰ä¸ªéª°å­æ˜¯å¦å¯ä»¥æ»¡è¶³æœä¸Šé¢çº¢è‰²ç‚¹æ•°ä¹‹å’Œä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> åŒæ—¶é»‘è‰²ç‚¹æ•°ä¹‹å’Œä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> ã€‚  <a href="https://www.luogu.com.cn/problem/T454245">ã€Œ2024 ç™¾åº¦ä¹‹æ˜Ÿé€‰æ‹”èµ›ã€ç¥åœ£åº„ä¸¥çš„å¤§èµŒåœº</a></p><h3 id="è§£é¢˜æ€è·¯-æšä¸¾"><strong>è§£é¢˜æ€è·¯</strong> æšä¸¾</h3><p>ç›´æ¥æš´åŠ›ä¸‰é‡å¾ªç¯æšä¸¾æ‰€æœ‰æ¸…ç©ºï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ»¡è¶³å³å¯ã€‚æ—¶é—´å¤æ‚åº¦å¸¸æ•°çº§ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">check</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">6</span>; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= <span class="hljs-number">6</span>; j ++ )<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>; k &lt;= <span class="hljs-number">6</span>; k ++ )&#123;<br>                <span class="hljs-type">int</span> r = <span class="hljs-number">0</span>, b = <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">if</span>(i == <span class="hljs-number">1</span> || i == <span class="hljs-number">4</span>) r += i;<br>                <span class="hljs-keyword">else</span> b += i;<br>                <span class="hljs-keyword">if</span>(j == <span class="hljs-number">1</span> || j == <span class="hljs-number">4</span>) r += j;<br>                <span class="hljs-keyword">else</span> b += j;<br>                <span class="hljs-keyword">if</span>(k == <span class="hljs-number">1</span> || k == <span class="hljs-number">4</span>) r += k;<br>                <span class="hljs-keyword">else</span> b += k;<br><br>                <span class="hljs-keyword">if</span>(r == x &amp;&amp; b == y) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> a, b; cin &gt;&gt; a &gt;&gt; b;<br>    cout &lt;&lt; (<span class="hljs-built_in">check</span>(a, b) ? <span class="hljs-string">&quot;Yes&quot;</span> : <span class="hljs-string">&quot;No&quot;</span>) &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="H-2024-å¹»æƒ³ä¹¡è¶Šé‡èµ›"><strong>H. 2024 å¹»æƒ³ä¹¡è¶Šé‡èµ›</strong></h2><h3 id="é¢˜ç›®æè¿°-8"><strong>é¢˜ç›®æè¿°</strong></h3><p>æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªäººï¼Œæ¯ä¸ªäººä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> å’Œ ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> è¡¨ç¤ºé€Ÿåº¦ã€‚æ¯ä¸ªäººå¯ä»¥å•ç‹¬è¡ŒåŠ¨ä¹Ÿå¯ä»¥é™„ç€åœ¨å…¶ä»–äººèº«ä¸Šä¸€èµ·è¡ŒåŠ¨ã€‚å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> é™„ç€åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸Šæ—¶ï¼š</p><ul><li><p>è‹¥é˜Ÿå‘˜ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> æ»¡è¶³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>â‰¥</mo><msub><mi>b</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">b_i \ge b_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œåˆ™é˜Ÿå‘˜ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ä¼šæ”¶åˆ°å½±å“ï¼Œé€Ÿåº¦ä»ç„¶ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼›</p></li><li><p>è‹¥é˜Ÿå‘˜ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> æ»¡è¶³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>&lt;</mo><msub><mi>b</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">b_i &lt; b_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œåˆ™é˜Ÿå‘˜ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> é€Ÿåº¦å˜ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>âˆ’</mo><mo stretchy="false">(</mo><msub><mi>b</mi><mi>j</mi></msub><mo>âˆ’</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">v_i - (b_j - b_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ã€‚</p></li></ul><p>å¦‚æœé™„ç€åä¼šå¯¼è‡´é€Ÿåº¦å˜ä¸ºè´Ÿæ•°ï¼Œåˆ™é™„ç€ä¸æˆç«‹ã€‚æœ€å¤šä¸¤ä¸ªäººä¸€èµ·è¡ŒåŠ¨ã€‚å®šä¹‰æ•´ä¸ªé˜Ÿä¼çš„é€Ÿåº¦ä¸ºä¸ºæœªé™„ç€åœ¨å…¶ä»–äººèº«ä¸Šçš„äººä¸­ï¼Œæœ€å°çš„é€Ÿåº¦ã€‚æ±‚å¯ä»¥è¾¾åˆ°çš„æœ€å¤§é€Ÿåº¦ã€‚</p><p><a href="https://www.luogu.com.cn/problem/T454246">ã€Œ2024 ç™¾åº¦ä¹‹æ˜Ÿé€‰æ‹”èµ›ã€2024 å¹»æƒ³ä¹¡è¶Šé‡èµ›</a></p><h3 id="è§£é¢˜æ€è·¯-äºŒåˆ†-è´ªå¿ƒ"><strong>è§£é¢˜æ€è·¯</strong> äºŒåˆ† + è´ªå¿ƒ</h3><p>æˆ‘ä»¬å¯ä»¥å…ˆå¯¹è¡¨è¾¾å¼è¿›è¡Œä¸€ä¸ªå˜å½¢ï¼Œå°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>âˆ’</mo><mo stretchy="false">(</mo><msub><mi>b</mi><mi>j</mi></msub><mo>âˆ’</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">v_i - (b_j - b_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> å˜ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>b</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">v_i + b_i - b_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ã€‚è‹¥æœ€ç»ˆå¯è¾¾çš„é€Ÿåº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span>ï¼Œæ‰€æœ‰é€Ÿåº¦å°äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span> çš„äººéƒ½å¿…é¡»é™„ç€åœ¨å…¶ä»–äººèº«ä¸Šã€‚</p><p>æ˜¾ç„¶é—®é¢˜å…·æœ‰å•è°ƒæ€§ï¼Œè€ƒè™‘äºŒåˆ†ç­”æ¡ˆã€‚æ¯æ¬¡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>h</mi><mi>e</mi><mi>c</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">check</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mord mathnormal">ec</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> æ—¶ï¼Œå°†æˆå‘˜æŒ‰ç…§ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>&lt;</mo><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">v_i &lt; ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>â‰¥</mo><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">v_i \ge ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span> åˆ†å¼€ã€‚å¯¹äºæ‰€æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>j</mi></msub><mo>&lt;</mo><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">v_j &lt; ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8252em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span> çš„æˆå‘˜ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>ï¼Œå¿…é¡»åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>j</mi></msub><mo>â‰¥</mo><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">v_j \ge ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9221em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span> çš„äººä¸­æ‰¾åˆ°ä¸€ä¸ªæˆå‘˜ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> å¯ä»¥æ»¡è¶³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>b</mi><mi>j</mi></msub><mo>â‰¥</mo><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">v_i + b_i - b_j \ge ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span>ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä»å¤§åˆ°å°æ’åºï¼Œè´ªå¿ƒåŒ¹é…æ¯ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>j</mi></msub><mo>&lt;</mo><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">v_j &lt; ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8252em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span> çš„æˆå‘˜é™„ç€åˆ°çš„æˆå‘˜ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ï¼Œè®©æ¯ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>j</mi></msub><mo>&lt;</mo><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">v_j &lt; ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8252em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span> çš„æˆå‘˜ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> åŒ¹é…åˆ°å¯åŒ¹é…çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i + b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æœ€å¤§çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>â‰¥</mo><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">v_i \ge ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span> çš„æˆå‘˜ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸Šå³å¯ã€‚å¦‚æœåœ¨åŒ¹é…è¿‡ç¨‹ä¸­å‡ºç° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>b</mi><mi>j</mi></msub><mo>&lt;</mo><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">v_i + b_i - b_j &lt; ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span>ï¼Œåˆ™è¡¨æ˜å½“å‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span> ä¸åˆæ³•ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span> éœ€è¦å‡å°ï¼›å¦åˆ™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span> åˆæ³•ã€‚æ—¶é—´å¤æ‚åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n (\log n)^2 )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MP make_pair</span><br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>;<br><br>pii p[N];<br><span class="hljs-type">int</span> n;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">bool</span> <span class="hljs-title">check</span><span class="hljs-params">(<span class="hljs-type">int</span> mid)</span></span>&#123;<br>    vector&lt;<span class="hljs-type">int</span>&gt; le, ge;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-keyword">auto</span> [v, b] = p[i];<br>        <span class="hljs-keyword">if</span>(v &gt;= mid) ge.<span class="hljs-built_in">emplace_back</span>(v + b);<br>        <span class="hljs-keyword">else</span> le.<span class="hljs-built_in">emplace_back</span>(b);<br>    &#125;<br><br>    <span class="hljs-type">int</span> szl = le.<span class="hljs-built_in">size</span>(), szg = ge.<span class="hljs-built_in">size</span>();<br>    <span class="hljs-keyword">if</span>(szl &gt; szg) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// ç‰¹åˆ¤</span><br>    <span class="hljs-built_in">sort</span>(<span class="hljs-built_in">begin</span>(ge), <span class="hljs-built_in">end</span>(ge), <span class="hljs-built_in">greater</span>&lt;<span class="hljs-type">int</span>&gt;());<br>    <span class="hljs-built_in">sort</span>(<span class="hljs-built_in">begin</span>(le), <span class="hljs-built_in">end</span>(le), <span class="hljs-built_in">greater</span>&lt;<span class="hljs-type">int</span>&gt;());<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; szl; i ++ )<br>        <span class="hljs-keyword">if</span>(ge[i] - le[i] &lt; mid) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        cin &gt;&gt; n;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, x, y; i &lt;= n; i ++ ) cin &gt;&gt; x &gt;&gt; y, p[i] = <span class="hljs-built_in">MP</span>(x, y);<br><br>        <span class="hljs-type">int</span> l = <span class="hljs-number">1</span>, r = <span class="hljs-number">1e9</span>;<br>        <span class="hljs-keyword">while</span>(l &lt; r)&#123;<br>            <span class="hljs-type">int</span> mid = l + r + <span class="hljs-number">1</span> &gt;&gt; <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">check</span>(mid)) l = mid;<br>            <span class="hljs-keyword">else</span> r = mid - <span class="hljs-number">1</span>;<br>        &#125;<br>        cout &lt;&lt; l &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å’å”±å…‰èŠ’</category>
      
      <category>æ‰¬å¤§æ ¡å†…é€‰æ‹”èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>ç®—æ³•ç«èµ›</tag>
      
      <tag>Luogu</tag>
      
      <tag>YAC</tag>
      
      <tag>é€‰æ‹”èµ›</tag>
      
      <tag>ç™¾åº¦ä¹‹æ˜Ÿ</tag>
      
      <tag>ç è¹„æ¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 æ‰¬å·å¤§å­¦ä¸å—é€šå¤§å­¦ GPLT è”è°Šé€‰æ‹”èµ›é¢˜è§£</title>
    <link href="/2024/12/16/2024YZUGPLT/"/>
    <url>/2024/12/16/2024YZUGPLT/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æº: <a href="https://www.pixiv.net/artworks/70531218">pixiv_id=70531218</a></p><h2 id="L1-1-æŠ“å…”å­ï¼Œæ£å¹´ç³•"><strong>L1-1 æŠ“å…”å­ï¼Œæ£å¹´ç³•</strong></h2><h3 id="é¢˜æ„æè¿°"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªè¿ç»­å­—ç¬¦ä¸²ï¼ŒåªåŒ…å«å°å†™è‹±æ–‡å­—æ¯ï¼Œæ‰¾å‡ºå­—ç¬¦ä¸²ä¸­æœ€å°çš„å­—ç¬¦ã€‚<a href="https://www.luogu.com.cn/problem/T428791">ã€Œ2024 æ‰¬å¤§GPLTé€‰æ‹”èµ›ã€L1-1 æŠ“å…”å­ï¼Œæ£å¹´ç³•</a></p><h3 id="è§£é¢˜æ–¹æ³•"><strong>è§£é¢˜æ–¹æ³•</strong></h3><p>å¾ˆç®€å•çš„ç­¾åˆ°é¢˜ï¼Œç›´æ¥æšä¸¾æ¯ä¸ªå­—ç¬¦å–æœ€å°å­—ç¬¦å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    string s; cin &gt;&gt; s;<br>    <span class="hljs-type">char</span> res = s[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;ch : s) res = <span class="hljs-built_in">min</span>(res, ch);<br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="L1-2-æœŸåˆè€ƒè¯•"><strong>L1-2 æœŸåˆè€ƒè¯•</strong></h2><h3 id="é¢˜æ„æè¿°-2"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªæ•´æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">a_1, a_2, \ldots, a_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œæ±‚å‡ºè¿™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªæ•´æ•°çš„å¹³å‡å€¼ã€‚ï¼ˆç»“æœä¿ç•™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span> ä½å°æ•°ï¼‰ <a href="https://www.luogu.com.cn/problem/T428797">ã€Œ2024 æ‰¬å¤§GPLTé€‰æ‹”èµ›ã€L1-2 æœŸåˆè€ƒè¯•</a></p><h3 id="è§£é¢˜æ–¹æ³•-2"><strong>è§£é¢˜æ–¹æ³•</strong></h3><p>éå¸¸ç®€å•çš„ç­¾åˆ°é¢˜ï¼Œæ±‚å‡ºæ€»å’Œæœ€åé™¤ä»¥æ•°é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> å³å¯ã€‚æ³¨æ„è¾“å‡ºç»“æœä¿ç•™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span> ä½å°æ•°ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">double</span> sum = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> n; cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, x; i &lt;= n; i ++ ) cin &gt;&gt; x, sum += x;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%.4lf\n&quot;</span>, sum / n);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="L1-3-æ…§éŸ³è€å¸ˆçš„é“¶æå¶"><strong>L1-3 æ…§éŸ³è€å¸ˆçš„é“¶æå¶</strong></h2><h3 id="é¢˜æ„æè¿°-3"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªå­¦ç”Ÿçš„ä¸‰é—¨è¯¾æˆç»©ï¼Œç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªå­¦ç”Ÿå­¦å·ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ã€‚å…ˆæŒ‰ç…§æˆç»©æ€»åˆ†ä»é«˜åˆ°ä½æ’åºï¼Œè‹¥æ€»åˆ†ä¸€æ ·å†æŒ‰ç…§ç¬¬ä¸€é—¨è¯¾ä»é«˜åˆ°ä½æ’åºï¼Œè‹¥ç¬¬ä¸€é—¨è¯¾ä¸€æ ·åˆ™æŒ‰ç…§å­¦å·ä»å°åˆ°å¤§æ’åºã€‚æœ€ç»ˆè¾“å‡ºå‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span> åå­¦ç”Ÿçš„å­¦å·å’Œæ€»åˆ†ã€‚<a href="https://www.luogu.com.cn/problem/T428895">ã€Œ2024 æ‰¬å¤§GPLTé€‰æ‹”èµ›ã€L1-3 æ…§éŸ³è€å¸ˆçš„é“¶æå¶</a></p><h3 id="è§£é¢˜æ–¹æ³•-ç»“æ„ä½“æ’åº"><strong>è§£é¢˜æ–¹æ³• ç»“æ„ä½“æ’åº</strong></h3><p>æœ¬é¢˜è€ƒå¯Ÿç»“æ„ä½“æ’åºï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç»“æ„ä½“å­˜å‚¨æ¯ä¸ªå­¦ç”Ÿçš„ç¬¬ä¸€é—¨è¯¾åˆ†æ•°ã€ä¸‰é—¨è¯¾æ€»åˆ†ä»¥åŠå­¦å·ï¼Œä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>sort</mtext></mrow><annotation encoding="application/x-tex">\text{sort}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord text"><span class="mord">sort</span></span></span></span></span> ç»“åˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>lambda</mtext></mrow><annotation encoding="application/x-tex">\text{lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">lambda</span></span></span></span></span> è¡¨è¾¾å¼è¿›è¡Œå¤šå…³é”®å­—æ’åºï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å¦å†™ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>cmp</mtext></mrow><annotation encoding="application/x-tex">\text{cmp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">cmp</span></span></span></span></span> å‡½æ•°ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">310</span>;<br><br><span class="hljs-type">int</span> n;<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123;<span class="hljs-type">int</span> a, sum, id;&#125;p[N];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, a, b, c; i &lt;= n; i ++ )&#123;<br>        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;<br>        p[i] = node&#123;a, a + b + c, i&#125;;<br>    &#125;<br><br>    <span class="hljs-built_in">sort</span>(p + <span class="hljs-number">1</span>, p + n + <span class="hljs-number">1</span>, [](node &amp;x, node &amp;y)&#123; <span class="hljs-comment">// lambda</span><br>        <span class="hljs-keyword">if</span>(x.sum != y.sum) <span class="hljs-keyword">return</span> x.sum &gt; y.sum;<br>        <span class="hljs-keyword">if</span>(x.a != y.a) <span class="hljs-keyword">return</span> x.a &gt; y.a;<br>        <span class="hljs-keyword">return</span> x.id &lt; y.id;<br>    &#125;);<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">5</span>; i ++ )&#123;<br>        <span class="hljs-keyword">auto</span> [a, sum, id] = p[i];<br>        cout &lt;&lt; id &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; sum &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="L1-4-åå°„Master"><strong>L1-4 åå°„Master</strong></h2><h3 id="é¢˜æ„æè¿°-4"><strong>é¢˜æ„æè¿°</strong></h3><p>ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ç­‰åˆ†çš„åœ†ï¼Œåœ†ä¸Šæœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªç­‰åˆ†ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>a</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">a_0, a_1, a_2, \ldots, a_{n-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>ã€‚ä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">a_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å‘ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">a_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> å°„å‡ºä¸€æ¡å…‰çº¿ï¼Œæ±‚ç»è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> æ¬¡åå°„åï¼Œæœ€ç»ˆå…‰çº¿å°„åˆ°åœ†ä¸Šçš„ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">a_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚<a href="https://www.luogu.com.cn/problem/T428893">ã€Œ2024 æ‰¬å¤§GPLTé€‰æ‹”èµ›ã€L1-4 åå°„Master</a></p><h3 id="è§£é¢˜æ–¹æ³•-æ•°å­¦"><strong>è§£é¢˜æ–¹æ³• æ•°å­¦</strong></h3><p>ç”±åŸºæœ¬çš„å¯¹ç§°æ€§è´¨ï¼Œç»è¿‡ç¬¬ä¸€æ¬¡åå°„åï¼Œåˆ°è¾¾äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">a_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ï¼›ç»è¿‡ç¬¬äºŒæ¬¡åå°„åï¼Œåˆ°è¾¾äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mn>2</mn><mo>Ã—</mo><mi>p</mi></mrow></msub></mrow><annotation encoding="application/x-tex">a_{2\times p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mbin mtight">Ã—</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> â€¦ æ­¤æ—¶å¯ä»¥å‘ç°ï¼Œå…‰çº¿æ‰€åˆ°ç‚¹ç§»åŠ¨çš„æ­¥é•¿å°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>ï¼Œè€Œéœ€è¦åå°„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> æ¬¡æ„å‘³ç€éœ€è¦ç»è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> æ¬¡ï¼Œç§»åŠ¨çš„æ€»é•¿åº¦å°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>Ã—</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">k \times p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>ã€‚ç”±äºæ˜¯åœ¨ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ç­‰åˆ†çš„åœ†ä¸Šç§»åŠ¨ï¼Œæ•…æœ€ç»ˆçš„ç­”æ¡ˆå°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>Ã—</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">k \times p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>mod</mtext></mrow><annotation encoding="application/x-tex">\text{mod}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">mod</span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ã€‚ï¼ˆæ³¨æ„éœ€è¦å¼€ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>longÂ long</mtext></mrow><annotation encoding="application/x-tex">\text{long long}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">longÂ long</span></span></span></span></span>ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    ll n, p, k; cin &gt;&gt; n &gt;&gt; p &gt;&gt; k;<br>    cout &lt;&lt; (k * p) % n &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="L1-5-å¹»æƒ³ä¹¡ç¨‹åºè®¾è®¡å¤§èµ›"><strong>L1-5 å¹»æƒ³ä¹¡ç¨‹åºè®¾è®¡å¤§èµ›</strong></h2><h3 id="é¢˜æ„æè¿°-5"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªèµ·å§‹å¹´ä»½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">y_l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªå¹´ä»½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">a_1, a_2, \ldots , a_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">y_l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å¹´å¼€å§‹ï¼Œç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">a_1, a_2, \ldots , a_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å¹´æ²¡æœ‰ä¸¾åŠæ¯”èµ›ï¼Œå…¶ä»–å¹´ä»½æ¯å¹´ä¸¾åŠä¸€æ¬¡ã€‚é—® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">y_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å¹´æ˜¯è‡ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">y_l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å¹´å¼€å§‹ç¬¬å‡ æ¬¡ä¸¾åŠæ¯”èµ›ã€‚ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">y_l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å¹´è®°ä¸ºç¬¬ä¸€æ¬¡ï¼Œä¿è¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>l</mi></msub><mo>â‰¤</mo><msub><mi>y</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">y_l \le y_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>l</mi></msub><mo>&lt;</mo><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_l &lt; a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼‰ <a href="https://www.luogu.com.cn/problem/T428890">ã€Œ2024 æ‰¬å¤§GPLTé€‰æ‹”èµ›ã€L1-5 å¹»æƒ³ä¹¡ç¨‹åºè®¾è®¡å¤§èµ›</a></p><h3 id="è§£æ³•ä¸€-æšä¸¾"><strong>è§£æ³•ä¸€ æšä¸¾</strong></h3><p>ä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">y_l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å¹´å¼€å§‹åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">y_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å¹´å…±æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><mi>m</mi><mo>=</mo><msub><mi>y</mi><mi>r</mi></msub><mo>âˆ’</mo><msub><mi>y</mi><mi>l</mi></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">sum = y_r - y_l + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å¹´ã€‚ç”±äºæ‰€ç»™å¹´ä»½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯å‡åºçš„ï¼Œæ•…æˆ‘ä»¬å¯ä»¥é¡ºåºæšä¸¾ç»Ÿè®¡å°äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">y_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„æ²¡æœ‰ä¸¾åŠæ¯”èµ›çš„å¹´ä»½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œæœ€åç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span> å‡å»ç»Ÿè®¡çš„å¹´ä»½æ•°é‡å³ä¸ºç­”æ¡ˆã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        <span class="hljs-type">int</span> l, r, n;<br>        cin &gt;&gt; l &gt;&gt; n;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">a</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br>        cin &gt;&gt; r;<br><br>        <span class="hljs-type">int</span> cnt = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n &amp;&amp; a[i] &lt; r; i ++ , cnt ++ );<br>        cout &lt;&lt; r - l + <span class="hljs-number">1</span> - cnt &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è§£æ³•äºŒ-äºŒåˆ†"><strong>è§£æ³•äºŒ äºŒåˆ†</strong></h3><p>ç”±äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> åŸæœ¬å°±æ˜¯å‡åºçš„ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ç”¨äºŒåˆ†æŸ¥æ‰¾æ‰¾åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸­ç¬¬ä¸€ä¸ªå¤§äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">y_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„å¹´ä»½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">a_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œè€Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">a_{k-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> å°±æ˜¯æœ€åä¸€ä¸ªå°äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">y_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„å¹´ä»½ï¼Œæ•…æ¯” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">y_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å°çš„å¹´ä»½æ•°é‡å°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ã€‚æœ€åç”¨å¹´ä»½æ€»æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><mi>m</mi><mo>âˆ’</mo><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">sum - (k-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> å³ä¸ºç­”æ¡ˆã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        <span class="hljs-type">int</span> l, r, n;<br>        cin &gt;&gt; l &gt;&gt; n;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">a</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br>        cin &gt;&gt; r;<br><br>        <span class="hljs-type">int</span> k = <span class="hljs-built_in">upper_bound</span>(a.<span class="hljs-built_in">begin</span>() + <span class="hljs-number">1</span>, a.<span class="hljs-built_in">end</span>(), r) - a.<span class="hljs-built_in">begin</span>();<br>        cout &lt;&lt; r - l + <span class="hljs-number">1</span> - (k - <span class="hljs-number">1</span>) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="L1-6-æƒŠäººçš„ç§˜å¯†"><strong>L1-6 æƒŠäººçš„ç§˜å¯†</strong></h2><h3 id="é¢˜æ„æè¿°-6"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„å­—ç¬¦ä¸²ï¼Œå­—ç¬¦å‡ºä¸­åªåŒ…å« <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ABCD</mtext></mrow><annotation encoding="application/x-tex">\text{ABCD}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">ABCD</span></span></span></span></span>ã€‚ç°åœ¨å¯ä»¥ä¿®æ”¹ä¸€äº›å­—ç¬¦ï¼Œæ±‚ä½¿å¾—å­—ç¬¦ä¸²ä¸­åªåŒ…å« <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>BC</mtext></mrow><annotation encoding="application/x-tex">\text{BC}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">BC</span></span></span></span></span> ä¸”ç›¸é‚»å­—ç¬¦éƒ½ä¸ç›¸åŒçš„æœ€å°‘ä¿®æ”¹æ¬¡æ•°ã€‚<a href="https://www.luogu.com.cn/problem/T428851">ã€Œ2024 æ‰¬å¤§GPLTé€‰æ‹”èµ›ã€L1-6 æƒŠäººçš„ç§˜å¯†</a></p><h3 id="è§£é¢˜æ–¹æ³•-æ€ç»´"><strong>è§£é¢˜æ–¹æ³• æ€ç»´</strong></h3><p>å­—ç¬¦ä¸²åªåŒ…å« <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>BC</mtext></mrow><annotation encoding="application/x-tex">\text{BC}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">BC</span></span></span></span></span> ä¸”ç›¸é‚»å­—ç¬¦éƒ½ä¸ç›¸åŒæ˜¾ç„¶åªæœ‰ä¸¤ç§å¯èƒ½ã€‚è¦ä¹ˆæ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>BCBCBC...</mtext></mrow><annotation encoding="application/x-tex">\text{BCBCBC...}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">BCBCBC...</span></span></span></span></span> çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯å¥‡æ•°ä½ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>B</mtext></mrow><annotation encoding="application/x-tex">\text{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">B</span></span></span></span></span>ï¼Œå¶æ•°ä½ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>C</mtext></mrow><annotation encoding="application/x-tex">\text{C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">C</span></span></span></span></span>ï¼›è¦ä¹ˆæ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>CBCBCB...</mtext></mrow><annotation encoding="application/x-tex">\text{CBCBCB...}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">CBCBCB...</span></span></span></span></span> çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯å¥‡æ•°ä½ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>C</mtext></mrow><annotation encoding="application/x-tex">\text{C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">C</span></span></span></span></span>ï¼Œå¶æ•°ä½ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>B</mtext></mrow><annotation encoding="application/x-tex">\text{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">B</span></span></span></span></span>ã€‚æ•…åªéœ€è¦ç»Ÿè®¡è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œæšä¸¾ç»Ÿè®¡æ¯ä¸€ä½æ˜¯å¦éœ€è¦ä¿®æ”¹ï¼Œæœ€ç»ˆå–ä¸¤ç§æƒ…å†µä¸‹çš„è¾ƒå°æ“ä½œæ¬¡æ•°å³ä¸ºç­”æ¡ˆã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> n; cin &gt;&gt; n;<br>    string s; cin &gt;&gt; s;<br>    s = <span class="hljs-string">&quot; &quot;</span> + s;<br>    <span class="hljs-type">int</span> cnt1 = <span class="hljs-number">0</span>, cnt2 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-type">char</span> c = s[i];<br>        <span class="hljs-keyword">if</span>(i &amp; <span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-keyword">if</span>(c != <span class="hljs-string">&#x27;B&#x27;</span>) cnt1 ++ ;<br>            <span class="hljs-keyword">if</span>(c != <span class="hljs-string">&#x27;C&#x27;</span>) cnt2 ++ ;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">if</span>(c != <span class="hljs-string">&#x27;C&#x27;</span>) cnt1 ++ ;<br>            <span class="hljs-keyword">if</span>(c != <span class="hljs-string">&#x27;B&#x27;</span>) cnt2 ++ ;<br>        &#125;<br>    &#125;<br>    cout &lt;&lt; <span class="hljs-built_in">min</span>(cnt1, cnt2) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="L1-7-è´¤è€…çš„å˜é‡æ›¿æ¢"><strong>L1-7 è´¤è€…çš„å˜é‡æ›¿æ¢</strong></h2><h3 id="é¢˜æ„æè¿°-7"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªå˜é‡ï¼Œæ¯ä¸ªå˜é‡æœ‰ä¸€ä¸ªåç§°å’Œå€¼ã€‚ç»™å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> ä¸ªå¥å­ï¼Œå°†æ¯ä¸ªå¥å­ä¸­çš„ <code>&#123;å˜é‡åç§°&#125;</code> æ›¿æ¢æˆå¯¹åº”çš„å€¼ã€‚<a href="https://www.luogu.com.cn/problem/T428897">ã€Œ2024 æ‰¬å¤§GPLTé€‰æ‹”èµ›ã€L1-7 è´¤è€…çš„å˜é‡æ›¿æ¢</a></p><h3 id="è§£é¢˜æ–¹æ³•-å“ˆå¸Œæ˜ å°„-å­—ç¬¦ä¸²æ“ä½œ"><strong>è§£é¢˜æ–¹æ³• å“ˆå¸Œæ˜ å°„ + å­—ç¬¦ä¸²æ“ä½œ</strong></h3><p>ç”±äºè¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯å¸¦ç©ºæ ¼çš„ï¼Œæ‰€ä»¥éœ€è¦åœ¨è¯»å…¥å­—ç¬¦ä¸²æ—¶ä½¿ç”¨ <code>getline(cin, s);</code></p><p>å¦‚æœåœ¨ä½¿ç”¨ <code>getline(cin, s)</code> ä¹‹å‰ä½¿ç”¨äº† <code>cin</code> ï¼Œä¼šå‰©ä½™ä¸€ä¸ª <code>\n</code> åœ¨ç¼“å†²åŒºä¸­ï¼Œè€Œæ­¤æ—¶ç›´æ¥ä½¿ç”¨ <code>getline(cin, s)</code> åˆ™ä¼šå¯¼è‡´è¯»å…¥äº†ä¸€ä¸ª <code>\n</code>ã€‚æ•…åœ¨ä½¿ç”¨ <code>getline(cin, s)</code> ä¹‹å‰ï¼Œå¯ä»¥ä½¿ç”¨ <code>cin.ignore()</code> æ¸…é™¤è¿™ä¸ªæ¢è¡Œç¬¦ <code>\n</code> ã€‚</p><p>å¯¹äºæ¯ä¸ªå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code>unordered_map</code> å»å­˜å‚¨ï¼Œä¸ºäº†æ–¹ä¾¿æ›¿æ¢ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å­˜å‚¨æ—¶å°±å°† <code>&#123;&#125;</code> åŠ åˆ°åç§°ä¸­ã€‚æ•°æ®è¾ƒå°ï¼Œæ•…æˆ‘ä»¬å¯ä»¥æšä¸¾æ¯ä¸ªå˜é‡ï¼Œç”¨ <code>find()</code> æ‰¾å‡ºå˜é‡å‡ºç°çš„ä½ç½®ï¼Œå°†å…¶ <code>replace()</code> æ‰å³å¯ï¼ˆå¦‚æœä¸çŸ¥é“ <code>replace()</code>ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œå­—ç¬¦ä¸²åˆ‡å‰²ï¼‰ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„åˆ°å­—ç¬¦ä¸²ä¸­å¯èƒ½å¤šæ¬¡å‡ºç°ä¸€ä¸ªå˜é‡ï¼Œæ‰€ä»¥æšä¸¾å˜é‡æ—¶éœ€è¦ <code>while</code> å¾ªç¯æ‰¾å‡ºæ‰€æœ‰çš„å½“å‰å˜é‡å‡ºç°çš„ä½ç½®ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br>unordered_map&lt;string, string&gt; mp;<br>string s, x;<br><span class="hljs-type">int</span> n, m;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">while</span>(n -- )&#123;<br>        cin &gt;&gt; s &gt;&gt; x;<br>        s = <span class="hljs-string">&quot;&#123;&quot;</span> + s + <span class="hljs-string">&quot;&#125;&quot;</span>;<br>        mp[s] = x;<br>    &#125;<br><br>    cin.<span class="hljs-built_in">ignore</span>();<br>    <span class="hljs-keyword">while</span>(m -- )&#123;<br>        <span class="hljs-built_in">getline</span>(cin, s);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;[t, val] : mp)&#123;<br>            <span class="hljs-type">int</span> pos = s.<span class="hljs-built_in">find</span>(t), len = t.<span class="hljs-built_in">size</span>();<br>            <span class="hljs-keyword">while</span>(pos != <span class="hljs-number">-1</span>)&#123;<br>                s = s.<span class="hljs-built_in">substr</span>(<span class="hljs-number">0</span>, pos) + val + s.<span class="hljs-built_in">substr</span>(pos + len);<br>                pos = s.<span class="hljs-built_in">find</span>(t);<br>            &#125;<br>        &#125;   <br>        cout &lt;&lt; s &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="L1-8-ä¸Šæµ·è“¬è±"><strong>L1-8 ä¸Šæµ·è“¬è±</strong></h2><h3 id="é¢˜æ„æè¿°-8"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>l</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l_i, r_i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>ï¼Œè¡¨ç¤ºåœ¨è¿™ä¸ªåŒºé—´å†…æœ‰äººæµ‡èŠ±ã€‚æ±‚å‡ºæœ€é•¿çš„è‡³å°‘æœ‰ä¸€ä¸ªäººæµ‡èŠ±çš„è¿ç»­æ—¶é—´æ®µé•¿åº¦ å’Œ æœ€é•¿åº¦æ— äººæµ‡èŠ±çš„è¿ç»­æ—¶é—´æ®µé•¿åº¦ã€‚<a href="https://www.luogu.com.cn/problem/T428859">ã€Œ2024 æ‰¬å¤§GPLTé€‰æ‹”èµ›ã€L1-8 ä¸Šæµ·è“¬è±</a></p><h3 id="è§£æ³•ä¸€-åŒºé—´åˆå¹¶"><strong>è§£æ³•ä¸€ åŒºé—´åˆå¹¶</strong></h3><p>æˆ‘ä»¬å¯ä»¥ç”¨åŒºé—´åˆå¹¶çš„æ€ç»´æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å…ˆå°†æ‰€æœ‰åŒºé—´æŒ‰ç…§å·¦ç«¯ç‚¹ä»å°åˆ°å¤§æ’åºï¼Œè®°å½•å½“å‰æœ‰äººæµ‡èŠ±åŒºé—´çš„å·¦ç«¯ç‚¹  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>lastl</mtext></mrow><annotation encoding="application/x-tex">\text{lastl}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">lastl</span></span></span></span></span> å’Œå³ç«¯ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>lastr</mtext></mrow><annotation encoding="application/x-tex">\text{lastr}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">lastr</span></span></span></span></span>ã€‚</p><p>é¡ºåºæšä¸¾æ¯ä¸ªåŒºé—´ï¼Œå¦‚æœåŒºé—´å·¦ç«¯ç‚¹å°äºç­‰äºå½“å‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>lastr</mtext></mrow><annotation encoding="application/x-tex">\text{lastr}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">lastr</span></span></span></span></span>ï¼Œåˆ™éœ€è¦åˆå¹¶åˆ°å‰ä¸€ä¸ªåŒºé—´ä¸­ï¼Œæ­¤æ—¶æ›´æ–° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>lastr</mtext></mrow><annotation encoding="application/x-tex">\text{lastr}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">lastr</span></span></span></span></span>ï¼›å¦åˆ™ï¼Œæˆ‘ä»¬æ›´æ–°æœ€é•¿æœ‰äººæµ‡èŠ±çš„è¿ç»­æ—¶é—´æ®µå’Œæœ€é•¿æ— äººæµ‡èŠ±çš„è¿ç»­æ—¶é—´æ®µï¼Œéšåå°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>lastl</mtext></mrow><annotation encoding="application/x-tex">\text{lastl}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">lastl</span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>lastr</mtext></mrow><annotation encoding="application/x-tex">\text{lastr}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">lastr</span></span></span></span></span> æ›´æ–°ä¸ºå½“å‰çš„åŒºé—´å³å¯ã€‚</p><p>æ³¨æ„å¾ªç¯ç»“æŸåè¿˜æœ‰æœ€åä¸€ä¸ªæœ‰äººæµ‡èŠ±çš„åŒºé—´ï¼Œæ‰€ä»¥éœ€è¦å†æ›´æ–°ä¸€æ¬¡æœ€é•¿æœ‰äººæµ‡èŠ±çš„è¿ç»­æ—¶é—´æ®µã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> fi first</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> se second</span><br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> n; cin &gt;&gt; n;<br>    <span class="hljs-function">vector&lt;pii&gt; <span class="hljs-title">a</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i].fi &gt;&gt; a[i].se;<br>    <span class="hljs-built_in">sort</span>(a.<span class="hljs-built_in">begin</span>() + <span class="hljs-number">1</span>, a.<span class="hljs-built_in">end</span>());<br><br>    <span class="hljs-type">int</span> res1 = <span class="hljs-number">0</span>, res2 = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> lst_l = a[<span class="hljs-number">1</span>].fi, lst_r = a[<span class="hljs-number">1</span>].se;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-keyword">auto</span> [l, r] = a[i];<br>        <span class="hljs-keyword">if</span>(lst_r &gt;= l) lst_r = <span class="hljs-built_in">max</span>(lst_r, r); <span class="hljs-comment">// åˆå¹¶åŒºé—´</span><br>        <span class="hljs-keyword">else</span>&#123;<br>            res1 = <span class="hljs-built_in">max</span>(res1, lst_r - lst_l);<br>            res2 = <span class="hljs-built_in">max</span>(res2, l - lst_r);<br>            lst_l = l, lst_r = r;<br>        &#125;<br>    &#125;<br>    res1 = <span class="hljs-built_in">max</span>(res1, lst_r - lst_l); <span class="hljs-comment">// æœ€åä¸€ä¸ªåŒºé—´</span><br><br>    cout &lt;&lt; res1 &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; res2 &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è§£æ³•äºŒ-å·®åˆ†"><strong>è§£æ³•äºŒ å·®åˆ†</strong></h3><p>å¯ä»¥ç”¨å·®åˆ†æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä½†æ˜¯è¦æ³¨æ„ä¸€ä¸ªæ¯”è¾ƒå‘çš„ç‚¹ï¼Œé¢˜ç›®ä¸­ä¸€ä¸ªåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>200</mn><mo separator="true">,</mo><mn>1000</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[200, 1000]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">200</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1000</span><span class="mclose">]</span></span></span></span> è¡¨ç¤ºæµ‡èŠ±çš„æ—¶é—´é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>800</mn></mrow><annotation encoding="application/x-tex">800</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">800</span></span></span></span>ï¼Œè€Œé <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>801</mn></mrow><annotation encoding="application/x-tex">801</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">801</span></span></span></span>ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬åº”å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> èŒƒå›´å†…éƒ½è¿›è¡Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span>ï¼Œå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo><mo>+</mo><mo>+</mo><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo>âˆ’</mo><mo>âˆ’</mo></mrow><annotation encoding="application/x-tex">b[l] ++ , b[r] --</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">+</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span></span></span></span> ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> fi first</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> se second</span><br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e6</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> b[N], n;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">1e9</span>, right = <span class="hljs-number">0</span>; <span class="hljs-comment">// è®°å½•å·¦å³è¾¹ç•Œ</span><br>    <span class="hljs-keyword">while</span>(n -- )&#123;<br>        <span class="hljs-type">int</span> l, r; cin &gt;&gt; l &gt;&gt; r;<br>        left = <span class="hljs-built_in">min</span>(left, l);<br>        right = <span class="hljs-built_in">max</span>(right, r);<br>        b[l] ++ , b[r] -- ;<br>    &#125;<br><br>    <span class="hljs-type">int</span> res1 = <span class="hljs-number">0</span>, res2 = <span class="hljs-number">0</span>, len1 = <span class="hljs-number">0</span>, len2 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = left; i &lt; right; i ++ )&#123;  <span class="hljs-comment">// æ³¨æ„èŒƒå›´</span><br>        b[i] += b[i - <span class="hljs-number">1</span>];   <span class="hljs-comment">// è¿˜åŸæ•°ç»„</span><br>        <span class="hljs-keyword">if</span>(b[i] &gt; <span class="hljs-number">0</span>) len1 ++ , len2 = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">else</span> len2 ++ , len1 = <span class="hljs-number">0</span>;<br>        res1 = <span class="hljs-built_in">max</span>(res1, len1);<br>        res2 = <span class="hljs-built_in">max</span>(res2, len2);<br>    &#125;<br><br>    cout &lt;&lt; res1 &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; res2 &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="L2-1-è•¾ç±³è‰äºšå·¡é€»è®°"><strong>L2-1 è•¾ç±³è‰äºšå·¡é€»è®°</strong></h2><h3 id="é¢˜æ„æè¿°-9"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„æ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>ï¼Œæ±‚æœ€é•¿çš„åŒºé—´å†…æ¯ä¸ªæ•°å­—ä¸é‡å¤å‡ºç°çš„åŒºé—´é•¿åº¦ã€‚<a href="https://www.luogu.com.cn/problem/T428892">ã€Œ2024 æ‰¬å¤§GPLTé€‰æ‹”èµ›ã€L2-1 è•¾ç±³è‰äºšå·¡é€»è®°</a></p><h3 id="è§£é¢˜æ–¹æ³•-åŒæŒ‡é’ˆ"><strong>è§£é¢˜æ–¹æ³• åŒæŒ‡é’ˆ</strong></h3><p>æˆ‘ä»¬å¯ä»¥ç”¨åŒæŒ‡é’ˆç»´æŠ¤ä¸€ä¸ªæ•°å­—ä¸é‡å¤å‡ºç°çš„çª—å£ã€‚å®šä¹‰ä¸€ä¸ª <code>unordered_map</code> è®°å½•æ¯ä¸ªæ•°å­—å‡ºç°çš„æ¬¡æ•°ã€‚</p><p>åŒæŒ‡é’ˆéå†æ—¶ï¼Œå³æŒ‡é’ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> å…ˆåŠ¨ï¼ŒåŒæ—¶æ›´æ–°æ•°å­—å‡ºç°æ¬¡æ•°ï¼Œè‹¥å‡ºç° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>p</mi><mo stretchy="false">[</mo><mi>a</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">mp[a[r]]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]]</span></span></span></span> <strong>å¤§äº</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> æ—¶ï¼Œæ­¤æ—¶éœ€è¦å°†å·¦æŒ‡é’ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> å‘å³ç§»åŠ¨ï¼Œåœ¨ç§»åŠ¨çš„åŒæ—¶æ›´æ–°æ•°å­—å‡ºç°æ¬¡æ•°ï¼Œç›´åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>p</mi><mo stretchy="false">[</mo><mi>a</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">mp[a[r]] = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä¸ºæ­¢ã€‚æ¯æ¬¡åŒæŒ‡é’ˆç§»åŠ¨è¿‡åï¼Œæ›´æ–°æœ€é•¿åŒºé—´é•¿åº¦ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br>unordered_map&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; mp; <span class="hljs-comment">// è®°å½•æ•°å­—å‡ºç°æ¬¡æ•°</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> n; cin &gt;&gt; n;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">a</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br><br>    <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> l = <span class="hljs-number">1</span>, r = <span class="hljs-number">1</span>; r &lt;= n; r ++ )&#123; <span class="hljs-comment">// åŒæŒ‡é’ˆç»´æŠ¤æ•°å­—åªå‡ºç°ä¸€æ¬¡çš„çª—å£</span><br>        mp[a[r]] ++ ;<br>        <span class="hljs-keyword">while</span>(mp[a[r]] &gt; <span class="hljs-number">1</span>) mp[a[l ++ ]] -- ; <span class="hljs-comment">// a[l]æ¬¡æ•°-1ï¼Œlå‘å³ç§»åŠ¨</span><br>        res = <span class="hljs-built_in">max</span>(res, r - l + <span class="hljs-number">1</span>); <span class="hljs-comment">// æ›´æ–°ç­”æ¡ˆ</span><br>    &#125;<br><br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="L2-2-æœˆå…‰å›¢å­"><strong>L2-2 æœˆå…‰å›¢å­</strong></h2><h3 id="é¢˜æ„æè¿°-10"><strong>é¢˜æ„æè¿°</strong></h3><p>æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> æ¬¡æ“ä½œï¼Œæ“ä½œåˆ†ä¸ºä¸¤ç§ï¼š</p><p><code>1 l r</code>ï¼šè¡¨ç¤ºå°†ä»·å€¼ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo separator="true">,</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">l, l + 1, \ldots , r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> çš„å›¢å­ä¾æ¬¡æ”¾å…¥æ ˆä¸­ï¼›</p><p><code>2 k</code>ï¼šè¡¨ç¤ºå–å‡ºæ ˆé¡¶çš„å‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> å›¢å­ï¼Œè®¡ç®—è¿™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä¸ªå›¢å­çš„æ€»ä»·å€¼å¹¶è¾“å‡ºã€‚</p><p><a href="https://www.luogu.com.cn/problem/T428900">ã€Œ2024 æ‰¬å¤§GPLTé€‰æ‹”èµ›ã€L2-2 æœˆå…‰å›¢å­</a></p><h3 id="è§£é¢˜æ–¹æ³•-æ ˆ"><strong>è§£é¢˜æ–¹æ³• æ ˆ</strong></h3><p>æ ¹æ®é¢˜ç›® â€œå®½åº¦å´æ°å¥½åªå¯ä»¥å®¹å¾—ä¸‹ä¸€ä¸ªæœˆå…‰å›¢å­â€ï¼Œâ€œæ¯æ¬¡ä»ç®±å­ä¸­å–å›¢å­ åªèƒ½å–èµ°ç®±å­æœ€é¡¶éƒ¨çš„ä¸€ä¸ªå›¢å­â€ çš„æ¡ä»¶ï¼Œæˆ‘ä»¬æ˜¾ç„¶å¯ä»¥ç”¨ <strong>æ ˆ</strong> æ¥æ¨¡æ‹Ÿä¸¤ç§æ“ä½œã€‚</p><p>å¦‚æœåœ¨æ¨¡æ‹Ÿè¿‡ç¨‹ä¸­ï¼Œæ¯æ¬¡æ”¾å›¢å­æ“ä½œéƒ½ä¸€ä¸ªä¸€ä¸ªæ”¾ï¼Œéœ€è¦è¿›è¡Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>âˆ’</mo><mi>l</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r - l + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> æ¬¡å…¥æ ˆï¼›æ¯æ¬¡å–å‡ºå›¢å­æ“ä½œï¼Œéœ€è¦è¿›è¡Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> æ¬¡å‡ºæ ˆã€‚è¿™æ˜¾ç„¶æ˜¯ä¼šæ¶ˆè€—å¤§é‡æ—¶é—´çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¼˜åŒ–å­˜å‚¨æ•°æ®çš„æ–¹å¼ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç”¨äºŒå…ƒç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(l, r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span> ä½œä¸ºæ ˆä¸­å­˜å‚¨çš„å…ƒç´ ã€‚</p><ul><li><p>å¯¹äºæ”¾å›¢å­çš„æ“ä½œï¼Œæˆ‘ä»¬ç›´æ¥å°†äºŒå…ƒç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(l, r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span> å‹å…¥æ ˆä¸­ï¼›</p></li><li><p>å¯¹äºå–å›¢å­çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿæ­¤æ—¶æ ˆé¡¶çš„äºŒå…ƒç»„é•¿åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>âˆ’</mo><mi>l</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r - l + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> æ˜¯å¦è¶…è¿‡äº†å½“å‰æ‰€éœ€å›¢å­æ•°é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ã€‚</p><p>å¦‚æœè¶…è¿‡äº†ï¼Œç”¨ç­‰æ¯”æ•°åˆ—æ±‚å’Œå¾—å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>getsum</mtext><mo stretchy="false">(</mo><mi>r</mi><mo>âˆ’</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{getsum}(r - k + 1, r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">getsum</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span> ç´¯åŠ ç­”æ¡ˆï¼ŒåŒæ—¶éœ€è¦æ›´æ–°æ ˆé¡¶çš„å³åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>âˆ’</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">r - k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ï¼Œæ‰€éœ€æ•°é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ç½®ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼›</p><p>å¦åˆ™ï¼Œæ±‚å‡ºæ ˆé¡¶äºŒå…ƒç»„çš„ç­‰æ¯”æ•°åˆ—æ±‚å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>getsum</mtext><mo stretchy="false">(</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{getsum}(l, r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">getsum</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span> ç´¯åŠ ç­”æ¡ˆï¼Œå¹¶ä¸”å½“å‰æ ˆé¡¶äºŒå…ƒç»„ç›´æ¥å‡ºæ ˆï¼Œæ‰€éœ€æ•°é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> å‡å»åŒºé—´é•¿åº¦ã€‚</p><p>å½“æ‰€éœ€æ•°é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> å‡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> æ—¶ï¼Œé€€å‡ºå¾ªç¯ï¼Œè¾“å‡ºç­”æ¡ˆã€‚</p></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">5e5</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> top;<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123;ll l, r;&#125;st[N];<br><br><span class="hljs-function">ll <span class="hljs-title">get_sum</span><span class="hljs-params">(ll l, ll r)</span></span>&#123; <span class="hljs-keyword">return</span> (r - l + <span class="hljs-number">1</span>) * (l + r) / <span class="hljs-number">2</span>; &#125; <br><span class="hljs-function">ll <span class="hljs-title">get_len</span><span class="hljs-params">(ll l, ll r)</span></span>&#123; <span class="hljs-keyword">return</span> r - l + <span class="hljs-number">1</span>; &#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> n; cin &gt;&gt; n;<br>    <span class="hljs-keyword">while</span>(n -- )&#123;<br>        <span class="hljs-type">int</span> op; cin &gt;&gt; op;<br>        <span class="hljs-keyword">if</span>(op == <span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-type">int</span> l, r; cin &gt;&gt; l &gt;&gt; r;<br>            st[ ++ top] = node&#123;l, r&#125;;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            ll k; cin &gt;&gt; k;<br>            ll res = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span>(k &gt; <span class="hljs-number">0</span>)&#123;<br>                <span class="hljs-keyword">auto</span> [l, r] = st[top];<br>                <span class="hljs-keyword">if</span>(k &lt; <span class="hljs-built_in">get_len</span>(l, r))&#123;  <span class="hljs-comment">// kä¸æ»¡æ ˆé¡¶å›¢å­çš„æ€»æ•°</span><br>                    res += <span class="hljs-built_in">get_sum</span>(r - k + <span class="hljs-number">1</span>, r);<br>                    st[top].r -= k;     <span class="hljs-comment">// æ›´æ–°æ ˆé¡¶çš„ r</span><br>                    k = <span class="hljs-number">0</span>;<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    res += <span class="hljs-built_in">get_sum</span>(l, r);<br>                    k -= <span class="hljs-built_in">get_len</span>(l, r); <span class="hljs-comment">// å‡å»æ ˆé¡¶å›¢å­æ€»æ•° </span><br>                    top -- ;            <span class="hljs-comment">// æ ˆé¡¶å‡ºæ ˆ</span><br>                &#125;<br>            &#125;<br>            cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="L2-3-ä½ å­˜åœ¨çš„ä»·å€¼"><strong>L2-3 ä½ å­˜åœ¨çš„ä»·å€¼</strong></h2><h3 id="é¢˜æ„æè¿°-11"><strong>é¢˜æ„æè¿°</strong></h3><p>æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªäººï¼Œæ¯ä¸ªäººæœ‰ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œä¸€ä¸ªä»·å€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>a</mi><msub><mi>l</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">val_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚å¦‚æœæœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">a_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>xor</mtext></mrow><annotation encoding="application/x-tex">\text{xor}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">xor</span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>v</mi></msub><mo>&gt;</mo><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mi>u</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>v</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a_v &gt; \max(a_u, a_v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œé‚£ä¹ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> ä¹‹é—´ç›¸äº’è®¤è¯†ï¼ˆè®¤è¯†å…³ç³»å…·æœ‰ä¼ é€’æ€§ï¼‰ã€‚æ±‚æ¯ä¸ªäººæ‰€å±è¿é€šå—çš„æ€»ä»·å€¼ã€‚<a href="https://www.luogu.com.cn/problem/T429782">ã€Œ2024 æ‰¬å¤§GPLTé€‰æ‹”èµ›ã€L2-3 ä½ å­˜åœ¨çš„ä»·å€¼</a></p><h3 id="è§£é¢˜æ–¹æ³•-å¹¶æŸ¥é›†-ä½è¿ç®—"><strong>è§£é¢˜æ–¹æ³• å¹¶æŸ¥é›† + ä½è¿ç®—</strong></h3><p>æˆ‘ä»¬å¯ä»¥ç”¨å¹¶æŸ¥é›†æ¥ç»´æŠ¤ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªç‚¹çš„è¿é€šæ€§ä»¥åŠè¿é€šå—çš„æ€»ä»·å€¼ã€‚å¦‚æœæš´åŠ›æšä¸¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">a_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">a_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯å¦æ»¡è¶³é¢˜ä¸­æ‰€éœ€æ¡ä»¶æ¥åˆå¹¶é›†åˆï¼Œæ˜¾ç„¶ä¼šè¶…æ—¶ã€‚</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> çš„å¤§å°ä¸è¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>30</mn></msup><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{30} - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">30</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä»äºŒè¿›åˆ¶ä½å…¥æ‰‹ã€‚</p><ul><li><p>è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>digit</mtext><mo stretchy="false">(</mo><mi>n</mi><mi>u</mi><mi>m</mi><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{digit}(num, k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">digit</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span> ä¸ºæ•°å­— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">num</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span> ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä½äºŒè¿›åˆ¶ä½çš„å€¼ã€‚</p></li><li><p>è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>highbit</mtext><mo stretchy="false">(</mo><mi>n</mi><mi>u</mi><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{highbit}(num)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">highbit</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> ä¸ºæ•°å­— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">num</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span> çš„æœ€é«˜çš„éé›¶ä½ã€‚</p></li></ul><p>å‡å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mi>u</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>v</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>a</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">\max(a_u, a_v) = a_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å¹¶ä¸”è¿™å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mi>u</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>v</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a_u, a_v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> æ˜¯æ»¡è¶³æ¡ä»¶çš„ã€‚å°†å…¶åˆ†è§£ä¸ºäºŒè¿›åˆ¶ã€‚å‡è®¾åˆ†è§£åç»“æœå¦‚ä¸‹ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>a</mi><mi>u</mi></msub><mo>=</mo><mn>101011</mn></mrow><annotation encoding="application/x-tex">a_u = 101011</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">101011</span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>a</mi><mi>v</mi></msub><mo>=</mo><mn>000101</mn></mrow><annotation encoding="application/x-tex">a_v = 000101</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">000101</span></span></span></span></span></p><p>æˆ‘ä»¬æ­¤æ—¶å¯ä»¥ç­”æ¡ˆçŒœæµ‹ä¸€ä¸‹ç»“è®ºã€‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">a_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„æœ€é«˜ä½ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>highbit</mtext><mo stretchy="false">(</mo><msub><mi>a</mi><mi>v</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{highbit}(a_v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">highbit</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œå½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">a_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>highbit</mtext><mo stretchy="false">(</mo><msub><mi>a</mi><mi>v</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{highbit}(a_v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">highbit</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ä½ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> æ—¶ï¼Œæ‰ä¼šä½¿å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">a_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>xor</mtext></mrow><annotation encoding="application/x-tex">\text{xor}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">xor</span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>v</mi></msub><mo>&gt;</mo><msub><mi>a</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">a_v &gt; a_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ã€‚</p><p>ä¹Ÿå°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>digit</mtext><mo stretchy="false">(</mo><msub><mi>a</mi><mi>u</mi></msub><mo separator="true">,</mo><mtext>highbit</mtext><mo stretchy="false">(</mo><msub><mi>a</mi><mi>v</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\text{digit}(a_u, \text{highbit}(a_v)) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">digit</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">highbit</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œæ‰æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">a_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>xor</mtext></mrow><annotation encoding="application/x-tex">\text{xor}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">xor</span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>v</mi></msub><mo>&gt;</mo><msub><mi>a</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">a_v &gt; a_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°è¯•ç”¨åè¯æ³•æ¥è¯æ˜ã€‚</p><p>å¦‚æœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>digit</mtext><mo stretchy="false">(</mo><msub><mi>a</mi><mi>u</mi></msub><mo separator="true">,</mo><mtext>highbit</mtext><mo stretchy="false">(</mo><msub><mi>a</mi><mi>v</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{digit}(a_u, \text{highbit}(a_v)) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">digit</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">highbit</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œé‚£ä¹ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">a_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>xor</mtext></mrow><annotation encoding="application/x-tex">\text{xor}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">xor</span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">a_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> åç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>highbit</mtext><mo stretchy="false">(</mo><msub><mi>a</mi><mi>v</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{highbit}(a_v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">highbit</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ä½å°±ä¼šå˜ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œæ­¤æ—¶å¾—åˆ°çš„ç»“æœæ˜¾ç„¶æ˜¯å°äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">a_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„ã€‚å› æ­¤ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>digit</mtext><mo stretchy="false">(</mo><msub><mi>a</mi><mi>u</mi></msub><mo separator="true">,</mo><mtext>highbit</mtext><mo stretchy="false">(</mo><msub><mi>a</mi><mi>v</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{digit}(a_u, \text{highbit}(a_v)) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">digit</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">highbit</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä¸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">a_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>xor</mtext></mrow><annotation encoding="application/x-tex">\text{xor}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">xor</span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>v</mi></msub><mo>&gt;</mo><msub><mi>a</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">a_v &gt; a_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> äº’ä¸ºå……è¦æ¡ä»¶ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æšä¸¾äºŒè¿›åˆ¶ä½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä½œä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>highbit</mtext></mrow><annotation encoding="application/x-tex">\text{highbit}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">highbit</span></span></span></span></span>ï¼Œä»¤ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><mi>d</mi><mo>=</mo><msup><mn>2</mn><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">mid = 2^{k + 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">mi</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œæ‰¾åˆ°æ‰€æœ‰ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä½ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> çš„ï¼Œå¹¶ä¸”å€¼ <strong>å¤§äºç­‰äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">mid</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">mi</span><span class="mord mathnormal">d</span></span></span></span> çš„æ‰€æœ‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">a_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong>ï¼›ä¹‹åï¼Œæ‰¾åˆ°æ‰€æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>highbit</mtext></mrow><annotation encoding="application/x-tex">\text{highbit}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">highbit</span></span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> çš„ï¼Œä¹Ÿå°±æ˜¯ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä½ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œå¹¶ä¸”å€¼ <strong>å°äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">mid</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">mi</span><span class="mord mathnormal">d</span></span></span></span> çš„æ‰€æœ‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">a_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong>ã€‚</p><p>å¯¹äºæ¯ä¸ªäºŒè¿›åˆ¶ä½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ï¼Œæ‰¾åˆ°çš„è¿™äº› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">a_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">a_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> éƒ½æ»¡è¶³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>digit</mtext><mo stretchy="false">(</mo><msub><mi>a</mi><mi>u</mi></msub><mo separator="true">,</mo><mtext>highbit</mtext><mo stretchy="false">(</mo><msub><mi>a</mi><mi>v</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\text{digit}(a_u, \text{highbit}(a_v)) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">digit</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">highbit</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œæ•…éœ€è¦å°†è¿™äº› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">a_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">a_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å…¨éƒ¨åˆå¹¶ã€‚</p><p>äºŒè¿›åˆ¶ä½å…¨éƒ¨æšä¸¾å®Œåï¼Œæœ€åä¾æ¬¡è¾“å‡ºæ¯ä¸ªäººæ‰€å±è¿é€šå—çš„æ€»ä»·å€¼ã€‚</p><p>ï¼ˆæ³¨æ„æ•°æ®èŒƒå›´ï¼Œè¿é€šå—ä»·å€¼éœ€è¦å¼€ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>longÂ long</mtext></mrow><annotation encoding="application/x-tex">\text{long long}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">longÂ long</span></span></span></span></span>ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> fa[N], a[N], n;<br>ll s[N];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123; <span class="hljs-keyword">return</span> fa[x] == x ? x : fa[x] = <span class="hljs-built_in">find</span>(fa[x]); &#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>&#123;<br>    <span class="hljs-type">int</span> fx = <span class="hljs-built_in">find</span>(x), fy = <span class="hljs-built_in">find</span>(y);<br>    <span class="hljs-keyword">if</span>(fx != fy) fa[fx] = fy, s[fy] += s[fx];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">get_k</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> k)</span></span>&#123; <span class="hljs-keyword">return</span> ((x &gt;&gt; k) &amp; <span class="hljs-number">1</span>); &#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) fa[i] = i, cin &gt;&gt; s[i];<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">29</span>; k &gt;= <span class="hljs-number">0</span>; k -- )&#123;<br>        <span class="hljs-type">int</span> mid = (<span class="hljs-number">1</span> &lt;&lt; (k + <span class="hljs-number">1</span>));<br>        vector&lt;<span class="hljs-type">int</span>&gt; v; <span class="hljs-comment">// å­˜å‚¨ a[u] å’Œ a[v]</span><br>        <span class="hljs-function">vector&lt;<span class="hljs-type">bool</span>&gt; <span class="hljs-title">flag</span><span class="hljs-params">(<span class="hljs-number">2</span>, <span class="hljs-literal">false</span>)</span></span>; <span class="hljs-comment">// flag[0] è®°å½•æ˜¯å¦æœ‰ a[u], flag[1] æ˜¯å¦æœ‰ a[v]</span><br>        <br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>            <span class="hljs-keyword">if</span>(!<span class="hljs-built_in">get_k</span>(a[i], k) &amp;&amp; a[i] &gt;= mid)<br>                v.<span class="hljs-built_in">push_back</span>(i), flag[<span class="hljs-number">0</span>] = <span class="hljs-literal">true</span>;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">get_k</span>(a[i], k) &amp;&amp; a[i] &lt; mid)<br>                v.<span class="hljs-built_in">push_back</span>(i), flag[<span class="hljs-number">1</span>] = <span class="hljs-literal">true</span>;<br><br>        <span class="hljs-keyword">if</span>(flag[<span class="hljs-number">0</span>] &amp;&amp; flag[<span class="hljs-number">1</span>])&#123;<br>            <span class="hljs-type">int</span> x = v[<span class="hljs-number">0</span>];<br>            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;y : v) <span class="hljs-built_in">merge</span>(x, y); <span class="hljs-comment">// åˆå¹¶</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cout &lt;&lt; s[<span class="hljs-built_in">find</span>(i)] &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="L2-4-æ¢¦æƒ³å¤©ç”Ÿ"><strong>L2-4 æ¢¦æƒ³å¤©ç”Ÿ</strong></h2><h3 id="é¢˜æ„æè¿°-12"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªå¤§å°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> çš„åœ°å›¾ï¼ŒåªåŒ…å«å°å†™è‹±æ–‡å­—ç¬¦ã€‚åœ°å›¾ä¸ºå…«è¿é€šï¼Œç§»åŠ¨çš„è·¯å¾„åªèƒ½ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>m</mtext><mo>â†’</mo><mtext>x</mtext><mo>â†’</mo><mtext>t</mtext><mo>â†’</mo><mtext>s</mtext><mo>â†’</mo><mtext>m</mtext><mo>â†’</mo><mtext>x</mtext><mo>â†’</mo><mo>â€¦</mo></mrow><annotation encoding="application/x-tex">\text{m} \rightarrow \text{x} \rightarrow \text{t} \rightarrow \text{s} \rightarrow \text{m} \rightarrow \text{x} \rightarrow \ldots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">m</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">x</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord text"><span class="mord">t</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">s</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">m</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">x</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.123em;"></span><span class="minner">â€¦</span></span></span></span> çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯æŒ‰ç…§å¾ªç¯å­—ç¬¦ä¸² <code>mxts</code> çš„é¡ºåºã€‚åˆ¤æ–­èƒ½å¦ä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> ç§»åŠ¨åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(n, m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> ã€‚<a href="https://www.luogu.com.cn/problem/T428901">ã€Œ2024 æ‰¬å¤§GPLTé€‰æ‹”èµ›ã€L2-4 æ¢¦æƒ³å¤©ç”Ÿ</a></p><h3 id="è§£é¢˜æ€è·¯-BFS"><strong>è§£é¢˜æ€è·¯ BFS</strong></h3><p>æ¯”è¾ƒå…¸å‹çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>BFS</mtext></mrow><annotation encoding="application/x-tex">\text{BFS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">BFS</span></span></span></span></span> æ¨¡æ¿é¢˜ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ª <code>unordered_map</code> è®°å½•æ¯ä¸ªå­—ç¬¦çš„ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼Œæ¯”å¦‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msup><mtext>m</mtext><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><annotation encoding="application/x-tex">&#x27;\text{m}&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord">m</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span> åé¢å¿…é¡»æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msup><mtext>x</mtext><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><annotation encoding="application/x-tex">&#x27;\text{x}&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>p</mi><msup><mo stretchy="false">[</mo><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msup><mtext>m</mtext><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">mp[&#x27;\text{m}&#x27;]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span><span class="mopen"><span class="mopen">[</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord">m</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msup><mtext>x</mtext><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><annotation encoding="application/x-tex">&#x27;\text{x}&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span> ã€‚å…¶ä½™çš„éƒ¨åˆ†å°±æ˜¯åŸºæœ¬çš„å¹¿åº¦ä¼˜å…ˆæœç´¢æ¨¡æ¿äº†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MP make_pair</span><br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> dx[<span class="hljs-number">8</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">-1</span>&#125;;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> dy[<span class="hljs-number">8</span>] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>&#125;;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">110</span>;<br><br>unordered_map&lt;<span class="hljs-type">char</span>, <span class="hljs-type">char</span>&gt; mp = &#123;<br>    &#123;<span class="hljs-string">&#x27;m&#x27;</span>, <span class="hljs-string">&#x27;x&#x27;</span>&#125;, &#123;<span class="hljs-string">&#x27;x&#x27;</span>, <span class="hljs-string">&#x27;t&#x27;</span>&#125;, &#123;<span class="hljs-string">&#x27;t&#x27;</span>, <span class="hljs-string">&#x27;s&#x27;</span>&#125;, &#123;<span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-string">&#x27;m&#x27;</span>&#125;<br>&#125;;<br><br><span class="hljs-type">int</span> n, m;<br><span class="hljs-type">char</span> g[N][N];<br><span class="hljs-type">bool</span> vis[N][N];<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">memset</span>(vis, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> vis);<br>    queue&lt;pii&gt; q;<br>    q.<span class="hljs-built_in">push</span>(<span class="hljs-built_in">MP</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>));<br>    vis[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = <span class="hljs-literal">true</span>;<br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-keyword">auto</span> [x, y] = q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">if</span>(x == n &amp;&amp; y == m) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">8</span>; k ++ )&#123;<br>            <span class="hljs-type">int</span> nx = x + dx[k], ny = y + dy[k];<br>            <span class="hljs-keyword">if</span>(nx &lt; <span class="hljs-number">1</span> || nx &gt; n || ny &lt; <span class="hljs-number">1</span> || ny &gt; m) <span class="hljs-keyword">continue</span>;<br>            <span class="hljs-keyword">if</span>(vis[nx][ny] || g[nx][ny] != mp[g[x][y]]) <span class="hljs-keyword">continue</span>;<br>            <br>            q.<span class="hljs-built_in">push</span>(<span class="hljs-built_in">MP</span>(nx, ny));<br>            vis[nx][ny] = <span class="hljs-literal">true</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        cin &gt;&gt; n &gt;&gt; m;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; (g[i] + <span class="hljs-number">1</span>);<br>        cout &lt;&lt; (<span class="hljs-built_in">bfs</span>() ? <span class="hljs-string">&quot;Yes&quot;</span> : <span class="hljs-string">&quot;No&quot;</span>) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="L3-1-é£ç¥å°‘å¥³çš„ç¥ç¦"><strong>L3-1 é£ç¥å°‘å¥³çš„ç¥ç¦</strong></h2><h3 id="é¢˜æ„æè¿°-13"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªç‚¹ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> æ¡æœ‰å‘è¾¹çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>DAG</mtext></mrow><annotation encoding="application/x-tex">\text{DAG}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">DAG</span></span></span></span></span>ã€‚æ¯æ¬¡å¯ä»¥èµ°åˆ°ä¸€ä¸ªç‚¹å½“ä¸”ä»…å½“èƒ½å¤Ÿåˆ°è¾¾è¿™ä¸ªç‚¹çš„æ‰€æœ‰ç‚¹éƒ½å·²ç»è¢«èµ°è¿‡ï¼ˆ <strong>æ‹“æ‰‘æ’åº</strong> ï¼‰ã€‚æ¯èµ°åˆ°ä¸€ä¸ª <strong>æ¯”ä¹‹å‰èµ°è¿‡çš„æ‰€æœ‰ç‚¹ç¼–å·éƒ½å¤§</strong> çš„ç‚¹ï¼Œæœ‰ä¸€å®šæ¦‚ç‡å¾—åˆ°ç¥ç¦ï¼Œä¹Ÿæœ‰ä¸€å®šæ¦‚ç‡æ”¶åˆ°æ”»å‡»ã€‚</p><p>æ±‚è§£ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li><p>æœ€ä¼˜æƒ…å†µä¸‹ï¼ˆæ¯æ¬¡éƒ½å¾—åˆ°ç¥ç¦ï¼‰ï¼Œé‡‡å–æœ€ä¼˜è¡Œèµ°ç­–ç•¥å¾—åˆ°çš„ç¥ç¦æ¬¡æ•°ã€‚</p></li><li><p>æœ€åæƒ…å†µä¸‹ï¼ˆæ¯æ¬¡éƒ½æ”¶åˆ°æ”»å‡»ï¼‰ï¼Œé‡‡å–æœ€ä¼˜è¡Œèµ°ç­–ç•¥æ”¶åˆ°çš„æ”»å‡»æ¬¡æ•°ã€‚</p></li></ul><p><a href="https://www.luogu.com.cn/problem/T430121">ã€Œ2024 æ‰¬å¤§GPLTé€‰æ‹”èµ›ã€L3-1 é£ç¥å°‘å¥³çš„ç¥ç¦</a></p><h3 id="è§£é¢˜æ–¹æ³•-æ‹“æ‰‘æ’åº-è´ªå¿ƒ"><strong>è§£é¢˜æ–¹æ³• æ‹“æ‰‘æ’åº + è´ªå¿ƒ</strong></h3><p>å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæ˜¾ç„¶æˆ‘ä»¬åªéœ€è¦é‡‡å–æ¯æ¬¡éƒ½é€‰å– <strong>ç¼–å·æœ€å°çš„å…¥åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></strong> çš„ç‚¹æ‰©å±•çš„è´ªå¿ƒç­–ç•¥å³å¯ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ <strong>å°æ ¹å †</strong> æ›¿æ¢é˜Ÿåˆ—æ¥è¿›è¡Œæ‹“æ‰‘æ’åºï¼Œå³ <code>priority_queue&lt;int, vector&lt;int&gt;, greater&lt;int&gt; &gt;</code>ã€‚æ¯æ¬¡å‡ºé˜Ÿçš„æ—¶å€™ï¼Œæ›´æ–°èµ°è¿‡çš„æœ€å¤§ç‚¹å¹¶è®°å½•ç­”æ¡ˆå³å¯ã€‚</p><p>å¯¹äºç¬¬äºŒä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°è¯•é‡‡å–æ¯æ¬¡éƒ½é€‰å– <strong>ç¼–å·æœ€å¤§çš„å…¥åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></strong> çš„ç‚¹æ‰©å±•çš„è´ªå¿ƒç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥ç”¨å¤§æ ¹å †è¿›è¡Œæ‹“æ‰‘æ’åºã€‚ç„¶è€Œï¼Œè¿™æ˜¯é”™è¯¯çš„ã€‚</p><p>ä¾‹å¦‚ä¸‹é¢çš„ç¤ºä¾‹ï¼š</p><p><img src="https://sukicdn.com/wyx/i/2024/03/06/3trl.png" alt=""></p><p>å¦‚æœç›´æ¥æŒ‰ç…§ æ¯æ¬¡é€‰å–æœ€å¤§çš„ç‚¹æ‰©å±•ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªè¡Œèµ°ç­–ç•¥ä¸ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>2</mn><mo>â†’</mo><mn>3</mn><mo>â†’</mo><mn>1</mn><mo>â†’</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">2 \rightarrow 3 \rightarrow 1 \rightarrow 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span></span></p><p>æ­¤æ—¶çš„ç­”æ¡ˆä¸ºï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> ã€‚</p><p>ç„¶è€Œï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ›´ä¼˜çš„ç­–ç•¥ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>2</mn><mo>â†’</mo><mn>1</mn><mo>â†’</mo><mn>4</mn><mo>â†’</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">2 \rightarrow 1 \rightarrow 4 \rightarrow 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span></span></p><p>æ­¤æ—¶çš„ç­”æ¡ˆä¸ºï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å‡è®¾å½“å‰æœªåˆ°è¾¾çš„å¯è¾¾ç‚¹ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">a_1, a_2, \ldots , a_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå…ˆå‰èµ°è¿‡çš„æœ€å¤§ç‚¹ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">mx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">x</span></span></span></span>ï¼Œé‚£ä¹ˆï¼Œå¯¹äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>&lt;</mo><mi>m</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">a_i &lt; mx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">x</span></span></span></span> çš„ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä¼˜å…ˆèµ°è¿™äº›ç‚¹ï¼Œä¸å—åˆ°ä»»ä½•ä¸€æ¬¡æ”»å‡»ã€‚</p><p>ä¸Šé¢èµ°åˆ°æœ€åï¼Œå¦‚æœå‰©ä¸‹çš„å…¨æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mi>m</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">&gt; mx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">x</span></span></span></span> çš„ç‚¹ï¼Œæˆ‘ä»¬æ­¤æ—¶å†é€‰æ‹©è¿™äº›ç‚¹ä¸­æœ€å¤§çš„ç‚¹è¿›è¡Œæ‰©å±•ã€‚è¿™æ ·å¯ä»¥å‡å°‘ä¸€äº›æ”»å‡»æ¬¡æ•°ã€‚</p><p>æˆ‘ä»¬ç”¨å¤§æ ¹å †æ¥å®ç°æ•´ä½“çš„æ‹“æ‰‘æ’åºï¼ŒåŒæ—¶å®šä¹‰ä¸€ä¸ªå¤‡é€‰é˜Ÿåˆ—æ¥å­˜å‚¨å½“å‰çš„ç¼–å·å¤§äºå…ˆå‰èµ°è¿‡çš„æœ€å¤§ç‚¹çš„ç‚¹ã€‚å…·ä½“çš„å®ç°è¿‡ç¨‹è§ä»£ç ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">5e5</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> n, m;<br><span class="hljs-type">int</span> h[N], e[N], ne[N], ind[N], tmp[N], idx;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>&#123;<br>    e[ ++ idx] = b, ne[idx] = h[a], h[a] = idx;<br>    ind[b] ++ ;<br>&#125;<br><br><span class="hljs-comment">// æœ€ä¼˜æƒ…å†µä¸‹è·å¾—å°½å¯èƒ½å¤šçš„ç¥ç¦æ¬¡æ•°</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">topo1</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> mx = <span class="hljs-number">0</span>, res = <span class="hljs-number">0</span>;<br>    priority_queue&lt;<span class="hljs-type">int</span>, vector&lt;<span class="hljs-type">int</span>&gt;, greater&lt;<span class="hljs-type">int</span>&gt; &gt; q; <span class="hljs-comment">// å°æ ¹å †</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-keyword">if</span>(!ind[i]) q.<span class="hljs-built_in">push</span>(i);<br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-type">int</span> u = q.<span class="hljs-built_in">top</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">if</span>(u &gt; mx)&#123;<br>            mx = u;  <span class="hljs-comment">// æ›´æ–°å…ˆå‰èµ°è¿‡çš„æœ€å¤§çš„ç‚¹</span><br>            res ++ ;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; i; i = ne[i])&#123;<br>            <span class="hljs-type">int</span> v = e[i];<br>            <span class="hljs-keyword">if</span>(!( -- ind[v])) q.<span class="hljs-built_in">push</span>(v);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-comment">// æœ€åæƒ…å†µä¸‹è·å¾—å°½å¯èƒ½å°‘çš„æ”»å‡»æ¬¡æ•°</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">topo2</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> mx = <span class="hljs-number">0</span>, res = <span class="hljs-number">0</span>, cnt = <span class="hljs-number">0</span>;<br>    priority_queue&lt;<span class="hljs-type">int</span>&gt; q; <span class="hljs-comment">// å¤§æ ¹å † è·å–å¯è¾¾çš„æœ€å¤§çš„ç‚¹æ‰©å±•</span><br>    queue&lt;<span class="hljs-type">int</span>&gt; wait;       <span class="hljs-comment">// å­˜å‚¨å½“å‰å¯è¾¾çš„å¤§äºå…ˆå‰æœ€å¤§ç‚¹çš„ç‚¹</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-keyword">if</span>(!ind[i]) q.<span class="hljs-built_in">push</span>(i);<br><br>    <span class="hljs-keyword">while</span>(cnt &lt; n)&#123;<br>        <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>            <span class="hljs-type">int</span> u = q.<span class="hljs-built_in">top</span>();<br>            q.<span class="hljs-built_in">pop</span>();<br><br>            cnt ++ ;    <span class="hljs-comment">// ç»Ÿè®¡èµ°åˆ°çš„ç‚¹çš„ä¸ªæ•°</span><br>            <span class="hljs-keyword">if</span>(u &gt; mx)&#123;  <br>                mx = u; <span class="hljs-comment">// æ›´æ–°</span><br>                res ++ ;<br>            &#125;<br><br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; i; i = ne[i])&#123;<br>                <span class="hljs-type">int</span> v = e[i];<br>                <span class="hljs-keyword">if</span>(!( -- ind[v]))&#123;<br>                    <span class="hljs-keyword">if</span>(v &gt; mx) wait.<span class="hljs-built_in">push</span>(v); <span class="hljs-comment">// å¦‚æœå¤§äºå…ˆå‰æœ€å¤§ç‚¹ æ”¾å…¥å¤‡é€‰ä¸­</span><br>                    <span class="hljs-keyword">else</span> q.<span class="hljs-built_in">push</span>(v);  <span class="hljs-comment">// å¦åˆ™ï¼Œæ”¾å…¥ä¼˜å…ˆé˜Ÿåˆ—ï¼Œå…ˆæ‰©å±•ï¼ˆè´ªå¿ƒï¼‰</span><br>                &#125;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">while</span>(wait.<span class="hljs-built_in">size</span>())&#123;  <span class="hljs-comment">// ä¼˜å…ˆé˜Ÿåˆ—æ²¡æœ‰å¯æ‰©å±•çš„äº†ï¼Œå†é€‰å¤‡é€‰é˜Ÿåˆ—ä¸­çš„</span><br>            q.<span class="hljs-built_in">push</span>(wait.<span class="hljs-built_in">front</span>());<br>            wait.<span class="hljs-built_in">pop</span>();  <br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">while</span>(m -- )&#123;<br>        <span class="hljs-type">int</span> u, v; cin &gt;&gt; u &gt;&gt; v;<br>        <span class="hljs-built_in">add</span>(u, v);<br>    &#125;<br><br>    <span class="hljs-comment">// task 1</span><br>    <span class="hljs-built_in">memcpy</span>(tmp, ind, <span class="hljs-keyword">sizeof</span> ind);<br>    cout &lt;&lt; <span class="hljs-built_in">topo1</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-comment">// task 2</span><br>    <span class="hljs-built_in">memcpy</span>(ind, tmp, <span class="hljs-keyword">sizeof</span> tmp);<br>    cout &lt;&lt; <span class="hljs-built_in">topo2</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="L3-2-ä¸ƒæ›œé­”æ³•ä½¿"><strong>L3-2 ä¸ƒæ›œé­”æ³•ä½¿</strong></h2><h3 id="é¢˜æ„æè¿°-14"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªå·¦éƒ¨ç‚¹å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> ä¸ªå³éƒ¨ç‚¹ï¼Œæ¯æ¬¡å¯ä»¥å–èµ°ä¸€å¯¹ç‚¹ï¼ˆä¸€ä¸ªæ˜¯å·¦éƒ¨ç‚¹ã€ä¸€ä¸ªæ˜¯å³éƒ¨ç‚¹ï¼‰å½“ä¸”ä»…å½“ä¸¤ä¸ªç‚¹çš„æƒå€¼æ»¡è¶³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>gcd</mi><mo>â¡</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\gcd(a_i, b_j) &gt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mop"><span style="margin-right:0.01389em;">g</span>cd</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ã€‚æ±‚æœ€å¤šå¯ä»¥å–èµ°å¤šå°‘å¯¹ç‚¹ã€‚<a href="https://www.luogu.com.cn/problem/T428979">ã€Œ2024 æ‰¬å¤§GPLTé€‰æ‹”èµ›ã€L3-2 ä¸ƒæ›œé­”æ³•ä½¿</a></p><h3 id="è§£é¢˜æ–¹æ³•-æœ€å¤§æµ-è´¨å› æ•°åˆ†è§£"><strong>è§£é¢˜æ–¹æ³• æœ€å¤§æµ + è´¨å› æ•°åˆ†è§£</strong></h3><p>å¾ˆæ˜¾ç„¶è¿™æ˜¯ä¸€ä¸ªäºŒåˆ†å›¾ã€‚åˆå§‹çš„æƒ³æ³•æ˜¯ï¼Œä¸¤ä¸¤æšä¸¾å·¦éƒ¨ç‚¹å’Œå³éƒ¨ç‚¹ï¼Œåˆ¤æ–­æ˜¯å¦æ»¡è¶³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>gcd</mi><mo>â¡</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\gcd(a_i, b_j) &gt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mop"><span style="margin-right:0.01389em;">g</span>cd</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å»ºè¾¹ï¼Œç„¶åè·‘ä¸€ä¸‹äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ã€‚è™½ç„¶å»ºè¾¹ç†è®ºä¸Šä¸ä¼šè¶…æ—¶ï¼Œä½†æ˜¯å»ºå®Œè¾¹åï¼Œè¾¹çš„ä¸ªæ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> æœ€å¤šä¼šæœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>500</mn><mo>Ã—</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">500 \times 500</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">500</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">500</span></span></span></span> æ¡ï¼Œè€ŒäºŒåˆ†å›¾æœ€å¤§åŒ¹é…çš„æ—¶é—´å¤æ‚åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nk)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">nk</span><span class="mclose">)</span></span></span></span>ï¼Œæ‰€ä»¥è¿™æ ·çš„å›¾å»ºæ¨¡æ–¹å¼è·‘äºŒåˆ†å›¾æœ€å¤§åŒ¹é…å¤§æ¦‚ç‡æ˜¯ä¼šè¶…æ—¶çš„ã€‚ï¼ˆä¹Ÿå¯ä»¥ç”¨ç½‘ç»œæµå»ºæ¨¡æ±‚è§£äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ï¼Œä½†è¿˜æ˜¯ä¼šè¶…æ—¶ï¼‰</p><p>å¯ä»¥å‘ç°ï¼Œä¸¤ä¸ªæ•°çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>gcd</mi><mo>â¡</mo></mrow><annotation encoding="application/x-tex">\gcd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mop"><span style="margin-right:0.01389em;">g</span>cd</span></span></span></span> å¤§äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œæ„å‘³ç€ä¸¤ä¸ªæ•°è‡³å°‘æœ‰ä¸€ä¸ªå…¬å…±è´¨å› å­ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸ªæ€§è´¨æ¥è¿›è¡Œå»ºæ¨¡ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å…ˆç­›ä¸€ä¸‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>7</mn></msup></mrow><annotation encoding="application/x-tex">10^7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span></span></span></span> èŒƒå›´ä»¥å†…çš„è´¨æ•°ï¼Œç„¶åå¯¹æ¯ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> è¿›è¡Œè´¨å› æ•°åˆ†è§£ï¼ˆæˆ–è€…ç›´æ¥è¯•é™¤æ³•ï¼‰ï¼Œå°†æ‰€æœ‰å‡ºç°çš„è´¨å› æ•°çœ‹ä½œæ˜¯å›¾ä¸­çš„ä¸€ä¸ªç‚¹ã€‚å¯¹äºæ¯ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå°†å…¶å‘è‡ªå·±çš„è´¨å› æ•°éƒ½è¿ä¸€æ¡å®¹é‡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> çš„è¾¹ï¼›å¯¹äºæ¯ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå°†è‡ªå·±çš„è´¨å› æ•°å‘è‡ªå·±è¿ä¸€æ¡å®¹é‡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> çš„è¾¹ã€‚åœ¨è¿›è¡Œæ­¤éƒ¨åˆ†è¿è¾¹æ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ›´æ–°ä¸€ä¸‹ç”¨åˆ°çš„è´¨æ•°ä¸ªæ•°ï¼Œæ¥æ›´æ–°æ±‡ç‚¹ã€‚</p><p>è´¨å› æ•°åˆ†è§£éƒ¨åˆ†è¿è¾¹ç»“æŸåï¼Œå†ä»æºç‚¹å‘æ‰€æœ‰å·¦éƒ¨ç‚¹è¿ä¸€æ¡å®¹é‡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> çš„è¾¹ï¼Œä»æ‰€æœ‰å³éƒ¨ç‚¹å‘æ±‡ç‚¹è¿ä¸€æ¡å®¹é‡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> çš„è¾¹ã€‚æœ€åè·‘ä¸€ä¸‹æœ€å¤§æµç®—æ³•å³å¯å¾—åˆ°ç­”æ¡ˆã€‚</p><p>æœ€ç»ˆå›¾ä¸­çš„ç‚¹ç¼–å·å¦‚ä¸‹ä¸ºï¼š</p><ul><li><p>æºç‚¹ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></p></li><li><p>å·¦éƒ¨ç‚¹ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>âˆ¼</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1 \sim n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></p></li><li><p>å³éƒ¨ç‚¹ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn><mo>âˆ¼</mo><mi>n</mi><mo>+</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n + 1 \sim n + m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></p></li><li><p>ä¸­é—´çš„è´¨å› æ•°ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mi>m</mi><mo>+</mo><mn>1</mn><mo>âˆ¼</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo>+</mo><mi>c</mi><mi>n</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">n + m + 1 \sim n + m + cnt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span></span></span></span></p></li><li><p>æ±‡ç‚¹ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mi>m</mi><mo>+</mo><mi>c</mi><mi>n</mi><mi>t</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n + m + cnt + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6984em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></p></li></ul><p>å…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">cnt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span></span></span></span> ä¸ºä½¿ç”¨åˆ°çš„è´¨å› æ•°ä¸ªæ•°ã€‚</p><p>é¢˜è§£ä¸­é‡‡ç”¨çš„æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>dinic</mtext></mrow><annotation encoding="application/x-tex">\text{dinic}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">dinic</span></span></span></span></span> ç®—æ³•ï¼ŒåŠ äº†å½“å‰å¼§ä¼˜åŒ–ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>, M = <span class="hljs-number">2e6</span> + <span class="hljs-number">10</span>, K = <span class="hljs-number">1e7</span> + <span class="hljs-number">2</span>, inf = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-type">int</span> n, m, src, des;<br><span class="hljs-type">int</span> h[N], e[M], ne[M], w[M], idx;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">int</span> c)</span></span>&#123;<br>    e[idx] = b, ne[idx] = h[a], w[idx] = c, h[a] = idx ++ ;<br>    e[idx] = a, ne[idx] = h[b], w[idx] = <span class="hljs-number">0</span>, h[b] = idx ++ ;<br>&#125;<br><br><span class="hljs-comment">// dinic æœ€å¤§æµ</span><br><span class="hljs-type">int</span> d[N], now[M]; <span class="hljs-comment">// å½“å‰å¼§ä¼˜åŒ–</span><br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">memset</span>(d, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> d);<br>    queue&lt;<span class="hljs-type">int</span>&gt; q;<br>    q.<span class="hljs-built_in">push</span>(src);<br>    d[src] = <span class="hljs-number">0</span>, now[src] = h[src];<br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-type">int</span> u = q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; ~i; i = ne[i])&#123;<br>            <span class="hljs-type">int</span> v = e[i], c = w[i];<br>            <span class="hljs-keyword">if</span>(!c || ~d[v]) <span class="hljs-keyword">continue</span>;<br><br>            q.<span class="hljs-built_in">push</span>(v);<br>            d[v] = d[u] + <span class="hljs-number">1</span>, now[v] = h[v];<br><br>            <span class="hljs-keyword">if</span>(v == des) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> flow)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(u == des) <span class="hljs-keyword">return</span> flow;<br>    <span class="hljs-type">int</span> used = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = now[u]; ~i &amp;&amp; used &lt; flow; i = ne[i])&#123;<br>        now[u] = i;<br>        <span class="hljs-type">int</span> v = e[i], c = w[i];<br>        <span class="hljs-keyword">if</span>(c &amp;&amp; d[v] == d[u] + <span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-type">int</span> f = <span class="hljs-built_in">dfs</span>(v, <span class="hljs-built_in">min</span>(c, flow - used));<br>            w[i] -= f, w[i ^ <span class="hljs-number">1</span>] += f;<br>            used += f;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> used;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">dinic</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">bfs</span>()) res += <span class="hljs-built_in">dfs</span>(src, inf);<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-comment">// çº¿æ€§ç­›è´¨æ•°</span><br><span class="hljs-type">int</span> prime[K], cnt;<br><span class="hljs-type">bool</span> st[K];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">work</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span></span>&#123;<br>    st[<span class="hljs-number">1</span>] = <span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-keyword">if</span>(!st[i]) prime[ ++ cnt] = i;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; prime[j] &lt;= n / i; j ++ )&#123;<br>            st[i * prime[j]] = <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">if</span>(i % prime[j] == <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// è´¨å› æ•°åˆ†è§£ å»ºè¾¹</span><br><span class="hljs-comment">// å·¦éƒ¨ç‚¹è¿è´¨å› æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add_a</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> u)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= cnt &amp;&amp; prime[i] &lt;= x; i ++ )&#123;<br>        <span class="hljs-keyword">if</span>(x % prime[i] == <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-built_in">add</span>(u, n + m + i, <span class="hljs-number">1</span>);<br>            des = <span class="hljs-built_in">max</span>(des, n + m + i);<br>            <span class="hljs-keyword">while</span>(x % prime[i] == <span class="hljs-number">0</span>) x /= prime[i];<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">// å³éƒ¨ç‚¹è¿è´¨å› æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add_b</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> u)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= cnt &amp;&amp; prime[i] &lt;= x; i ++ )&#123;<br>        <span class="hljs-keyword">if</span>(x % prime[i] == <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-built_in">add</span>(n + m + i, u, <span class="hljs-number">1</span>);<br>            des = <span class="hljs-built_in">max</span>(des, n + m + i);<br>            <span class="hljs-keyword">while</span>(x % prime[i] == <span class="hljs-number">0</span>) x /= prime[i];<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-built_in">work</span>(K - <span class="hljs-number">1</span>);<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        src = des = <span class="hljs-number">0</span>;<br>        <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h), idx = <span class="hljs-number">0</span>;<br>        cin &gt;&gt; n &gt;&gt; m;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, x; i &lt;= n; i ++ ) cin &gt;&gt; x, <span class="hljs-built_in">add_a</span>(x, i); <br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, x; i &lt;= m; i ++ ) cin &gt;&gt; x, <span class="hljs-built_in">add_b</span>(x, n + i); <br>        des ++ ;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-built_in">add</span>(src, i, <span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i ++ ) <span class="hljs-built_in">add</span>(n + i, des, <span class="hljs-number">1</span>);<br><br>        cout &lt;&lt; <span class="hljs-built_in">dinic</span>() &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="L3-3-ä¿¡ä»°æ˜¯ä¸ºäº†è™šå¹»ä¹‹äºº"><strong>L3-3 ä¿¡ä»°æ˜¯ä¸ºäº†è™šå¹»ä¹‹äºº</strong></h2><h3 id="é¢˜æ„æè¿°-15"><strong>é¢˜æ„æè¿°</strong></h3><p>ä¸€æ£µæ ‘ï¼Œæ¯ä¸ªç‚¹æœ‰ä¸€ä¸ªé¢œè‰²å’Œæƒå€¼ã€‚æ“ä½œæœ‰åŒ…æ‹¬ï¼šæ±‚æ ‘ä¸Šä¸¤ç‚¹ä¹‹é—´å”¯ä¸€è·¯å¾„ä¸Šé¢œè‰²ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> çš„ç‚¹æƒä¹‹å’Œæˆ–æœ€å¤§å€¼ï¼Œä¿®æ”¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> ç‚¹çš„é¢œè‰²æˆ–æƒå€¼ã€‚<a href="https://www.luogu.com.cn/problem/T428981">ã€Œ2024 æ‰¬å¤§GPLTé€‰æ‹”èµ›ã€L3-3 ä¿¡ä»°æ˜¯ä¸ºäº†è™šå¹»ä¹‹äºº</a></p><h3 id="è§£é¢˜æ–¹æ³•-æ ‘é“¾å‰–åˆ†-åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘"><strong>è§£é¢˜æ–¹æ³• æ ‘é“¾å‰–åˆ† + åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘</strong></h3><p>å¯¹äºè¿™æ ·çš„æ ‘ä¸Šè¯¢é—®å’ŒåŒºé—´ä¿®æ”¹é—®é¢˜ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šç”¨æ ‘é“¾å‰–åˆ†æ¥è§£å†³ã€‚</p><p>ç”±äºåœ¨è¯¢é—®çš„æ—¶å€™ï¼Œéœ€è¦çŸ¥é“ <strong>ç•™å®¿è¿‡çš„</strong> åœ°åŒºçš„åŒºé—´æœ€å€¼/åŒºé—´å’Œï¼Œå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªå®—æ•™éƒ½å¼€ä¸€ä¸ªçº¿æ®µæ ‘ï¼Œå³æ¯ä¸ªå®—æ•™éƒ½æœ‰ä¸€ä¸ªçº¿æ®µæ ‘çš„æ ¹ã€‚ç”±äºç©ºé—´çš„é™åˆ¶ï¼Œæˆ‘ä»¬éœ€è¦é‡‡ç”¨ <strong>åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘</strong> ã€‚</p><p>å¯¹äºä¿®æ”¹å®—æ•™çš„æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> ç‚¹åŸå…ˆå®—æ•™çš„çº¿æ®µæ ‘ä¸Šå°†è¿™ä¸ªç‚¹æ¸…é™¤ï¼Œç„¶åè½¬ç§»åˆ°æ–°å®—æ•™çš„çº¿æ®µæ ‘ä¸Šã€‚å…¶ä»–å¤§éƒ¨åˆ†åœ°æ–¹â€¦ä¹Ÿå°±å’Œæ ‘é“¾å‰–åˆ†æ¿å­å·®ä¸å¤šå§ï¼ˆé€ƒ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">2e5</span> + <span class="hljs-number">10</span>, M = (N &lt;&lt; <span class="hljs-number">1</span>), inf = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-type">int</span> n, q, root[N];<br><span class="hljs-type">int</span> h[N], e[M], ne[M], idx;<br><span class="hljs-type">int</span> w[N], cri[N]; <span class="hljs-comment">// è¯„çº§ å®—æ•™</span><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123; <span class="hljs-type">int</span> ls, rs, sum, mx; &#125;tr[N &lt;&lt; <span class="hljs-number">3</span>];<br><span class="hljs-type">int</span> son[N], dfn[N], fa[N], dep[N], siz[N], top[N], num, tot;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>&#123;<br>    e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ;<br>&#125;<br><br><span class="hljs-comment">//--------------çº¿æ®µæ ‘----------------</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">pushup</span><span class="hljs-params">(<span class="hljs-type">int</span> &amp;u)</span></span>&#123;<br>    tr[u].sum = tr[tr[u].ls].sum + tr[tr[u].rs].sum;<br>    tr[u].mx = <span class="hljs-built_in">max</span>(tr[tr[u].ls].mx, tr[tr[u].rs].mx);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">update</span><span class="hljs-params">(<span class="hljs-type">int</span> &amp;u, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r, <span class="hljs-type">int</span> k, <span class="hljs-type">int</span> x)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(!u) u = ++ tot;<br>    <span class="hljs-keyword">if</span>(l == r) &#123;tr[u].sum = tr[u].mx = x; <span class="hljs-keyword">return</span>;&#125;<br>    <span class="hljs-type">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span>(k &lt;= mid) <span class="hljs-built_in">update</span>(tr[u].ls, l, mid, k, x);<br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">update</span>(tr[u].rs, mid + <span class="hljs-number">1</span>, r, k, x);<br>    <span class="hljs-built_in">pushup</span>(u);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">remov</span><span class="hljs-params">(<span class="hljs-type">int</span> &amp;u, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r, <span class="hljs-type">int</span> k)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(!u) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-keyword">if</span>(l == r) &#123;tr[u].sum = tr[u].mx = <span class="hljs-number">0</span>; <span class="hljs-keyword">return</span>;&#125;<br>    <span class="hljs-type">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span>(k &lt;= mid) <span class="hljs-built_in">remov</span>(tr[u].ls, l, mid, k);<br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">remov</span>(tr[u].rs, mid + <span class="hljs-number">1</span>, r, k);<br>    <span class="hljs-built_in">pushup</span>(u);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-type">int</span> &amp;u, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r, <span class="hljs-type">int</span> ql, <span class="hljs-type">int</span> qr)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(!u) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span>(ql &lt;= l &amp;&amp; r &lt;= qr) <span class="hljs-keyword">return</span> tr[u].sum;<br>    <span class="hljs-type">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>, res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span>(ql &lt;= mid) res += <span class="hljs-built_in">query</span>(tr[u].ls, l, mid, ql, qr);<br>    <span class="hljs-keyword">if</span>(qr &gt; mid) res += <span class="hljs-built_in">query</span>(tr[u].rs, mid + <span class="hljs-number">1</span>, r, ql, qr);<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">querymx</span><span class="hljs-params">(<span class="hljs-type">int</span> &amp;u, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r, <span class="hljs-type">int</span> ql, <span class="hljs-type">int</span> qr)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(!u) <span class="hljs-keyword">return</span> -inf;<br>    <span class="hljs-keyword">if</span>(ql &lt;= l &amp;&amp; r &lt;= qr) <span class="hljs-keyword">return</span> tr[u].mx;<br>    <span class="hljs-type">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>, res = -inf;<br>    <span class="hljs-keyword">if</span>(ql &lt;= mid) res = <span class="hljs-built_in">max</span>(res, <span class="hljs-built_in">querymx</span>(tr[u].ls, l, mid, ql, qr));<br>    <span class="hljs-keyword">if</span>(qr &gt; mid) res = <span class="hljs-built_in">max</span>(res, <span class="hljs-built_in">querymx</span>(tr[u].rs, mid + <span class="hljs-number">1</span>, r, ql, qr));<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-comment">//-----------------------------------</span><br><span class="hljs-comment">// è¯¢é—®è·¯å¾„æƒå€¼å’Œ</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">qRange</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>&#123;<br>    <span class="hljs-type">int</span> ans = <span class="hljs-number">0</span>, res, c = cri[x];<br>    <span class="hljs-keyword">while</span>(top[x] ^ top[y])&#123;<br>        <span class="hljs-keyword">if</span>(dep[top[x]] &lt; dep[top[y]]) <span class="hljs-built_in">swap</span>(x, y);<br>        res = <span class="hljs-built_in">query</span>(root[c], <span class="hljs-number">1</span>, n, dfn[top[x]], dfn[x]);<br>        ans += res;<br>        x = fa[top[x]];<br>    &#125;<br>    <span class="hljs-keyword">if</span>(dep[x] &gt; dep[y]) <span class="hljs-built_in">swap</span>(x, y);<br>    res = <span class="hljs-built_in">query</span>(root[c], <span class="hljs-number">1</span>, n, dfn[x], dfn[y]);<br>    ans += res;<br>    <span class="hljs-keyword">return</span> ans;<br>&#125;<br><br><span class="hljs-comment">// è¯¢é—®è·¯å¾„æœ€å¤§å€¼</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">qMx</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>&#123;<br>    <span class="hljs-type">int</span> ans = -inf, res, c = cri[x];<br>    <span class="hljs-keyword">while</span>(top[x] ^ top[y])&#123;<br>        <span class="hljs-keyword">if</span>(dep[top[x]] &lt; dep[top[y]]) <span class="hljs-built_in">swap</span>(x, y);<br>        res = <span class="hljs-built_in">querymx</span>(root[c], <span class="hljs-number">1</span>, n, dfn[top[x]], dfn[x]);<br>        ans = <span class="hljs-built_in">max</span>(ans, res);<br>        x = fa[top[x]];<br>    &#125;<br>    <span class="hljs-keyword">if</span>(dep[x] &gt; dep[y]) <span class="hljs-built_in">swap</span>(x, y);<br>    res = <span class="hljs-built_in">querymx</span>(root[c], <span class="hljs-number">1</span>, n, dfn[x], dfn[y]);<br>    ans = <span class="hljs-built_in">max</span>(ans, res);<br>    <span class="hljs-keyword">return</span> ans;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dfs1</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> f, <span class="hljs-type">int</span> depth)</span></span>&#123;<br>    dep[u] = depth, fa[u] = f, siz[u] = <span class="hljs-number">1</span>;<br>    <span class="hljs-type">int</span> mxson = <span class="hljs-number">-1</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; ~i; i = ne[i])&#123;<br>        <span class="hljs-type">int</span> v = e[i];<br>        <span class="hljs-keyword">if</span>(v == f) <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-built_in">dfs1</span>(v, u, depth + <span class="hljs-number">1</span>);<br>        siz[u] += siz[v];<br>        <span class="hljs-keyword">if</span>(siz[v] &gt; mxson) son[u] = v, mxson = siz[v];<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dfs2</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> topf)</span></span>&#123;<br>    dfn[u] = ++ num, top[u] = topf;<br>    <span class="hljs-keyword">if</span>(!son[u]) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-built_in">dfs2</span>(son[u], topf);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; ~i; i = ne[i])&#123;<br>        <span class="hljs-type">int</span> v = e[i];<br>        <span class="hljs-keyword">if</span>(v == fa[u] || v == son[u]) <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-built_in">dfs2</span>(v, v);<br>    &#125; <br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);<br>    cin &gt;&gt; n &gt;&gt; q;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; w[i] &gt;&gt; cri[i];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, u, v; i &lt; n; i ++ ) cin &gt;&gt; u &gt;&gt; v, <span class="hljs-built_in">add</span>(u, v), <span class="hljs-built_in">add</span>(v, u);<br><br>    <span class="hljs-built_in">dfs1</span>(<span class="hljs-number">1</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">1</span>);<br>    <span class="hljs-built_in">dfs2</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);<br><br>    <span class="hljs-comment">// æ¯ä¸ªå®—æ•™å¼€ä¸€ä¸ªçº¿æ®µæ ‘</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-built_in">update</span>(root[cri[i]], <span class="hljs-number">1</span>, n, dfn[i], w[i]);<br>    <span class="hljs-keyword">while</span>(q -- )&#123;<br>        string s; cin &gt;&gt; s;<br>        <span class="hljs-keyword">if</span>(s == <span class="hljs-string">&quot;CC&quot;</span>)&#123;<br>            <span class="hljs-type">int</span> x, c; cin &gt;&gt; x &gt;&gt; c;<br>            <span class="hljs-built_in">remov</span>(root[cri[x]], <span class="hljs-number">1</span>, n, dfn[x]);    <span class="hljs-comment">// æ¸…é™¤</span><br>            <span class="hljs-built_in">update</span>(root[c], <span class="hljs-number">1</span>, n, dfn[x], w[x]);  <span class="hljs-comment">// å…¨éƒ¨è½¬ç§»åˆ°å®—æ•™ä¸ºcçš„çº¿æ®µæ ‘</span><br>            cri[x] = c;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(s == <span class="hljs-string">&quot;CW&quot;</span>)&#123;<br>            <span class="hljs-type">int</span> x, nw; cin &gt;&gt; x &gt;&gt; nw;<br>            <span class="hljs-built_in">update</span>(root[cri[x]], <span class="hljs-number">1</span>, n, dfn[x], nw); <span class="hljs-comment">// è¯„çº§æ”¹ä¸ºnw</span><br>            w[x] = nw;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(s == <span class="hljs-string">&quot;QS&quot;</span>)&#123;<br>            <span class="hljs-type">int</span> x, y; cin &gt;&gt; x &gt;&gt; y;<br>            cout &lt;&lt; <span class="hljs-built_in">qRange</span>(x, y) &lt;&lt; endl;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(s == <span class="hljs-string">&quot;QM&quot;</span>)&#123;<br>            <span class="hljs-type">int</span> x, y; cin &gt;&gt; x &gt;&gt; y;<br>            cout &lt;&lt; <span class="hljs-built_in">qMx</span>(x, y) &lt;&lt; endl;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å’å”±å…‰èŠ’</category>
      
      <category>æ‰¬å¤§æ ¡å†…é€‰æ‹”èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>ç®—æ³•ç«èµ›</tag>
      
      <tag>Luogu</tag>
      
      <tag>YAC</tag>
      
      <tag>é€‰æ‹”èµ›</tag>
      
      <tag>GPLT</tag>
      
      <tag>å›¢ä½“å¤©æ¢¯èµ›</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ubuntu ä¸‹ VS Code è¿è¡Œ C++ å¤šçº¿ç¨‹ç¨‹åº</title>
    <link href="/2024/12/15/20241215/"/>
    <url>/2024/12/15/20241215/</url>
    
    <content type="html"><![CDATA[<p>æ–‡ç« å¤§å›¾æ¥æº: <a href="https://www.pixiv.net/artworks/105845465">pixiv_id=105845465</a></p><h2 id="Ubuntu-ä¸‹-VS-Code-è¿è¡Œ-C-å¤šçº¿ç¨‹æŠ¥é”™">Ubuntu ä¸‹ VS Code è¿è¡Œ C++ å¤šçº¿ç¨‹æŠ¥é”™</h2><p>å‡è®¾å†™äº†å¦‚ä¸‹ C++ å¤šçº¿ç¨‹ç¨‹åº:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo() start, thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Hello, this is Alice Margatroid.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;foo() end, thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main() start, thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Hello, this is MarisaMagic.&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-function">std::thread <span class="hljs-title">t</span><span class="hljs-params">(foo)</span></span>;<br>    t.<span class="hljs-built_in">join</span>();<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;main(), end, thread id = &quot;</span> &lt;&lt; std::this_thread::<span class="hljs-built_in">get_id</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ Ubuntu ç¯å¢ƒä¸‹ç”¨ VS Code ä¸­çš„ <strong>Code Runner æ’ä»¶è¿è¡Œ</strong> C++ ä»£ç ä¼šå‡ºç°å¦‚ä¸‹æŠ¥é”™:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">In function `std::thread::thread&lt;void (&amp;)()&gt;(void (&amp;)())&#x27;:<br>test.cpp:(.text._ZNSt6threadC2IRFvvEJEEEOT_DpOT0_[_ZNSt6threadC5IRFvvEJEEEOT_DpOT0_]+0x2f): <br>undefined reference to `pthread_create&#x27;<br>collect2: error: ld returned 1 exit status<br></code></pre></td></tr></table></figure><p>å¦‚æœé€‰æ‹© <strong>ç”Ÿæˆ C/C++ g++ ç”Ÿæˆæ´»åŠ¨æ–‡ä»¶</strong> ä¹Ÿä¼šæŠ¥é”™:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/15/uhb.png" alt=""></p><h2 id="æŠ¥é”™åŸå› ">æŠ¥é”™åŸå› </h2><p>åœ¨ Ubuntu å¹³å°ä¸‹åˆ›å»ºçº¿ç¨‹æ—¶ä¼šè°ƒç”¨ pthread_create() å‡½æ•°ï¼Œä½†æ˜¯ pthread åº“ä¸æ˜¯ Linux ç³»ç»Ÿé»˜è®¤çš„åº“ï¼Œéœ€è¦é“¾æ¥åˆ° pthread åº“ã€‚å› æ­¤åœ¨ä½¿ç”¨ g++ ç¼–è¯‘æ—¶ï¼ŒåŠ ä¸Šé“¾æ¥ pthread åº“å‘½ä»¤ï¼Œå³å¯ç¼–è¯‘æˆåŠŸ:</p><p>æ•…æˆ‘ä»¬å¯ä»¥æ‰“å¼€ç»ˆç«¯ï¼Œæˆ–è€…åœ¨ VS Code ä¸­æ‰“å¼€ç»ˆç«¯è¾“å…¥å¦‚ä¸‹ç¼–è¯‘å‘½ä»¤:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">g++ test.cpp -o <span class="hljs-built_in">test</span> -lpthread <br></code></pre></td></tr></table></figure><p>è¿è¡Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå‘ç°å¤šçº¿ç¨‹ç¨‹åºè¿è¡ŒæˆåŠŸ:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./test<br></code></pre></td></tr></table></figure><p>å¯æ˜¯æˆ‘ä»¬è¿˜æ²¡æœ‰æˆåŠŸè§£å†³å¦‚ä½•åœ¨ VS Code ä¸­ä½¿ç”¨ <strong>Code Runner æ’ä»¶</strong> æˆ–è€… <strong>ç”Ÿæˆ C/C++ g++ ç”Ÿæˆæ´»åŠ¨æ–‡ä»¶</strong> è¿è¡Œ C++ å¤šçº¿ç¨‹ç¨‹åºã€‚</p><p><img src="https://sukicdn.com/wyx/i/2024/12/15/61yn.png" alt=""></p><h2 id="è§£å†³æ–¹æ³•">è§£å†³æ–¹æ³•</h2><h3 id="Code-Runner-æ’ä»¶é…ç½®ä¿®æ”¹">Code Runner æ’ä»¶é…ç½®ä¿®æ”¹</h3><p>æ‰“å¼€ Code Runner æ‰©å±•è®¾ç½®ï¼Œè¾“å…¥å…³é”®è¯ Executor Mapï¼Œç‚¹å‡»ç¬¬ä¸€ä¸ªé€‰é¡¹ä¸­â€œåœ¨ settings.json ä¸­ç¼–è¾‘â€ã€‚</p><p><img src="https://sukicdn.com/wyx/i/2024/12/15/88x9b.png" alt=""></p><p>æ‰“å¼€ä¹‹åï¼Œçœ‹åˆ°å¦‚ä¸‹ç•Œé¢ã€‚ç„¶ååœ¨ â€œcppâ€ é‚£ä¸€è¡Œçš„ç¼–è¯‘å‘½ä»¤ä¸­ï¼Œå¢åŠ  -lpthread é“¾æ¥å‘½ä»¤å¹¶ä¿å­˜å³å¯ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;cpp&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cd $dir &amp;&amp; g++ $fileName -o $fileNameWithoutExt -lpthread &amp;&amp; $dir$fileNameWithoutExt&quot;</span><br></code></pre></td></tr></table></figure><p>ä¿®æ”¹åå¤§è‡´å¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/15/16ezi.png" alt=""></p><p>ä¹‹åç‚¹å‡»å³ä¸Šè§’ <strong>Code Runner æ’ä»¶</strong> è¿è¡Œä»£ç çš„æŒ‰é’®å°±å¯ä»¥è¿è¡ŒæˆåŠŸ DAâ­ZE~</p><p><img src="https://sukicdn.com/wyx/i/2024/12/15/175xp.png" alt=""></p><h3 id="ç”Ÿæˆ-C-C-g-ç”Ÿæˆæ´»åŠ¨æ–‡ä»¶é…ç½®ä¿®æ”¹">ç”Ÿæˆ C/C++ g++ ç”Ÿæˆæ´»åŠ¨æ–‡ä»¶é…ç½®ä¿®æ”¹</h3><p>é”®ç›˜æŒ‰ä¸‹ â€œCtrl + Shift + Pâ€ï¼Œæ‰“å¼€å‘½ä»¤é¢æ¿ã€‚è¾“å…¥å…³é”®è¯ â€œTasksâ€ æ‰¾åˆ° â€œTasks: Configure Default Build Taskâ€ ç‚¹å¼€ã€‚</p><p><img src="https://sukicdn.com/wyx/i/2024/12/15/8ewil.png" alt=""></p><p>ç‚¹å¼€ä¹‹åé€‰æ‹© â€œC/C++: g++ ç”Ÿæˆæ´»åŠ¨æ–‡ä»¶â€ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç¼–è¯‘é…ç½®æ–‡ä»¶ tasks.json ã€‚</p><p><img src="https://sukicdn.com/wyx/i/2024/12/15/179mu.png" alt=""></p><p>åœ¨ç¼–è¯‘é…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ° â€œargsâ€ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œç¼–è¯‘å‘½ä»¤æ—¶åŠ å…¥çš„å‚æ•°ã€‚å¢åŠ ä¸€æ¡ â€œ-lpthreadâ€ï¼Œä¿å­˜æ–‡ä»¶å³å¯ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;tasks&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cppbuild&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;label&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;C/C++: g++ ç”Ÿæˆæ´»åŠ¨æ–‡ä»¶&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;command&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/usr/bin/g++&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;args&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>            <span class="hljs-string">&quot;-fdiagnostics-color=always&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-string">&quot;-g&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-string">&quot;$&#123;file&#125;&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-string">&quot;-o&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-string">&quot;$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-string">&quot;-lpthread&quot;</span><br>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;options&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;cwd&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;$&#123;fileDirname&#125;&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;problemMatcher&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>            <span class="hljs-string">&quot;$gcc&quot;</span><br>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;group&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;kind&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;build&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;isDefault&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><br>        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;detail&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ç¼–è¯‘å™¨: /usr/bin/g++&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure><p>ä¿®æ”¹é…ç½®åå¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="https://sukicdn.com/wyx/i/2024/12/15/8ewft.png" alt=""></p><p>ä¹‹åä½¿ç”¨ <strong>ç”Ÿæˆ C/C++ g++ ç”Ÿæˆæ´»åŠ¨æ–‡ä»¶</strong> ä¹Ÿå¯ä»¥è¿è¡ŒæˆåŠŸ DAâ­ZE ~</p><p><img src="https://sukicdn.com/wyx/i/2024/12/15/67gs.png" alt=""></p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ol><li><p><a href="https://blog.csdn.net/afgqwjgfjqwgfg/article/details/115737489">VS Codeåœ¨ubuntuä¸­æ‰§è¡Œå¤šçº¿ç¨‹ç¨‹åºæ—¶æŠ¥é”™ï¼šundefined reference to `pthread_create</a></p></li><li><p><a href="https://worktile.com/kb/ask/402685.html">ç¼–è¯‘å¤šçº¿ç¨‹ç¨‹åºlinuxå‘½ä»¤</a></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>è¿½é€ç¹æ˜Ÿ</category>
      
      <category>C++ å°æŠ€å·§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>Ubuntu</tag>
      
      <tag>Linux</tag>
      
      <tag>VS Code</tag>
      
      <tag>å¤šçº¿ç¨‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 YAC Round 13 é¢˜è§£</title>
    <link href="/2024/12/14/YAC_Round_13/"/>
    <url>/2024/12/14/YAC_Round_13/</url>
    
    <content type="html"><![CDATA[<h2 id="A-æ¬¢è¿æ¥åˆ°å¤œé›€é£Ÿå ‚"><strong>A æ¬¢è¿æ¥åˆ°å¤œé›€é£Ÿå ‚</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šMarisaMagic</p></blockquote><h3 id="é¢˜æ„æè¿°"><strong>é¢˜æ„æè¿°</strong></h3><p>è¾“å‡º <code>Welcome to Touhou Mystia's Izakaya.</code> <a href="https://www.luogu.com.cn/problem/T544164">ã€ŒYAC Round 13ã€æ¬¢è¿æ¥åˆ°å¤œé›€é£Ÿå ‚</a></p><h3 id="è§£é¢˜æ€è·¯"><strong>è§£é¢˜æ€è·¯</strong></h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">marisa</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Welcome to Touhou Mystia&#x27;s Izakaya.&quot;</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; <span class="hljs-comment">// cin &gt;&gt; T;</span><br>    <span class="hljs-keyword">while</span>(T -- ) <span class="hljs-built_in">marisa</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="B-å¥½è¯„çƒ­ç«æœå¤©"><strong>B å¥½è¯„çƒ­ç«æœå¤©</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šMarisaMagic</p></blockquote><h3 id="é¢˜æ„æè¿°-2"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚æœ€å¤§è¿ç»­å‡ºç° <code>pink</code> çš„æ¬¡æ•°ã€‚<a href="https://www.luogu.com.cn/problem/T544165">ã€ŒYAC Round 13ã€å¥½è¯„çƒ­ç«æœå¤©</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆæ¨¡æ‹Ÿï¼‰"><strong>è§£é¢˜æ€è·¯</strong> ï¼ˆæ¨¡æ‹Ÿï¼‰</h3><p>å®šä¹‰ä¸€ä¸ªè®¡æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">cnt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span></span></span></span> ç´¯è®¡ <code>pink</code> å‡ºç°çš„æ¬¡æ•°ã€‚éå† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœé‡åˆ° <code>pink</code> è®¡æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>+1</mtext></mrow><annotation encoding="application/x-tex">\text{+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord">+1</span></span></span></span></span>ï¼Œå¹¶æ›´æ–°ç­”æ¡ˆï¼›å¦åˆ™è®¡æ•°æ¸… <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">marisa</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> n, mx = <span class="hljs-number">0</span>, cnt = <span class="hljs-number">0</span>; cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        string s; cin &gt;&gt; s;<br>        <span class="hljs-keyword">if</span>(s[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;p&#x27;</span>) cnt ++ , mx = <span class="hljs-built_in">max</span>(mx, cnt);<br>        <span class="hljs-keyword">else</span> cnt = <span class="hljs-number">0</span>;<br>    &#125;<br>    cout &lt;&lt; mx &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; <span class="hljs-comment">// cin &gt;&gt; T;</span><br>    <span class="hljs-keyword">while</span>(T -- ) <span class="hljs-built_in">marisa</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="C-é€†è½¬å¤©åœ°"><strong>C é€†è½¬å¤©åœ°</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šMarisaMagic</p></blockquote><h3 id="é¢˜æ„æè¿°-3"><strong>é¢˜æ„æè¿°</strong></h3><p>å¯¹äºä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„å­—ç¬¦ä¸² <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>ï¼Œå¦ä¸€ä¸ªé•¿åº¦ç›¸åŒçš„å­—ç¬¦ä¸² <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> çš„ <strong>ä¸ç›¸ä¼¼åº¦</strong> å®šä¹‰ä¸ºï¼šä¸åŒä½ç½®ä¸Šçš„ä¸åŒå­—ç¬¦çš„å¯¹æ•°ã€‚ç»™å®šä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>ï¼Œæ„é€ ä¸€ä¸ªé•¿åº¦ç›¸åŒçš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> ä½¿å¾—ä¸ç›¸ä¼¼åº¦æœ€å¤§åŒ–ã€‚<a href="https://www.luogu.com.cn/problem/T544002">ã€ŒYAC Round 13ã€é€†è½¬å¤©åœ°</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆå­—ç¬¦ä¸²ï¼Œè´ªå¿ƒï¼Œæ„é€ ï¼‰"><strong>è§£é¢˜æ€è·¯</strong> ï¼ˆå­—ç¬¦ä¸²ï¼Œè´ªå¿ƒï¼Œæ„é€ ï¼‰</h3><p>è€ƒè™‘å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> çš„æ¯ä¸€ä¸ªä½ç½®ä¸Šçš„ä¸ç›¸ä¼¼åº¦æœ€å¤§åŒ–ï¼Œä¹Ÿå°±æ˜¯è®©æ¯ä¸ªä½ç½®ä¸Šçš„å­—ç¬¦å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> ä¸­å…¶ä»–ä½ç½®çš„å­—ç¬¦å°½å¯èƒ½éƒ½ä¸ç›¸åŒã€‚</p><p>å¯¹äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> çš„ä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸Šçš„å­—ç¬¦ï¼Œç›´æ¥å°†å…¶è®¾å®šä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> ä¸­ <strong>é™¤äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä»¥å¤–</strong> çš„ <strong>æ‰€æœ‰ä½ç½®ä¸Šå‡ºç°æ¬¡æ•°æœ€å°‘çš„å­—ç¬¦</strong> å³å¯ã€‚å­—ç¬¦ä¸²åªåŒ…å«å°å†™å­—æ¯ï¼Œæ•…å¯ä»¥é¢„å¤„ç†ç»Ÿè®¡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> ä¸­æ¯ä¸ªå­—ç¬¦çš„ä¸ªæ•°ï¼Œåœ¨æšä¸¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> çš„æ¯ä¸ªä½ç½®æ—¶ï¼Œæšä¸¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> ä¸­å…¶ä»–ä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>26</mn></mrow><annotation encoding="application/x-tex">26</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">26</span></span></span></span> ä¸ªå­—ç¬¦å“ªä¸ªå‡ºç°æ¬¡æ•°æœ€å°‘ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæšä¸¾å‡ºç°æ¬¡æ•°æœ€å°‘çš„å­—æ¯æ—¶ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> ä¸­å½“å‰ä½ç½®çš„å­—æ¯å‡ºç°æ¬¡æ•°éœ€è¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>-1</mtext></mrow><annotation encoding="application/x-tex">\text{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord text"><span class="mord">-1</span></span></span></span></span>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">marisa</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> n; cin &gt;&gt; n;<br>    string s; cin &gt;&gt; s;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">cnt</span><span class="hljs-params">(<span class="hljs-number">26</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;ch : s) cnt[ch - <span class="hljs-string">&#x27;a&#x27;</span>] ++ ;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;ch : s)&#123;<br>        <span class="hljs-type">int</span> mn = <span class="hljs-number">1e9</span>; <span class="hljs-type">char</span> res;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">26</span>; i ++ )<br>            <span class="hljs-keyword">if</span>(mn &gt; cnt[i] - (ch - <span class="hljs-string">&#x27;a&#x27;</span> == i))&#123;<br>                mn = cnt[i] - (ch - <span class="hljs-string">&#x27;a&#x27;</span> == i);<br>                res = <span class="hljs-string">&#x27;a&#x27;</span> + i;<br>            &#125;<br>        cout &lt;&lt; res;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; <span class="hljs-comment">//cin &gt;&gt; T;</span><br>    <span class="hljs-keyword">while</span>(T -- ) <span class="hljs-built_in">marisa</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="D-éœ²æ˜“å…¹çš„æ—…è¡Œåšå®¢"><strong>D éœ²æ˜“å…¹çš„æ—…è¡Œåšå®¢</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šMarisaMagic</p></blockquote><h3 id="é¢˜æ„æè¿°-4"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> çš„çŸ©é˜µï¼Œæ¯ä¸€æ­¥åªèƒ½å‘å³æˆ–å‘ä¸‹ç§»åŠ¨ä¸€æ¬¡ï¼Œé‡åˆ° <code>0</code> åŠ  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> åˆ†ï¼›é‡åˆ° <code>1</code> åŠ  1 åˆ†ï¼›é‡åˆ° <code>?</code> å¯ä»¥ä½¿ç”¨ä¸€æ¬¡æ‹ç…§çš„æœºä¼šåŠ  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ†ï¼Œä¹Ÿå¯ä»¥ä¸ä½¿ç”¨æ‹ç…§çš„æœºä¼šåŠ  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> åˆ†ã€‚æ±‚ä½¿ç”¨ä¸è¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> æ¬¡æ‹ç…§æœºä¼šä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> ç§»åŠ¨åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(n, m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> çš„æœ€å¤§å¾—åˆ†ã€‚<a href="https://www.luogu.com.cn/problem/T544238">ã€ŒYAC Round 13ã€éœ²æ˜“å…¹çš„æ—…è¡Œåšå®¢</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆåŠ¨æ€è§„åˆ’ï¼‰"><strong>è§£é¢˜æ€è·¯</strong> ï¼ˆåŠ¨æ€è§„åˆ’ï¼‰</h3><p>è€ƒè™‘åŠ¨æ€è§„åˆ’ï¼Œè®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">dp_{i,j,k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> è¡¨ç¤ºèµ°åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> ä¸”ä½¿ç”¨ä¸è¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> æ¬¡æ‹ç…§æœºä¼šè·å¾—çš„æœ€å¤§å¾—åˆ†ã€‚æœ‰å¦‚ä¸‹çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p><ul><li><p>å½“é‡åˆ°å­—ç¬¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> æˆ– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> æ—¶</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mo separator="true">,</mo><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>k</mi></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mtext>Â </mtext><msub><mi>g</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mo separator="true">,</mo><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>k</mi></mrow></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext>Â </mtext><msub><mi>g</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">dp_{i,j,k} = \begin{cases}\max(dp_{i-1, j, k}, dp_{i, j-1, k}) + 1, \ g_{i,j} = 1\\\\\max(dp_{i-1, j, k}, dp_{i, j-1, k}), \ g_{i, j} = 0\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â©</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â¨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â§</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li><li><p>å½“é‡åˆ°å­—ç¬¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">?</mo></mrow><annotation encoding="application/x-tex">?</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mclose">?</span></span></span></span> æ—¶ï¼Œå¯ä»¥ä¸ä½¿ç”¨æœºä¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mo>=</mo><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mo separator="true">,</mo><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>k</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dp_{i, j, k} = \max(dp_{i-1, j, k}, dp_{i, j-1, k})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€æ¬¡æœºä¼šåŠ  1 åˆ†</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mo>=</mo><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mtext>Â </mtext><mi>k</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">dp_{i, j, k} = \max(dp_{i-1, j, k-1}, dp_{i, j-1, k-1}) + 1, \ k &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></p></li></ul><p>æœ€ç»ˆç­”æ¡ˆå°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo separator="true">,</mo><mi>p</mi></mrow></msub></mrow><annotation encoding="application/x-tex">dp_{n, m, p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">510</span>, M = <span class="hljs-number">310</span>;<br><br>string g[N];<br><span class="hljs-type">int</span> n, m, p, f[N][N][M];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">marisa</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; n &gt;&gt; m &gt;&gt; p;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; g[i], g[i] = <span class="hljs-string">&quot; &quot;</span> + g[i];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j ++ )<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt;= p; k ++ )&#123;<br>                <span class="hljs-keyword">if</span>(g[i][j] != <span class="hljs-string">&#x27;?&#x27;</span>)&#123;<br>                    <span class="hljs-keyword">if</span>(g[i][j] == <span class="hljs-string">&#x27;1&#x27;</span>)&#123;<br>                        f[i][j][k] = <span class="hljs-built_in">max</span>(f[i - <span class="hljs-number">1</span>][j][k], f[i][j - <span class="hljs-number">1</span>][k]) + <span class="hljs-number">1</span>;<br>                    &#125;<span class="hljs-keyword">else</span>&#123;<br>                        f[i][j][k] = <span class="hljs-built_in">max</span>(f[i - <span class="hljs-number">1</span>][j][k], f[i][j - <span class="hljs-number">1</span>][k]);<br>                    &#125;<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    f[i][j][k] = <span class="hljs-built_in">max</span>(f[i - <span class="hljs-number">1</span>][j][k], f[i][j - <span class="hljs-number">1</span>][k]);<br>                    <span class="hljs-keyword">if</span>(k &gt; <span class="hljs-number">0</span>)&#123;<br>                        f[i][j][k] = <span class="hljs-built_in">max</span>(f[i - <span class="hljs-number">1</span>][j][k - <span class="hljs-number">1</span>], <br>                        f[i][j - <span class="hljs-number">1</span>][k - <span class="hljs-number">1</span>]) + <span class="hljs-number">1</span>;<br>                    &#125;<br>                &#125;<br>            &#125;<br><br>    cout &lt;&lt; f[n][m][p] &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- ) <span class="hljs-built_in">marisa</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="E-æœˆéƒ½å…¨èƒ½ç‰¹è®­"><strong>E æœˆéƒ½å…¨èƒ½ç‰¹è®­</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šMarisaMagic</p></blockquote><h3 id="é¢˜æ„æè¿°-5"><strong>é¢˜æ„æè¿°</strong></h3><p>æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªæŠ€èƒ½ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> ä¸ªæœˆå…‰è‰ã€‚ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªæœˆå…‰è‰å¯ä»¥åœ¨æŠ€èƒ½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">t_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸Šæå‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„èƒ½åŠ›å€¼ã€‚æ±‚åœ¨ä¸è¿ç»­ä½¿ç”¨ä¸¤ä¸ªç›¸åŒå¯¹åº”æŠ€èƒ½çš„æœˆå…‰è‰çš„æƒ…å†µä¸‹ï¼Œä½¿å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªæŠ€èƒ½çš„æå‡èƒ½åŠ›å€¼éƒ½ <strong>è‡³å°‘</strong> è¾¾åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> æ‰€éœ€çš„æœ€å°‘æœˆå…‰è‰ä¸ªæ•°ã€‚ <a href="https://www.luogu.com.cn/problem/T544004">ã€ŒYAC Round 13ã€æœˆéƒ½å…¨èƒ½ç‰¹è®­</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆæ’åºï¼Œè´ªå¿ƒï¼‰"><strong>è§£é¢˜æ€è·¯</strong> ï¼ˆæ’åºï¼Œè´ªå¿ƒï¼‰</h3><p>å¯¹äºæ¯ä¸ªæŠ€èƒ½ï¼Œé€‰æ‹©æ›´å¤§æå‡å€¼çš„æœˆå…‰è‰ï¼Œåˆ°è¾¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> æ‰€éœ€çš„æœˆå…‰è‰æ›´å°‘ã€‚å¯ä»¥ç”¨ <code>pair</code> å­˜å‚¨æ¯ä¸ªæœˆå…‰è‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">t_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œç„¶åæŒ‰ç…§ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸ºç¬¬ä¸€å…³é”®å­—ä»å¤§åˆ°å°æ’åºã€‚ä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> æšä¸¾åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> ç´¯è®¡æ¯ä¸ªæŠ€èƒ½çš„æå‡å€¼ï¼Œå¹¶è®°å½•æ¯ä¸ªæŠ€èƒ½æ‰€éœ€çš„æœ€å°‘æœˆå…‰è‰æ•°é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">need_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">ee</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚æšä¸¾å®Œåæ‰€æœ‰æŠ€èƒ½æ‰€éœ€çš„æœˆå…‰è‰æ•°é‡è®°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span>ã€‚</p><p>é¦–å…ˆæ¯ä¸ªæŠ€èƒ½çš„æå‡å€¼è¦ç¡®ä¿èƒ½åˆ°è¾¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ã€‚åœ¨è´ªå¿ƒæšä¸¾çš„è¿‡ç¨‹ä¸­ï¼Œç»Ÿè®¡ä¸€ä¸‹åˆ°è¾¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> çš„æŠ€èƒ½æ•°é‡æ˜¯å¦æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªå³å¯ã€‚å¦‚æœæ— æ³•æ»¡è¶³ï¼Œè¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span>ã€‚</p><p>ç°åœ¨è€ƒè™‘æ˜¯å¦å¯æ»¡è¶³äº¤å‰ä½¿ç”¨ä¸åŒå¯¹åº”æŠ€èƒ½çš„æœˆå…‰è‰ï¼Œè®°æ‰€éœ€æœ€å¤šæ•°é‡æœˆå…‰è‰ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>max</mi><mo>â¡</mo></msub></mrow><annotation encoding="application/x-tex">need_{\max}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">ee</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå¯¹åº”æŠ€èƒ½ç¼–å·ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><msub><mi>d</mi><mi>max</mi><mo>â¡</mo></msub></mrow><annotation encoding="application/x-tex">id_{\max}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚æœ‰ä¸€ä¸ªæ€§è´¨å³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><mi>n</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>max</mi><mo>â¡</mo></msub><mo>âˆ’</mo><mn>1</mn><mo>â‰¤</mo><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">2 \times need_{\max} - 1 \le ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">ee</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span> æ—¶ï¼Œè¿™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span> ä¸ªå¯ä»¥å®ç°äº¤å‰ä½¿ç”¨ï¼ˆå¯ä»¥è‡ªè¡Œæ¨¡æ‹ŸéªŒè¯ï¼‰ï¼š</p><ul><li><p>å¦‚æœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><mi>n</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>max</mi><mo>â¡</mo></msub><mo>âˆ’</mo><mn>1</mn><mo>â‰¤</mo><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">2 \times need_{\max} - 1 \le ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">ee</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span>ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥äº¤å‰ä½¿ç”¨äº†ã€‚æ•…æ­¤æ—¶çš„ç­”æ¡ˆå°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span>ï¼›</p></li><li><p>å¦‚æœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><mi>n</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>max</mi><mo>â¡</mo></msub><mo>âˆ’</mo><mn>1</mn><mo>&gt;</mo><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">2 \times need_{\max} - 1 &gt; ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">ee</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span>ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å†å¤šä½¿ç”¨ <strong>é™¤ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><msub><mi>d</mi><mi>max</mi><mo>â¡</mo></msub></mrow><annotation encoding="application/x-tex">id_{\max}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¹‹å¤–</strong> çš„å…¶å®ƒç§ç±»ç§ä»»æ„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><mi>n</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>max</mi><mo>â¡</mo></msub><mo>âˆ’</mo><mn>1</mn><mo>âˆ’</mo><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">2 \times need_{\max} - 1 - ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">ee</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span> ä¸ªæœˆå…‰è‰å°±å¯ä»¥åˆšå¥½å®ç°äº¤å‰ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç´¯è®¡å…¶å®ƒç§ç±»å‰©ä½™çš„æœˆå…‰è‰æ•°é‡ï¼Œè®°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">le</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span></span></span></span>ã€‚è‹¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><mi>n</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>max</mi><mo>â¡</mo></msub><mo>âˆ’</mo><mn>1</mn><mo>âˆ’</mo><mi>a</mi><mi>n</mi><mi>s</mi><mo>â‰¤</mo><mi>l</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">2 \times need_{\max} - 1 - ans \le le</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">ee</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span></span></span></span>ï¼Œå°±å¯ä»¥åˆšå¥½äº¤å‰ã€‚æ•…æ­¤æ—¶ç­”æ¡ˆä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><mi>n</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>max</mi><mo>â¡</mo></msub><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2 \times need_{\max} - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">ee</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼›å¦åˆ™ï¼Œè¿˜æ˜¯æ— æ³•æ»¡è¶³äº¤å‰ï¼Œæ­¤æ—¶è¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span>ã€‚</p></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> fi first</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> se second</span><br><span class="hljs-keyword">using</span> pii = pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">marisa</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> n, m, k; cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;<br>    <span class="hljs-function">vector&lt;pii&gt; <span class="hljs-title">p</span><span class="hljs-params">(m + <span class="hljs-number">1</span>)</span></span>;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">cnt</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>; <span class="hljs-comment">// ç»Ÿè®¡æ¯ç§æœˆå…‰è‰çš„æ•°é‡</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i ++ ) cin &gt;&gt; p[i].fi, cnt[p[i].fi] ++ ;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i ++ ) cin &gt;&gt; p[i].se;<br>    <span class="hljs-built_in">sort</span>(<span class="hljs-built_in">begin</span>(p) + <span class="hljs-number">1</span>, <span class="hljs-built_in">end</span>(p), [](pii &amp;x, pii &amp;y)&#123;<br>        <span class="hljs-keyword">return</span> x.se &gt; y.se; <br>    &#125;);<br>    <br>    <span class="hljs-type">int</span> ans = <span class="hljs-number">0</span>, mx_need = <span class="hljs-number">0</span>, mx_id = <span class="hljs-number">0</span>, tot = <span class="hljs-number">0</span>;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">sum</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span>, <span class="hljs-title">need</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>; <span class="hljs-comment">// æ¯ä¸ªæŠ€èƒ½æå‡å€¼å’Œæ‰€éœ€æ•°é‡</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i ++ )&#123;<br>        <span class="hljs-keyword">auto</span> [id, c] = p[i];<br>        <span class="hljs-keyword">if</span>(sum[id] &gt;= k) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// å·²ç»è¾¾åˆ°kå°±è·³è¿‡</span><br><br>        sum[id] += c;<br>        <span class="hljs-keyword">if</span>(sum[id] &gt;= k) tot ++ ; <span class="hljs-comment">// è®°å½•æ»¡è¶³å¤§äºç­‰äºkçš„æŠ€èƒ½æ•°</span><br><br>        need[id] ++ ;<br>        <span class="hljs-keyword">if</span>(need[id] &gt; mx_need)&#123; <span class="hljs-comment">// è®°å½•æ‰€éœ€æœˆå…‰è‰æœ€å¤§çš„æ•°é‡åŠå…¶ç§ç±»ç¼–å·</span><br>            mx_need = need[id]; <br>            mx_id = id;<br>        &#125;<br><br>        ans ++ ;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(tot &lt; n)&#123; <span class="hljs-comment">// æ— æ³•ä½¿å¾—æ‰€æœ‰æŠ€èƒ½æ»¡è¶³å¤§äºç­‰äºk</span><br>        cout &lt;&lt; <span class="hljs-number">-1</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(mx_need * <span class="hljs-number">2</span> - <span class="hljs-number">1</span> &lt;= ans)&#123; <span class="hljs-comment">// å·²ç»å¯ä»¥äº¤å‰</span><br>        cout &lt;&lt; ans &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-type">int</span> le = <span class="hljs-number">0</span>; <span class="hljs-comment">// å‰©ä½™çš„å…¶ä»–é¢˜ç›®çš„æ•°é‡</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-keyword">if</span>(i != mx_id) le += cnt[i] - need[i];<br>    <span class="hljs-keyword">if</span>(mx_need * <span class="hljs-number">2</span> - <span class="hljs-number">1</span> - ans &lt;= le) cout &lt;&lt; mx_need * <span class="hljs-number">2</span> - <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br>    <span class="hljs-keyword">else</span> cout &lt;&lt; <span class="hljs-number">-1</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; <span class="hljs-comment">//cin &gt;&gt; T;</span><br>    <span class="hljs-keyword">while</span>(T -- ) <span class="hljs-built_in">marisa</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="F-æ¨±èŠ±æ ‘ä¸‹çš„æ¬²æœ›ä¹‹æœ"><strong>F æ¨±èŠ±æ ‘ä¸‹çš„æ¬²æœ›ä¹‹æœ</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šMarisaMagic</p></blockquote><h3 id="é¢˜æ„æè¿°-6"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªæ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">a_1, a_2, \ldots, a_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œæ±‚æœ‰å¤šå°‘ä¸ªå­åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>â‰¤</mo><mi>l</mi><mo>â‰¤</mo><mi>r</mi><mo>â‰¤</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1 \le l \le r \le n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> æ»¡è¶³åŒºé—´æ‰€æœ‰æ•°çš„ä¹˜ç§¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mi>l</mi></mrow><mi>r</mi></msubsup><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\prod_{i=l}^{r}a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯ä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°ã€‚<a href="https://www.luogu.com.cn/problem/T545111">ã€ŒYAC Round 13ã€æ¨±èŠ±æ ‘ä¸‹çš„æ¬²æœ›ä¹‹æœ</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆè´¨å› æ•°åˆ†è§£ï¼Œå‰ç¼€å¼‚æˆ–å’Œï¼ŒåŠ¨æ€è§„åˆ’ï¼ŒçŠ¶æ€å‹ç¼©ï¼‰"><strong>è§£é¢˜æ€è·¯</strong> ï¼ˆè´¨å› æ•°åˆ†è§£ï¼Œå‰ç¼€å¼‚æˆ–å’Œï¼ŒåŠ¨æ€è§„åˆ’ï¼ŒçŠ¶æ€å‹ç¼©ï¼‰</h3><p>å¯ä»¥å‘ç°ï¼Œä¸€ä¸ªæ•°æ˜¯å®Œå…¨å¹³æ–¹æ•°æ—¶ï¼Œå®ƒçš„æ‰€æœ‰è´¨å› å­çš„æŒ‡æ•°éƒ½ä¸ºå¶æ•°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é¢„å¤„ç†å¯¹æ¯ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> è¿›è¡Œè´¨å› æ•°åˆ†è§£ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> èŒƒå›´æ¯”è¾ƒå°ï¼‰ï¼Œå¹¶è®¡ç®—æ¯ç§è´¨å› å­çš„æŒ‡æ•°å‰ç¼€å’Œï¼Œå¯ä»¥åˆ¤æ–­æ¯ä¸ªå­åŒºé—´çš„ä¹˜ç§¯æ˜¯å¦æ—¶å®Œå…¨å¹³æ–¹æ•°ã€‚ä½†æ˜¯ï¼Œæšä¸¾å­åŒºé—´æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> çš„ï¼Œä¼šè¶…æ—¶ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç”¨ <strong>çŠ¶æ€å‹ç¼©</strong> æ¥ <strong>å­˜å‚¨æ¯ä¸ªæ•°è´¨å› å­çš„æŒ‡æ•°çš„å¥‡å¶æ€§</strong>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æœ€å¤§åªæœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>30</mn></mrow><annotation encoding="application/x-tex">30</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">30</span></span></span></span>ï¼Œå› æ­¤æˆ‘ä»¬ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>30</mn></mrow><annotation encoding="application/x-tex">30</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">30</span></span></span></span> ä½å°±å¯ä»¥è¡¨ç¤ºæ¯ä¸ªè´¨å› å­æŒ‡æ•°çš„å¥‡å¶æ€§ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥é¢„å¤„ç† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>30</mn></mrow><annotation encoding="application/x-tex">30</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">30</span></span></span></span> ä»¥å†…è´¨æ•°ï¼Œç”¨æ›´å°çš„ä½æ•°è¡¨ç¤ºï¼‰ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> è¡¨ç¤ºæŒ‡æ•°ä¸ºå¥‡æ•°ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> è¡¨ç¤ºæŒ‡æ•°ä¸ºå¶æ•°ã€‚</p><p>å½“ä¸€ä¸ªåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> æ‰€æœ‰è´¨å› å­æŒ‡æ•°å’Œéƒ½æ˜¯å¶æ•°æ—¶ï¼Œå‰ç¼€å¼‚æˆ–å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><msub><mi>e</mi><mtext>xor</mtext></msub><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">pre_{\text{xor}}[r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">xor</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><msub><mi>e</mi><mtext>xor</mtext></msub><mo stretchy="false">[</mo><mi>l</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">pre_{\text{xor}}[l - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">xor</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> çš„çŠ¶æ€è¡¨ç¤ºæ˜¾ç„¶æ˜¯ä¸€æ ·çš„ã€‚</p><p>æ•…è€ƒè™‘åŠ¨æ€è§„åˆ’ï¼Œä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> éå†æ•°ç»„ï¼Œè¾¹éå†è¾¹è®¡ç®—æ¯ä¸ªæ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å¾—åˆ°çš„è´¨å› å­æŒ‡æ•°çŠ¶æ€ï¼Œå¹¶è®¡ç®—å‰ç¼€å¼‚æˆ–å’Œã€‚è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">dp_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸ºéå†åˆ°å½“å‰ä½ç½®ä¹‹å‰å‰ç¼€å¼‚æˆ–å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> å‡ºç°çš„æ¬¡æ•°ï¼Œæ•…åªè¦åœ¨éå†è¿‡ç¨‹ä¸­ç´¯åŠ  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">dp_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå†æ›´æ–° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mi>x</mi></msub><mtext>+=</mtext><mn>1</mn></mrow><annotation encoding="application/x-tex">dp_x \text{+=} 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord text"><span class="mord">+=</span></span><span class="mord">1</span></span></span></span> å³å¯ã€‚ï¼ˆç”±äºæ•°å­—æ¯”è¾ƒå¤§ï¼Œéœ€è¦ç”¨ <code>map</code> å®ç° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">dp_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼‰</p><p>æ—¶é—´å¤æ‚åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>n</mi><msqrt><msub><mi>a</mi><mi>max</mi><mo>â¡</mo></msub></msqrt><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n\sqrt{a_{\max}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0647em;vertical-align:-0.3147em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6853em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œå…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>max</mi><mo>â¡</mo></msub></mrow><annotation encoding="application/x-tex">a_{\max}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸ºæ‰€æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„æœ€å¤§å€¼ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">marisa</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> n; cin &gt;&gt; n;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">s</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>; <span class="hljs-comment">// æ¯ä¸ªæ•°è´¨å› å­æŒ‡æ•°çŠ¶æ€</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, x; i &lt;= n; i ++ )&#123; <span class="hljs-comment">// è´¨å› æ•°åˆ†è§£ï¼ŒçŠ¶æ€å‹ç¼©</span><br>        cin &gt;&gt; x;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> p = <span class="hljs-number">2</span>; p * p &lt;= x; p ++ )<br>            <span class="hljs-keyword">while</span>(x % p == <span class="hljs-number">0</span>) x /= p, s[i] ^= (<span class="hljs-number">1</span> &lt;&lt; p);<br>        <span class="hljs-keyword">if</span>(x &gt; <span class="hljs-number">1</span>) s[i] ^= (<span class="hljs-number">1</span> &lt;&lt; x);<br>    &#125;<br><br>    <span class="hljs-type">long</span> <span class="hljs-type">long</span> ans = <span class="hljs-number">0</span>;<br>    unordered_map&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; dp; <span class="hljs-comment">// ç»Ÿè®¡å‰é¢å‰ç¼€å¼‚æˆ–å’Œå‡ºç°æ¬¡æ•°</span><br>    dp[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>; <span class="hljs-comment">// æ³¨æ„ dp[0] èµ‹å€¼ä¸º 1</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        s[i] ^= s[i - <span class="hljs-number">1</span>]; <span class="hljs-comment">// å‰ç¼€å¼‚æˆ–å’Œ</span><br>        ans += dp[s[i]] ++ ; <span class="hljs-comment">// ç´¯åŠ ç­”æ¡ˆå¹¶æ›´æ–°å¼‚æˆ–å’Œå‡ºç°æ¬¡æ•°</span><br>    &#125;<br>    cout &lt;&lt; ans &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; <span class="hljs-comment">//cin &gt;&gt; T;</span><br>    <span class="hljs-keyword">while</span>(T -- ) <span class="hljs-built_in">marisa</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="G-è¶…çº§tagæ–™ç†å¤§èµ›"><strong>G è¶…çº§tagæ–™ç†å¤§èµ›</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šMarisaMagic</p></blockquote><h3 id="é¢˜æ„æè¿°-7"><strong>é¢˜æ„æè¿°</strong></h3><p>æœ‰ä¸€ä¸ªæ•°è½´ï¼Œæ•°è½´ä¸Šæœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªä¸åŒçš„æ•´æ•°ç‚¹ï¼Œåˆ†ä¸ºè“è‰²å’Œçº¢è‰²ã€‚æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> æ¬¡æ“ä½œï¼Œç»´æŠ¤ä¸€ä¸ªå¯é‡é›†åˆå­˜æ”¾çº¿æ®µï¼š</p><ul><li><p><code>1 l r</code>ï¼šå°†æ‰€æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>â‰¤</mo><mi>x</mi><mo>â‰¤</mo><mi>y</mi><mo>â‰¤</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">l \le x \le y \le r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> ä¸” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x, y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> å‡ä¸ºæ•´æ•°çš„çº¿æ®µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x, y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span></span></span></span> æ”¾åˆ°é›†åˆä¸­ã€‚</p></li><li><p><code>2 k</code>ï¼šæ’¤é”€ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> æ¬¡æ“ä½œä¸­æ·»åŠ çš„æ‰€æœ‰çº¿æ®µã€‚</p></li></ul><p>åˆå§‹æƒ…å†µä¸‹å’Œæ¯æ¬¡æ“ä½œåï¼Œå¯ä»¥ä»»æ„æ¬¡é€‰æ‹©çº¿æ®µã€‚æ¯æ¬¡é€‰å‡ºä¸€æ¡çº¿æ®µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x, y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span></span></span></span>ï¼Œéœ€è¦æ»¡è¶³ <strong>ä½äºç«¯ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> ä¸Š</strong> çš„æ•´æ•°ç‚¹å‡ä¸ºçº¢ç‚¹ã€‚é€‰å‡ºåï¼Œçº¿æ®µåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x, y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span></span></span></span> å†…æ‰€æœ‰è“ç‚¹å‡ä¼šå˜æˆçº¢ç‚¹ã€‚</p><p>åœ¨åˆå§‹æƒ…å†µä¸‹å’Œæ¯æ¬¡æ“ä½œåï¼Œåˆ¤æ–­æ˜¯å¦èƒ½å¤Ÿæ‰¾åˆ°è‡³å°‘ä¸€ç§åˆæ³•çš„é€‰æ‹©æ–¹æ¡ˆä½¿å¾—æ‰€æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªæ•´æ•°ç‚¹éƒ½å˜æˆçº¢ç‚¹ã€‚</p><p><a href="https://www.luogu.com.cn/problem/T544015">ã€ŒYAC Round 13ã€è¶…çº§tagæ–™ç†å¤§èµ›</a></p><p><strong>å„ç»„è¯¢é—®ä¹‹é—´ç‹¬ç«‹ã€‚</strong></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆçº¿æ®µæ ‘ï¼Œç¦»æ•£åŒ–ï¼ŒäºŒåˆ†ï¼‰"><strong>è§£é¢˜æ€è·¯</strong> ï¼ˆçº¿æ®µæ ‘ï¼Œç¦»æ•£åŒ–ï¼ŒäºŒåˆ†ï¼‰</h3><p>é¢˜ç›®çœ‹ä¼¼æ¯æ¬¡å¢åŠ äº†å¾ˆå¤šçº¿æ®µï¼Œä½†å®é™…ä¸Šé™¤äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªæ•´æ•°ç‚¹ä¹‹å¤–çš„ç‚¹éƒ½æ— æ„ä¹‰ï¼Œä¸”æ“ä½œä¸­æœ€æœ‰ç”¨çš„çº¿æ®µåªæœ‰é‚£ä¸ª <strong>ç«¯ç‚¹å‡ä¸ºçº¢ç‚¹</strong> ä¸”å¯ä»¥è¦†ç›–æœ€å¤§èŒƒå›´çš„çº¿æ®µï¼Œå¤§èŒƒå›´ä¸€å®šæ˜¯å¯ä»¥è¦†ç›–å°èŒƒå›´çš„ã€‚å› æ­¤ï¼Œæ¯æ¬¡æ“ä½œåªéœ€è¦è€ƒè™‘ä¸€ä¸ªçº¿æ®µå³å¯ã€‚</p><p>æ•…æˆ‘ä»¬å¯ä»¥å°†å¢åŠ æ“ä½œçœ‹ä½œæ¯æ¬¡å¢åŠ ä¸€æ¡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> èŒƒå›´å†…ç«¯ç‚¹ä¸ºçº¢ç‚¹çš„æœ€é•¿çº¿æ®µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x, y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span></span></span></span>ï¼Œå°†åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x, y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span></span></span></span> çš„è“ç‚¹éƒ½å˜æˆçº¢ç‚¹ã€‚</p><p>æˆ‘ä»¬æ¯æ¬¡å¢åŠ çš„çº¿æ®µéƒ½æ˜¯è¦†ç›–èŒƒå›´æœ€å¤§çš„ï¼Œè€Œåˆå­˜åœ¨æ’¤é”€æ“ä½œï¼Œæ•…æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸€åŒºé—´ä¿®æ”¹æ“ä½œçœ‹ä½œæ˜¯åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x, y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span></span></span></span> çš„æ¯ä¸ªæ•´æ•°ç‚¹ä¸Š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span>ã€‚æ’¤é”€æ“ä½œä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦è®°å½•æ¯ä¸€æ¬¡å¢åŠ çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x, y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span></span></span></span>ï¼Œå½“å‡ºç°æ’¤é”€æ“ä½œæ—¶ï¼Œå–å‡ºå¹¶å°†åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x, y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span></span></span></span> æ•´æ•°ç‚¹éƒ½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span> å³å¯ã€‚<br>æ¯æ¬¡è¯¢é—®åªéœ€è¦åˆ¤æ–­æ•´ä¸ªæ•°è½´ä¸Šçš„æœ€å°å€¼æ˜¯å¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰¤</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\le 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> å³å¯åˆ¤æ–­æ˜¯å¦è¿˜å­˜åœ¨æ²¡æœ‰è¢«è¦†ç›–åˆ°çš„è“ç‚¹ã€‚å¦‚æœè¿˜å­˜åœ¨è“ç‚¹ï¼Œé‚£ä¹ˆå°±é›†åˆä¸­çš„æ‰€æœ‰çº¿æ®µæ— æ³•ä½¿å¾—æ‰€æœ‰ç‚¹å˜æˆçº¢ç‚¹ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬è€ƒè™‘ç”¨çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´æœ€å°å€¼ï¼Œæ”¯æŒåŒºé—´ä¿®æ”¹ã€‚æ¯æ¬¡è¯¢é—®æŸ¥è¯¢ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªæ•´æ•°ç‚¹çš„æœ€å°å€¼æ˜¯å¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰¤</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\le 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> å³å¯ã€‚</p><p>å¦‚ä½•å®ç°æ‰¾åˆ°æœ€å¤§è¦†ç›–èŒƒå›´çš„çº¿æ®µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x, y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span></span></span></span> ï¼Ÿæˆ‘ä»¬å¯ä»¥ç¦»æ•£åŒ–æ‰€æœ‰çš„åˆå§‹çº¢è‰²ç‚¹ï¼Œæ¯æ¬¡æ“ä½œåäºŒåˆ†åŒºé—´èŒƒå›´æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºç­‰äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> çš„ä½ç½®çš„çº¢ç‚¹å’Œæœ€åä¸€ä¸ªå°äºç­‰äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> çš„ä½ç½®çš„çº¢ç‚¹å³å¯ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n \log{n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">n</span></span><span class="mclose">)</span></span></span></span>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ls (u &lt;&lt; 1)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> rs (u &lt;&lt; 1 | 1)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> mid (l + r &gt;&gt; 1)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">5e5</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> n, m, q, a[N], p[N], b[N], id[N], mn[N &lt;&lt; <span class="hljs-number">2</span>], lazy[N &lt;&lt; <span class="hljs-number">2</span>];<br>pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; ops[N];<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">pushup</span><span class="hljs-params">(<span class="hljs-type">int</span> u)</span></span>&#123; mn[u] = <span class="hljs-built_in">min</span>(mn[ls], mn[rs]); &#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">pushdown</span><span class="hljs-params">(<span class="hljs-type">int</span> u)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(lazy[u])&#123;<br>        lazy[ls] += lazy[u], mn[ls] += lazy[u];<br>        lazy[rs] += lazy[u], mn[rs] += lazy[u];    <br>        lazy[u] = <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">build</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(l == r)&#123; mn[u] = a[l]; <span class="hljs-keyword">return</span>; &#125;<br>    <span class="hljs-built_in">build</span>(ls, l, mid);<br>    <span class="hljs-built_in">build</span>(rs, mid + <span class="hljs-number">1</span>, r);<br>    <span class="hljs-built_in">pushup</span>(u);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">modify</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r, <span class="hljs-type">int</span> ql, <span class="hljs-type">int</span> qr, <span class="hljs-type">int</span> x)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(ql &lt;= l &amp;&amp; r &lt;= qr)&#123; mn[u] += x, lazy[u] += x; <span class="hljs-keyword">return</span>; &#125;<br>    <span class="hljs-built_in">pushdown</span>(u);<br>    <span class="hljs-keyword">if</span>(ql &lt;= mid) <span class="hljs-built_in">modify</span>(ls, l, mid, ql, qr, x);<br>    <span class="hljs-keyword">if</span>(qr &gt; mid) <span class="hljs-built_in">modify</span>(rs, mid + <span class="hljs-number">1</span>, r, ql, qr, x);<br>    <span class="hljs-built_in">pushup</span>(u);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r, <span class="hljs-type">int</span> ql, <span class="hljs-type">int</span> qr)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(ql &lt;= l &amp;&amp; r &lt;= qr) <span class="hljs-keyword">return</span> mn[u];<br>    <span class="hljs-built_in">pushdown</span>(u);<br>    <span class="hljs-type">int</span> res = <span class="hljs-number">1e9</span>;<br>    <span class="hljs-keyword">if</span>(ql &lt;= mid) res = <span class="hljs-built_in">min</span>(res, <span class="hljs-built_in">query</span>(ls, l, mid, ql, qr));<br>    <span class="hljs-keyword">if</span>(qr &gt; mid) res = <span class="hljs-built_in">min</span>(res, <span class="hljs-built_in">query</span>(rs, mid + <span class="hljs-number">1</span>, r, ql, qr));<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; q;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; p[i];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        cin &gt;&gt; a[i];<br>        <span class="hljs-keyword">if</span>(a[i]) b[ ++ m] = p[i], id[m] = i; <span class="hljs-comment">// ç¦»æ•£åŒ–æ»¡è¶³çŠ¶æ€çš„çº¢ç‚¹</span><br>    &#125;<br><br>    <span class="hljs-built_in">build</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, n);<br>    cout &lt;&lt; (<span class="hljs-built_in">query</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, n, <span class="hljs-number">1</span>, n) &lt;= <span class="hljs-number">0</span> ? <span class="hljs-string">&quot;No&quot;</span> : <span class="hljs-string">&quot;Yes&quot;</span>) &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, op, l, r, x, y, k; i &lt;= q; i ++ )&#123;<br>        cin &gt;&gt; op;<br>        <span class="hljs-keyword">if</span>(op == <span class="hljs-number">1</span>)&#123;<br>            cin &gt;&gt; l &gt;&gt; r;<br>            x = id[<span class="hljs-built_in">lower_bound</span>(b + <span class="hljs-number">1</span>, b + m + <span class="hljs-number">1</span>, l) - b]; <span class="hljs-comment">// äºŒåˆ†æ‰¾åˆ°æœ€å¤§èŒƒå›´å¯ä»¥æŸ“çº¢çš„åŒºé—´</span><br>            y = id[<span class="hljs-built_in">upper_bound</span>(b + <span class="hljs-number">1</span>, b + m + <span class="hljs-number">1</span>, r) - b - <span class="hljs-number">1</span>];<br>            <span class="hljs-keyword">if</span>(x &amp;&amp; y &amp;&amp; x &lt;= y)&#123;<br>                <span class="hljs-built_in">modify</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, n, x, y, <span class="hljs-number">1</span>);<br>                ops[i] = &#123;x, y&#125;;<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            cin &gt;&gt; k;<br>            <span class="hljs-keyword">auto</span> [x, y] = ops[k];<br>            <span class="hljs-keyword">if</span>(x &amp;&amp; y &amp;&amp; x &lt;= y) <span class="hljs-built_in">modify</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, n, x, y, <span class="hljs-number">-1</span>);<br>        &#125;<br>        cout &lt;&lt; (<span class="hljs-built_in">query</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, n, <span class="hljs-number">1</span>, n) &lt;= <span class="hljs-number">0</span> ? <span class="hljs-string">&quot;No&quot;</span> : <span class="hljs-string">&quot;Yes&quot;</span>) &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å’å”±å…‰èŠ’</category>
      
      <category>YAC æ‰¬å·å¤§å­¦ç®—æ³•ç»ƒä¹ èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>ç®—æ³•ç«èµ›</tag>
      
      <tag>Luogu</tag>
      
      <tag>YAC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 YAC Round 12 é¢˜è§£</title>
    <link href="/2024/12/14/YAC_Round_12/"/>
    <url>/2024/12/14/YAC_Round_12/</url>
    
    <content type="html"><![CDATA[<h2 id="A-æ°´ä¸Šç”±å´çš„å­—ç¬¦ä¸²"><strong>A æ°´ä¸Šç”±å´çš„å­—ç¬¦ä¸²</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šLynia</p></blockquote><h3 id="é¢˜æ„æè¿°"><strong>é¢˜æ„æè¿°</strong></h3><p>å€’åºè¾“å‡ºå­—ç¬¦ä¸²ã€‚<a href="https://www.luogu.com.cn/problem/T541159">ã€ŒYAC Round 12ã€æ°´ä¸Šç”±å´çš„å­—ç¬¦ä¸²</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆè¯­æ³•é¢˜ï¼‰"><strong>è§£é¢˜æ€è·¯</strong> ï¼ˆè¯­æ³•é¢˜ï¼‰</h3><p>ç›´æ¥å€’åºè¾“å‡ºï¼Œæˆ–è€…ç”¨ C++ çš„ <code>reverse</code> æ›´æ”¹æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨ Python çš„åˆ‡ç‰‡ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span> (T--) &#123;<br>        string a; cin &gt;&gt; a;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = a.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) cout &lt;&lt; a[i];<br>        cout &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span> (T--) &#123;<br>        string a; cin &gt;&gt; a;<br>        <span class="hljs-built_in">reverse</span>(a.<span class="hljs-built_in">begin</span>(), a.<span class="hljs-built_in">end</span>());<br>        cout &lt;&lt; a &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">T = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(T): <span class="hljs-built_in">print</span>(<span class="hljs-built_in">input</span>()[::-<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure><h2 id="B-ä¸‰åˆ†ä¹‹ç‹"><strong>B ä¸‰åˆ†ä¹‹ç‹</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šMarisaMagic</p></blockquote><h3 id="é¢˜æ„æè¿°-2"><strong>é¢˜æ„æè¿°</strong></h3><p>å·²çŸ¥çƒç­ä½äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span>ï¼Œä¸‰åˆ†çº¿ä¸ºä¸€ä¸ªåŠå¾„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>7.25</mn><mi>m</mi></mrow><annotation encoding="application/x-tex">7.25m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">7.25</span><span class="mord mathnormal">m</span></span></span></span> çš„åœ†å¼§ï¼ŒæŠ•ç¯®ç‚¹å¯ç”± <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> è¡¨ç¤ºï¼ˆå•ä½ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>ï¼‰ã€‚ç»Ÿè®¡å‘½ä¸­çš„æŠ•ç¯®ä¸­æœ‰å¤šå°‘ä¸ªæ˜¯ä¸‰åˆ†çƒã€‚ï¼ˆâ€œbang!!!â€ ä¸ºæŠ•ç¯®å‘½ä¸­ï¼Œâ€œmissedâ€ ä¸ºæœªå‘½ä¸­ï¼‰<a href="https://www.luogu.com.cn/problem/T539405">ã€ŒYAC Round 12ã€ä¸‰åˆ†ä¹‹ç‹</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆç®€å•è®¡ç®—å‡ ä½•ï¼‰"><strong>è§£é¢˜æ€è·¯</strong> ï¼ˆç®€å•è®¡ç®—å‡ ä½•ï¼‰</h3><p>å¯¹äºæ¯æ¬¡æŠ•ç¯®ï¼Œå…ˆåˆ¤æ–­æ˜¯å¦è¿›çƒï¼Œå†åˆ¤æ–­æ˜¯å¦æ»¡è¶³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>&gt;</mo><mn>7.2</mn><msup><mn>5</mn><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">x ^ 2 + y ^ 2 &gt; 7.25^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">7.2</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> or <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup></mrow></msqrt><mo>&gt;</mo><mn>7.25</mn></mrow><annotation encoding="application/x-tex">\sqrt{x ^ 2 + y ^ 2} &gt; 7.25</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.2822em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9578em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.9178em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120c340,-704.7,510.7,-1060.3,512,-1067l0 -0c4.7,-7.3,11,-11,19,-11H40000v40H1012.3s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60zM1001 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2822em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">7.25</span></span></span></span> å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">marisa</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> n, ans = <span class="hljs-number">0</span>; cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        string s; cin &gt;&gt; s;<br>        <span class="hljs-type">double</span> x, y; cin &gt;&gt; x &gt;&gt; y;<br>        ans += (s[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;b&#x27;</span> &amp;&amp; x * x + y * y &gt; <span class="hljs-number">7.25</span> * <span class="hljs-number">7.25</span>);<br>    &#125;<br>    cout &lt;&lt; ans &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; <span class="hljs-comment">// cin &gt;&gt; T;</span><br>    <span class="hljs-keyword">while</span>(T -- ) <span class="hljs-built_in">marisa</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="C-å¤§ç©ºé­”æœ¯"><strong>C å¤§ç©ºé­”æœ¯</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šMarisaMagic</p></blockquote><h3 id="é¢˜æ„æè¿°-3"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªæ— æ•°ä¸ªèŠ‚ç‚¹çš„å¸¦æƒæ— å‘å®Œå…¨å›¾ï¼Œç¼–å· <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>âˆ¼</mo><mo>+</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">1 \sim +\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">+</span><span class="mord">âˆ</span></span></span></span>ï¼Œä¸¤ä¸ªä¸åŒèŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> ä¹‹é—´çš„è¾¹çš„é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>lcm</mtext><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{lcm}(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">lcm</span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>ã€‚æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ä¸¤ä¸ªèŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x, y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ï¼Œæ±‚ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„æœ€çŸ­è·ç¦»ã€‚ <a href="https://www.luogu.com.cn/problem/T540661">ã€ŒYAC Round 12ã€å¤§ç©ºé­”æœ¯</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆæ•°å­¦ï¼‰"><strong>è§£é¢˜æ€è·¯</strong> ï¼ˆæ•°å­¦ï¼‰</h3><p>å…ˆåˆ¤æ–­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x = y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> çš„æƒ…å†µï¼Œæ­¤æ—¶ç­”æ¡ˆä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼›</p><p>è‹¥èµ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> æ­¥ï¼Œæœ€çŸ­çš„è·ç¦»å°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>lcm</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{lcm}(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">lcm</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>ï¼›</p><p>è‹¥èµ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> æ­¥ï¼Œç¬¬ä¸€æ­¥ä¸€å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰¥</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">\ge x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼Œç¬¬äºŒæ­¥ä¸€å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰¥</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">\ge y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ï¼Œå› æ­¤èµ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> æ­¥æ‰€å¾—çš„è·ç¦»ä¸€å®šæ»¡è¶³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰¥</mo><mi>x</mi><mo>+</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">\ge x + y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ã€‚æ˜¾ç„¶ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> çš„èµ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> æ­¥çš„æœ€çŸ­è·ç¦»å¯ä»¥åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>lcm</mtext><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mtext>lcm</mtext><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo>+</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">\text{lcm}(1, x) + \text{lcm}(1, y) = x + y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">lcm</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">lcm</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> æ—¶å–åˆ°ã€‚</p><p>è‹¥èµ°å¤§äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> æ­¥ï¼Œæ˜¾ç„¶ä¸ä¼šæ¯”åªèµ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> æ­¥æ›´ä¼˜ã€‚å› æ­¤å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=Ì¸</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x \not = y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel">î€ </span></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> æ—¶ï¼Œç­”æ¡ˆå°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>â¡</mo><mo stretchy="false">(</mo><mtext>lcm</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>x</mi><mo>+</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\min(\text{lcm}(x, y), x + y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord text"><span class="mord">lcm</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>ã€‚ä½†æ˜¯ï¼Œæ•°æ®èŒƒå›´ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>18</mn></msup></mrow><annotation encoding="application/x-tex">1 \le x, y \le 10^{18}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">18</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œç›´æ¥æ±‚æœ€å°å…¬å€æ•°ä¼šå¯¼è‡´æ•°æ®æº¢å‡ºï¼ˆä¸ºæ­¤æœ¬é¢˜ä¹Ÿå¡æ‰äº†pythonï¼‰</p><p>æˆ‘ä»¬å‡å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>&lt;</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x &lt; y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>gcd</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\gcd(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span style="margin-right:0.01389em;">g</span>cd</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> è¡¨ç¤º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x, y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> çš„ <strong>æœ€å¤§å…¬çº¦æ•°</strong>ï¼Œåˆ†ç±»è®¨è®º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>lcm</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{lcm}(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">lcm</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> ä¸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>+</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x + y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> çš„å¤§å°å…³ç³»ï¼š</p><ul><li><p>è‹¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>gcd</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">\gcd(x, y) = x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span style="margin-right:0.01389em;">g</span>cd</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼Œå¯ä»¥æ¨å‡º:</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>lcm</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>y</mi><mo>&lt;</mo><mi>x</mi><mo>+</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">\text{lcm}(x, y) = y &lt; x + y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">lcm</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span></p><p>æ•…æ­¤æ—¶ç­”æ¡ˆä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ã€‚</p></li><li><p>è‹¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>gcd</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=Ì¸</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">\gcd(x, y) \not = x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span style="margin-right:0.01389em;">g</span>cd</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel">î€ </span></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼Œåˆ™è¡¨æ˜ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>x</mi><mrow><mi>gcd</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>â‰¥</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\frac{x}{\gcd(x, y)} \ge 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2154em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight" style="margin-right:0.01389em;">g</span><span class="mtight">c</span><span class="mtight">d</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>ï¼Œç”±æ­¤æˆ‘ä»¬å¯ä»¥æ¨å‡ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>lcm</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>x</mi><mo>Ã—</mo><mi>y</mi></mrow><mrow><mi>gcd</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>â‰¥</mo><mn>2</mn><mi>y</mi><mo>&gt;</mo><mi>x</mi><mo>+</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">\text{lcm}(x, y) = \frac{x \times y}{\gcd(x, y)} \ge 2 y &gt; x + y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">lcm</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1963em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span style="margin-right:0.01389em;">g</span>cd</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span></p><p>æ•…æ­¤æ—¶ç­”æ¡ˆä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>+</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x + y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ã€‚</p></li></ul><p>æˆ‘ä»¬ç”šè‡³å¯ä»¥ä¸ç”¨æ±‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>gcd</mi><mo>â¡</mo></mrow><annotation encoding="application/x-tex">\gcd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mop"><span style="margin-right:0.01389em;">g</span>cd</span></span></span></span> æ¥è¿›è¡Œåˆ¤æ–­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>gcd</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo>â‡”</mo><mi>y</mi><mspace></mspace><mspace width="0.6667em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\gcd(x, y) = x \Leftrightarrow y \mod x = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span style="margin-right:0.01389em;">g</span>cd</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‡”</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6667em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> æ˜¯ä¸€ä¸ªå……è¦æ¡ä»¶ï¼Œå› æ­¤åªéœ€è¦çœ‹æ˜¯å¦æ»¡è¶³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mspace></mspace><mspace width="0.6667em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y \mod x = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6667em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> æ¡ä»¶åˆ¤æ–­ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">using</span> ll = <span class="hljs-type">long</span> <span class="hljs-type">long</span>;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">marisa</span><span class="hljs-params">()</span></span>&#123;<br>    ll x, y; cin &gt;&gt; x &gt;&gt; y;<br>    <span class="hljs-keyword">if</span>(x == y)&#123; cout &lt;&lt; <span class="hljs-number">0</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <span class="hljs-keyword">return</span>; &#125;<br>    <span class="hljs-keyword">if</span>(x &gt; y) <span class="hljs-built_in">swap</span>(x, y);<br>    cout &lt;&lt; (y % x == <span class="hljs-number">0</span> ? y : x + y) &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- ) <span class="hljs-built_in">marisa</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="D-è¯é³¥é¢¨æœˆ"><strong>D è¯é³¥é¢¨æœˆ</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šMarisaMagic</p></blockquote><h3 id="é¢˜æ„æè¿°-4"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€é¢— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸ºé»‘è‰²æˆ–ç™½è‰²ã€‚æ±‚ <strong>ç›¸é‚»èŠ‚ç‚¹é¢œè‰²å‡ä¸ç›¸åŒ</strong> çš„æœ€é•¿ç®€å•è·¯å¾„çš„é•¿åº¦ï¼ˆèŠ‚ç‚¹ä¸ªæ•°ï¼‰ã€‚<a href="https://www.luogu.com.cn/problem/T539630">ã€ŒYAC Round 12ã€è¯é³¥é¢¨æœˆ</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆæ ‘çš„ç›´å¾„-æ ‘å½¢DP-ä¸¤æ¬¡DFSï¼‰"><strong>è§£é¢˜æ€è·¯</strong> ï¼ˆæ ‘çš„ç›´å¾„ æ ‘å½¢DP / ä¸¤æ¬¡DFSï¼‰</h3><p>ä»¥ä¸‹ç§°æ»¡è¶³ <strong>ç›¸é‚»èŠ‚ç‚¹é¢œè‰²å‡ä¸ç›¸åŒ</strong> çš„æœ€é•¿ç®€å•è·¯å¾„ä¸ºâ€œåˆæ³•è·¯å¾„â€ã€‚</p><p>æˆ‘ä»¬è®¾å®šèŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä¸ºæ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œè€ƒè™‘ <strong>æ ‘å½¢DP</strong>ã€‚è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">f_1[u]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> ä¸ºæ ¹çš„å­æ ‘å‘ä¸‹æ‰€èƒ½å»¶ä¼¸çš„ <strong>æœ€é•¿</strong> åˆæ³•è·¯å¾„é•¿åº¦ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>2</mn></msub><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">f_2[u]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> ä¸ºæ ¹çš„å­æ ‘å‘ä¸‹æ‰€èƒ½å»¶ä¼¸çš„ <strong>æ¬¡é•¿</strong> åˆæ³•è·¯å¾„é•¿åº¦ã€‚è¦æ±‚å¾—æ•´æ£µæ ‘çš„æœ€é•¿åˆæ³•è·¯å¾„é•¿åº¦ï¼Œæšä¸¾æ¯ä¸ªèŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä½œä¸ºä¸­é—´çš„ç‚¹ï¼Œæ‰¾å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>+</mo><msub><mi>f</mi><mn>2</mn></msub><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">f_1[i] + f_2[i] + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> æœ€å¤§å€¼å³å¯ï¼ˆè·¯å¾„é•¿åº¦å®šä¹‰ä¸ºèŠ‚ç‚¹ä¸ªæ•°ï¼Œå› æ­¤è¦ $ + 1$ï¼‰ã€‚</p><p>å¯ä»¥å‘ç°ä¸Šè¿°åšæ³•å’Œæ±‚è§£ <a href="https://oi-wiki.org/graph/tree-diameter/"><strong>æ ‘çš„ç›´å¾„</strong></a> æ˜¯å®Œå…¨ä¸€è‡´çš„ï¼Œä½†éœ€è¦åœ¨çŠ¶æ€è½¬ç§»è¿‡ç¨‹ä¸­å¢åŠ èŠ‚ç‚¹é¢œè‰²çš„åˆ¤æ–­ã€‚è‡ªåº•å‘ä¸Šä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> è½¬ç§»åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> æ—¶ï¼Œå¦‚æœé¢œè‰²ä¸åŒï¼Œç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">f_1[v] + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> ä¸ºæ ¹çš„å­æ ‘æ‰€èƒ½å»¶ä¼¸çš„æœ€é•¿å’Œæ¬¡é•¿é•¿åº¦æ­£å¸¸æ›´æ–°ï¼›å¦‚æœé¢œè‰²ç›¸åŒï¼Œåˆ™ä¸èƒ½èµ°è¿‡å»ï¼Œç›´æ¥è·³è¿‡å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// dpæ±‚æ ‘çš„ç›´å¾„ å†™æ³•1</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> n, ans, c[N], f1[N], f2[N];<br>vector&lt;<span class="hljs-type">int</span>&gt; e[N];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> fa)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;v : e[u])&#123;<br>        <span class="hljs-keyword">if</span>(v == fa) <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-built_in">dfs</span>(v, u);<br>        <span class="hljs-keyword">if</span>(c[u] == c[v]) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// é¢œè‰²ç›¸åŒç›´æ¥è·³è¿‡</span><br>        <span class="hljs-type">int</span> tmp = f1[v] + <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span>(tmp &gt; f1[u]) f2[u] = f1[u], f1[u] = tmp;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(tmp &gt; f2[u]) f2[u] = tmp;<br>    &#125;<br>    ans = <span class="hljs-built_in">max</span>(ans, f1[u] + f2[u] + <span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">marisa</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; c[i];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, u, v; i &lt; n; i ++ )&#123;<br>        cin &gt;&gt; u &gt;&gt; v;<br>        e[u].<span class="hljs-built_in">emplace_back</span>(v);<br>        e[v].<span class="hljs-built_in">emplace_back</span>(u);<br>    &#125;<br><br>    <span class="hljs-built_in">dfs</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);<br><br>    cout &lt;&lt; ans &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; <span class="hljs-comment">//cin &gt;&gt; T;</span><br>    <span class="hljs-keyword">while</span>(T -- ) <span class="hljs-built_in">marisa</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨å¦ä¸€ç§æ ‘å½¢ DP æ–¹æ³•ã€‚å®šä¹‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">f[u]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> ä¸ºæ ¹çš„å­æ ‘å‘ä¸‹æ‰€èƒ½å»¶ä¼¸çš„ <strong>æœ€é•¿</strong> åˆæ³•è·¯å¾„é•¿åº¦ã€‚ç±»ä¼¼äº <a href="https://oi-wiki.org/graph/tree-diameter/"><strong>æ ‘çš„ç›´å¾„ OI Wiki</strong></a> ä¸­ <strong>è¿‡ç¨‹2</strong> çš„åšæ³•ï¼Œå¢åŠ ä¸€ä¸ªèŠ‚ç‚¹é¢œè‰²åˆ¤æ–­å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// dpæ±‚æ ‘çš„ç›´å¾„ å†™æ³•2</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> fa)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;v : e[u])&#123;<br>        <span class="hljs-keyword">if</span>(v == fa) <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-built_in">dfs</span>(v, u);<br>        <span class="hljs-keyword">if</span>(c[u] ^ c[v])&#123;<br>            ans = <span class="hljs-built_in">max</span>(ans, dp[u] + dp[v] + <span class="hljs-number">2</span>); <span class="hljs-comment">// èŠ‚ç‚¹ä¸ªæ•°éœ€å†+1</span><br>            dp[u] = <span class="hljs-built_in">max</span>(dp[u], dp[v] + <span class="hljs-number">1</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸€æ¡è¾¹ä¸ŠèŠ‚ç‚¹é¢œè‰²ç›¸åŒï¼Œæˆ‘ä»¬çš„æ“ä½œæ˜¯ç›´æ¥è·³è¿‡ï¼Œè¾¹ä¸Šç«¯ç‚¹æ‰€å±çš„å­æ ‘ä¹‹é—´ç»“æœäº’ä¸å½±å“ã€‚å› æ­¤å¯ä»¥åœ¨å»ºæ ‘çš„æ—¶å€™å¿½ç•¥è¿™äº›ç«¯ç‚¹é¢œè‰²ç›¸åŒçš„è¾¹ï¼Œæ„å»ºè‹¥å¹²ä¸ªå°æ ‘ã€‚æœ€ç»ˆæˆ‘ä»¬åªéœ€è¦åœ¨æ¯ä¸ªå°æ ‘ä¸Šå•ç‹¬è¿›è¡Œ <strong>æ ‘å½¢DP / ä¸¤æ¬¡DFS</strong> æ±‚å¾—æ ‘çš„ç›´å¾„ï¼Œå†å–æœ€å¤§å€¼å³ä¸ºç­”æ¡ˆã€‚ä»¥ä¸‹ç»™å‡ºå¿½ç•¥ç«¯ç‚¹é¢œè‰²ç›¸åŒçš„è¾¹ï¼Œç”¨ <strong>ä¸¤æ¬¡DFS</strong> æ±‚è§£çš„ä»£ç ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// ä¸¤æ¬¡dfsæ±‚æ ‘çš„ç›´å¾„</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> n, ans, id, c[N], dist[N];<br>vector&lt;<span class="hljs-type">int</span>&gt; e[N];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> fa)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;v : e[u])&#123;<br>        <span class="hljs-keyword">if</span>(v == fa) <span class="hljs-keyword">continue</span>;<br>        dist[v] = dist[u] + <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span>(dist[v] &gt; dist[id]) id = v; <span class="hljs-comment">// è®°å½•æœ€è¿œç«¯ç‚¹</span><br>        <span class="hljs-built_in">dfs</span>(v, u);<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">marisa</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; c[i];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, u, v; i &lt; n; i ++ )&#123;<br>        cin &gt;&gt; u &gt;&gt; v;<br>        <span class="hljs-keyword">if</span>(c[u] + c[v] != <span class="hljs-number">1</span>) <span class="hljs-keyword">continue</span>;<br>        e[u].<span class="hljs-built_in">emplace_back</span>(v);<br>        e[v].<span class="hljs-built_in">emplace_back</span>(u);<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        id = <span class="hljs-number">0</span>;<br>        <span class="hljs-built_in">dfs</span>(i, <span class="hljs-number">0</span>);  <span class="hljs-comment">// æ‰¾åˆ°ç«¯ç‚¹c</span><br>        dist[id] = <span class="hljs-number">0</span>;<br>        <span class="hljs-built_in">dfs</span>(id, <span class="hljs-number">0</span>); <span class="hljs-comment">// æ‰¾åˆ°idå¯¹åº”æœ€è¿œç‚¹  </span><br>        ans = <span class="hljs-built_in">max</span>(ans, dist[id] + <span class="hljs-number">1</span>);<br>    &#125;<br><br>    cout &lt;&lt; ans &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; <span class="hljs-comment">//cin &gt;&gt; T;</span><br>    <span class="hljs-keyword">while</span>(T -- ) <span class="hljs-built_in">marisa</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="E-äº¤å‰æ˜Ÿå°˜"><strong>E äº¤å‰æ˜Ÿå°˜</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šMarisaMagic</p></blockquote><h3 id="é¢˜æ„æè¿°-5"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªèŠ‚ç‚¹çš„å¸¦æƒæ— å‘å›¾ï¼Œæœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> ä¸ªé›†åˆï¼Œç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªé›†åˆå¯è¡¨ç¤ºä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub><mo>=</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><msub><mi>v</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>v</mi><mrow><mi mathvariant="normal">âˆ£</mi><mi>P</mi><mi mathvariant="normal">âˆ£</mi></mrow></msub><mo separator="true">,</mo><msub><mi>b</mi><mrow><mi mathvariant="normal">âˆ£</mi><mi>P</mi><mi mathvariant="normal">âˆ£</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">P_i = \{(v_1, b_1), (v_2, b_2), \ldots, (v_{|P|}, b_{|P|}) \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mopen">{(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ£</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mtight">âˆ£</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ£</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mtight">âˆ£</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mclose">)}</span></span></span></span>ã€‚å¯¹äºåŒä¸€é›†åˆä¸­çš„ä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>v</mi><mi>j</mi></msub><mo separator="true">,</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(v_i, b_i), (v_j, b_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œæœ‰ä¸€æ¡è¿æ¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">v_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> çš„è¾¹æƒä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">b_i + b_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> çš„æ— å‘è¾¹ã€‚å¯¹äºèŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">i\in [1, n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6986em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span>ï¼Œæ±‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> çš„æœ€çŸ­è·¯é•¿åº¦ã€‚<a href="https://www.luogu.com.cn/problem/T539768">ã€ŒYAC Round 12ã€äº¤å‰æ˜Ÿå°˜</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆdijkstraï¼Œæ„é€ ï¼‰"><strong>è§£é¢˜æ€è·¯</strong> ï¼ˆdijkstraï¼Œæ„é€ ï¼‰</h3><p>ç›´æ¥æš´åŠ›å»ºå›¾è·‘ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>j</mi><mi>k</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">dijkstra</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03148em;">ijk</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span></span></span></span> æœ€çŸ­è·¯ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mo>âˆ‘</mo><mrow><mi mathvariant="normal">âˆ£</mi><msub><mi>P</mi><mi>i</mi></msub><msup><mi mathvariant="normal">âˆ£</mi><mn>2</mn></msup></mrow><mo stretchy="false">)</mo><mi>log</mi><mo>â¡</mo><mrow><mo>âˆ‘</mo><mrow><mi mathvariant="normal">âˆ£</mi><msub><mi>P</mi><mi>i</mi></msub><msup><mi mathvariant="normal">âˆ£</mi><mn>2</mn></msup></mrow></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}((n + \sum{|P_i|^2})\log{\sum{|P_i|^2}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">((</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œä½†æ˜¯ä¼šå¯¼è‡´è¾¹æ•°å¤ªå¤§ MLEã€‚å› æ­¤éœ€è¦è€ƒè™‘æ„é€ è½¬å˜å»ºå›¾æ–¹å¼æ¥ä¼˜åŒ–ç©ºé—´ã€‚</p><p>å¯¹äºæ¯ä¸ªé›†åˆï¼Œè€ƒè™‘æ„å»ºä¸€ä¸ª <strong>è™šç‚¹</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ã€‚å¯¹äºåŒä¸€ä¸ªé›†åˆçš„æ¯ä¸ªç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(v_i, b_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œåœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> ä¹‹é—´è¿æ¥ä¸€æ¡è¾¹æƒ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„æ— å‘è¾¹ã€‚ç”±æ­¤å°†åŸæœ¬çš„å®Œå…¨å›¾è½¬æ¢ä¸ºäº† <strong>èŠèŠ±å›¾</strong>ï¼Œè¾¹çš„æ•°é‡å¤§å¤§å‡å°‘ã€‚</p><p>åœ¨è½¬æ¢æ„å»ºçš„å›¾ä¸­ï¼Œç›¸å½“äºå°†åŸå…ˆçš„ä¸€æ¡è¾¹æƒä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">b_i + b_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> çš„è¾¹æ‹†æˆäº†ä¸¤æ¡åˆ†åˆ«é•¿ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">b_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> çš„è¾¹ã€‚è¿™äº›æ‹†åˆ†åçš„è¾¹é€šè¿‡è¢«é‡å¤åˆ©ç”¨ä»¥è¾¾åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><msub><mi>h</mi><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></msub><mo>=</mo><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo separator="true">,</mo><mi mathvariant="normal">âˆ€</mi><mtext>Â </mtext><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">âˆ£</mi><mi>P</mi><mi mathvariant="normal">âˆ£</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">length_{(v_i, v_j)} = b_i + b_j, \forall \ i, j\in [1, |P|]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.072em;vertical-align:-0.3775em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">t</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3775em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">âˆ€</span><span class="mspace">Â </span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">âˆ£</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord">âˆ£</span><span class="mclose">]</span></span></span></span>ï¼Œæ‰€æ„å»ºå‡ºçš„å›¾ä¸åŸå›¾ç­‰ä»·ã€‚</p><p>æ•…åœ¨è½¬æ¢æ„å»ºå‡ºçš„å›¾ä¸Šè·‘ä¸€é <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>j</mi><mi>k</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">dijkstra</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03148em;">ijk</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span></span></span></span> æœ€çŸ­è·¯å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mo>âˆ‘</mo><mrow><mi mathvariant="normal">âˆ£</mi><msub><mi>P</mi><mi>i</mi></msub><mi mathvariant="normal">âˆ£</mi></mrow><mo stretchy="false">)</mo><mi>log</mi><mo>â¡</mo><mrow><mo>âˆ‘</mo><mrow><mi mathvariant="normal">âˆ£</mi><msub><mi>P</mi><mi>i</mi></msub><mi mathvariant="normal">âˆ£</mi></mrow></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}((n + \sum{|P_i|})\log{\sum{|P_i|}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">((</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span></span></span><span class="mclose">)</span></span></span></span>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">6e5</span> + <span class="hljs-number">10</span>;<br><span class="hljs-keyword">using</span> ll = <span class="hljs-type">long</span> <span class="hljs-type">long</span>;<br><span class="hljs-keyword">using</span> pll = pair&lt;ll, ll&gt;;<br><br><span class="hljs-type">int</span> n, m, st[N];<br>vector&lt;pll&gt; e[N];<br>ll dist[N];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dijkstra</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">memset</span>(dist, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> dist);<br>    priority_queue&lt;pll, vector&lt;pll&gt;, greater&lt;pll&gt; &gt; q;<br>    q.<span class="hljs-built_in">emplace</span>(dist[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>, <span class="hljs-number">1</span>);<br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-keyword">auto</span> [d, u] = q.<span class="hljs-built_in">top</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">if</span>(st[u]) <span class="hljs-keyword">continue</span>;<br>        st[u] = <span class="hljs-literal">true</span>;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;[v, w] : e[u])<br>            <span class="hljs-keyword">if</span>(dist[v] &gt; d + w) q.<span class="hljs-built_in">emplace</span>(dist[v] = d + w, v);<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">marisa</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, k; i &lt;= m; i ++ )&#123;<br>        cin &gt;&gt; k;<br>        <span class="hljs-type">int</span> u = n + i; <span class="hljs-comment">// è™šæ‹Ÿç‚¹</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>, v, w; j &lt;= k; j ++ )&#123;<br>            cin &gt;&gt; v &gt;&gt; w;<br>            e[u].<span class="hljs-built_in">emplace_back</span>(v, w);<br>            e[v].<span class="hljs-built_in">emplace_back</span>(u, w);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-built_in">dijkstra</span>();<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cout &lt;&lt; dist[i] &lt;&lt; <span class="hljs-string">&quot; \n&quot;</span>[i == n];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; <span class="hljs-comment">// cin &gt;&gt; T;</span><br>    <span class="hljs-keyword">while</span>(T -- ) <span class="hljs-built_in">marisa</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="F-å°±åœ¨ä½ èº«è¾¹"><strong>F å°±åœ¨ä½ èº«è¾¹</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šLynia</p></blockquote><h3 id="é¢˜æ„æè¿°-6"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™ä½ é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„åºåˆ— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">a_1, a_2, \cdots, a_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œä½ å¯ä»¥è¿›è¡Œæœ€å¤š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> æ¬¡æ“ä½œï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥æŠŠä¸€ä¸ªå…ƒç´ å¢åŠ æˆ–å‡å°‘ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œæ±‚æ“ä½œåæœ€é•¿çš„è¿ç»­ç›¸ç­‰çš„å­ä¸²ã€‚<a href="https://www.luogu.com.cn/problem/T541162">ã€ŒYAC Round 12ã€å°±åœ¨ä½ èº«è¾¹</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆåŒæŒ‡é’ˆï¼Œä¸­ä½æ•°æ€§è´¨ï¼ŒåŒå †æ¨¡æ‹Ÿï¼‰"><strong>è§£é¢˜æ€è·¯</strong> ï¼ˆåŒæŒ‡é’ˆï¼Œä¸­ä½æ•°æ€§è´¨ï¼ŒåŒå †æ¨¡æ‹Ÿï¼‰</h3><p>å¾ˆæ˜æ˜¾è¿™é¢˜å¯ä»¥ç”¨åŒæŒ‡é’ˆå¼€ä¸ª<strong>æ»‘åŠ¨çª—å£</strong>è§£å†³ã€‚é—®é¢˜æ˜¯æšä¸¾çš„æ¯ä¸ªåŒºé—´è¯¥å…¨ç­‰äºä»€ä¹ˆå€¼ï¼Œè¿™é‡Œå°±ä½¿ç”¨ä¸Šäº†<strong>ä¸­ä½æ•°æ€§è´¨</strong>â€”â€”<strong>æœ€å°åŒ–ç»å¯¹åå·®</strong>ï¼Œä¸­ä½æ•°æ˜¯ä½¿å¾—ç»å¯¹åå·®å’Œï¼ˆå³æ‰€æœ‰æ•°æ®ç‚¹ä¸ä¸­ä½æ•°çš„ç»å¯¹å·®å€¼ä¹‹å’Œï¼‰æœ€å°çš„å€¼ã€‚</p><p>æ•°å­¦ä¸Šï¼Œè¿™å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Minimize</mtext><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant="normal">âˆ£</mi><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><mi>M</mi><mi mathvariant="normal">âˆ£</mi></mrow><annotation encoding="application/x-tex">\text{Minimize} \sum_{i=1}^{n} |x_i - M|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord text"><span class="mord">Minimize</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord">âˆ£</span></span></span></span></span></p><p>å…¶ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> ä¸ºä¸­ä½æ•°ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸ºæ•°æ®é›†ä¸­çš„å„ä¸ªæ•°å€¼ã€‚</p><p>çŸ¥é“äº†è¿™ä¸ªæ€§è´¨åï¼Œæˆ‘ä»¬æ‰¾åˆ°æ»‘åŠ¨çª—å£æšä¸¾çš„åŒºé—´çš„ä¸­ä½æ•°ï¼Œç›´æ¥è®¡ç®—åŒºé—´æ‰€æœ‰å€¼å˜æˆä¸­ä½æ•°è¦çš„æ€»æ“ä½œæ¬¡æ•°å°±è¡Œï¼Œæ ¹æ®æ€»æ“ä½œæ˜¯å¦è¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> æ¥åˆ¤æ–­æ…¢æŒ‡é’ˆçš„ç§»åŠ¨ã€‚</p><p>è‡³äºä¸­ä½æ•°çš„ç»´æŠ¤ï¼Œæˆ‘ä»¬è¿™è¾¹ä½¿ç”¨ä¸¤ä¸ª <code>multiset</code> å³å¯ï¼Œå½“ç„¶è¿‡ç¨‹ä¸­å¯¹è¿™ä¸¤ä¸ªåŒå †è¦è¿›è¡Œä¸æ–­è°ƒæ•´ï¼Œå…·ä½“å®ç°å‚è€ƒé¢˜è§£ä»£ç ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-keyword">define</span> fa(i,op,n) for (int i = op; i &lt;= n; i++)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> fb(j,op,n) for (int j = op; j &gt;= n; j--)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> var auto</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> all(i) i.begin(), i.end()</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> endl <span class="hljs-string">&#x27;\n&#x27;</span></span><br><span class="hljs-keyword">using</span> ll = <span class="hljs-type">long</span> <span class="hljs-type">long</span>;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">solve</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>ll n, k; cin &gt;&gt; n &gt;&gt; k;<br>var a = <span class="hljs-built_in">vector</span>&lt;ll&gt;(n + <span class="hljs-number">1</span>, <span class="hljs-number">0</span>);<br><span class="hljs-built_in">fa</span>(i, <span class="hljs-number">1</span>, n)cin &gt;&gt; a[i];<br><br><span class="hljs-comment">// åŒå †ç»´æŠ¤ä¸­ä½æ•°</span><br>multiset&lt;ll&gt;r;              <span class="hljs-comment">// å³å †ï¼Œå­˜å¤§äºç­‰äºä¸­ä½æ•°çš„</span><br>multiset&lt;ll, greater&lt;ll&gt;&gt;l; <span class="hljs-comment">// å·¦å †ï¼Œå­˜å°äºç­‰äºä¸­ä½æ•°çš„ï¼Œä¸­ä½æ•°ä¹Ÿå­˜è¿™é‡Œäº†</span><br>ll l_sum = <span class="hljs-number">0</span>, r_sum = <span class="hljs-number">0</span>;    <span class="hljs-comment">// åŒå †å„è‡ªæ±‚å’Œ</span><br><br><span class="hljs-comment">// åŒå †åˆ·æ–°ï¼Œç»´æŠ¤ä¸­ä½æ•°çš„æ­£ç¡®æ’ä½</span><br><span class="hljs-comment">// lenï¼šå½“å‰çš„åŒºé—´é•¿åº¦</span><br>var f = [&amp;](<span class="hljs-type">int</span> len)-&gt;<span class="hljs-type">void</span> &#123;<br>ll tmp;<br><br><span class="hljs-comment">// å…ˆè°ƒæ•´å¤§å°</span><br><span class="hljs-comment">// å·¦å †ä¸èƒ½æœ‰å¤§äºå³å †çš„</span><br><span class="hljs-keyword">while</span> (l.<span class="hljs-built_in">size</span>() <span class="hljs-keyword">and</span> r.<span class="hljs-built_in">size</span>() <span class="hljs-built_in">and</span> (*l.<span class="hljs-built_in">begin</span>()) &gt; (*r.<span class="hljs-built_in">begin</span>())) &#123;<br>tmp = (*l.<span class="hljs-built_in">begin</span>());<br>r_sum += tmp, r.<span class="hljs-built_in">insert</span>(tmp);<br>l_sum -= tmp, l.<span class="hljs-built_in">erase</span>(l.<span class="hljs-built_in">begin</span>());<br>&#125;<br><br><span class="hljs-comment">// å†è°ƒæ•´åŒå †ä¸ªæ•°</span><br><span class="hljs-keyword">if</span> (len &amp; <span class="hljs-number">1</span>) &#123; <br><span class="hljs-comment">// å¥‡æ•°çš„æ—¶å€™ï¼Œl.size() - r.size() == 1</span><br><span class="hljs-keyword">while</span> (l.<span class="hljs-built_in">size</span>() &lt; r.<span class="hljs-built_in">size</span>() + <span class="hljs-number">1</span>) &#123;<br>tmp = (*r.<span class="hljs-built_in">begin</span>());<br>l_sum += tmp, l.<span class="hljs-built_in">insert</span>(tmp);<br>r_sum -= tmp, r.<span class="hljs-built_in">erase</span>(r.<span class="hljs-built_in">begin</span>());<br>&#125;<br><span class="hljs-keyword">while</span> (l.<span class="hljs-built_in">size</span>() &gt; r.<span class="hljs-built_in">size</span>() + <span class="hljs-number">1</span>) &#123;<br>tmp = (*l.<span class="hljs-built_in">begin</span>());<br>r_sum += tmp, r.<span class="hljs-built_in">insert</span>(tmp);<br>l_sum -= tmp, l.<span class="hljs-built_in">erase</span>(l.<span class="hljs-built_in">begin</span>());<br>&#125;<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br><span class="hljs-comment">// å¶æ•°çš„æ—¶å€™ï¼Œl.size() == r.size()</span><br><span class="hljs-keyword">while</span> (l.<span class="hljs-built_in">size</span>() &lt; r.<span class="hljs-built_in">size</span>()) &#123;<br>tmp = (*r.<span class="hljs-built_in">begin</span>());<br>l_sum += tmp, l.<span class="hljs-built_in">insert</span>(tmp);<br>r_sum -= tmp, r.<span class="hljs-built_in">erase</span>(r.<span class="hljs-built_in">begin</span>());<br>&#125;<br><span class="hljs-keyword">while</span> (l.<span class="hljs-built_in">size</span>() &gt; r.<span class="hljs-built_in">size</span>()) &#123;<br>tmp = (*l.<span class="hljs-built_in">begin</span>());<br>r_sum += tmp, r.<span class="hljs-built_in">insert</span>(tmp);<br>l_sum -= tmp, l.<span class="hljs-built_in">erase</span>(l.<span class="hljs-built_in">begin</span>());<br>&#125;<br>&#125;<br>&#125;;<br><br><span class="hljs-comment">// åŒæŒ‡é’ˆæ‰¾æœ€é•¿å…¨ç›¸ç­‰åŒºé—´</span><br>ll j = <span class="hljs-number">1</span>;   <span class="hljs-comment">// æ…¢æŒ‡é’ˆ</span><br>ll ans = <span class="hljs-number">1</span>; <span class="hljs-comment">// æœ€é•¿å…¨ç›¸ç­‰åŒºé—´é•¿åº¦</span><br><span class="hljs-built_in">fa</span>(i, <span class="hljs-number">1</span>, n) &#123;<br><span class="hljs-keyword">if</span> (l.<span class="hljs-built_in">size</span>() == <span class="hljs-number">0</span>)l_sum += a[i], l.<span class="hljs-built_in">insert</span>(a[i]); <span class="hljs-comment">// å…ˆæ”¾å·¦å †ä¸€ä¸ª</span><br><span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">if</span> (a[i] &lt;= (*l.<span class="hljs-built_in">begin</span>()))l_sum += a[i], l.<span class="hljs-built_in">insert</span>(a[i]);<br><span class="hljs-keyword">else</span> r_sum += a[i], r.<span class="hljs-built_in">insert</span>(a[i]);<br>&#125;<br><br><span class="hljs-built_in">f</span>(i - j + <span class="hljs-number">1</span>); <span class="hljs-comment">// åˆ·æ–°åŒå †</span><br>ll mmid = (*l.<span class="hljs-built_in">begin</span>()); <span class="hljs-comment">// å½“å‰ä¸­ä½æ•°</span><br>ll now = (mmid * (ll)l.<span class="hljs-built_in">size</span>() - l_sum) + (r_sum - mmid * (ll)r.<span class="hljs-built_in">size</span>()); <span class="hljs-comment">// å…¨æ”¹æˆä¸­ä½æ•°è¦ä½¿ç”¨çš„æ“ä½œæ¬¡æ•°</span><br><br><span class="hljs-keyword">while</span> (now &gt; k <span class="hljs-keyword">and</span> j &lt; i) &#123; <span class="hljs-comment">// æ›´æ–°æ…¢æŒ‡é’ˆ</span><br><span class="hljs-comment">// æŠŠå·¦å³å †çš„ a[j] åˆ æ‰</span><br><span class="hljs-keyword">if</span> (l.<span class="hljs-built_in">count</span>(a[j])) l_sum -= a[j], l.<span class="hljs-built_in">erase</span>(l.<span class="hljs-built_in">find</span>(a[j]));<br><span class="hljs-keyword">else</span> r_sum -= a[j], r.<span class="hljs-built_in">erase</span>(r.<span class="hljs-built_in">find</span>(a[j]));<br>j++;<br><br><span class="hljs-built_in">f</span>(i - j + <span class="hljs-number">1</span>); <span class="hljs-comment">// åˆ·æ–°åŒå †</span><br>mmid = (*l.<span class="hljs-built_in">begin</span>()); <span class="hljs-comment">// å½“å‰ä¸­ä½æ•°</span><br>now = (mmid * (ll)l.<span class="hljs-built_in">size</span>() - l_sum) + (r_sum - mmid * (ll)r.<span class="hljs-built_in">size</span>()); <span class="hljs-comment">// å…¨æ”¹æˆä¸­ä½æ•°è¦ä½¿ç”¨çš„æ“ä½œæ¬¡æ•°</span><br>&#125;<br><br>ans = <span class="hljs-built_in">max</span>(ans, i - j + <span class="hljs-number">1</span>); <span class="hljs-comment">// æ›´æ–°ç­”æ¡ˆ</span><br>&#125;<br>cout &lt;&lt; ans &lt;&lt; endl;<br><span class="hljs-keyword">return</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>ios::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-number">0</span>), cin.<span class="hljs-built_in">tie</span>(<span class="hljs-number">0</span>), cout.<span class="hljs-built_in">tie</span>(<span class="hljs-number">0</span>);<br><span class="hljs-type">int</span> _ = <span class="hljs-number">1</span>;<br><span class="hljs-comment">//cin &gt;&gt; _;</span><br><span class="hljs-built_in">fa</span>(i, <span class="hljs-number">1</span>, _)<span class="hljs-built_in">solve</span>();<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å’å”±å…‰èŠ’</category>
      
      <category>YAC æ‰¬å·å¤§å­¦ç®—æ³•ç»ƒä¹ èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>ç®—æ³•ç«èµ›</tag>
      
      <tag>Luogu</tag>
      
      <tag>YAC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 YAC Round 11 é¢˜è§£</title>
    <link href="/2024/12/14/YAC_Round_11/"/>
    <url>/2024/12/14/YAC_Round_11/</url>
    
    <content type="html"><![CDATA[<h2 id="A-ç©å¼„äººå½¢çš„å°‘å¥³"><strong>A ç©å¼„äººå½¢çš„å°‘å¥³</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šMarisaMagic</p></blockquote><h3 id="é¢˜æ„æè¿°"><strong>é¢˜æ„æè¿°</strong></h3><p>åˆ†åˆ«ç»Ÿè®¡å­—ç¬¦ä¸² <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>â€œshanghaiâ€</mtext></mrow><annotation encoding="application/x-tex">â€œ\text{shanghai}â€</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">â€œ</span><span class="mord text"><span class="mord">shanghai</span></span><span class="mord">â€</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>â€œpenglaiâ€</mtext></mrow><annotation encoding="application/x-tex">â€œ\text{penglai}â€</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">â€œ</span><span class="mord text"><span class="mord">penglai</span></span><span class="mord">â€</span></span></span></span> çš„ä¸ªæ•° <a href="https://www.luogu.com.cn/problem/T527990">ã€ŒYAC Round 11ã€ç©å¼„äººå½¢çš„å°‘å¥³</a></p><h3 id="è§£é¢˜æ€è·¯"><strong>è§£é¢˜æ€è·¯</strong></h3><p>å¼€ä¸€ä¸ª <code>map</code> ç›´æ¥ç»Ÿè®¡å³å¯ï¼Œæˆ–è€…å†™åˆ¤æ–­è¯­å¥åˆ†åˆ«ç»Ÿè®¡ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">marisa</span><span class="hljs-params">()</span></span>&#123;<br>    unordered_map&lt;string, <span class="hljs-type">int</span>&gt; mp;<br>    <span class="hljs-type">int</span> n; cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )&#123;<br>        string s; cin &gt;&gt; s;<br>        mp[s] ++ ;<br>    &#125;<br>    cout &lt;&lt; mp[<span class="hljs-string">&quot;shanghai&quot;</span>] &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; mp[<span class="hljs-string">&quot;penglai&quot;</span>] &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; <span class="hljs-comment">// cin &gt;&gt; T;</span><br>    <span class="hljs-keyword">while</span>(T -- ) <span class="hljs-built_in">marisa</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="B-é­”æ³•å­¦å¾’KKKçš„è¯•ç‚¼"><strong>B é­”æ³•å­¦å¾’KKKçš„è¯•ç‚¼</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šSouth_Orange</p></blockquote><h3 id="é¢˜æ„æè¿°-2"><strong>é¢˜æ„æè¿°</strong></h3><p>å·¥ä½œæ—¥è·å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> ç‚¹é­”åŠ›å€¼ï¼ŒåŒä¼‘æ—¥è·å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> ç‚¹é­”åŠ›å€¼ã€‚åˆ¤æ–­é­”åŠ›å€¼è¾¾åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> é¢˜éœ€è¦å¤šå°‘å¤©ã€‚<a href="https://www.luogu.com.cn/problem/T536624">ã€ŒYAC Round 11ã€é­”æ³•å­¦å¾’ KKK çš„è¯•ç‚¼</a></p><h3 id="è§£é¢˜æ€è·¯-æ¨¡æ‹Ÿ"><strong>è§£é¢˜æ€è·¯</strong> (æ¨¡æ‹Ÿ)</h3><p>å…ˆæ±‚å‡ºä¸€å‘¨èƒ½è·å¾—å¤šå°‘é­”åŠ›å€¼ã€‚å†æ±‚å‡ºéœ€è¦å‡ ä¸ªå®Œæ•´çš„æ˜ŸæœŸï¼Œè¿˜å‰©å¤šå°‘é­”åŠ›å€¼æœªè·å¾—ã€‚</p><ul><li>å¦‚æœå‰©çš„é­”åŠ›å€¼åœ¨å·¥ä½œæ—¥èƒ½è·å¾—å®Œï¼Œå°±åŠ ä¸Šéœ€è¦çš„å¤©æ•°ã€‚</li><li>å¦åˆ™ï¼Œå…ˆåŠ ä¸Šå·¥ä½œæ—¥çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span> å¤©ï¼Œå†åŠ ä¸ŠåŒä¼‘æ—¥éœ€è¦çš„å¤©æ•°ã€‚</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br>ll a, b, n;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    LL res = <span class="hljs-number">0</span>;<br>    cin &gt;&gt; a &gt;&gt; b &gt;&gt; n;<br>    res = n / (<span class="hljs-number">5</span> * a + <span class="hljs-number">2</span> * b) * <span class="hljs-number">7</span>; <span class="hljs-comment">// å®Œæ•´çš„å‘¨æ•°*7</span><br>    n %= (<span class="hljs-number">5</span> * a + <span class="hljs-number">2</span> * b); <span class="hljs-comment">// å‰©ä½™çš„é­”åŠ›å€¼</span><br>    <span class="hljs-keyword">if</span> (n != <span class="hljs-number">0</span>)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">5</span> * a) <span class="hljs-comment">// å·¥ä½œæ—¥èƒ½å®Œæˆ</span><br>        &#123;<br>            <span class="hljs-keyword">if</span> (n % a != <span class="hljs-number">0</span>) res += n / a + <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">else</span> res += n / a;<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-comment">// å·¥ä½œæ—¥ä¸èƒ½å®Œæˆ</span><br>        &#123;<br>            res += <span class="hljs-number">5</span>;<br>            n -= <span class="hljs-number">5</span> * a;<br>            <span class="hljs-keyword">if</span> (n % b != <span class="hljs-number">0</span>) res += n / b + <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">else</span> res += n / b;<br>        &#125;<br>    &#125;<br>    cout &lt;&lt; res &lt;&lt; endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="C-ç¤¾äº¤åª’ä½“"><strong>C ç¤¾äº¤åª’ä½“</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šSouth_Orange</p></blockquote><h3 id="é¢˜æ„æè¿°-3"><strong>é¢˜æ„æè¿°</strong></h3><p>å¦‚æœä¸€ä¸ªäººåŒæ—¶æ˜¯è¯„è®ºè€…ä¸è¢«è¯„è®ºè€…çš„å¥½å‹åˆ™å¯ä»¥çœ‹åˆ°è¿™æ¡è¯„è®ºï¼Œåˆ¤æ–­æœ€å¤šæ·»åŠ ä¸¤ä¸ªæ–°å¥½å‹åèƒ½çœ‹åˆ°çš„æœ€å¤šçš„è¯„è®ºæ•°é‡ã€‚<a href="https://www.luogu.com.cn/problem/T536379">ã€ŒYAC Round 11ã€ç¤¾äº¤åª’ä½“</a></p><h3 id="è§£é¢˜æ€è·¯-æ€ç»´"><strong>è§£é¢˜æ€è·¯</strong> (æ€ç»´)</h3><p>å¦‚æœæš´åŠ›æšä¸¾æ‰€æœ‰æœªåŠ çš„å¥½å‹æ—¶é—´å¤æ‚åº¦ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œä¼šè¶…æ—¶ã€‚</p><p>è€ƒè™‘åˆ°åªæœ‰å‡ºç°è¿‡çš„æ‰å€¼å¾—æšä¸¾ï¼Œè¿™æ ·æœ€å¤šåªéœ€è¦æšä¸¾<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>å¯¹ï¼Œæ—¶é—´å¤æ‚åº¦é™ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></p><p>å…ˆé¢„å¤„ç†å‡ºæ¥æ·»åŠ ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ä¸ªäººåèƒ½å¢åŠ çš„è¯„è®ºæ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mi>h</mi><mi>i</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">zhi[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord mathnormal">hi</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>ï¼Œå†é¢„å¤„ç†å‡ºæ¥æ·»åŠ ä¸¤ä¸ªäºº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i,j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> æ—¶å¢åŠ çš„è¯„è®ºæ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>p</mi><mo stretchy="false">[</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">mp[{i,j}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span class="mclose">]</span></span></span></span> (æ­¤è¯„è®ºæ•°ä¸åŒ…å«æ·»åŠ ä»–ä»¬ä¸­å•ä¸ªäººæ—¶æ‰€å¢åŠ çš„è¯„è®ºæ•°),æœ€åæšä¸¾æ¯ä¸€å¯¹è¯„è®ºï¼Œä»¥åŠä¸æ·»åŠ ä»»ä½•äººèƒ½çœ‹åˆ°çš„åˆå§‹è¯„è®ºæ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>e</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">res</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">res</span></span></span></span>ï¼Œç­”æ¡ˆ:</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mi>n</mi><mi>s</mi><mo>=</mo><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>a</mi><mi>n</mi><mi>s</mi><mo separator="true">,</mo><mi>r</mi><mi>e</mi><mi>s</mi><mo>+</mo><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>m</mi><mi>p</mi><mo stretchy="false">[</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><mo stretchy="false">]</mo><mo>+</mo><mi>z</mi><mi>h</mi><mi>i</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>+</mo><mi>z</mi><mi>h</mi><mi>i</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ans = \max(ans,res + \max(mp[{i,j}]+zhi[i]+zhi[j]))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">res</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord mathnormal">hi</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord mathnormal">hi</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]))</span></span></span></span></span></p><p>ç„¶åå†è€ƒè™‘è¦é€‰çš„ä¸¤ä¸ªäººå¹¶æ²¡æœ‰ç›¸äº’è¯„è®ºè¿‡çš„æƒ…å†µï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mi>h</mi><mi>i</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">zhi[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord mathnormal">hi</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span> æœ€å¤§å€¼ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">mx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">x</span></span></span></span>ï¼Œæ¬¡å¤§å€¼ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>i</mi><mi>m</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">cimx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">im</span><span class="mord mathnormal">x</span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mi>n</mi><mi>s</mi><mo>=</mo><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>a</mi><mi>n</mi><mi>s</mi><mo separator="true">,</mo><mi>r</mi><mi>e</mi><mi>s</mi><mo>+</mo><mi>m</mi><mi>x</mi><mo>+</mo><mi>c</mi><mi>i</mi><mi>m</mi><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ans = \max(ans,res + mx + cimx)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">res</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">im</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></p><p>æœ€åæ³¨æ„è¯„è®ºè€…ä¸è¢«è¯„è®ºè€…æ˜¯åŒä¸€ä¸ªäººçš„æƒ…å†µ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;set&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;map&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><br><span class="hljs-keyword">using</span> ll = <span class="hljs-type">long</span> <span class="hljs-type">long</span>;<br><span class="hljs-keyword">using</span> pii = pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;;<br><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">2e5</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> n, k;<br><span class="hljs-type">int</span> m;<br><span class="hljs-type">int</span> a[N], b[N];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">solve</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>set&lt;<span class="hljs-type">int</span>&gt; se;<br>map&lt;pii, <span class="hljs-type">int</span>&gt; mp;<br>cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;<br><span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">zhi</span><span class="hljs-params">(k + <span class="hljs-number">1</span>)</span></span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>;i &lt;= n;i++)<br>&#123;<br><span class="hljs-type">int</span> t;<br>cin &gt;&gt; t;<br>se.<span class="hljs-built_in">insert</span>(t);<br>&#125;<br><span class="hljs-type">int</span> ans = <span class="hljs-number">0</span>;<br><span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>;i &lt;= m;i++)<br>&#123;<br>cin &gt;&gt; a[i] &gt;&gt; b[i];<br><span class="hljs-keyword">if</span> (a[i] &gt; b[i]) <span class="hljs-built_in">swap</span>(a[i], b[i]);<br><br><span class="hljs-keyword">if</span> (a[i] == b[i])<br>&#123;<br><span class="hljs-keyword">if</span> (!se.<span class="hljs-built_in">count</span>(a[i])) zhi[a[i]]++;<br><span class="hljs-keyword">else</span> res++;<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-keyword">if</span> (!se.<span class="hljs-built_in">count</span>(a[i]) &amp;&amp; se.<span class="hljs-built_in">count</span>(b[i])) zhi[a[i]]++;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (se.<span class="hljs-built_in">count</span>(a[i]) &amp;&amp; !se.<span class="hljs-built_in">count</span>(b[i])) zhi[b[i]]++;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (se.<span class="hljs-built_in">count</span>(a[i]) &amp;&amp; se.<span class="hljs-built_in">count</span>(b[i])) res++;<br><span class="hljs-keyword">else</span> mp[&#123;a[i], b[i]&#125;]++;<br>&#125;<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>;i &lt;= m;i++)<br>&#123;<br><span class="hljs-keyword">if</span> (a[i] == b[i])<br>&#123;<br><span class="hljs-keyword">if</span> (!se.<span class="hljs-built_in">count</span>(a[i])) ans = <span class="hljs-built_in">max</span>(ans, res + zhi[a[i]]);<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-keyword">if</span> (!se.<span class="hljs-built_in">count</span>(a[i]) &amp;&amp; !se.<span class="hljs-built_in">count</span>(b[i]))<br>ans = <span class="hljs-built_in">max</span>(ans, res + mp[&#123;a[i], b[i]&#125;] + zhi[a[i]] + zhi[b[i]]);<br>&#125;<br>&#125;<br><span class="hljs-type">int</span> mx = <span class="hljs-number">0</span>, cimx = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>;i &lt;= k;i++)<br>&#123;<br><span class="hljs-keyword">if</span> (zhi[i] &gt; mx)<br>&#123;<br>cimx = mx;<br>mx = zhi[i];<br>&#125;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (zhi[i] &gt; cimx)<br>cimx = zhi[i];<br>&#125;<br>ans = <span class="hljs-built_in">max</span>(ans, res + mx + cimx);<br>cout &lt;&lt; ans &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>ios::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-number">0</span>);cin.<span class="hljs-built_in">tie</span>(<span class="hljs-number">0</span>);cout.<span class="hljs-built_in">tie</span>(<span class="hljs-number">0</span>);<br><span class="hljs-type">int</span> T = <span class="hljs-number">1</span>;<br><span class="hljs-comment">// cin &gt;&gt; T;</span><br><span class="hljs-keyword">while</span> (T--)<br>&#123;<br><span class="hljs-built_in">solve</span>();<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="D-æ¢¦è¿ç§‘å­¦ä¸–çºª"><strong>D æ¢¦è¿ç§‘å­¦ä¸–çºª</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šMarisaMagic</p></blockquote><h3 id="é¢˜æ„æè¿°-4"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªå›¾ï¼Œæ¯ä¸ªç‚¹æœ‰ä¸€ä¸ªå€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå¯ä»¥èŠ±è´¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo>+</mo><mi>a</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[u] + a[v]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span> ä»£ä»·æ„å»ºä¸€æ¡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>â†’</mo><mi>v</mi></mrow><annotation encoding="application/x-tex">u \rightarrow v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> çš„è¾¹ã€‚æ±‚ä½¿å¾—å­˜åœ¨ä»»æ„ä¸¤ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo separator="true">,</mo><mi>v</mi></mrow><annotation encoding="application/x-tex">u, v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> å¯ä»¥äº’ç›¸åˆ°è¾¾çš„æœ€å°ä»£ä»·ã€‚<a href="https://www.luogu.com.cn/problem/T536353">ã€ŒYAC Round 11ã€æ¢¦è¿ç§‘å­¦ä¸–çºª</a></p><h3 id="è§£é¢˜æ€è·¯-2"><strong>è§£é¢˜æ€è·¯</strong></h3><p>å¦‚æœå›¾ä¸­æœ¬æ¥å°±å­˜åœ¨ç¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ— éœ€æ„å»ºä»»ä½•è¾¹ã€‚æ­¤æ—¶æœ€å°ä»£ä»·ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>;</p><p>å¦‚æœä¸å­˜åœ¨ç¯ï¼Œé‚£ä¹ˆè¯¥å›¾ä¸ºä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ã€‚è€ƒè™‘è¿›è¡Œæ‹“æ‰‘æ’åºï¼Œå¹¶åœ¨æ‹“æ‰‘æ’åºä¸­è¿›è¡ŒåŠ¨æ€è§„åˆ’ç»´æŠ¤æœ€å°å€¼ã€‚è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[u]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span> è¡¨ç¤ºæ‰€æœ‰èƒ½åˆ°è¾¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> çš„ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[v]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span> çš„æœ€å°å€¼ï¼Œå› æ­¤åªéœ€è¦åœ¨æ‹“æ‰‘æ’åºçš„è¿‡ç¨‹ä¸­æ‰¾åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>min</mi><mo>â¡</mo></mrow><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>â†’</mo><mi>v</mi><mo stretchy="false">)</mo><mo>âˆˆ</mo><mi>E</mi></mrow></msub><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo>+</mo><mi>a</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\min_{(u\rightarrow v) \in E} dp[u] + a[v]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">u</span><span class="mrel mtight">â†’</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mclose mtight">)</span><span class="mrel mtight">âˆˆ</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span> å³å¯ã€‚</p><p>å½“ç„¶ï¼Œå›¾å¯èƒ½ä¸è¿é€šï¼Œå¯èƒ½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[u]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span> æœ€å°çš„ä¸¤ä¸ªç‚¹äº’ç›¸ä¸å¯è¾¾ï¼Œæˆ‘ä»¬è¿˜éœ€è€ƒè™‘å‡­ç©ºæ„é€ è¿™ä¸¤ä¸ªç‚¹ä¹‹é—´çš„ç¯æ‰€éœ€çš„ä»£ä»·ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">using</span> ll = <span class="hljs-type">long</span> <span class="hljs-type">long</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">5e5</span> + <span class="hljs-number">10</span>;<br><span class="hljs-type">const</span> ll INF = <span class="hljs-number">2e9</span>;<br><br>vector&lt;<span class="hljs-type">int</span>&gt; e[N];<br><span class="hljs-type">int</span> n, m, ind[N], a[N];<br>ll mn1 = INF, mn2 = INF, ans = INF;<br><span class="hljs-type">int</span> dp[N];  <span class="hljs-comment">// dp[u]è¡¨ç¤ºå¯ä»¥åˆ°è¾¾uçš„ç‚¹ä¸­ç»“ç•Œå¼ºåº¦çš„æœ€å°å€¼</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">topo</span><span class="hljs-params">()</span></span>&#123;<br>    queue&lt;<span class="hljs-type">int</span>&gt; q;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        dp[i] = a[i];<br>        <span class="hljs-keyword">if</span>(!ind[i]) q.<span class="hljs-built_in">emplace</span>(i);<br>    &#125;<br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-type">int</span> u = q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;v : e[u])&#123;<br>            ans = <span class="hljs-built_in">min</span>(ans, (ll)dp[u] + a[v]); <span class="hljs-comment">// v -&gt; åˆ°è¾¾uçš„æœ€å°å€¼ç‚¹</span><br>            dp[v] = <span class="hljs-built_in">min</span>(dp[v], dp[u]); <span class="hljs-comment">// æ›´æ–°åˆ°è¾¾vçš„ç‚¹ä¸­çš„ç»“ç•Œå¼ºåº¦æœ€å°å€¼</span><br>            <span class="hljs-keyword">if</span>(!( -- ind[v])) q.<span class="hljs-built_in">emplace</span>(v);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-keyword">if</span>(ind[i]) ans = <span class="hljs-number">0</span>; <span class="hljs-comment">// æœ¬æ¥å°±å­˜åœ¨ç¯</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">marisa</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;  <span class="hljs-comment">// æ‰¾åˆ°æœ€å°å’Œæ¬¡å°å€¼</span><br>        cin &gt;&gt; a[i];<br>        <span class="hljs-keyword">if</span>(a[i] &lt;= mn1) mn2 = mn1, mn1 = a[i];<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(a[i] &lt; mn2) mn2 = a[i];<br>    &#125;<br>    ans = (mn1 + mn2) &lt;&lt; <span class="hljs-number">1</span>;  <span class="hljs-comment">// å‡­ç©ºæ„é€ ä¸€ä¸ªç¯çš„æƒ…å†µ</span><br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, u, v; i &lt;= m; i ++ )&#123;<br>        cin &gt;&gt; u &gt;&gt; v;<br>        e[u].<span class="hljs-built_in">emplace_back</span>(v);<br>        ind[v] ++ ;<br>    &#125;<br><br>    <span class="hljs-built_in">topo</span>();<br><br>    cout &lt;&lt; ans &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; <span class="hljs-comment">// cin &gt;&gt; T;</span><br>    <span class="hljs-keyword">while</span>(T -- ) <span class="hljs-built_in">marisa</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="E-ç§˜é“¶ä¹‹å¡”"><strong>E ç§˜é“¶ä¹‹å¡”</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šSouth_Orange</p></blockquote><h3 id="é¢˜æ„æè¿°-5"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> ä¸ªæ•´æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mi mathvariant="normal">.</mi><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><msub><mi>A</mi><mi>N</mi></msub></mrow><annotation encoding="application/x-tex">A_1.A_2, \cdots, A_N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸­é€‰å‡ºä¸¤ä¸ªè¿›è¡Œå¼‚æˆ–è®¡ç®—ï¼Œå¾—åˆ°çš„ç»“æœæœ€å¤§æ˜¯å¤šå°‘ï¼Ÿ<a href="https://www.luogu.com.cn/problem/T536628">ã€ŒYAC Round 11ã€ç§˜é“¶ä¹‹å¡”</a></p><h3 id="è§£é¢˜æ€è·¯-01-trieæ ‘"><strong>è§£é¢˜æ€è·¯</strong> (01 trieæ ‘)</h3><p>é¦–å…ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> æ¨¡æ‹Ÿè‚¯å®šä¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>L</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">TLE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span>ã€‚</p><p>å­—å…¸æ ‘ï¼š<br>å­—å…¸æ ‘ï¼ˆtrie æ ‘ï¼‰æ˜¯ä¸€ç§ç”¨äºå®ç°å­—ç¬¦ä¸²å¿«é€Ÿæ£€ç´¢çš„å¤šå‰æ ‘ç»“æ„ã€‚<br>trie æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ‹¥æœ‰è‹¥å¹²ä¸ªå­—ç¬¦æŒ‡é’ˆï¼Œè‹¥åœ¨æ’å…¥æˆ–æ£€ç´¢å­—ç¬¦ä¸²æ—¶æ‰«æåˆ°ä¸€ä¸ªå­—ç¬¦ cï¼Œå°±æ²¿ç€å½“å‰èŠ‚ç‚¹çš„ c å­—ç¬¦æŒ‡é’ˆï¼Œèµ°å‘è¯¥æŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹ã€‚</p><p>ä¸Šæ–‡æåˆ°ï¼Œç”¨æšä¸¾è‚¯å®šè¶…æ—¶ã€‚<br>è€ƒè™‘è¿ç”¨å­—å…¸æ ‘å¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚</p><p>ä¼˜åŒ–æ–¹æ³•ï¼š<br>æŠŠæ¯ä¸€ä¸ªæ•°å­—è½¬æ¢æˆäºŒè¿›åˆ¶çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>01</mn></mrow><annotation encoding="application/x-tex">01</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">01</span></span></span></span>å­—ç¬¦ä¸²æ’å…¥å­—å…¸æ ‘ï¼Œå†ä¾æ¬¡éå†æ•´æ£µå­—å…¸æ ‘ã€‚<br>éå†çš„æ—¶å€™æˆ‘ä»¬è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿè¯¥é€‰æ‹©å“ªä¸€æ¡åˆ†æ”¯éå†ä¸‹å»ï¼Ÿ<br>é€‰æ‹©ï¼šå› ä¸ºå¼‚æˆ–è¿ç®—æ˜¯ç›¸åŒä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œä¸ç›¸åŒä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘è´ªå¿ƒï¼Œå³è¿™ä¸€ä½å°½é‡ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;set&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;map&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><br><span class="hljs-keyword">using</span> ll = <span class="hljs-type">long</span> <span class="hljs-type">long</span>;<br><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>;<br><br>ll son[N * <span class="hljs-number">31</span>][<span class="hljs-number">2</span>], a[N];<br>ll idx;<br><span class="hljs-type">int</span> n;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(ll x)</span></span><br><span class="hljs-function"></span>&#123;<br>ll p = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">31</span>;~i;i--) <span class="hljs-comment">// æ‹†ä½æ’å…¥å­—å…¸æ ‘</span><br>&#123;<br>ll&amp; s = son[p][x &gt;&gt; i &amp; <span class="hljs-number">1</span>];<br><span class="hljs-keyword">if</span> (!s) s = ++idx;<br>p = s;<br>&#125;<br>&#125;<br><br><span class="hljs-function">ll <span class="hljs-title">query</span><span class="hljs-params">(ll x)</span></span><br><span class="hljs-function"></span>&#123;<br>ll res = <span class="hljs-number">0</span>, p = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">31</span>;~i;i--)<br>&#123;<br>ll s = x &gt;&gt; i &amp; <span class="hljs-number">1</span>;<br><span class="hljs-keyword">if</span> (son[p][!s]) <span class="hljs-comment">// å°½é‡é€‰æ‹©ä¸å½“å‰ä½ä¸åŒçš„è·¯å¾„</span><br>&#123;<br>res += <span class="hljs-number">1ll</span> &lt;&lt; i;<br>p = son[p][!s];<br>&#125;<br><span class="hljs-keyword">else</span> p = son[p][s];<br>&#125;<br><span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">solve</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>cin &gt;&gt; n;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>;i &lt;= n;i++)<br>&#123;<br>cin &gt;&gt; a[i];<br><span class="hljs-built_in">insert</span>(a[i]);<br>&#125;<br>ll res = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>;i &lt;= n;i++)<br>res = <span class="hljs-built_in">max</span>(res, <span class="hljs-built_in">query</span>(a[i]));<br>cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>ios::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-number">0</span>);cin.<span class="hljs-built_in">tie</span>(<span class="hljs-number">0</span>);cout.<span class="hljs-built_in">tie</span>(<span class="hljs-number">0</span>);<br><span class="hljs-type">int</span> T = <span class="hljs-number">1</span>;<br><span class="hljs-comment">//cin &gt;&gt; T;</span><br><span class="hljs-keyword">while</span> (T--)<br>&#123;<br><span class="hljs-built_in">solve</span>();<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="F-æ´»æ³¼çº¯æƒ…çš„æ•°å­¦å®¶"><strong>F æ´»æ³¼çº¯æƒ…çš„æ•°å­¦å®¶</strong></h2><blockquote><p>å‡ºé¢˜äººï¼šMarisaMagic</p></blockquote><h3 id="é¢˜æ„æè¿°-6"><strong>é¢˜æ„æè¿°</strong></h3><p>åˆ å» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">1, 2, \ldots, 9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">9</span></span></span></span> ä¹‹é—´çš„æŸä¸ªæ•°å­— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼Œæ±‚æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> åœ¨åˆ å»æ•°å­— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> çš„æƒ…å†µä¸‹åœ¨è‡ªç„¶æ•°ä¸­æ’åœ¨ç¬¬å‡ ä½ã€‚<a href="https://www.luogu.com.cn/problem/T536440">ã€ŒYAC Round 11ã€æ´»æ³¼çº¯æƒ…çš„æ•°å­¦å®¶</a></p><h3 id="è§£é¢˜æ€è·¯-3"><strong>è§£é¢˜æ€è·¯</strong></h3><p>å…ˆè€ƒè™‘ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">x = 9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span></span></span></span> çš„æƒ…å†µã€‚å¦‚æœåˆ é™¤çš„æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>9</mn></mrow><annotation encoding="application/x-tex">9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span></span></span></span>ï¼Œé‚£ä¹ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn></mrow><annotation encoding="application/x-tex">8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8</span></span></span></span> ä¹‹åæ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>88</mn></mrow><annotation encoding="application/x-tex">88</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">88</span></span></span></span> ä¹‹åæ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn></mrow><annotation encoding="application/x-tex">100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">100</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>188</mn></mrow><annotation encoding="application/x-tex">188</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">188</span></span></span></span> ä¹‹åæ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>200</mn></mrow><annotation encoding="application/x-tex">200</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">200</span></span></span></span>ã€‚ä¸éš¾å‘ç°ï¼Œè¿™å…¶å®å°±æ˜¯ â€œé€¢ä¹è¿›ä¸€â€ï¼Œä¹Ÿå°±æ˜¯è¯´æ–°çš„è‡ªç„¶æ•°åˆ—æ˜¯ä¹è¿›åˆ¶æ•°ã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦æŠŠ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çœ‹ä½œæ˜¯ä¹è¿›åˆ¶æ•°ï¼Œç„¶åè½¬æ¢ä¸ºåè¿›åˆ¶æ•°å°±æ˜¯ç­”æ¡ˆã€‚</p><p>å†è€ƒè™‘ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=Ì¸</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">x \not = 9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel">î€ </span></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span></span></span></span> çš„æƒ…å†µã€‚æˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰å¤§äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> çš„æ•°ä½éƒ½å‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œå°äºç­‰äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> çš„æ•°ä½ä¿æŒä¸å˜ï¼Œæ­¤æ—¶ä¹Ÿå¯ä»¥æŠŠæ–°çš„æ•°åˆ—çœ‹æˆä¹è¿›åˆ¶æ•°ã€‚å› æ­¤åŒæ ·å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> è½¬æ¢æˆåè¿›åˆ¶æ•°å³å¯ã€‚</p><p>æ³¨æ„ï¼šè‡ªç„¶æ•°åŒ…æ‹¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œå› æ­¤æœ€åç­”æ¡ˆéœ€è¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">using</span> ll = <span class="hljs-type">long</span> <span class="hljs-type">long</span>;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">marisa</span><span class="hljs-params">()</span></span>&#123;<br>    string s; <span class="hljs-type">int</span> x; cin &gt;&gt; s &gt;&gt; x;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;c : s) <span class="hljs-keyword">if</span>(c - <span class="hljs-string">&#x27;0&#x27;</span> &gt; x) c -- ; <span class="hljs-comment">// å¤§äºxçš„æ•°å­—--</span><br><br><span class="hljs-comment">// çœ‹ä½œä¹è¿›åˆ¶æ•°ï¼Œè½¬æ¢ä¸ºåè¿›åˆ¶æ•°å³ä¸ºå…¶æ’å</span><br>    ll ans = <span class="hljs-number">0</span>, pro = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> it = s.<span class="hljs-built_in">rbegin</span>(); it != s.<span class="hljs-built_in">rend</span>(); it ++ )&#123; <span class="hljs-comment">// åå‘éå†</span><br>        ans += (*it - <span class="hljs-string">&#x27;0&#x27;</span>) * pro; <br>        pro *= <span class="hljs-number">9</span>;<br>    &#125;<br>    cout &lt;&lt; ans + <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;  <span class="hljs-comment">// è‡ªç„¶æ•°åŒ…å«0ï¼Œæœ€åéœ€è¦+1</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- ) <span class="hljs-built_in">marisa</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å’å”±å…‰èŠ’</category>
      
      <category>YAC æ‰¬å·å¤§å­¦ç®—æ³•ç»ƒä¹ èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>ç®—æ³•ç«èµ›</tag>
      
      <tag>Luogu</tag>
      
      <tag>YAC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 YAC Round 10 é¢˜è§£</title>
    <link href="/2024/12/14/YAC_Round_10/"/>
    <url>/2024/12/14/YAC_Round_10/</url>
    
    <content type="html"><![CDATA[<h2 id="A-å¹»æƒ³ä¹¡çºªå¹´æ³•"><strong>A å¹»æƒ³ä¹¡çºªå¹´æ³•</strong></h2><h3 id="é¢˜æ„æè¿°"><strong>é¢˜æ„æè¿°</strong></h3><p>ä¸€å¹´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>12</mn></mrow><annotation encoding="application/x-tex">12</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">12</span></span></span></span> ä¸ªæœˆï¼Œæ¯ä¸ªæœˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>30</mn></mrow><annotation encoding="application/x-tex">30</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">30</span></span></span></span> å¤©ï¼Œæ¯å‘¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span> å¤©ï¼Œåˆ†åˆ«ä¸ºå‘¨ä¸€è‡³å‘¨äº”ã€‚ç»™å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">y_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å¹´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">m_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æœˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">d_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ—¥ä»¥åŠè¿™å¤©æ˜¯å‘¨å‡ ï¼Œæ±‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">y_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å¹´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">m_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æœˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">d_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ—¥æ˜¯å‘¨å‡ ã€‚<a href="https://www.luogu.com.cn/problem/T440701">ã€ŒYAC Round 10ã€å¹»æƒ³ä¹¡çºªå¹´æ³•</a></p><h3 id="è§£é¢˜æ€è·¯"><strong>è§£é¢˜æ€è·¯</strong></h3><p>å¯ä»¥ç›´æ¥æ±‚ä¸¤å¤©çš„æ€»å¤©æ•°ï¼Œæ±‚å‡ºä¸¤æ•°ä¹‹å·®å°±å¯ä»¥å¾—å‡ºæ˜¯å‘¨å‡ ï¼ˆæ³¨æ„å·®ä¸ºè´Ÿæ•°ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>C++</mtext></mrow><annotation encoding="application/x-tex">\text{C++}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord">C++</span></span></span></span></span> éœ€è¦åŠ ä¸Š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span> å†å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span> å–æ¨¡ï¼‰ã€‚å½“ç„¶ï¼Œç”±é¢˜æ„å¯çŸ¥ä¸€å¹´ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>360</mn></mrow><annotation encoding="application/x-tex">360</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">360</span></span></span></span> å¤©ï¼Œä¸€ä¸ªæœˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>30</mn></mrow><annotation encoding="application/x-tex">30</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">30</span></span></span></span> å¤©ï¼Œè¿™äº›éƒ½æ­£å¥½æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span> çš„å€æ•°ï¼Œæ‰€ä»¥ç­”æ¡ˆä¹‹å’Œå¤©æ•°ä¹‹å·® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>d</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">d_2 - d_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æœ‰å…³ã€‚å› æ­¤å¯ä»¥ä¸ç”¨è®¡ç®—æ€»å¤©æ•°ï¼Œåªè®¡ç®—å¤©æ•°ä¹‹å·®å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br>string to[<span class="hljs-number">6</span>] = &#123;<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;Monday&quot;</span>, <span class="hljs-string">&quot;Tuesday&quot;</span>, <span class="hljs-string">&quot;Wednesday&quot;</span>, <span class="hljs-string">&quot;Thursday&quot;</span>, <span class="hljs-string">&quot;Friday&quot;</span>&#125;;<br>unordered_map&lt;string, <span class="hljs-type">int</span>&gt; mp = &#123;<br>    &#123;<span class="hljs-string">&quot;Monday&quot;</span>, <span class="hljs-number">1</span>&#125;,<br>    &#123;<span class="hljs-string">&quot;Tuesday&quot;</span>, <span class="hljs-number">2</span>&#125;,<br>    &#123;<span class="hljs-string">&quot;Wednesday&quot;</span>, <span class="hljs-number">3</span>&#125;,<br>    &#123;<span class="hljs-string">&quot;Thursday&quot;</span>, <span class="hljs-number">4</span>&#125;,<br>    &#123;<span class="hljs-string">&quot;Friday&quot;</span>, <span class="hljs-number">5</span>&#125;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        <span class="hljs-type">int</span> y1, m1, d1; cin &gt;&gt; y1 &gt;&gt; m1 &gt;&gt; d1;<br>        string s; cin &gt;&gt; s;<br>        <span class="hljs-type">int</span> y2, m2, d2; cin &gt;&gt; y2 &gt;&gt; m2 &gt;&gt; d2;<br><br>        <span class="hljs-type">int</span> a = mp[s], d = d2 - d1; <span class="hljs-comment">// d å¤©æ•°ä¹‹å·®</span><br>        <span class="hljs-type">int</span> b = ((a + d - <span class="hljs-number">1</span>) % <span class="hljs-number">5</span> + <span class="hljs-number">5</span>) % <span class="hljs-number">5</span> + <span class="hljs-number">1</span>; <span class="hljs-comment">// æ³¨æ„è´Ÿæ•°</span><br>        cout &lt;&lt; to[b] &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="B-éœ²å¨œæƒ³è¦æˆä¸ºä¼˜ç­‰ç”Ÿ"><strong>B éœ²å¨œæƒ³è¦æˆä¸ºä¼˜ç­‰ç”Ÿ</strong></h2><h3 id="é¢˜æ„æè¿°-2"><strong>é¢˜æ„æè¿°</strong></h3><p>æ±‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªæ•´æ•°çš„å¹³å‡åˆ†ï¼Œå¹¶ä¿ç•™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä½å°æ•°ï¼ˆå°æ•°ç‚¹åç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä½åé¢å…¨éƒ¨æˆªæ–­ï¼‰<a href="https://www.luogu.com.cn/problem/T440702">ã€ŒYAC Round 10ã€éœ²å¨œæƒ³è¦æˆä¸ºä¼˜ç­‰ç”Ÿ</a></p><h3 id="è§£é¢˜æ€è·¯-æ¨¡æ‹Ÿ"><strong>è§£é¢˜æ€è·¯</strong> æ¨¡æ‹Ÿ</h3><p>å…ˆæ±‚å‡ºæ€»åˆ† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">âŒŠ</mo><mfrac><mrow><mi>s</mi><mi>u</mi><mi>m</mi></mrow><mi>n</mi></mfrac><mo fence="true">âŒ‹</mo></mrow><annotation encoding="application/x-tex">\left \lfloor \frac{sum}{n} \right \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">âŒŠ</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">âŒ‹</span></span></span></span></span></span> ä¸ºå°æ•°ç‚¹ä¹‹å‰çš„æ•´æ•°éƒ¨åˆ†ã€‚å¯¹äºå°æ•°ç‚¹ä¹‹å <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä½ï¼Œæ¨¡æ‹Ÿæ•°å­¦é™¤æ³•è¿‡ç¨‹å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> n, k, sum = <span class="hljs-number">0</span>; cin &gt;&gt; n &gt;&gt; k;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, x; i &lt;= n; i ++ ) cin &gt;&gt; x, sum += x;<br>    cout &lt;&lt; sum / n &lt;&lt; <span class="hljs-string">&quot;.&quot;</span>; <span class="hljs-comment">// æ•´æ•°éƒ¨åˆ†</span><br><br>    sum %= n;<br>    <span class="hljs-keyword">while</span>(k -- )&#123;   <span class="hljs-comment">// æ¨¡æ‹Ÿé™¤æ³•</span><br>        sum *= <span class="hljs-number">10</span>;<br>        cout &lt;&lt; sum / n;<br>        sum %= n;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="C-äººå¶å·¨å¤§åŒ–è®¡åˆ’"><strong>C äººå¶å·¨å¤§åŒ–è®¡åˆ’</strong></h2><h3 id="é¢˜æ„æè¿°-3"><strong>é¢˜æ„æè¿°</strong></h3><p>èµ·ç‚¹ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0,0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span>ï¼Œå¯ä»¥æœä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘ç§»åŠ¨ï¼Œåˆ†åˆ«å¯¹åº” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>â€™Uâ€™,Â â€™Dâ€™,Â â€™Lâ€™,Â â€™Râ€™</mtext></mrow><annotation encoding="application/x-tex">\text{&#x27;U&#x27;, &#x27;D&#x27;, &#x27;L&#x27;, &#x27;R&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">â€™Uâ€™,Â â€™Dâ€™,Â â€™Lâ€™,Â â€™Râ€™</span></span></span></span></span> ã€‚ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„åŸºæœ¬æŒ‡ä»¤åºåˆ—ï¼ŒæŒ‰ç…§é¡ºåºé‡å¤æ‰§è¡Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> è½®æ•´ä¸ªåŸºæœ¬åºåˆ—ï¼Œæ±‚æ•´ä¸ªç§»åŠ¨è¿‡ç¨‹ä¸­è·ç¦»èµ·ç‚¹çš„æœ€å¤§æ›¼å“ˆé¡¿è·ç¦»ã€‚<a href="https://www.luogu.com.cn/problem/T440703">ã€ŒYAC Round 10ã€äººå¶å·¨å¤§åŒ–è®¡åˆ’</a></p><h3 id="è§£é¢˜æ€è·¯-æ¨¡æ‹Ÿ-è´ªå¿ƒ-æšä¸¾"><strong>è§£é¢˜æ€è·¯</strong> æ¨¡æ‹Ÿ + è´ªå¿ƒ + æšä¸¾</h3><p>æ‰§è¡Œä¸€è½®åŸºæœ¬åºåˆ—ååˆ°è¾¾çš„ä½ç½®ï¼Œè·ç¦»æ‰§è¡Œä¹‹å‰çš„èµ·ç‚¹ä¼šäº§ç”Ÿä¸€ä¸ªåç§»é‡ï¼Œå¯ä»¥å‡è®¾è¿™ä¸ªåç§»é‡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>ã€‚æ¨¡æ‹Ÿå¯ä»¥å‘ç°ï¼Œæ¯ä¸€è½®ä¸­åˆ°è¾¾çš„æ¯ä¸ªç‚¹è·ç¦»èµ·ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span> çš„æ›¼å“ˆé¡¿è·ç¦»éƒ½æ¯”ä¸Šä¸€è½®çš„æ¯ä¸ªç‚¹éƒ½å¤šäº†ä¸€ä¸ªåç§»é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>ï¼Œæ•…æœ€åç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> æ¬¡åˆ°è¾¾çš„æ¯ä¸ªç‚¹éƒ½æ¯”å‰é¢æ¯ä¸€è½®åˆ°è¾¾çš„ç‚¹è·ç¦»èµ·ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span> æ›´ä¼˜ã€‚</p><p>å› æ­¤æˆ‘ä»¬åªéœ€è¦å…ˆæ¨¡æ‹Ÿç¬¬ä¸€è½®å¾—åˆ°ç»ˆç‚¹ä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_1, y_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">x_1 + y_1 = d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>ï¼‰ï¼Œç„¶åä¹˜ä¸Š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œæšä¸¾ä¸€ä¸‹æœ€åç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> è½®æ¯ä¸ªç‚¹è·ç¦»èµ·ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span> çš„æ›¼å“ˆé¡¿è·ç¦»å–æœ€å¤§å€¼å³å¯ã€‚ ä½†æ˜¯ï¼Œè¿™æ ·è¿˜ä¸å®Œå…¨æ­£ç¡®ã€‚</p><p>æ¯”å¦‚æœ‰ä¸€ä¸ªåºåˆ— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&quot;UUUULLLLDDDDDRRRRR&quot;</mtext></mrow><annotation encoding="application/x-tex">\text{&quot;UUUULLLLDDDDDRRRRR&quot;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">&quot;UUUULLLLDDDDDRRRRR&quot;</span></span></span></span></span>ï¼Œé‡å¤æ‰§è¡Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> æ¬¡ï¼Œæ¨¡æ‹Ÿåå¯ä»¥å‘ç°ç­”æ¡ˆåœ¨ç¬¬ä¸€è½®æ‰§è¡Œåºåˆ—ä¸­ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æšä¸¾ç¬¬ä¸€è½®ä¸­çš„æ‰€æœ‰ç‚¹æ›¼å“ˆé¡¿è·ç¦»æœ€å¤§å€¼ã€‚</p><p>ç»¼ä¸Šï¼Œåªéœ€è¦æšä¸¾ç¬¬ä¸€è½®å’Œç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> è½®çš„ç‚¹å–æœ€å¤§æ›¼å“ˆé¡¿è·ç¦»å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> dx[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">1</span>&#125;, dy[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">-1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>&#125;;<br>unordered_map&lt;<span class="hljs-type">char</span>, <span class="hljs-type">int</span>&gt; mp = &#123; &#123;<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-number">0</span>&#125;, &#123;<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-string">&#x27;U&#x27;</span>, <span class="hljs-number">2</span>&#125;, &#123;<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-number">3</span>&#125; &#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        ll n, K; cin &gt;&gt; n &gt;&gt; K;<br>        string a; cin &gt;&gt; a;<br><br>        ll x = <span class="hljs-number">0</span>, y = <span class="hljs-number">0</span>, res = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )&#123; <span class="hljs-comment">// ç¬¬ä¸€è½®ä¹Ÿéœ€è¦æšä¸¾ï¼Œå¹¶æ±‚å‡ºç¬¬ä¸€è½®ç»ˆç‚¹ä½ç½®</span><br>            <span class="hljs-type">int</span> k = mp[a[i]];<br>            x = x + dx[k], y = y + dy[k];<br>            res = <span class="hljs-built_in">max</span>(res, <span class="hljs-built_in">llabs</span>(x) + <span class="hljs-built_in">llabs</span>(y));<br>        &#125;<br><br>        x *= (K - <span class="hljs-number">1</span>), y *= (K - <span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )&#123; <span class="hljs-comment">// ç¬¬ k è½®æšä¸¾æ¯ä¸ªç‚¹</span><br>            <span class="hljs-type">int</span> k = mp[a[i]];<br>            x = x + dx[k], y = y + dy[k];<br>            res = <span class="hljs-built_in">max</span>(res, <span class="hljs-built_in">llabs</span>(x) + <span class="hljs-built_in">llabs</span>(y));<br>        &#125;<br><br>        cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="D-Touhou-å…½ç‹åŸ"><strong>D Touhou å…½ç‹åŸ</strong></h2><h3 id="é¢˜æ„æè¿°-4"><strong>é¢˜æ„æè¿°</strong></h3><p>æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªå…³å¡ï¼Œæ¯ä¸ªå…³å¡æ¶ˆè€— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">h_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ç‚¹ç”Ÿå‘½å€¼å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ç‚¹è€åŠ›å€¼ï¼Œä»·å€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸ªé‡‘å¸ã€‚ç°åœ¨æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span> ç‚¹ç”Ÿå‘½å€¼ å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> ç‚¹è€åŠ›å€¼ï¼Œæ±‚é€‰æ‹©ä¸€äº›å…³å¡å¯ä»¥è·å¾—çš„é‡‘å¸æœ€å¤§æ•°é‡ã€‚ <a href="https://www.luogu.com.cn/problem/T440704">ã€ŒYAC Round 10ã€Touhou å…½ç‹åŸ</a></p><h3 id="è§£é¢˜æ€è·¯-äºŒç»´è´¹ç”¨èƒŒåŒ…"><strong>è§£é¢˜æ€è·¯</strong> äºŒç»´è´¹ç”¨èƒŒåŒ…</h3><p>æ˜¾ç„¶æ˜¯äºŒç»´è´¹ç”¨èƒŒåŒ…é—®é¢˜ï¼Œä½†æ˜¯ç”±äºç©ºé—´é™åˆ¶ï¼Œåªèƒ½ä½¿ç”¨ç©ºé—´ä¼˜åŒ–çš„äºŒç»´è´¹ç”¨èƒŒåŒ…æ¨¡æ¿ï¼ˆ<a href="https://www.acwing.com/solution/content/53753/">AcWing 8. äºŒç»´è´¹ç”¨çš„èƒŒåŒ…é—®é¢˜ã€äºŒç»´è´¹ç”¨01èƒŒåŒ…é—®é¢˜ã€‘</a>ï¼‰ã€‚</p><p>å‡ ä¹å’Œæ¨¡æ¿æ²¡æœ‰å·®åˆ«ï¼Œåªéœ€è¦å¢åŠ ä¸€ä¸ªé€æ”¯è€åŠ›å€¼æ˜¯å¦å¯ä»¥ç”¨ç”Ÿå‘½å€¼æ¥ä»£æ›¿çš„çŠ¶æ€è½¬ç§»å³å¯ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo>=</mo><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>j</mi><mo>âˆ’</mo><mi>h</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo>âˆ’</mo><mi>s</mi><mo stretchy="false">]</mo><mo>+</mo><mi>w</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>j</mi><mo>&gt;</mo><mi>h</mi><mo separator="true">,</mo><mi>k</mi><mo>&gt;</mo><mo>=</mo><mi>s</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo>=</mo><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>j</mi><mo>âˆ’</mo><mi>h</mi><mo>âˆ’</mo><mo stretchy="false">(</mo><mi>s</mi><mo>âˆ’</mo><mi>k</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>+</mo><mi>w</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>j</mi><mo>âˆ’</mo><mi>h</mi><mo>âˆ’</mo><mo stretchy="false">(</mo><mi>s</mi><mo>âˆ’</mo><mi>k</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>0</mn><mo separator="true">,</mo><mi>k</mi><mo>&lt;</mo><mi>s</mi></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases}dp[j][k] = \max(dp[j][k], dp[j - h][k - s] + w), &amp; j &gt; h, k &gt;= s\\\\dp[j][k] = \max(dp[j][k], dp[j - h - (s - k)][0] + w), &amp; j - h - (s - k) &gt; 0, k &lt; s\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â©</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â¨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â§</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">h</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">s</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mpunct">,</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">s</span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">s</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1010</span>, M = <span class="hljs-number">310</span>;<br><br>ll dp[M][M];<br><span class="hljs-type">int</span> n, H, S;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; H &gt;&gt; S;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, h, s, w; i &lt;= n; i ++ )&#123;<br>        cin &gt;&gt; h &gt;&gt; s &gt;&gt; w;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = H; j &gt; h; j -- ) <span class="hljs-comment">// ä¸èƒ½å‡å°‘åˆ°0</span><br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = S; k &gt;= <span class="hljs-number">0</span>; k -- )&#123;<br>                <span class="hljs-keyword">if</span>(k &gt;= s) dp[j][k] = <span class="hljs-built_in">max</span>(dp[j][k], dp[j - h][k - s] + w);<br>                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(j - h - (s - k) &gt; <span class="hljs-number">0</span>) <br>                    dp[j][k] = <span class="hljs-built_in">max</span>(dp[j][k], dp[j - h - (s - k)][<span class="hljs-number">0</span>] + w);<br>            &#125;<br>    &#125;<br>    cout &lt;&lt; dp[H][S] &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="E-ç”œèœœçš„ç‚¹å¿ƒæ—¶é—´"><strong>E ç”œèœœçš„ç‚¹å¿ƒæ—¶é—´</strong></h2><h3 id="é¢˜æ„æè¿°-5"><strong>é¢˜æ„æè¿°</strong></h3><p>æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚æœ‰å¤šå°‘å¯¹å­—ç¬¦ä¸²æ‹¼æ¥åå¯ä»¥åˆ†æˆå®Œå…¨ç›¸åŒçš„ä¸¤ä¸ªä¸²ã€‚<a href="https://www.luogu.com.cn/problem/T440705">ã€ŒYAC Round 10ã€ç”œèœœçš„ç‚¹å¿ƒæ—¶é—´</a></p><h3 id="è§£é¢˜æ€è·¯-å­—ç¬¦ä¸²å“ˆå¸Œ"><strong>è§£é¢˜æ€è·¯</strong> å­—ç¬¦ä¸²å“ˆå¸Œ</h3><p>é¦–å…ˆï¼Œè‹¥ä¸€ä¸ªä¸² <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> å’Œ ä¸€ä¸ªä¸² <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> æ‹¼æ¥åå¾—åˆ°çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">AB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> æ˜¯å¯ä»¥å®Œå…¨åˆ†æˆç›¸åŒä¸¤ä»½çš„ï¼Œæ˜¾ç„¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">BA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">A</span></span></span></span> ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚å› æ­¤åœ¨ç»Ÿè®¡è¿‡ç¨‹ä¸­åªéœ€è¦æ­£ç€åšä¸€æ¬¡å³å¯ã€‚</p><p>å¯ä»¥å‘ç°ä¸€ä¸ªä¸² <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> å’Œ ä¸€ä¸ªä¸² <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> æ‹¼æ¥åå¾—åˆ°çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">AB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> æ˜¯å¯ä»¥å®Œå…¨åˆ†æˆç›¸åŒçš„ä¸¤ä¸ªä¸²æœ‰å¦‚ä¸‹å‡ ç§æƒ…å†µï¼š</p><ul><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> å®Œå…¨ç›¸åŒï¼›</p></li><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> çš„ä¸­é—´éƒ¨åˆ†å®Œå…¨ç›¸åŒã€‚</p></li><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> çš„ä¸­é—´éƒ¨åˆ†å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> å®Œå…¨ç›¸åŒï¼›</p></li></ul><p>PSï¼šè¿™é‡Œçš„ä¸²çš„ä¸­é—´éƒ¨åˆ†å‰ææ˜¯ä¸­é—´éƒ¨åˆ†çš„ä¸¤ä¾§çš„ä¸²æ˜¯ä¸€æ ·çš„ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æšä¸¾æ¯ä¸ªä¸²ï¼Œç´¯è®¡è¿™ä¸ªä¸²å‡ºç°çš„æ¬¡æ•°ï¼Œå¹¶ä¸”æšä¸¾è¿™ä¸ªä¸²çš„ä¸­é—´éƒ¨åˆ†ä¹Ÿè¿›è¡Œç»Ÿè®¡ã€‚å¯¹äºæšä¸¾çš„æ¯ä¸ªä¸²ï¼Œå…¶ç­”æ¡ˆçš„è´¡çŒ®å°±æ˜¯å…ˆå‰ <strong>ä¸å…¶å®Œå…¨ç›¸åŒçš„ä¸²çš„ä¸ªæ•°</strong> + <strong>ä¸å…¶å®Œå…¨ç›¸åŒçš„ä¸­é—´éƒ¨åˆ†çš„ä¸ªæ•°</strong> + <strong>ä¸å…¶ä¸­é—´éƒ¨åˆ†å®Œå…¨ç›¸åŒçš„ä¸²çš„ä¸ªæ•°</strong> ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç”¨å­—ç¬¦ä¸²å“ˆå¸Œæ¥å®ç°ï¼Œç»´æŠ¤æ¯ä¸ªä¸²ä»¥åŠä¸­é—´éƒ¨åˆ†çš„å‡ºç°æ¬¡æ•°ã€‚æœ¬é¢˜å¯¹äºå¡äº†ä¸€äº›æ¯”è¾ƒå¸¸ç”¨çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>base</mtext></mrow><annotation encoding="application/x-tex">\text{base}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">base</span></span></span></span></span>ï¼Œå»ºè®®ä½¿ç”¨åŒå“ˆå¸Œæˆ–è€…ä½¿ç”¨æ¯”è¾ƒç¨€å¥‡å¤æ€ªçš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>base</mtext></mrow><annotation encoding="application/x-tex">\text{base}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">base</span></span></span></span></span> ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MP make_pair</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> fi first</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> se second</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-keyword">typedef</span> pair&lt;ll, ll&gt; pll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">4e5</span> + <span class="hljs-number">10</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> mod1 = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> mod2 = <span class="hljs-number">998244353</span>;<br><br>ll hs1[N], bs1[N], hs2[N], bs2[N];<br>ll base1, base2;<br>string s;<br><span class="hljs-type">int</span> n;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">work</span><span class="hljs-params">()</span></span>&#123; <span class="hljs-comment">// åŒå“ˆå¸Œ</span><br>    base1 = <span class="hljs-number">131</span>, base2 = <span class="hljs-number">233</span>;<br>    hs1[<span class="hljs-number">0</span>] = hs2[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br>    bs1[<span class="hljs-number">0</span>] = bs2[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        bs1[i] = (bs1[i - <span class="hljs-number">1</span>] * base1) % mod1;<br>        bs2[i] = (bs2[i - <span class="hljs-number">1</span>] * base2) % mod2;<br>        hs1[i] = (hs1[i - <span class="hljs-number">1</span>] * base1 + s[i - <span class="hljs-number">1</span>] - <span class="hljs-string">&#x27;a&#x27;</span> + <span class="hljs-number">1</span>) % mod1;<br>        hs2[i] = (hs2[i - <span class="hljs-number">1</span>] * base2 + s[i - <span class="hljs-number">1</span>] - <span class="hljs-string">&#x27;a&#x27;</span> + <span class="hljs-number">1</span>) % mod2;        <br>    &#125;<br>&#125;<br><br><span class="hljs-function">pll <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r)</span></span>&#123;<br>    ll x = ((hs1[r] - hs1[l - <span class="hljs-number">1</span>] * bs1[r - l + <span class="hljs-number">1</span>]) % mod1 + mod1) % mod1;<br>    ll y = ((hs2[r] - hs2[l - <span class="hljs-number">1</span>] * bs2[r - l + <span class="hljs-number">1</span>]) % mod2 + mod2) % mod2;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">MP</span>(x, y);<br>&#125;<br><br>map&lt;pll, ll&gt; mp1, mp2; <span class="hljs-comment">// mp1 ç»´æŠ¤æ¯ä¸ªä¸²å‡ºç°æ¬¡æ•°ï¼Œmp2 ç»´æŠ¤æ‰€æœ‰ä¸­é—´éƒ¨åˆ†å‡ºç°æ¬¡æ•°</span><br>ll res = <span class="hljs-number">0</span>;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> m; cin &gt;&gt; m;<br>    <span class="hljs-keyword">while</span>(m -- )&#123;<br>        cin &gt;&gt; s;<br>        n = s.<span class="hljs-built_in">size</span>();<br><br>        <span class="hljs-built_in">work</span>();<br><br>        <span class="hljs-keyword">auto</span> cur = <span class="hljs-built_in">query</span>(<span class="hljs-number">1</span>, n);<br>        res += mp1[cur];  <span class="hljs-comment">// ä¸å…¶å®Œå…¨ç›¸åŒçš„ä¸²çš„ä¸ªæ•°</span><br>        mp1[cur] ++ ;     <span class="hljs-comment">// ç´¯è®¡æ¯ä¸ªä¸²å‡ºç°çš„æ¬¡æ•°</span><br><br>        res += mp2[cur];  <span class="hljs-comment">// ä¸å…¶å®Œå…¨ç›¸åŒçš„ä¸­é—´éƒ¨åˆ†çš„ä¸ªæ•°</span><br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; <span class="hljs-number">2</span> * i &lt; n; i ++ )&#123; <span class="hljs-comment">// æšä¸¾ä¸­é—´éƒ¨åˆ†</span><br>            <span class="hljs-keyword">auto</span> x = <span class="hljs-built_in">query</span>(<span class="hljs-number">1</span>, i), y = <span class="hljs-built_in">query</span>(n - i + <span class="hljs-number">1</span>, n); <span class="hljs-comment">// å‰æä¸¤ä¾§ä¸€æ ·</span><br>            <span class="hljs-keyword">if</span>(x == y)&#123;<br>                <span class="hljs-keyword">auto</span> z = <span class="hljs-built_in">query</span>(i + <span class="hljs-number">1</span>, n - i); <span class="hljs-comment">// ä¸­é—´å†…éƒ¨éƒ¨åˆ†</span><br>                res += mp1[z];  <span class="hljs-comment">// ä¸å…¶ä¸­é—´éƒ¨åˆ†å®Œå…¨ç›¸åŒçš„ä¸²çš„ä¸ªæ•°</span><br>                mp2[z] ++ ;     <span class="hljs-comment">// ç´¯è®¡ä¸­é—´éƒ¨åˆ†  </span><br>            &#125;<br>        &#125;<br>    &#125;<br><br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="F-ã€Šæ–‡æ–‡ã€‚æ–°é—»ã€‹"><strong>F ã€Šæ–‡æ–‡ã€‚æ–°é—»ã€‹</strong></h2><h3 id="é¢˜æ„æè¿°-6"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€é¢— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> èŠ‚ç‚¹çš„æ ‘ï¼Œæ¯ä¸ªè¾¹æœ‰ä¸€ä¸ªä¸¤ä¸ªè¾¹æƒ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">w_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">w_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œåˆ†åˆ«ä¸ºå•ç¨‹ä½¿ç”¨å’Œæ— é™æ¬¡ä½¿ç”¨ã€‚ç°åœ¨éœ€è¦ä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> ä¸€ç›´æŒ‰é¡ºåºéå†åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>ï¼Œæ±‚æ•´ä¸ªéå†è¿‡ç¨‹çš„æœ€å°èŠ±è´¹ä¸ºå¤šå°‘ã€‚<a href="https://www.luogu.com.cn/problem/T441435">ã€ŒYAC Round 10ã€ã€Šæ–‡æ–‡ã€‚æ–°é—»ã€‹</a></p><h3 id="è§£é¢˜æ€è·¯-å€å¢æ±‚LCA-æ ‘ä¸Šå·®åˆ†"><strong>è§£é¢˜æ€è·¯</strong> å€å¢æ±‚LCA + æ ‘ä¸Šå·®åˆ†</h3><p>æœ‰æ¡ä»¶å¯çŸ¥ä¸ºä¸€æ£µæ ‘ï¼ŒèŠ‚ç‚¹ä¸¤ä¸¤ä¹‹é—´æœ€çŸ­è·¯å¾„ç¡®å®šã€‚å€å¢æ±‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>C</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">LCA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">A</span></span></span></span>ï¼ˆæˆ–è€…å…¶ä»–æ–¹æ³•ï¼‰ï¼Œæ ‘ä¸Šè¾¹å·®åˆ†å¹¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>f</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">dfs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">df</span><span class="mord mathnormal">s</span></span></span></span> æ±‚æ ‘ä¸Šå‰ç¼€å’Œæ±‚å‡ºæ¯æ¡è¾¹ç»è¿‡å¤šå°‘æ¬¡ï¼ˆæ¯ä¸ªç‚¹å‘ä¸Šåˆ°å…¶çˆ¶èŠ‚ç‚¹çš„ä¸€æ¡è¾¹ä¸ºè¿™ä¸ªèŠ‚ç‚¹å¯¹åº”çš„è¾¹ï¼‰ï¼Œæœ€åæšä¸¾ä¸€ä¸‹æ¯æ¡è¾¹ä¸Šä½¿ç”¨å•ç¨‹ç¥¨è¿˜æ˜¯å¤šç¨‹ç¥¨æ›´åˆ’ç®—ç´¯åŠ å³ä¸ºç­”æ¡ˆã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">2e5</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123; <span class="hljs-type">int</span> v, w1, w2; &#125;;<br>vector&lt;node&gt; e[N];<br><span class="hljs-type">int</span> n, b[N], c1[N], c2[N], d[N], f[N][<span class="hljs-number">22</span>];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">bfs</span><span class="hljs-params">(<span class="hljs-type">int</span> src)</span></span>&#123;<br>    queue&lt;<span class="hljs-type">int</span>&gt; q;<br>    q.<span class="hljs-built_in">push</span>(src);<br>    d[src] = <span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-type">int</span> u = q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;[v, w1, w2] : e[u])&#123;<br>            <span class="hljs-keyword">if</span>(!d[v])&#123;<br>                q.<span class="hljs-built_in">push</span>(v);<br>                d[v] = d[u] + <span class="hljs-number">1</span>, f[v][<span class="hljs-number">0</span>] = u;<br>                <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>; k &lt;= <span class="hljs-number">20</span>; k ++ ) f[v][k] = f[f[v][k - <span class="hljs-number">1</span>]][k - <span class="hljs-number">1</span>];<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">lca</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(d[a] &lt; d[b]) <span class="hljs-built_in">swap</span>(a, b);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">20</span>; ~k; k -- )<br>        <span class="hljs-keyword">if</span>(d[f[a][k]] &gt;= d[b]) a = f[a][k];<br>    <span class="hljs-keyword">if</span>(a == b) <span class="hljs-keyword">return</span> a;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">20</span>; ~k; k -- )<br>        <span class="hljs-keyword">if</span>(f[a][k] != f[b][k]) a = f[a][k], b = f[b][k];<br>    <span class="hljs-keyword">return</span> f[a][<span class="hljs-number">0</span>];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> fa)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;[v, w1, w2] : e[u])&#123;<br>        <span class="hljs-keyword">if</span>(v == fa) <span class="hljs-keyword">continue</span>;<br>        c1[v] = w1, c2[v] = w2; <span class="hljs-comment">// æ¯ä¸ªèŠ‚ç‚¹å‘ä¸Šåˆ°çˆ¶èŠ‚ç‚¹çš„è¾¹</span><br>        <span class="hljs-built_in">dfs</span>(v, u);<br>        b[u] += b[v];<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, u, v, w1, w2; i &lt; n; i ++ )&#123;<br>        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w1 &gt;&gt; w2;<br>        e[u].<span class="hljs-built_in">push_back</span>(node&#123;v, w1, w2&#125;);<br>        e[v].<span class="hljs-built_in">push_back</span>(node&#123;u, w1, w2&#125;);<br>    &#125;<br><br>    <span class="hljs-built_in">bfs</span>(<span class="hljs-number">1</span>);<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> u = <span class="hljs-number">1</span>; u &lt; n; u ++ )&#123;<br>        <span class="hljs-type">int</span> v = u + <span class="hljs-number">1</span>, anc = <span class="hljs-built_in">lca</span>(u, v);<br>        b[u] ++ , b[v] ++ , b[anc] -= <span class="hljs-number">2</span>; <span class="hljs-comment">// è¾¹å·®åˆ†</span><br>    &#125;<br><br>    <span class="hljs-built_in">dfs</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);<br><br>    ll res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++ ) res += <span class="hljs-built_in">min</span>((ll)b[i] * c1[i], (ll)c2[i]);<br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å’å”±å…‰èŠ’</category>
      
      <category>YAC æ‰¬å·å¤§å­¦ç®—æ³•ç»ƒä¹ èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>ç®—æ³•ç«èµ›</tag>
      
      <tag>Luogu</tag>
      
      <tag>YAC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 YAC Round 9 é¢˜è§£</title>
    <link href="/2024/12/14/YAC_Round_9/"/>
    <url>/2024/12/14/YAC_Round_9/</url>
    
    <content type="html"><![CDATA[<h2 id="A-æœªæ¥ä¸å¯é™é‡"><strong>A æœªæ¥ä¸å¯é™é‡</strong></h2><h3 id="é¢˜æ„æè¿°"><strong>é¢˜æ„æè¿°</strong></h3><p>è¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>â€œSkyÂ isÂ limit.â€</mtext></mrow><annotation encoding="application/x-tex">\text{â€œSky is limit.â€}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">â€œSkyÂ isÂ limit.â€</span></span></span></span></span> ã€‚<a href="https://www.luogu.com.cn/problem/T438134">https://www.luogu.com.cn/problem/T438134</a></p><h3 id="è§£é¢˜æ€è·¯"><strong>è§£é¢˜æ€è·¯</strong></h3><p>ç­¾åˆ°é¢˜ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Sky is limit.&quot;</span>);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="B-â‘¨-å·å½©ç¥¨"><strong>B â‘¨ å·å½©ç¥¨</strong></h2><h3 id="é¢˜æ„æè¿°-2"><strong>é¢˜æ„æè¿°</strong></h3><p>ä¸€ä¸ªå¤§å°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>9</mn></mrow><annotation encoding="application/x-tex">9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span></span></span></span> è¡Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>9</mn></mrow><annotation encoding="application/x-tex">9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span></span></span></span> åˆ—çš„æ•°ç»„ï¼Œæ¯ä¸ªä½ç½®æœ‰ä¸€ä¸ªå·ç å’Œé‡‘é¢ã€‚è¯¢é—®ä¸¤ä¸ªæ•°å­—ï¼Œæ±‚ç­‰äºè¿™ä¸¤ä¸ªæ•°å­—çš„ä½ç½®çš„é‡‘é¢æ€»æ•°ã€‚æœ€åç­”æ¡ˆè®°å¾—è¦å‡å» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>999</mn></mrow><annotation encoding="application/x-tex">999</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">999</span></span></span></span> ã€‚<a href="https://www.luogu.com.cn/problem/T438073">ã€ŒYAC Round 9ã€â‘¨ å·å½©ç¥¨</a></p><h3 id="è§£é¢˜æ€è·¯-2"><strong>è§£é¢˜æ€è·¯</strong></h3><p>æŒ‰ç…§é¢˜æ„ç»Ÿè®¡å³å¯ï¼Œæ³¨æ„å¼€ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>longÂ long</mtext></mrow><annotation encoding="application/x-tex">\text{long long}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">longÂ long</span></span></span></span></span> ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">11</span>;<br><br><span class="hljs-type">int</span> g[N][N], w[N][N], n1, n2;<br>ll res = <span class="hljs-number">-999</span>;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">9</span>; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= <span class="hljs-number">9</span>; j ++ )<br>            cin &gt;&gt; g[i][j];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">9</span>; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= <span class="hljs-number">9</span>; j ++ )<br>            cin &gt;&gt; w[i][j];<br><br>    cin &gt;&gt; n1 &gt;&gt; n2;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">9</span>; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= <span class="hljs-number">9</span>; j ++ )<br>            <span class="hljs-keyword">if</span>(g[i][j] == n1 || g[i][j] == n2) res += w[i][j];<br><br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="C-åœ¨ç®€å•é¢˜å¯»æ±‚å›æ–‡ä¸²æ˜¯å¦æé”™äº†ä»€ä¹ˆ"><strong>C åœ¨ç®€å•é¢˜å¯»æ±‚å›æ–‡ä¸²æ˜¯å¦æé”™äº†ä»€ä¹ˆ</strong></h2><h3 id="é¢˜æ„æè¿°-3"><strong>é¢˜æ„æè¿°</strong></h3><p>æ±‚ç»™å®šå­—ç¬¦ä¸²ä¸­æ¯ä¸ªå­—ç¬¦å‡ºç°æ¬¡æ•°ä¸è¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> æ¬¡çš„å›æ–‡å­ä¸²ä¸ªæ•°ã€‚<a href="https://www.luogu.com.cn/problem/T438078">ã€ŒYAC Round 9ã€åœ¨ç®€å•é¢˜å¯»æ±‚å›æ–‡ä¸²æ˜¯å¦æé”™äº†ä»€ä¹ˆ</a></p><h3 id="è§£é¢˜æ€è·¯-ä¸­å¿ƒæ‰©å±•æ³•"><strong>è§£é¢˜æ€è·¯</strong> ä¸­å¿ƒæ‰©å±•æ³•</h3><p>æœ¬é¢˜æ±‚è§£çš„å…³é”®ä¹‹å¤„åœ¨äº <strong>æ¯ä¸ªå­—ç¬¦å‡ºç°æ¬¡æ•°ä¸è¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> æ¬¡</strong>ï¼Œç”±äºåªåŒ…å«å°å†™è‹±æ–‡å­—ç¬¦ï¼Œæ•…æœ€é•¿çš„å›æ–‡ä¸²é•¿åº¦ä¸ä¼šè¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>26</mn><mo>Ã—</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">26 \times 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">26</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>ï¼ˆä¹Ÿå°±æ˜¯æ¯ç§è‹±æ–‡å­—ç¬¦éƒ½å‡ºç°ä¸¤æ¬¡ï¼Œä¸”å‘ˆç°å¯¹ç§°çš„å½¢å¼ï¼‰ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æšä¸¾æ¯ä¸ªä½ç½®ï¼Œé‡‡ç”¨ä¸­å¿ƒæ‰©å±•æ³•ï¼Œåœ¨æ‰©å±•è¿‡ç¨‹ä¸­ï¼Œç»´æŠ¤æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°ï¼Œä¸æ–­å‘ä¸¤è¾¹æ‰©å±•å¾—åˆ°å›æ–‡å­ä¸²çš„ä¸ªæ•°ï¼ˆç”±å‰é¢çš„ç»“è®ºå¯çŸ¥ï¼Œæ¯ä¸ªä½ç½®æ‰©å±•æ¬¡æ•°ä¸ä¼šè¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>26</mn></mrow><annotation encoding="application/x-tex">26</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">26</span></span></span></span> æ¬¡ï¼‰ã€‚åˆ†åˆ«ç»Ÿè®¡å¥‡æ•°é•¿åº¦å’Œå¶æ•°é•¿åº¦çš„å›æ–‡å­ä¸²ä¸ªæ•°ï¼Œç´¯åŠ ç­”æ¡ˆå³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    string s; cin &gt;&gt; s;<br>    <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>, n = s.<span class="hljs-built_in">size</span>();<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )&#123; <span class="hljs-comment">// é•¿åº¦ä¸ºå¥‡æ•°</span><br>        <span class="hljs-type">int</span> cur = <span class="hljs-number">1</span>;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">cnt</span><span class="hljs-params">(<span class="hljs-number">26</span>, <span class="hljs-number">0</span>)</span></span>;<br>        cnt[s[i] - <span class="hljs-string">&#x27;a&#x27;</span>] ++ ;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> l = i - <span class="hljs-number">1</span>, r = i + <span class="hljs-number">1</span>; l &gt;= <span class="hljs-number">0</span> &amp;&amp; r &lt; n &amp;&amp; s[l] == s[r]; l -- , r ++ )&#123;<br>            cnt[s[l] - <span class="hljs-string">&#x27;a&#x27;</span>] += <span class="hljs-number">2</span>;<br>            <span class="hljs-keyword">if</span>(cnt[s[l] - <span class="hljs-string">&#x27;a&#x27;</span>] &gt; <span class="hljs-number">2</span>) <span class="hljs-keyword">break</span>;<br>            cur ++ ;<br>        &#125;<br>        res += cur;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i ++ )&#123; <span class="hljs-comment">// é•¿åº¦ä¸ºå¶æ•°</span><br>        <span class="hljs-type">int</span> cur = <span class="hljs-number">0</span>;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">cnt</span><span class="hljs-params">(<span class="hljs-number">26</span>, <span class="hljs-number">0</span>)</span></span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> l = i, r = i + <span class="hljs-number">1</span>; l &gt;= <span class="hljs-number">0</span> &amp;&amp; r &lt; n &amp;&amp; s[l] == s[r]; l -- , r ++ )&#123;<br>            cnt[s[l] - <span class="hljs-string">&#x27;a&#x27;</span>] += <span class="hljs-number">2</span>;<br>            <span class="hljs-keyword">if</span>(cnt[s[l] - <span class="hljs-string">&#x27;a&#x27;</span>] &gt; <span class="hljs-number">2</span>) <span class="hljs-keyword">break</span>;<br>            cur ++ ;<br>        &#125;<br>        res += cur;<br>    &#125;<br><br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="D-ã€Šä¸œæ–¹å¦–ç²¾æ­¦è¸ä¼šã€‹"><strong>D ã€Šä¸œæ–¹å¦–ç²¾æ­¦è¸ä¼šã€‹</strong></h2><h3 id="é¢˜æ„æè¿°-4"><strong>é¢˜æ„æè¿°</strong></h3><p>æ¸¸æˆå…æœ‰ä¸€å°æ¸¸æˆæœºï¼Œæœ€å¤šå¯ä»¥ä¸¤ä¸ªäººåŒæ—¶æ¸¸ç©ï¼Œéœ€è¦ç»´æŠ¤ä¸€ä¸ªé˜Ÿåˆ—æ¨¡æ‹Ÿæ’é˜Ÿç©æ¸¸æˆã€‚æœ‰ä»¥ä¸‹ä¸‰ç§äº‹ä»¶ï¼š</p><ul><li><p><code>start</code>ï¼š ä¸€å±€æ¸¸æˆå¼€å§‹ã€‚ä¸Šä¸€å±€çš„ç©æ¸¸æˆçš„äººéœ€è¦ <strong>å…ˆæŒ‰ç…§åŸæœ¬çš„é¡ºåºå›åˆ°é˜Ÿå°¾</strong> ä»¥è®©å‡ºæ¸¸æˆæœºï¼ˆå‰ææ˜¯å­˜åœ¨ä¸Šä¸€å±€æ¸¸æˆï¼‰ã€‚ ç„¶åï¼Œè®©å½“å‰é˜Ÿåˆ—ä¸­çš„ å‰ä¸¤ä¸ªäººæˆ–ä¸€ä¸ªäººï¼ˆ<strong>é˜Ÿåˆ—é‡Œå¯èƒ½åªæœ‰ä¸€ä¸ªäºº</strong>ï¼‰ ä¸Šåœºï¼Œæ­¤æ—¶æŒ‰ç…§é¡ºåºè¾“å‡ºè¿™ä¸¤ä¸ªäººæˆ–ä¸€ä¸ªäººï¼› è‹¥è¿™ä¸€å±€æ¸¸æˆæ— äººä¸Šåœºï¼Œåˆ™è¾“å‡º <code>Error</code> å¹¶å¿½ç•¥è¿™ä¸ªäº‹ä»¶ã€‚</p></li><li><p><code>arrive x</code>ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> åˆ°è¾¾æ¸¸æˆå…å¹¶ä¸”åŠ å…¥é˜Ÿå°¾ã€‚ æ­¤æ—¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> <strong>ä¸åº”è¯¥åœ¨æ’é˜Ÿä¹Ÿä¸åº”è¯¥åœ¨æ¸¸ç©</strong>ï¼Œè‹¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> ä¸åœ¨é˜Ÿåˆ—ä¸­ï¼Œåˆ™äº‹ä»¶æˆåŠŸæ‰§è¡Œï¼Œè¾“å‡º <code>OK</code>ï¼›å¦åˆ™è¾“å‡º <code>Error</code> å¹¶å¿½ç•¥è¿™ä¸ªäº‹ä»¶ã€‚</p></li><li><p><code>leave x</code>ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> ç¦»å¼€æ¸¸æˆå…å¹¶ç¦»å¼€é˜Ÿåˆ—ã€‚ æ­¤æ—¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> <strong>åº”è¯¥åœ¨æ’é˜Ÿä½†ä¸åº”è¯¥åœ¨æ¸¸ç©</strong>ï¼Œè‹¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> åœ¨æ’é˜Ÿï¼Œåˆ™äº‹ä»¶æˆåŠŸæ‰§è¡Œï¼Œè¾“å‡º <code>OK</code>ï¼› å¦åˆ™è¾“å‡º <code>Error</code> å¹¶å¿½ç•¥è¿™ä¸ªäº‹ä»¶ã€‚</p></li></ul><p><a href="https://www.luogu.com.cn/problem/T438100">ã€ŒYAC Round 9ã€ã€Šä¸œæ–¹å¦–ç²¾æ­¦è¸ä¼šã€‹</a></p><h3 id="è§£é¢˜æ€è·¯-text-set-æ¨¡æ‹Ÿ"><strong>è§£é¢˜æ€è·¯</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>set</mtext></mrow><annotation encoding="application/x-tex">\text{set}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord text"><span class="mord">set</span></span></span></span></span> æ¨¡æ‹Ÿ</h3><p>æˆ‘ä»¬å…ˆæ•´ç†ä¸€ä¸‹éœ€è¦ç»´æŠ¤çš„ä¸œè¥¿ï¼š</p><ul><li><p>å½“å‰å¤„åœ¨é˜Ÿåˆ—ä¸­çš„äººï¼Œå¹¶ä¸”éœ€è¦ç»´æŠ¤é¡ºåºã€‚</p></li><li><p>å½“å‰æ­£åœ¨ç©æ¸¸æˆçš„äººã€‚</p></li><li><p>æ¯ä¸ªäººæ˜¯å¦åœ¨æ’é˜Ÿ / ç©æ¸¸æˆã€‚</p></li></ul><p>æœ¬é¢˜çš„ä¸»è¦éš¾ç‚¹åœ¨äº <code>leave</code> çš„å®ç°ï¼Œé˜Ÿåˆ—ä¸­çš„ä»»æ„ä½ç½®çš„äººéƒ½å¯ä»¥ç¦»å¼€é˜Ÿåˆ—ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬ä¸å¾—ä¸é‡‡ç”¨å¯ä»¥åˆ é™¤ä»»æ„ä½ç½®å…ƒç´ çš„æ•°æ®ç»“æ„ï¼Œä½†åŒæ—¶æˆ‘ä»¬æœ‰éœ€è¦ç»´æŠ¤æ¯ä¸ªäººçš„é¡ºåºã€‚æ•…æˆ‘ä»¬è€ƒè™‘ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>set</mtext></mrow><annotation encoding="application/x-tex">\text{set}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord text"><span class="mord">set</span></span></span></span></span> å­˜å‚¨æ¯ä¸ªäººçš„å§“åå¹¶èµ‹äºˆä¸€ä¸ªç¼–å·ï¼Œæ ¹æ®ç¼–å·çš„å¤§å°å‡åºç»´æŠ¤è¿™ä¸ªé˜Ÿåˆ—ä¸­çš„æ‰€æœ‰äººã€‚</p><p>æˆ‘ä»¬å¯ä»¥å®šä¹‰æ¯ä¸ªäººçš„ç¼–å·ä¸ºï¼šå½“å‰é˜Ÿåˆ—ä¸­æœ€åä¸€ä¸ªäººçš„ç¼–å· <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>+Â 1</mtext></mrow><annotation encoding="application/x-tex">\text{+ 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord">+Â 1</span></span></span></span></span> ï¼ˆè‹¥é˜Ÿåˆ—å…ˆå‰ä¸ºç©ºï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰è¿™ä¸ªç¬¬ä¸€ä¸ªåŠ å…¥é˜Ÿåˆ—çš„äººçš„ç¼–å·ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼‰ã€‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>set</mtext></mrow><annotation encoding="application/x-tex">\text{set}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord text"><span class="mord">set</span></span></span></span></span> å­˜å‚¨ä¸€ä¸ªåŒ…å«å§“åå’Œè¿™ä¸ªç¼–å·çš„ç»“æ„ä½“ï¼Œé‡è½½ä¸€ä¸‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo></mrow><annotation encoding="application/x-tex">&lt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span></span></span></span> è¿ç®—ç¬¦å³å¯ç»´æŠ¤é˜Ÿåˆ—ä¸­äººçš„é¡ºåºã€‚</p><p>å¯¹äºæ¯ä¸ªäººæ˜¯å¦åœ¨æ’é˜Ÿ / ç©æ¸¸æˆï¼Œåªéœ€è¦å¼€ä¸¤ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>map</mtext></mrow><annotation encoding="application/x-tex">\text{map}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">map</span></span></span></span></span> è®°å½•ä¸€ä¸‹å³å¯ã€‚å¯¹äºæ˜¯å¦åœ¨æ’é˜Ÿï¼Œæˆ‘ä»¬éœ€è¦è®°å½•ä¸€ä¸‹å…¶ç¼–å·ï¼ˆä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿åˆ é™¤æ“ä½œï¼‰ï¼›å¯¹äºæ˜¯å¦åœ¨ç©æ¸¸æˆï¼Œåªéœ€è¦è®°å½•æ˜¯å¦åœ¨ç©å³å¯ã€‚</p><p>åŒæ—¶ï¼Œåœ¨æ¯å±€æ¸¸æˆå¼€å§‹æ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†å…ˆå‰ç©æ¸¸æˆçš„äººå…ˆåŠ å…¥é˜Ÿåˆ—ï¼Œå†è®©é˜Ÿåˆ—çš„å‰ä¸¤ä¸ªæˆ–ä¸€ä¸ªäººä¸Šåœºã€‚æ•…æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ•°ç»„æš‚å­˜æ¯å±€æ¸¸æˆå¼€å§‹æ—¶ä¸Šåœºçš„äººçš„åå­—ï¼ˆåŒ…æ‹¬äººæ•°ï¼‰ã€‚</p><p>æ›´å…·ä½“çš„ç»†èŠ‚è§ä»£ç æ³¨é‡Šã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123;<br>    string s;<br>    <span class="hljs-type">int</span> id;    <span class="hljs-comment">// æŒ‰ç…§æ’é˜Ÿç¼–å·ç»´æŠ¤é¡ºåº</span><br>    <span class="hljs-type">bool</span> <span class="hljs-keyword">operator</span> &lt; (<span class="hljs-type">const</span> node &amp;b) <span class="hljs-type">const</span> &#123; <span class="hljs-keyword">return</span> id &lt; b.id; &#125; <br>&#125;;<br><br>set&lt;node&gt; q;   <span class="hljs-comment">// ç»´æŠ¤é˜Ÿåˆ—</span><br>unordered_map&lt;string, <span class="hljs-type">int</span>&gt; inq;  <span class="hljs-comment">// ç»´æŠ¤åœ¨æ’é˜Ÿ åŠå…¶ æ’é˜Ÿç¼–å·</span><br>unordered_map&lt;string, <span class="hljs-type">bool</span>&gt; ing; <span class="hljs-comment">// ç»´æŠ¤æ˜¯å¦åœ¨æ¸¸ç©</span><br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">bool</span> <span class="hljs-title">try_insert</span><span class="hljs-params">(string s)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(inq[s] || ing[s]) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// å¦‚æœåœ¨æ’é˜Ÿ æˆ–è€… åœ¨æ¸¸ç©</span><br>    <span class="hljs-type">int</span> id = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-keyword">auto</span> it = q.<span class="hljs-built_in">end</span>();   <span class="hljs-comment">// æœ€åä¸€ä¸ªè¿­ä»£å™¨</span><br>        it -- ;              <br>        <span class="hljs-keyword">auto</span> [t, pre] = *it; <span class="hljs-comment">// å–é˜Ÿå°¾çš„äººçš„ç¼–å·</span><br>        id = pre + <span class="hljs-number">1</span>;        <span class="hljs-comment">// é˜Ÿå°¾ç¼–å· + 1</span><br>    &#125;<br>    inq[s] = id;             <span class="hljs-comment">// ç»´æŠ¤æ¯ä¸ªäººç¼–å·</span><br>    q.<span class="hljs-built_in">insert</span>(node&#123;s, id&#125;);   <span class="hljs-comment">// åŠ å…¥é˜Ÿåˆ—</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">bool</span> <span class="hljs-title">try_erase</span><span class="hljs-params">(string s)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(!inq[s]) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// å¦‚æœä¸åœ¨æ’é˜Ÿ æ— æ³•åˆ é™¤ï¼ˆåŒ…æ‹¬æ­£åœ¨ç©çš„äººï¼‰</span><br>    q.<span class="hljs-built_in">erase</span>(node&#123;s, inq[s]&#125;);  <span class="hljs-comment">// ç¦»é˜Ÿ</span><br>    inq[s] = <span class="hljs-number">0</span>;                <span class="hljs-comment">// ç¼–å·ç½®ä¸º0</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br>string t[<span class="hljs-number">2</span>];  <span class="hljs-comment">// å­˜å‚¨æ¯åœºç©æ¸¸æˆçš„äºº</span><br><span class="hljs-type">int</span> num;      <span class="hljs-comment">// æ¯åœºç©æ¸¸æˆçš„æ•°é‡</span><br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">try_start</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; num; i ++ )&#123;  <span class="hljs-comment">// ä¸Šä¸€åœºæ¸¸æˆçš„äººé‡æ–°åŠ å…¥åˆ°é˜Ÿå°¾</span><br>        ing[t[i]] = <span class="hljs-literal">false</span>;  <br>        <span class="hljs-built_in">try_insert</span>(t[i]);   <br>    &#125;<br>    num = <span class="hljs-built_in">min</span>(<span class="hljs-number">2</span>, (<span class="hljs-type">int</span>)q.<span class="hljs-built_in">size</span>());    <br>    <span class="hljs-keyword">if</span>(!num)&#123; <br>        cout &lt;&lt; <span class="hljs-string">&quot;Error&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;     <span class="hljs-comment">// æ²¡æœ‰äººä¸Šæ¸¸æˆ</span><br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; num; i ++ )&#123;<br>        <span class="hljs-keyword">auto</span> [cur, id] = *q.<span class="hljs-built_in">begin</span>(); <span class="hljs-comment">// è¿›å…¥æ¸¸æˆçš„ç©å®¶</span><br>        t[i] = cur;                  <span class="hljs-comment">// æš‚å­˜è¿™å±€ç©æ¸¸æˆçš„äºº</span><br>        <span class="hljs-built_in">try_erase</span>(cur);              <span class="hljs-comment">// ä»é˜Ÿåˆ—ä¸­åˆ é™¤ï¼ˆå› ä¸ºç©æ¸¸æˆçš„äººä¸èƒ½ç¦»å¼€ï¼Œä¸ºäº†åç»­æ­£ç¡®æ‰§è¡Œleaveæ“ä½œï¼‰</span><br>        ing[cur] = <span class="hljs-literal">true</span>;             <span class="hljs-comment">// åœ¨ç©æ¸¸æˆ</span><br>        cout &lt;&lt; cur &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>    &#125;<br>    cout &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-type">int</span> n;<br>string op, s;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">while</span>(n -- )&#123;<br>        cin &gt;&gt; op;<br>        <span class="hljs-keyword">if</span>(op[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;a&#x27;</span>)&#123;<br>            cin &gt;&gt; s;<br>            cout &lt;&lt; (<span class="hljs-built_in">try_insert</span>(s) ? <span class="hljs-string">&quot;OK&quot;</span> : <span class="hljs-string">&quot;Error&quot;</span>) &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(op[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;l&#x27;</span>)&#123;<br>            cin &gt;&gt; s;<br>            cout &lt;&lt; (<span class="hljs-built_in">try_erase</span>(s) ? <span class="hljs-string">&quot;OK&quot;</span> : <span class="hljs-string">&quot;Error&quot;</span>) &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-built_in">try_start</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="E-å¹½é›…åœ°ç»½æ”¾å§ï¼Œå¢¨æŸ“ä¹‹æ¨±"><strong>E å¹½é›…åœ°ç»½æ”¾å§ï¼Œå¢¨æŸ“ä¹‹æ¨±</strong></h2><h3 id="é¢˜æ„æè¿°-5"><strong>é¢˜æ„æè¿°</strong></h3><p>æ„é€ ä¸€æ£µæ ‘æ»¡è¶³å¦‚ä¸‹æ¡ä»¶ï¼š</p><ul><li><p>ä¸€å…±æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªèŠ‚ç‚¹</p></li><li><p>æ»¡è¶³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> ä¸ªé™åˆ¶æ¡ä»¶ï¼Œå…¶ä¸­ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªé™åˆ¶æ¡ä»¶å¯ä»¥ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u_i, v_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼šè¡¨ç¤ºèŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¹‹é—´çš„å”¯ä¸€æœ€çŸ­è·¯å¾„ä¸Š <strong>æ°å¥½æœ‰ä¸¤æ¡è¾¹</strong> ã€‚</p></li></ul><p><a href="https://www.luogu.com.cn/problem/T438145">ã€ŒYAC Round 9ã€å¹½é›…åœ°ç»½æ”¾å§ï¼Œå¢¨æŸ“ä¹‹æ¨±</a></p><h3 id="è§£é¢˜æ€è·¯-æ„é€ -å¹¶æŸ¥é›†"><strong>è§£é¢˜æ€è·¯</strong> æ„é€  + å¹¶æŸ¥é›†</h3><p>èŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> ä¹‹é—´çš„è·¯å¾„æ°å¥½æœ‰ä¸¤æ¡è¾¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> ä¹‹é—´æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªä¸­é—´èŠ‚ç‚¹ã€‚ æˆ‘ä»¬å¯ä»¥å…ˆå‡å®šå¯¹äºä»»æ„çš„é™åˆ¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u_i, v_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªå¾…ç¡®å®šçš„ä¸­é—´ç‚¹ä½¿å…¶æˆç«‹ã€‚</p><p>å‡è®¾æœ‰ä¸€ä¸ªé™åˆ¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1, 2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span> å’Œå¦ä¸€ä¸ªé™åˆ¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1, 3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span>ï¼Œæ­¤æ—¶èŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">1, 2, 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span></span></span></span> ä¼šä¸å¯é¿å…åœ°è¿åˆ°ä¸€ä¸ªè¿é€šå—ä¸­ï¼Œè€Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè¿™äº›è¿é€šå—å†…çš„ç‚¹éƒ½å¯ä»¥å…±äº«ä¸€ä¸ªä¸­é—´èŠ‚ç‚¹ï¼ˆåç»­ç§°ä¹‹ä¸ºä¸­å¿ƒï¼‰ï¼Œä½¿å¾—è¿é€šå—ä¸­æ‰€æœ‰çš„é™åˆ¶æ¡ä»¶éƒ½æˆç«‹ï¼ˆå‘ˆç°å‡ºä¸€ä¸ªèŠèŠ±å›¾çš„æ¨¡æ ·ï¼‰ã€‚</p><p>æ•…æˆ‘ä»¬å¯ä»¥ç”¨å¹¶æŸ¥é›†å…ˆæ±‚å‡ºæ‰€æœ‰çš„è¿é€šå—ï¼Œæ¯ä¸ªè¿é€šå—éƒ½æœ‰ä¸€ä¸ªå¾…ç¡®å®šçš„ä¸­å¿ƒï¼ˆå‘ˆç°å‡ºè‹¥å¹²ä¸ªèŠèŠ±å›¾ï¼‰ã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚ä½•ä½¿å¾—è¿™å¤šä¸ªèŠèŠ±å›¾è¿æˆä¸€é¢—æ ‘ï¼ŒåŒæ—¶è¿˜èƒ½å¤Ÿä½¿å¾—æ‰€æœ‰é™åˆ¶æ¡ä»¶ä¾æ—§æˆç«‹å‘¢ï¼Ÿ</p><ul><li><p>å¦‚æœæœ‰ä¸¤ä¸ªåŠä»¥ä¸Šçš„è¿é€šå—ï¼ˆèŠèŠ±å›¾ï¼‰ï¼Œé‚£ä¹ˆä¸€å®šæœ‰è§£ã€‚æˆ‘ä»¬å¯ä»¥å…ˆä»»é€‰ä¸¤ä¸ªè¿é€šå—ï¼Œå¹¶ä¸”åœ¨è¿™ä¸¤ä¸ªè¿é€šå—ä¸­å„è‡ªä»»é€‰ä¸€ä¸ªç‚¹ä½œä¸º <strong>å¯¹æ–¹è¿é€šå—çš„ä¸­å¿ƒ</strong>ï¼Œç„¶ååœ¨ä¸¤ä¸ªé€‰æ‹©çš„ç‚¹ä¹‹é—´å†è¿ä¸€æ¡è¾¹ã€‚å‡è®¾é€‰æ‹©çš„ä¸¤ä¸ªè¿é€šå—ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">p_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œåœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">p_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸­ä»»é€‰çš„ä¸€ä¸ªèŠ‚ç‚¹ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼Œåœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸­ä»»é€‰çš„ä¸€ä¸ªèŠ‚ç‚¹ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ï¼Œä½œä¸ºå¯¹æ–¹çš„ä¸­å¿ƒã€‚æ„é€ å‡ºæ¥çš„æ ·å­å¦‚å›¾æ‰€ç¤ºï¼š</p>  <div align='center'>      <img src="https://s2.loli.net/2024/12/14/RNzSD4o9OGWn1I8.png" width=100% />  </div><p>ç„¶åï¼Œè€ƒè™‘å¤„ç†å‰©ä¸‹çš„è¿é€šå—ï¼ˆèŠèŠ±å›¾ï¼‰ã€‚è€Œæ­¤æ—¶æˆ‘ä»¬å‘ç°ï¼Œåªè¦ä»»æ„é€‰æ‹©ä¸€ä¸ªå…ˆå‰ä»»é€‰çš„ä¸¤ä¸ªè¿é€šå—ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºä¸Šä¸‹æ‰€æœ‰è¿é€šå—çš„ä¸­å¿ƒå³å¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé€‰æ‹©è¿é€šå— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">p_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸­çš„ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç„¶åä½œä¸ºå…¶ä½™æ‰€æœ‰è¿é€šå—å…±äº«çš„ä¸­å¿ƒã€‚è¿™æ ·å°±å¯ä»¥æ»¡è¶³æ‰€æœ‰çš„é™åˆ¶æ¡ä»¶äº†ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€‰æ‹©å…ˆå‰åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">p_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸­é€‰æ‹©çš„èŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> ã€‚</p><p>åŸºäºä¹‹å‰é‚£å¼ å›¾ï¼Œæˆ‘ä»¬æœ€ç»ˆæ„é€ å‡ºæ¥çš„æ ·å­å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>  <div align='center'>      <img src="https://s2.loli.net/2024/12/14/RSidCXtG1lPx6cV.png" width=100% />  </div></li><li><p>å¦‚æœåªæœ‰ä¸€ä¸ªè¿é€šå—ï¼Œå½“åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œæ­¤æ—¶æ²¡æœ‰ä»»ä½•é™åˆ¶æ¡ä»¶ï¼Œä¹Ÿæ˜¯æœ‰è§£çš„ï¼Œåªä¸è¿‡è¿™ä¸ªæ ‘æ²¡æœ‰è¾¹è€Œå·²ï¼›å¦åˆ™ï¼Œä¸€å®šæ— è§£ã€‚å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œæ€»å…±åªæœ‰ä¸€ä¸ªè¿é€šå—ï¼ˆèŠèŠ±å›¾ï¼‰ï¼Œæˆ‘ä»¬è‡³å°‘éœ€è¦ä¸€ä¸ªèŠ‚ç‚¹æ¥ä½œä¸ºè¿™ä¸ªè¿é€šå—çš„ä¸­å¿ƒèŠ‚ç‚¹ï¼Œç„¶è€Œæ­¤æ—¶æ‰€æœ‰ç‚¹éƒ½åœ¨è¿™ä¸ªè¿é€šå—ä¸Šï¼Œæ²¡æœ‰å‰©ä½™ç‚¹å¯ä»¥ç”¨äº†ï¼Œæ•…æ— è§£ã€‚</p></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">3e5</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> fa[N]; <span class="hljs-comment">// å¹¶æŸ¥é›†</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123; <span class="hljs-keyword">return</span> fa[x] == x ? x : fa[x] = <span class="hljs-built_in">find</span>(fa[x]); &#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>&#123; fa[<span class="hljs-built_in">find</span>(x)] = <span class="hljs-built_in">find</span>(y); &#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        <span class="hljs-type">int</span> n, m; cin &gt;&gt; n &gt;&gt; m;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) fa[i] = i;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, u, v; i &lt;= m; i ++ ) cin &gt;&gt; u &gt;&gt; v, <span class="hljs-built_in">merge</span>(u, v);<br>        <br>        <span class="hljs-type">int</span> cnt = <span class="hljs-number">0</span>;      <span class="hljs-comment">// è¿é€šå—ï¼ˆèŠèŠ±å›¾ï¼‰ä¸ªæ•°</span><br>        vector&lt;<span class="hljs-type">int</span>&gt; v;    <span class="hljs-comment">// ä»»é€‰çš„ä¸¤ä¸ªè¿é€šå—çš„èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>            <span class="hljs-keyword">if</span>(fa[i] == i)&#123;<br>                cnt ++ ;<br>                <span class="hljs-keyword">if</span>(v.<span class="hljs-built_in">size</span>() &lt; <span class="hljs-number">2</span>) v.<span class="hljs-built_in">push_back</span>(i);<br>            &#125;<br><br>        <span class="hljs-keyword">if</span>(cnt == <span class="hljs-number">1</span>)&#123;     <span class="hljs-comment">// å¦‚æœåªæœ‰ä¸€ä¸ªèŠèŠ±å›¾ æ²¡æœ‰å…¶ä»–ç‚¹å¯ä»¥ä½œä¸ºä¸­å¿ƒ </span><br>            cout &lt;&lt; (n == <span class="hljs-number">1</span> ? <span class="hljs-string">&quot;Yes&quot;</span> : <span class="hljs-string">&quot;No&quot;</span>) &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <span class="hljs-comment">// ç‰¹åˆ¤åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹</span><br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br><br>        cout &lt;&lt; <span class="hljs-string">&quot;Yes&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        cout &lt;&lt; v[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; v[<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <span class="hljs-comment">// ä»»é€‰çš„ä¸¤ä¸ªç‚¹è¿ä¸€æ¡è¾¹</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>            <span class="hljs-keyword">if</span>(i == v[<span class="hljs-number">0</span>] || i == v[<span class="hljs-number">1</span>]) <span class="hljs-keyword">continue</span>;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">find</span>(i) == v[<span class="hljs-number">0</span>]) cout &lt;&lt; v[<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>            <span class="hljs-keyword">else</span> cout &lt;&lt; v[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="F-å’å”±å…‰èŠ’"><strong>F å’å”±å…‰èŠ’</strong></h2><h3 id="é¢˜æ„æè¿°-6"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> æ¡è¾¹çš„æ— å‘å›¾ã€‚æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ä¸¤ä¸ªç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x, y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ï¼Œé—®ä¸¤ç‚¹ä¹‹é—´æ‰€æœ‰çš„ç®€å•è·¯å¾„ä¸Šæœ€å°è¾¹æƒçš„æœ€å¤§å€¼ã€‚<a href="https://www.luogu.com.cn/problem/T438129">ã€ŒYAC Round 9ã€å’å”±å…‰èŠ’</a></p><h3 id="è§£æ³•ä¸€-text-kruskal-å¯å‘å¼åˆå¹¶"><strong>è§£æ³•ä¸€</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>kruskal</mtext></mrow><annotation encoding="application/x-tex">\text{kruskal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">kruskal</span></span></span></span></span> + å¯å‘å¼åˆå¹¶</h3><p>ä¸éš¾æƒ³åˆ°çš„æ–¹æ³•æ˜¯ï¼Œå°†è¾¹æƒä»å¤§åˆ°å°æ’åºï¼Œå¯¹äºæ¯ä¸ªè¯¢é—® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>ï¼Œå°†è¾¹ä¾æ¬¡æ’å…¥å›¾ä¸­ï¼Œç›´åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> è¿é€šæ—¶çš„é‚£æ¡è¾¹å°±æ˜¯ä¸¤ç‚¹ä¹‹é—´æ‰€æœ‰ç®€å•è·¯å¾„çš„æœ€å°è¾¹æƒçš„æœ€å¤§å€¼ã€‚è¿™æ˜¯å…¸å‹çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>kruskal</mtext></mrow><annotation encoding="application/x-tex">\text{kruskal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">kruskal</span></span></span></span></span> æ±‚æœ€å°/æœ€å¤§ç”Ÿæˆæ ‘æ–¹æ³•ã€‚ä½†æ˜¯æœ‰å¾ˆå¤šç»„è¯¢é—®ï¼Œæ¯ç»„è¯¢é—®éƒ½è¿›è¡Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>kruskal</mtext></mrow><annotation encoding="application/x-tex">\text{kruskal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">kruskal</span></span></span></span></span> å»ºæ ‘ï¼Œæ˜¾ç„¶æ˜¯ä¸å¯å–çš„ã€‚</p><p>å¯ä»¥å‘ç°æœ¬é¢˜å…è®¸ç¦»çº¿å¤„ç†è¯¢é—®ï¼Œæ•…æˆ‘ä»¬å¯ä»¥è€ƒè™‘ <strong>å¯å‘å¼åˆå¹¶</strong> æ¥è¿›è¡Œä¼˜åŒ–ã€‚</p><p>åˆ©ç”¨å¯å‘å¼åˆå¹¶çš„æ€æƒ³ï¼Œæˆ‘ä»¬å°†æ¯ä¸ªè¯¢é—®æŒ‚åœ¨å®ƒçš„ä¸¤ä¸ªç«¯ç‚¹ä¸Šï¼Œç„¶ååœ¨åˆå¹¶ä¸¤ä¸ªè¿é€šå—æ—¶ï¼Œ<strong>å¤„ç†è¾ƒå°çš„è¿é€šå—ä¸­çš„è¯¢é—®</strong>ï¼Œå¹¶å°†è¾ƒå°è¿é€šå—è¿æ¥åˆ°è¾ƒå¤§è¿é€šå—ä¸Šï¼ˆ<a href="https://oi-wiki.org/graph/dsu-on-tree/">OI Wiki å¯å‘å¼åˆå¹¶</a>ï¼‰ã€‚</p><p>æˆ‘ä»¬å‡è®¾è¾ƒå¤§çš„è¿é€šå—ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">fx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">x</span></span></span></span>ï¼Œè¾ƒå°çš„è¿é€šå—ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">fy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ï¼š</p><ul><li><p>è‹¥å½“å‰å…³äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">fy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> è¯¢é—®çš„ <strong>å¦ä¸€ä¸ªç«¯ç‚¹å·²ç»å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">fx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">x</span></span></span></span> è¿é€š</strong>ï¼Œé‚£ä¹ˆå½“å‰æšä¸¾åˆ°çš„è¾¹çš„é•¿åº¦å°±æ˜¯è¿™ä¸ªè¯¢é—®çš„ç­”æ¡ˆã€‚</p></li><li><p>å¦åˆ™ï¼Œè¿™æ¡è¾¹è¿˜ä¸èƒ½ä½¿å¾—è¿™ä¸ªè¯¢é—®æˆç«‹ã€‚æ•…æ­¤æ—¶æˆ‘ä»¬è¦æŠŠè¿™ä¸ªè¯¢é—® <strong>è½¬ç§»åˆ°<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">fx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">x</span></span></span></span> ä¸­</strong>ï¼Œä¹‹ååœ¨è¿›è¡Œå†å¤„ç†ã€‚</p></li></ul><p>ç”±äºå¯å‘å¼åˆå¹¶ç®—æ³•æ¯æ¬¡åˆå¹¶åˆ°è¾ƒå¤§è¿é€šå—çš„ç‰¹ç‚¹ï¼Œè¯¢é—®æ˜¯ä¸ä¼šé‡å¤å¤„ç†çš„ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>, M = <span class="hljs-number">3e5</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123; <span class="hljs-type">int</span> u, v, w; &#125;e[M];<br>vector&lt;pii&gt; query[N];<br><span class="hljs-type">int</span> fa[N], sz[N], ans[N], n, m, q;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123; <span class="hljs-keyword">return</span> fa[x] == x ? x : fa[x] = <span class="hljs-built_in">find</span>(fa[x]); &#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, u, v, w; i &lt;= m; i ++ )&#123;<br>        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;<br>        e[i] = node&#123;u, v, w&#125;;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, u, v; i &lt;= q; i ++ )&#123;<br>        cin &gt;&gt; u &gt;&gt; v;<br>        query[u].<span class="hljs-built_in">emplace_back</span>(v, i);<br>        query[v].<span class="hljs-built_in">emplace_back</span>(u, i);<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) fa[i] = i, sz[i] = <span class="hljs-number">1</span>;<br>    <span class="hljs-built_in">sort</span>(e + <span class="hljs-number">1</span>, e + m + <span class="hljs-number">1</span>, [](node &amp;a, node &amp;b)&#123; <span class="hljs-keyword">return</span> a.w &gt; b.w; &#125;);<br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i ++ )&#123; <span class="hljs-comment">// kruskalæœ€å¤§ç”Ÿæˆæ ‘</span><br>        <span class="hljs-keyword">auto</span> [x, y, w] = e[i];<br>        <span class="hljs-type">int</span> fx = <span class="hljs-built_in">find</span>(x), fy = <span class="hljs-built_in">find</span>(y);<br>        <span class="hljs-keyword">if</span>(fx == fy) <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-keyword">if</span>(sz[fx] &lt; sz[fy]) <span class="hljs-built_in">swap</span>(fx, fy);       <span class="hljs-comment">// åˆå¹¶åˆ°è¾ƒå¤§çš„è¿é€šå—</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;[u, id] : query[fy])&#123;         <span class="hljs-comment">// å¤„ç†è¾ƒå°è¿é€šå—ä¸Šçš„è¯¢é—®</span><br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">find</span>(u) == fx) ans[id] = w;      <span class="hljs-comment">// è¿é€š ç­”æ¡ˆä¸ºå½“å‰çš„è¾¹é•¿åº¦</span><br>            <span class="hljs-keyword">else</span> query[fx].<span class="hljs-built_in">emplace_back</span>(u, id); <span class="hljs-comment">// å¦åˆ™è½¬ç§»åˆ°å¤§è¿é€šå—</span><br>        &#125; <br>        fa[fy] = fx, sz[fx] += sz[fy];<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= q; i ++ ) cout &lt;&lt; (ans[i] ? ans[i] : <span class="hljs-number">-1</span>) &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br/><h3 id="è§£æ³•äºŒ-text-kruskal-å€å¢-text-LCA"><strong>è§£æ³•äºŒ</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>kruskal</mtext></mrow><annotation encoding="application/x-tex">\text{kruskal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">kruskal</span></span></span></span></span> + å€å¢ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>LCA</mtext></mrow><annotation encoding="application/x-tex">\text{LCA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">LCA</span></span></span></span></span></h3><p>æˆ‘ä»¬è¦æ±‚çš„æ˜¯ä¸¤ç‚¹ä¹‹é—´æ‰€æœ‰ç®€å•è·¯å¾„ä¸­æœ€å°è¾¹æƒçš„æœ€å¤§å€¼ï¼Œæ•…æˆ‘ä»¬å¯ä»¥å…ˆç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>kruskal</mtext></mrow><annotation encoding="application/x-tex">\text{kruskal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">kruskal</span></span></span></span></span> æ„å»ºå‡ºæœ€å¤§ç”Ÿæˆæ ‘ï¼Œæ‰€æœ‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> è¯¢é—®çš„ç­”æ¡ˆä¸€å®šæ˜¯è¿™é¢—æœ€å¤§ç”Ÿæˆæ ‘ä¸Šä¸¤ç‚¹ä¹‹é—´å”¯ä¸€æœ€çŸ­è·¯å¾„ä¸Šçš„æœ€å°è¾¹æƒã€‚</p><p>æ ‘ä¸Šä¸¤ç‚¹ä¹‹é—´æœ€çŸ­çš„è·¯å¾„ï¼Œä¸éš¾æƒ³åˆ°ä¸¤ç‚¹çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>LCA</mtext></mrow><annotation encoding="application/x-tex">\text{LCA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">LCA</span></span></span></span></span>ï¼ˆæœ€è¿‘å…¬å…±ç¥–å…ˆï¼‰ï¼Œè€ƒè™‘ç”¨ <strong>å€å¢</strong> æ±‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>LCA</mtext></mrow><annotation encoding="application/x-tex">\text{LCA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">LCA</span></span></span></span></span> çš„åŒæ—¶ç»´æŠ¤ä¸¤ç‚¹åˆ°ç¥–å…ˆçš„æœ€å°è¾¹ã€‚æ¯å½“è¯¢é—®ä¸€å¯¹ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> æ—¶ï¼Œè¯¢é—®çš„ç­”æ¡ˆå°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>c</mi><mi>a</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">lca(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> çš„æœ€å°è¾¹ã€‚</p><p><a href="https://www.luogu.com.cn/problem/P3379">P3379 ã€æ¨¡æ¿ã€‘æœ€è¿‘å…¬å…±ç¥–å…ˆï¼ˆLCAï¼‰</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>, M = <span class="hljs-number">3e5</span> + <span class="hljs-number">10</span>, inf = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-type">int</span> n, m, q, fa[N];<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123; <span class="hljs-type">int</span> u, v, w; &#125;edge[M];<br>vector&lt;pii&gt; e[N];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123; <span class="hljs-keyword">return</span> fa[x] == x ? x : fa[x] = <span class="hljs-built_in">find</span>(fa[x]); &#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">kruskal</span><span class="hljs-params">()</span></span>&#123; <span class="hljs-comment">// æœ€å¤§ç”Ÿæˆæ ‘</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) fa[i] = i;<br>    <span class="hljs-built_in">sort</span>(edge + <span class="hljs-number">1</span>, edge + m + <span class="hljs-number">1</span>, [](node &amp;a, node &amp;b)&#123; <span class="hljs-keyword">return</span> a.w &gt; b.w; &#125;);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i ++ )&#123;<br>        <span class="hljs-keyword">auto</span> [u, v, w] = edge[i];<br>        <span class="hljs-type">int</span> fx = <span class="hljs-built_in">find</span>(u), fy = <span class="hljs-built_in">find</span>(v);<br>        <span class="hljs-keyword">if</span>(fx == fy) <span class="hljs-keyword">continue</span>;<br>        fa[fy] = fx;<br>        e[u].<span class="hljs-built_in">emplace_back</span>(v, w);<br>        e[v].<span class="hljs-built_in">emplace_back</span>(u, w);<br>    &#125;<br>&#125;   <br><br><span class="hljs-type">int</span> f[N][<span class="hljs-number">22</span>], mn[N][<span class="hljs-number">22</span>], d[N]; <span class="hljs-comment">// å€å¢æ±‚lcaå¹¶ç»´æŠ¤æœ€å°è¾¹</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">bfs</span><span class="hljs-params">(<span class="hljs-type">int</span> src)</span></span>&#123;<br>    queue&lt;<span class="hljs-type">int</span>&gt; q;<br>    q.<span class="hljs-built_in">push</span>(src);<br>    d[src] = <span class="hljs-number">1</span>, f[src][<span class="hljs-number">0</span>] = src, mn[src][<span class="hljs-number">0</span>] = inf;<br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-type">int</span> u = q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;[v, w] : e[u])&#123;<br>            <span class="hljs-keyword">if</span>(!d[v])&#123;<br>                q.<span class="hljs-built_in">push</span>(v);<br>                d[v] = d[u] + <span class="hljs-number">1</span>, f[v][<span class="hljs-number">0</span>] = u, mn[v][<span class="hljs-number">0</span>] = w;<br><br>                <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>; k &lt;= <span class="hljs-number">20</span>; k ++ )&#123;<br>                    f[v][k] = f[f[v][k - <span class="hljs-number">1</span>]][k - <span class="hljs-number">1</span>];<br>                    mn[v][k] = <span class="hljs-built_in">min</span>(mn[v][k - <span class="hljs-number">1</span>], mn[f[v][k - <span class="hljs-number">1</span>]][k - <span class="hljs-number">1</span>]);<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">lca</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">find</span>(a) != <span class="hljs-built_in">find</span>(b)) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>; <span class="hljs-comment">// ä¸è¿é€š</span><br>    <span class="hljs-type">int</span> res = inf;<br>    <span class="hljs-keyword">if</span>(d[a] &lt; d[b]) <span class="hljs-built_in">swap</span>(a, b);<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">20</span>; k &gt;= <span class="hljs-number">0</span>; k -- )<br>        <span class="hljs-keyword">if</span>(d[f[a][k]] &gt;= d[b])&#123;<br>            res = <span class="hljs-built_in">min</span>(res, mn[a][k]);<br>            a = f[a][k];<br>        &#125;<br><br>    <span class="hljs-keyword">if</span>(a == b) <span class="hljs-keyword">return</span> res;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">20</span>; k &gt;= <span class="hljs-number">0</span>; k -- )<br>        <span class="hljs-keyword">if</span>(f[a][k] != f[b][k])&#123;<br>            res = <span class="hljs-built_in">min</span>(&#123;res, mn[a][k], mn[b][k]&#125;);<br>            a = f[a][k], b = f[b][k];<br>        &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">min</span>(&#123;res, mn[a][<span class="hljs-number">0</span>], mn[b][<span class="hljs-number">0</span>]&#125;);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, u, v, w; i &lt;= m; i ++ )&#123;<br>        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;<br>        edge[i] = node&#123;u, v, w&#125;;<br>    &#125;<br><br>    <span class="hljs-built_in">kruskal</span>();<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-keyword">if</span>(!d[i]) <span class="hljs-built_in">bfs</span>(i);<br><br>    <span class="hljs-keyword">while</span>(q -- )&#123;<br>        <span class="hljs-type">int</span> u, v; cin &gt;&gt; u &gt;&gt; v;<br>        cout &lt;&lt; <span class="hljs-built_in">lca</span>(u, v) &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å’å”±å…‰èŠ’</category>
      
      <category>YAC æ‰¬å·å¤§å­¦ç®—æ³•ç»ƒä¹ èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>ç®—æ³•ç«èµ›</tag>
      
      <tag>Luogu</tag>
      
      <tag>YAC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 YAC Round 8 é¢˜è§£</title>
    <link href="/2024/12/14/YAC_Round_8/"/>
    <url>/2024/12/14/YAC_Round_8/</url>
    
    <content type="html"><![CDATA[<h2 id="A-ã€Œçˆ±ã€ä¸è‡ªåŠ¨æ‰‹è®°äººå¶"><strong>A ã€Œçˆ±ã€ä¸è‡ªåŠ¨æ‰‹è®°äººå¶</strong></h2><h3 id="é¢˜æ„æè¿°"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„è¿ç»­å­—ç¬¦ä¸²ï¼Œç»Ÿè®¡æ¯ç§å­—ç¬¦çš„ä¸ªæ•°ï¼Œå¹¶æŒ‰ç…§å­—ç¬¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ascii</mtext></mrow><annotation encoding="application/x-tex">\text{ascii}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord text"><span class="mord">ascii</span></span></span></span></span> ç çš„é¡ºåºä»å°åˆ°å¤§è¾“å‡ºç»“æœã€‚ï¼ˆçœ‹æ¸…æ¥šè¾“å‡ºæ ¼å¼ï¼‰<a href="https://www.luogu.com.cn/problem/T435833">ã€ŒYAC Round 8ã€ã€Œçˆ±ã€ä¸è‡ªåŠ¨æ‰‹è®°äººå¶</a></p><h3 id="è§£é¢˜æ€è·¯-text-map-è®¡æ•°"><strong>è§£é¢˜æ€è·¯  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>map</mtext></mrow><annotation encoding="application/x-tex">\text{map}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">map</span></span></span></span></span> è®¡æ•°</strong></h3><p>ä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>map</mtext></mrow><annotation encoding="application/x-tex">\text{map}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">map</span></span></span></span></span> è®¡æ•°å¹¶è¾“å‡ºå³å¯ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>C++</mtext></mrow><annotation encoding="application/x-tex">\text{C++}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord">C++</span></span></span></span></span> ä¸­çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>map</mtext></mrow><annotation encoding="application/x-tex">\text{map}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">map</span></span></span></span></span> é»˜è®¤ä»¥é”®å€¼å¯¹ä¸­çš„é”®ä¸ºç¬¬ä¸€å…³é”®å­—ä»å°åˆ°å¤§æ’åºï¼‰ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br>map&lt;<span class="hljs-type">char</span>, <span class="hljs-type">int</span>&gt; mp;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    string s; cin &gt;&gt; s;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;ch : s) mp[ch] ++ ;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;[ch, x] : mp) cout &lt;&lt; ch &lt;&lt; <span class="hljs-string">&quot;: &quot;</span> &lt;&lt; x &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="B-å°äº”å’Œæ‹æ‹æ˜¯å§å¦¹"><strong>B å°äº”å’Œæ‹æ‹æ˜¯å§å¦¹</strong></h2><h3 id="é¢˜æ„æè¿°-2"><strong>é¢˜æ„æè¿°</strong></h3><p>è¾“å…¥ä¸¤ä¸ªæ­£æ•´æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ï¼Œåˆ¤æ–­ä¸¤ä¸ªæ•°æ˜¯å¦éƒ½æ˜¯è´¨æ•°å¹¶ä¸”ä¸¤æ•°ä¹‹å·®æ˜¯å¦æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>555</mn></mrow><annotation encoding="application/x-tex">555</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">555</span></span></span></span> çš„å€æ•°ã€‚<a href="https://www.luogu.com.cn/problem/T435836">ã€ŒYAC Round 8ã€å°äº”å’Œæ‹æ‹æ˜¯å§å¦¹</a></p><h3 id="è§£æ³•ä¸€-è¯•é™¤æ³•åˆ¤æ–­è´¨æ•°"><strong>è§£æ³•ä¸€ è¯•é™¤æ³•åˆ¤æ–­è´¨æ•°</strong></h3><p>ç”¨è¯•é™¤æ³•åˆ¤æ–­è´¨æ•°ï¼ŒåŒæ—¶åˆ¤æ–­ä¸¤æ•°ä¹‹å·®æ˜¯å¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>555</mn></mrow><annotation encoding="application/x-tex">555</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">555</span></span></span></span> çš„å€æ•°å³å¯ã€‚ï¼ˆæ³¨æ„åˆ¤æ–­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼‰ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">check</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(x == <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= (<span class="hljs-type">int</span>)<span class="hljs-built_in">sqrt</span>(x); i ++ )<br>        <span class="hljs-keyword">if</span>(x % i == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        <span class="hljs-type">int</span> x, y; cin &gt;&gt; x &gt;&gt; y;<br>        <span class="hljs-keyword">if</span>((x - y) % <span class="hljs-number">555</span> == <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-built_in">check</span>(x) &amp;&amp; <span class="hljs-built_in">check</span>(y)) cout &lt;&lt; <span class="hljs-string">&quot;YES&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        <span class="hljs-keyword">else</span> cout &lt;&lt; <span class="hljs-string">&quot;NO&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è§£æ³•äºŒ-çº¿æ€§ç­›è´¨æ•°"><strong>è§£æ³•äºŒ çº¿æ€§ç­›è´¨æ•°</strong></h3><p>æ•°æ®èŒƒå›´ä¸å¤§ï¼Œå¯ä»¥é¢„å¤„ç†ç”¨çº¿æ€§ç­›ç­›å‡ºæ‰€æœ‰è´¨æ•°ï¼Œå¦‚æœä¸¤ä¸ªæ•°ä¸­å­˜åœ¨ä¸€ä¸ªæˆ–ä¸€ä¸ªä»¥ä¸Šçš„æ•°ä¸ºåˆæ•°ï¼ˆå³ä¸æ˜¯è´¨æ•°ï¼‰ï¼Œæˆ–è€…å·®ä¸æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>555</mn></mrow><annotation encoding="application/x-tex">555</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">555</span></span></span></span> çš„å€æ•°ï¼Œé‚£ä¹ˆè¾“å‡º <code>NO</code> å³å¯ï¼›å¦åˆ™ï¼Œè¾“å‡º <code>YES</code> ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> prime[N], cnt;<br><span class="hljs-type">bool</span> st[N];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">work</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span></span>&#123;<br>    st[<span class="hljs-number">1</span>] = <span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-keyword">if</span>(!st[i]) prime[ ++ cnt] = i;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; prime[j] &lt;= n / i; j ++ )&#123;<br>            st[i * prime[j]] = <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">if</span>(i % prime[j] == <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-built_in">work</span>(N - <span class="hljs-number">1</span>);<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        <span class="hljs-type">int</span> x, y; cin &gt;&gt; x &gt;&gt; y;<br>        <span class="hljs-keyword">if</span>(st[x] || st[y] || (x - y) % <span class="hljs-number">555</span> != <span class="hljs-number">0</span>) cout &lt;&lt; <span class="hljs-string">&quot;NO&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        <span class="hljs-keyword">else</span> cout &lt;&lt; <span class="hljs-string">&quot;YES&quot;</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="C-æ²³åŸç§‘æŠ€ç‰Œè®¡ç®—å™¨"><strong>C æ²³åŸç§‘æŠ€ç‰Œè®¡ç®—å™¨</strong></h2><h3 id="é¢˜æ„æè¿°-3"><strong>é¢˜æ„æè¿°</strong></h3><p>æ¨¡æ¿é¢˜ï¼Œè®¡ç®—å¸¦æœ‰åŠ å‡ä¹˜é™¤è¿ç®—ä»¥åŠæ‹¬å·çš„è¡¨è¾¾å¼ã€‚<a href="https://www.luogu.com.cn/problem/T435839">ã€ŒYAC Round 8ã€æ²³åŸç§‘æŠ€ç‰Œè®¡ç®—å™¨</a></p><h3 id="è§£é¢˜æ€è·¯-æ ˆ"><strong>è§£é¢˜æ€è·¯ æ ˆ</strong></h3><p>ä¸»è¦çš„æ€è·¯ä¸ºåŒæ ˆæ¨¡æ‹Ÿï¼Œå…¶ä¸­ä¸€ä¸ªæ ˆå­˜å‚¨è®¡ç®—çš„æ•°å­—ï¼Œå¦ä¸€ä¸ªæ ˆå­˜å‚¨è¿ç®—ç¬¦å·ã€‚</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>AcWing</mtext></mrow><annotation encoding="application/x-tex">\text{AcWing}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">AcWing</span></span></span></span></span> åŸé¢˜ï¼Œ<a href="https://www.acwing.com/solution/content/40978/">AcWing 3302. è¡¨è¾¾å¼æ±‚å€¼ï¼šå¤šå›¾è®²è§£è¿ç®—ç¬¦ä¼˜å…ˆçº§+è¯¦ç»†ä»£ç æ³¨é‡Š</a> é«˜èµé¢˜è§£è‚¯å®šæ¯”æˆ‘å†™å¾—å¥½ã€‚ï¼ˆå…¶å®æ˜¯æˆ‘è¿™æ¬¡æƒ³å·æ‡’äº† ğŸ˜‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br>string s;<br>stack&lt;<span class="hljs-type">int</span>&gt; nums;<br>stack&lt;<span class="hljs-type">char</span>&gt; ops;<br><span class="hljs-comment">//è¿ç®—ç¬¦ä¼˜å…ˆçº§</span><br>unordered_map&lt;<span class="hljs-type">char</span>, <span class="hljs-type">int</span>&gt; mp&#123; &#123;<span class="hljs-string">&#x27;+&#x27;</span>, <span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-string">&#x27;-&#x27;</span>, <span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-string">&#x27;*&#x27;</span>, <span class="hljs-number">2</span>&#125;, &#123;<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-number">2</span>&#125; &#125;;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">caculate</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">//æ ˆé¡¶çš„ä¸¤ä¸ªæ•°å­—</span><br>    <span class="hljs-type">int</span> b = nums.<span class="hljs-built_in">top</span>();<br>    nums.<span class="hljs-built_in">pop</span>();<br>    <span class="hljs-type">int</span> a = nums.<span class="hljs-built_in">top</span>();<br>    nums.<span class="hljs-built_in">pop</span>();<br><br>    <span class="hljs-type">char</span> op = ops.<span class="hljs-built_in">top</span>();<br>    ops.<span class="hljs-built_in">pop</span>();<br><br>    <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span>(op == <span class="hljs-string">&#x27;+&#x27;</span>) res = (a + b);<br>    <span class="hljs-keyword">if</span>(op == <span class="hljs-string">&#x27;-&#x27;</span>) res = (a - b);<br>    <span class="hljs-keyword">if</span>(op == <span class="hljs-string">&#x27;*&#x27;</span>) res = (a * b);<br>    <span class="hljs-keyword">if</span>(op == <span class="hljs-string">&#x27;/&#x27;</span>) res = (a / b);<br><br>    nums.<span class="hljs-built_in">push</span>(res);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; s;<br>    <span class="hljs-type">int</span> n = s.<span class="hljs-built_in">size</span>();<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">isdigit</span>(s[i]))&#123;<br>            <span class="hljs-comment">//è®¡ç®—å½“å‰æ•°å­—</span><br>            <span class="hljs-type">int</span> cur = <span class="hljs-number">0</span>, j = i;<br>            <span class="hljs-keyword">while</span>(j &lt; n &amp;&amp; <span class="hljs-built_in">isdigit</span>(s[j]))&#123;<br>                cur = cur * <span class="hljs-number">10</span> + (s[j] - <span class="hljs-string">&#x27;0&#x27;</span>);<br>                j ++ ;<br>            &#125;<br>            nums.<span class="hljs-built_in">push</span>(cur);<br>            i = j - <span class="hljs-number">1</span>;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(s[i] == <span class="hljs-string">&#x27;(&#x27;</span>)&#123;<br>            ops.<span class="hljs-built_in">push</span>(s[i]);     <span class="hljs-comment">//å·¦æ‹¬å·ç›´æ¥å…¥æ ˆ</span><br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(s[i] == <span class="hljs-string">&#x27;)&#x27;</span>)&#123;<br>            <span class="hljs-comment">//é‡åˆ°å³æ‹¬å· ä¼˜å…ˆè®¡ç®—æ‹¬å·é‡Œçš„</span><br>            <span class="hljs-keyword">while</span>(ops.<span class="hljs-built_in">top</span>() != <span class="hljs-string">&#x27;(&#x27;</span>)<br>                <span class="hljs-built_in">caculate</span>();     <span class="hljs-comment">//é‡åˆ°å·¦æ‹¬å·åœæ­¢</span><br>            ops.<span class="hljs-built_in">pop</span>();          <span class="hljs-comment">//å¼¹å‡ºå·¦æ‹¬å·</span><br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">while</span>(!ops.<span class="hljs-built_in">empty</span>() &amp;&amp; mp[ops.<span class="hljs-built_in">top</span>()] &gt;= mp[s[i]])<br>                <span class="hljs-built_in">caculate</span>();     <span class="hljs-comment">//å…¥æ ˆè¿ç®—ç¬¦ä¼˜å…ˆçº§ä½ï¼Œå…ˆç®—æ ˆå†…çš„</span><br>            ops.<span class="hljs-built_in">push</span>(s[i]);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">while</span>(!ops.<span class="hljs-built_in">empty</span>()) <span class="hljs-built_in">caculate</span>();<br>    <span class="hljs-type">int</span> ans = nums.<span class="hljs-built_in">top</span>();<br>    cout &lt;&lt; ans &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="D-è¿ååºéå†éƒ½å¿˜è®°äº†ï¼Œå’‹åŠï¼Ÿ"><strong>D è¿ååºéå†éƒ½å¿˜è®°äº†ï¼Œå’‹åŠï¼Ÿ</strong></h2><h3 id="é¢˜æ„æè¿°-4"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€é¢—äºŒå‰æ ‘çš„ å‰åºéå†åºåˆ— å’Œ ä¸­åºéå†åºåˆ—ï¼ŒèŠ‚ç‚¹ç¼–å·ä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>âˆ¼</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1 \sim n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>ï¼Œæ„é€ å‡ºåŸäºŒå‰æ ‘ï¼Œå¹¶è¾“å‡ºé•œåƒäºŒå‰æ ‘çš„ååºéå†åºåˆ—ã€‚<a href="https://www.luogu.com.cn/problem/T435838">ã€ŒYAC Round 8ã€è¿ååºéå†éƒ½å¿˜è®°äº†ï¼Œå’‹åŠï¼Ÿ</a></p><h3 id="è§£é¢˜æ€è·¯-é€’å½’"><strong>è§£é¢˜æ€è·¯ é€’å½’</strong></h3><p>ä¸€å¹´å¤šä»¥å‰å†™è¿‡ä¸€ç¯‡åšå®¢ï¼Œä¸“é—¨è®²çš„å·²çŸ¥ä¸¤ç§éå†æ–¹å¼æ„é€ äºŒå‰æ ‘ã€‚ä¸è¿‡æ˜¯ä¸€å¹´å‰äº†ï¼Œç°åœ¨æ¥çœ‹åƒæ˜¯é»‘å†å²â€¦ğŸ¥¹ <a href="https://www.cnblogs.com/MAKISE004/p/17080153.html">[æ•°æ®ç»“æ„] æ ¹æ®å‰ä¸­ååºéå†ä¸­çš„ä¸¤ç§æ„é€ äºŒå‰æ ‘ </a></p><p>é•œåƒçš„éƒ¨åˆ†æ¯”è¾ƒç®€å•ï¼Œååºéå†é€’å½’çš„æ—¶å€™åªè¦å…ˆé€’å½’éå†å³å­æ ‘å†é€’å½’éå†å·¦å­æ ‘å³å¯ã€‚</p><p>ç›¸æ¯”è¾ƒ PTA ä¸­ <a href="https://www.cnblogs.com/MAKISE004/p/17325714.html">å›¢ä½“å¤©æ¢¯ç»ƒä¹  L2-011 ç©è½¬äºŒå‰æ ‘ </a> ç•¥ç®€å•ä¸€äº›ã€‚ï¼ˆå“ˆå“ˆï¼Œè¿™ç¯‡åšå®¢ä¹Ÿæ˜¯å¿«ä¸€å¹´å‰å†™çš„äº†ğŸ¥²</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-type">int</span> n;<br>unordered_map&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; in_idx;  <span class="hljs-comment">//ä¸­åºéå†çš„å¯¹åº”ä¸‹æ ‡</span><br>vector&lt;<span class="hljs-type">int</span>&gt; pre;  <span class="hljs-comment">//ä¸­åº å‰åº</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123;<br>    <span class="hljs-type">int</span> val;<br>    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span> *left, *right;<br>&#125;node;<br>node *T;<br>vector&lt;<span class="hljs-type">int</span>&gt; res; <br><br><span class="hljs-comment">// ä¸­åºéå†å’Œå‰åºéå†æ„é€ äºŒå‰æ ‘</span><br><span class="hljs-function">node* <span class="hljs-title">build</span><span class="hljs-params">(<span class="hljs-type">int</span> in_l, <span class="hljs-type">int</span> in_r, <span class="hljs-type">int</span> pre_l, <span class="hljs-type">int</span> pre_r)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(in_l &gt; in_r || pre_l &gt; pre_r) <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<br>    <span class="hljs-type">int</span> root_val = pre[pre_l];   <span class="hljs-comment">//å‰åºéå†ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸ºå­æ ‘æ ¹èŠ‚ç‚¹</span><br>    <span class="hljs-type">int</span> mid = in_idx[root_val];  <span class="hljs-comment">//å®šä½æ ¹èŠ‚ç‚¹åæ ‡</span><br>    <span class="hljs-type">int</span> left_num = mid - in_l;   <span class="hljs-comment">//å·¦å­æ ‘èŠ‚ç‚¹ä¸ªæ•°</span><br><br>    node *root = <span class="hljs-keyword">new</span> node;<br>    root-&gt;val = root_val;<br>    root-&gt;left = <span class="hljs-built_in">build</span>(in_l, mid - <span class="hljs-number">1</span>, pre_l + <span class="hljs-number">1</span>, pre_l + left_num);<br>    root-&gt;right = <span class="hljs-built_in">build</span>(mid + <span class="hljs-number">1</span>, in_r, pre_l + left_num + <span class="hljs-number">1</span>, pre_r);<br><br>    <span class="hljs-keyword">return</span> root;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">postorder</span><span class="hljs-params">(node *root)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">NULL</span>) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-built_in">postorder</span>(root-&gt;right);<br>    <span class="hljs-built_in">postorder</span>(root-&gt;left);<br>    res.<span class="hljs-built_in">push_back</span>(root-&gt;val);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n;<br>    pre.<span class="hljs-built_in">resize</span>(n);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) cin &gt;&gt; pre[i];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )&#123;<br>        <span class="hljs-type">int</span> x; cin &gt;&gt; x;<br>        in_idx[x] = i;        <span class="hljs-comment">//è®°å½•ä¸­åºéå†å„èŠ‚ç‚¹å€¼å¯¹åº”çš„ä¸‹æ ‡</span><br>    &#125;<br><br>    T = <span class="hljs-built_in">build</span>(<span class="hljs-number">0</span>, n - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, n - <span class="hljs-number">1</span>);  <span class="hljs-comment">//å»ºæ ‘</span><br><br>    <span class="hljs-built_in">postorder</span>(T);<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= n - <span class="hljs-number">1</span>; i ++ ) cout &lt;&lt; res[i] &lt;&lt; <span class="hljs-string">&quot; \n&quot;</span>[i==n<span class="hljs-number">-1</span>];<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="E-ä¸è¦å†æ‰“éªšæ‰°ç”µè¯äº†ï¼"><strong>E ä¸è¦å†æ‰“éªšæ‰°ç”µè¯äº†ï¼</strong></h2><h3 id="é¢˜æ„æè¿°-5"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„ç½‘æ ¼å›¾ï¼Œç›¸é‚»çš„åŒºåŸŸéƒ½æœ‰è¾¹ï¼Œä½†æ˜¯æœ‰éƒ¨åˆ†ç›¸é‚»åŒºåŸŸçš„è¾¹æ–­å¼€äº†ã€‚ä¸¤ä¸ªç‚¹å¯ä»¥é€šè¿‡è‹¥å¹²æ¡è¾¹äº’ç›¸åˆ°è¾¾ï¼Œæ±‚æœ‰å¤šå°‘å¯¹ç‚¹æ— æ³•äº’ç›¸åˆ°è¾¾ã€‚<a href="https://www.luogu.com.cn/problem/T435831">ã€ŒYAC Round 8ã€ä¸è¦å†æ‰“éªšæ‰°ç”µè¯äº†ï¼</a></p><h3 id="è§£é¢˜æ€è·¯"><strong>è§£é¢˜æ€è·¯</strong></h3><p>æˆ‘ä»¬è½¬æ¢ä¸€ä¸‹é—®é¢˜ï¼Œè¦æ±‚æœ‰å¤šå°‘å¯¹ç‚¹ä¹‹é—´æ— æ³•äº’ç›¸åˆ°è¾¾ï¼Œä¹Ÿå°±æ˜¯ä¸è¿é€šçš„ç‚¹çš„å¯¹æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ±‚å‡ºå›¾ä¸­çš„æ¯ä¸ªè¿é€šå—ï¼Œå¹¶ç»Ÿè®¡æ¯ä¸ªè¿é€šå—ä¸­çš„ç‚¹æ•°ã€‚</p><p>æœ€åä¸è¿é€šçš„ç‚¹çš„å¯¹æ•°ï¼Œæ˜¾ç„¶å°±æ˜¯ä¸¤ä¸¤è¿é€šå—ä¹‹é—´ç‚¹æ•°ä¹˜ç§¯ç´¯åŠ å’Œï¼ˆæ³¨æ„ä¸è¦é‡å¤è®¡ç®—ï¼‰ï¼›å½“ç„¶ä¹Ÿå¯ä»¥ç´¯åŠ æ¯ä¸ªè¿é€šå—ç‚¹æ•°ä¸å…¶ä»–ä¸åœ¨å½“å‰è¿é€šå—çš„ç‚¹æ•°ï¼Œæœ€åå†é™¤ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> å³å¯ã€‚</p><p>è®°å½•æ–­å¼€çš„è¾¹çš„æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œå¯ä»¥è®°å½•æ¯ä¸ªç‚¹ä¸å…¶ç›¸é‚»å››ä¸ªæ–¹å‘æ˜¯å¦æ–­å¼€ï¼Œå®ç°å¾ˆç®€å•ï¼›ä¹Ÿå¯ä»¥å°†æ¯ä¸ªç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> æ˜ å°„ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mi>n</mi><mo>+</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">(x - 1) \times n + y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ï¼Œå¯¹äºä¸€ä¸ªæ–­å¼€çš„è¾¹ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>u</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>u</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_u, y_u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>v</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>v</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_v, y_v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œå¯¹åº”çš„æ˜ å°„å€¼ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span>ï¼Œæ­¤æ—¶ç”¨<br><code>map&lt;pair&lt;int, int&gt;, bool&gt;</code> æ¥è®°å½• <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> å³å¯ã€‚</p><p>æ±‚è¿é€šå—åŠè¿é€šå—å†…ç‚¹æ•°æ–¹æ³•ä¹Ÿå¾ˆå¤šï¼Œå¯ä»¥ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>BFS</mtext></mrow><annotation encoding="application/x-tex">\text{BFS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">BFS</span></span></span></span></span>ï¼Œä¹Ÿå¯ä»¥å¹¶æŸ¥é›†ç»´æŠ¤é›†åˆå¤§å°ã€‚</p><h3 id="è§£æ³•ä¸€-BFS"><strong>è§£æ³•ä¸€ BFS</strong></h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MP make_pair</span><br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> dx[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>&#125;;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> dy[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>&#125;;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e4</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> n, m, q; <br>map&lt;pii, <span class="hljs-type">bool</span>&gt; ban; <span class="hljs-comment">// è®°å½•æ¥è§¦ä¸è‰¯çš„ç”µè¯çº¿è·¯</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">getID</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>&#123; <span class="hljs-keyword">return</span> (x - <span class="hljs-number">1</span>) * n + y; &#125;<br><br><span class="hljs-type">bool</span> vis[<span class="hljs-number">110</span>][<span class="hljs-number">110</span>]; <span class="hljs-comment">// æ ‡è®°æ˜¯å¦è®¿é—®è¿‡</span><br><span class="hljs-type">int</span> g[<span class="hljs-number">110</span>][<span class="hljs-number">110</span>];    <span class="hljs-comment">// æ˜¯å¦æœ‰å±…æ°‘</span><br><span class="hljs-type">int</span> sz[N];  <span class="hljs-comment">// æ¯ä¸ªè¿é€šå—å±…æ°‘ä¸ªæ•°</span><br><span class="hljs-type">int</span> num;    <span class="hljs-comment">// è¿é€šå—æ ‡è®°</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">bfs</span><span class="hljs-params">(<span class="hljs-type">int</span> sx, <span class="hljs-type">int</span> sy)</span></span>&#123;<br>    queue&lt;pii&gt; q;<br>    q.<span class="hljs-built_in">emplace</span>(sx, sy);<br>    vis[sx][sy] = <span class="hljs-literal">true</span>;<br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-keyword">auto</span> [x, y] = q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        sz[num] += g[x][y];<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">4</span>; k ++ )&#123;<br>            <span class="hljs-type">int</span> nx = x + dx[k], ny = y + dy[k];<br>            <span class="hljs-keyword">if</span>(nx &lt; <span class="hljs-number">1</span> || ny &lt; <span class="hljs-number">1</span> || nx &gt; n || ny &gt; n) <span class="hljs-keyword">continue</span>;<br>            <span class="hljs-keyword">if</span>(vis[nx][ny] || ban[<span class="hljs-built_in">MP</span>(<span class="hljs-built_in">getID</span>(x, y), <span class="hljs-built_in">getID</span>(nx, ny))]) <span class="hljs-keyword">continue</span>;<br>            q.<span class="hljs-built_in">emplace</span>(nx, ny);<br>            vis[nx][ny] = <span class="hljs-literal">true</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;<br>    <span class="hljs-keyword">while</span>(q -- )&#123;<br>        <span class="hljs-type">int</span> x1, y1, x2, y2; cin &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2;<br>        <span class="hljs-type">int</span> u = <span class="hljs-built_in">getID</span>(x1, y1), v = <span class="hljs-built_in">getID</span>(x2, y2);<br>        ban[<span class="hljs-built_in">MP</span>(u, v)] = ban[<span class="hljs-built_in">MP</span>(v, u)] = <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, x, y; i &lt;= m; i ++ ) cin &gt;&gt; x &gt;&gt; y, g[x][y] = <span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>            <span class="hljs-keyword">if</span>(!vis[i][j]) num ++ , <span class="hljs-built_in">bfs</span>(i, j);<br><br>    ll res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= num; i ++ ) res += sz[i] * (m - sz[i]);<br>    cout &lt;&lt; res / <span class="hljs-number">2</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;  <span class="hljs-comment">// æ¯ä¸€å¯¹ç®—äº†ä¸¤æ¬¡ï¼Œæ•…é™¤ä»¥2</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è§£æ³•äºŒ-å¹¶æŸ¥é›†"><strong>è§£æ³•äºŒ å¹¶æŸ¥é›†</strong></h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MP make_pair</span><br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> dx[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>&#125;;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> dy[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>&#125;;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e4</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> n, m, q; <br>map&lt;pii, <span class="hljs-type">bool</span>&gt; ban; <span class="hljs-comment">// è®°å½•æ¥è§¦ä¸è‰¯çš„ç”µè¯çº¿è·¯</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">getID</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>&#123; <span class="hljs-keyword">return</span> (x - <span class="hljs-number">1</span>) * n + y; &#125;<br><br><span class="hljs-type">int</span> fa[N], s[N];    <span class="hljs-comment">// å¹¶æŸ¥é›† ç»´æŠ¤é›†åˆå¤§å°</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123; <span class="hljs-keyword">return</span> fa[x] == x ? x : fa[x] = <span class="hljs-built_in">find</span>(fa[x]); &#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>&#123;<br>    <span class="hljs-type">int</span> fx = <span class="hljs-built_in">find</span>(x), fy = <span class="hljs-built_in">find</span>(y);<br>    <span class="hljs-keyword">if</span>(fx ^ fy) fa[fy] = fx, s[fx] += s[fy];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;<br>    <span class="hljs-keyword">while</span>(q -- )&#123;<br>        <span class="hljs-type">int</span> x1, y1, x2, y2; cin &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2;<br>        <span class="hljs-type">int</span> u = <span class="hljs-built_in">getID</span>(x1, y1), v = <span class="hljs-built_in">getID</span>(x2, y2);<br>        <span class="hljs-keyword">if</span>(u &gt; v) <span class="hljs-built_in">swap</span>(u, v); <span class="hljs-comment">// å»ºè¾¹æ—¶åªéœ€è¦å‘ä¸‹å’Œå‘å³è¿è¾¹å³å¯ï¼Œæ•…è®°å½•å°åˆ°å¤§çš„ban</span><br>        ban[<span class="hljs-built_in">MP</span>(u, v)] = <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n * n; i ++ ) fa[i] = i; <span class="hljs-comment">// åˆå§‹åŒ–å¹¶æŸ¥é›†</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i ++ )&#123;<br>        <span class="hljs-type">int</span> x, y; cin &gt;&gt; x &gt;&gt; y;<br>        <span class="hljs-type">int</span> u = <span class="hljs-built_in">getID</span>(x, y);<br>        s[u] = <span class="hljs-number">1</span>;             <span class="hljs-comment">// æœ‰å±…æ°‘æ‰åˆå§‹åŒ–å¤§å°ä¸º1ï¼Œå¦åˆ™åˆå§‹ä¸º0</span><br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )&#123;<br>            <span class="hljs-type">int</span> u = <span class="hljs-built_in">getID</span>(i, j);<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">2</span>; k ++ )&#123;<br>                <span class="hljs-type">int</span> ni = i + dx[k], nj = j + dy[k];<br>                <span class="hljs-keyword">if</span>(ni &lt; <span class="hljs-number">1</span> || nj &lt; <span class="hljs-number">1</span> || ni &gt; n || nj &gt; n) <span class="hljs-keyword">continue</span>;<br>                <span class="hljs-type">int</span> v = <span class="hljs-built_in">getID</span>(ni, nj);<br>                <span class="hljs-keyword">if</span>(ban[<span class="hljs-built_in">MP</span>(u, v)]) <span class="hljs-keyword">continue</span>;<br>                <span class="hljs-built_in">merge</span>(u, v);  <span class="hljs-comment">// åˆå¹¶</span><br>            &#125;<br>        &#125;<br><br>    ll res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n * n; i ++ )<br>        <span class="hljs-keyword">if</span>(fa[i] == i) res += s[i] * (m - s[i]);<br>    cout &lt;&lt; res / <span class="hljs-number">2</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <span class="hljs-comment">// æ¯ä¸€å¯¹å±…æ°‘ç®—äº†ä¸¤æ¬¡ï¼Œæ•…é™¤ä»¥2</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="F-æœ€å–œæ¬¢çš„å­—ç¬¦ä¸²-I"><strong>F æœ€å–œæ¬¢çš„å­—ç¬¦ä¸² I</strong></h2><h3 id="é¢˜æ„æè¿°-6"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„å­—ç¬¦ä¸² <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>ï¼Œå…¶ä¸­åŒ…å«å­—æ¯å’Œæ•°å­—ã€‚ä»å·¦å¾€å³ä¾æ¬¡è¯»å–æ¯ä¸ªå­—ç¬¦ï¼Œå¦‚æœå®ƒæ˜¯å­—æ¯ï¼Œé‚£ä¹ˆå°†å®ƒåŠ å…¥å­—ç¬¦ä¸² <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> ä¸­ï¼Œå¦‚æœæ˜¯æ•°å­—(ä¾‹å¦‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span> )ï¼Œé‚£ä¹ˆä½ éœ€è¦å°†å­—ç¬¦ä¸² <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> å¤åˆ¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">d - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> æ¬¡å¹¶æ·»åŠ åˆ°å­—ç¬¦ä¸² <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> çš„æœ«å°¾ã€‚<a href="https://www.luogu.com.cn/problem/T429546">ã€ŒYAC Round 8ã€æœ€å–œæ¬¢çš„å­—ç¬¦ä¸² I</a></p><h3 id="è§£é¢˜æ€è·¯-2"><strong>è§£é¢˜æ€è·¯</strong></h3><p>å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªåƒ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&quot;appleappleappleappleappleapple&quot;</mtext></mrow><annotation encoding="application/x-tex">\text{&quot;appleappleappleappleappleapple&quot;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">&quot;appleappleappleappleappleapple&quot;</span></span></span></span></span> è¿™æ ·çš„è§£ç å­—ç¬¦ä¸²å’Œä¸€ä¸ªåƒ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>K=24</mtext></mrow><annotation encoding="application/x-tex">\text{K=24}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">K=24</span></span></span></span></span> è¿™æ ·çš„ç´¢å¼•ï¼Œé‚£ä¹ˆå¦‚æœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>K=4</mtext></mrow><annotation encoding="application/x-tex">\text{K=4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">K=4</span></span></span></span></span>ï¼Œç­”æ¡ˆæ˜¯ç›¸åŒçš„ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œå½“è§£ç çš„å­—ç¬¦ä¸²ç­‰äºæŸä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>size</mtext></mrow><annotation encoding="application/x-tex">\text{size}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord text"><span class="mord">size</span></span></span></span></span> çš„å•è¯é‡å¤æŸäº›æ¬¡æ•°ï¼ˆä¾‹å¦‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>apple</mtext></mrow><annotation encoding="application/x-tex">\text{apple}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">apple</span></span></span></span></span> ä¸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>size=5</mtext></mrow><annotation encoding="application/x-tex">\text{size=5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord text"><span class="mord">size=5</span></span></span></span></span> ç»„åˆé‡å¤ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn></mrow><annotation encoding="application/x-tex">6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">6</span></span></span></span> æ¬¡ï¼‰æ—¶ï¼Œç´¢å¼• <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>K</mtext></mrow><annotation encoding="application/x-tex">\text{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">K</span></span></span></span></span> çš„ç­”æ¡ˆä¸ç´¢å¼• <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>KÂ %Â size</mtext></mrow><annotation encoding="application/x-tex">\text{K \% size}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord text"><span class="mord">KÂ %Â size</span></span></span></span></span> çš„ç­”æ¡ˆç›¸åŒã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡é€†å‘å·¥ä½œï¼Œè·Ÿè¸ªè§£ç å­—ç¬¦ä¸²çš„å¤§å°ã€‚æ¯å½“è§£ç çš„å­—ç¬¦ä¸²ç­‰äºæŸäº›å•è¯ é‡å¤ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span> æ¬¡æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>K</mtext></mrow><annotation encoding="application/x-tex">\text{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">K</span></span></span></span></span> å‡å°‘åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>KÂ %Â len(word)</mtext></mrow><annotation encoding="application/x-tex">\text{K \% len(word)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">KÂ %Â len(word)</span></span></span></span></span> ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ­£å‘å¤„ç†ï¼Œæ‰¾å‡ºè§£ç åçš„å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚ ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€†å‘å·¥ä½œï¼Œè·Ÿè¸ª  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>size</mtext></mrow><annotation encoding="application/x-tex">\text{size}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord text"><span class="mord">size</span></span></span></span></span>ï¼š è§£æç¬¦å· <code>S[0], S[1], ..., S[i]</code> åè§£ç å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</p><p>å¦‚æœæˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªæ•°å­— <code>S[i]</code>ï¼Œåˆ™è¡¨ç¤ºåœ¨è§£æ <code>S[0]ï¼ŒS[1]ï¼Œ...ï¼ŒS[i-1]</code> ä¹‹åè§£ç å­—ç¬¦ä¸²çš„å¤§å°å°†æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>sizeÂ /Â int(S[i])</mtext></mrow><annotation encoding="application/x-tex">\text{size / int(S[i])}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">sizeÂ /Â int(S[i])</span></span></span></span></span>ã€‚ å¦åˆ™ï¼Œå°†æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>sizeÂ -Â 1</mtext></mrow><annotation encoding="application/x-tex">\text{size - 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord text"><span class="mord">sizeÂ -Â 1</span></span></span></span></span>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-function"><span class="hljs-type">char</span> <span class="hljs-title">work</span><span class="hljs-params">(string s, <span class="hljs-type">int</span> K)</span> </span>&#123;<br>    ll size = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> N = s.<span class="hljs-built_in">size</span>();<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i ++ ) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">isdigit</span>(s[i])) size *= s[i] - <span class="hljs-string">&#x27;0&#x27;</span>;<br>        <span class="hljs-keyword">else</span> size ++ ;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = N - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i -- )&#123;<br>        K %= size;<br>        <span class="hljs-keyword">if</span> (K == <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-built_in">isalpha</span>(s[i])) <span class="hljs-keyword">return</span> s[i];<br><br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">isdigit</span>(s[i])) size /= s[i] - <span class="hljs-string">&#x27;0&#x27;</span>;<br>        <span class="hljs-keyword">else</span> size -- ;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27; &#x27;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    string s; cin &gt;&gt; s;<br>    <span class="hljs-type">int</span> k; cin &gt;&gt; k;<br>    cout &lt;&lt; <span class="hljs-built_in">work</span>(s, k) &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å’å”±å…‰èŠ’</category>
      
      <category>YAC æ‰¬å·å¤§å­¦ç®—æ³•ç»ƒä¹ èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>ç®—æ³•ç«èµ›</tag>
      
      <tag>Luogu</tag>
      
      <tag>YAC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 ACM-ICPC æ ¡å†…é€‰æ‹”èµ› / YAC Round 7 é¢˜è§£</title>
    <link href="/2024/12/14/YAC_Round_7/"/>
    <url>/2024/12/14/YAC_Round_7/</url>
    
    <content type="html"><![CDATA[<h2 id="A-æˆé•¿çš„é“è·¯"><strong>A æˆé•¿çš„é“è·¯</strong></h2><h3 id="é¢˜æ„æè¿°"><strong>é¢˜æ„æè¿°</strong></h3><p>ä¸€å…±æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> å¤©ï¼Œç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> å¤©åš <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>+</mo><mn>2</mn><mo>+</mo><mo>â€¦</mo><mo>+</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">1 + 2 + \ldots + i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªé¢˜ï¼Œæ±‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> å¤©ä¸€å…±åšäº†å¤šå°‘é¢˜ã€‚<a href="https://www.luogu.com.cn/problem/T434250">ã€ŒYAC Round 7ã€æˆé•¿çš„é“è·¯</a></p><h3 id="è§£é¢˜æ€è·¯"><strong>è§£é¢˜æ€è·¯</strong></h3><p>ç­¾åˆ°é¢˜ã€‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„èŒƒå›´ä¸å¤§ï¼Œå¯ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> æ¬¡ç”¨ç­‰å·®æ•°åˆ—æ±‚å’Œå…¬å¼æ±‚å¾—æ¯ä¸€å¤©çš„åšé¢˜æ•°é‡ï¼Œç´¯åŠ å¾—åˆ°è¿™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> å¤©çš„æ•°é‡ä¹‹å’Œã€‚</p><p>å½“ç„¶ï¼Œå¯ä»¥é€šè¿‡æ•°å­¦æ¨å¯¼å¾—å‡ºæ‰€æ±‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> é¡¹å’Œå°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><mn>6</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{n(n + 1)(n + 2)}{6}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ã€‚</p><p>(æ³¨æ„æ•°æ®èŒƒå›´ï¼Œéœ€è¦å¼€ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>longÂ long</mtext></mrow><annotation encoding="application/x-tex">\text{long long}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">longÂ long</span></span></span></span></span>)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    ll n; cin &gt;&gt; n;<br>    cout &lt;&lt; n * (n + <span class="hljs-number">1</span>) * (n + <span class="hljs-number">2</span>) / <span class="hljs-number">6</span> &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="B-ç«¹æ—å†°ç«äºº"><strong>B ç«¹æ—å†°ç«äºº</strong></h2><h3 id="é¢˜æ„æè¿°-2"><strong>é¢˜æ„æè¿°</strong></h3><p>ä¸€å…±æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ç§ç«¹å­ï¼Œç§ç±»ç¼–å·ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>âˆ¼</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1 \sim n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>ã€‚ä¸¤ä¸ªäººåˆ†åˆ«æ‰¾åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> ç§å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> ç§ç«¹å­ï¼Œé—®è¿™ä¸¤ä¸ªäººæ˜¯å¦å¯ä»¥å‡‘é½å…¨éƒ¨çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ç§ç«¹å­ã€‚<a href="https://www.luogu.com.cn/problem/T434254">ã€ŒYAC Round 7ã€ç«¹æ—å†°ç«äºº</a></p><h3 id="è§£é¢˜æ€è·¯-2"><strong>è§£é¢˜æ€è·¯</strong></h3><p>ç­¾åˆ°é¢˜ã€‚ç”¨å“ˆå¸Œé›†åˆæˆ–è€…å®šä¹‰ä¸€ä¸ªè®°å½•æ•°ç»„æ ‡è®°ç§ç±»æ˜¯å¦è®¿é—®è¿‡ï¼Œæœ€ååˆ¤æ–­ä¸€ä¸‹æ˜¯å¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ç§ç«¹å­éƒ½è¢«æ‰¾åˆ°å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> n, x, y, c; cin &gt;&gt; n;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">bool</span>&gt; <span class="hljs-title">vis</span><span class="hljs-params">(n + <span class="hljs-number">1</span>, <span class="hljs-literal">false</span>)</span></span>;<br><br>    cin &gt;&gt; x;<br>    <span class="hljs-keyword">while</span>(x -- ) cin &gt;&gt; c, vis[c] = <span class="hljs-literal">true</span>;<br>    cin &gt;&gt; y;<br>    <span class="hljs-keyword">while</span>(y -- ) cin &gt;&gt; c, vis[c] = <span class="hljs-literal">true</span>;<br><br>    <span class="hljs-type">bool</span> flag = <span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">if</span>(!vis[i])&#123;<br>            flag = <span class="hljs-literal">false</span>;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br><br>    cout &lt;&lt; (flag ? <span class="hljs-string">&quot;It Takes Two.&quot;</span> : <span class="hljs-string">&quot;Maybe Next Time.&quot;</span>) &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="C-æ™šå®‰ï¼Œçˆ±ä¸½ä¸"><strong>C æ™šå®‰ï¼Œçˆ±ä¸½ä¸</strong></h2><h3 id="é¢˜æ„æè¿°-3"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>01</mn></mrow><annotation encoding="application/x-tex">01</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">01</span></span></span></span> å­—ç¬¦ä¸²å’Œä¸€ä¸ªæ¬¡æ•°é™åˆ¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥é€‰æ‹©ä¸€ä¸ªä¸‹æ ‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>i</mi><mo>+</mo><mi>L</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[i, i + L - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> èŒƒå›´å†…å­—ç¬¦ä¸²ä¸­çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å…¨éƒ¨å˜æˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œæ±‚èƒ½å¤Ÿåœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> æ¬¡æ“ä½œå†…ä½¿å¾—å­—ç¬¦ä¸²ä¸­çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å…¨éƒ¨å˜æˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> çš„æœ€å°çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span>ã€‚<a href="https://www.luogu.com.cn/problem/T434251">ã€ŒYAC Round 7ã€æ™šå®‰ï¼Œçˆ±ä¸½ä¸</a></p><h3 id="è§£é¢˜æ€è·¯-äºŒåˆ†"><strong>è§£é¢˜æ€è·¯</strong> äºŒåˆ†</h3><p>å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬é€‰æ‹©çš„é•¿åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span> è¶Šé•¿ï¼Œä½¿å¾—å­—ç¬¦ä¸²å…¨éƒ¨å˜æˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> çš„æ“ä½œæ¬¡æ•°ä¹Ÿä¼šè¶Šå°‘ã€‚å‡è®¾æˆ‘ä»¬æœ€ç»ˆå¾—åˆ°çš„æœ€å°çš„é•¿åº¦æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{ans}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">an</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œé€‰æ‹©çš„é•¿åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰¥</mo><msub><mi>L</mi><mrow><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\ge L_{ans}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">an</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œæ“ä½œæ¬¡æ•°å°äºç­‰äºæ¬¡æ•°é™åˆ¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ï¼›é€‰æ‹©çš„é•¿åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><msub><mi>L</mi><mrow><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">&lt; L_{ans}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">an</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œæ“ä½œæ¬¡æ•°å¤§äºæ¬¡æ•°é™åˆ¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ã€‚æ˜¾ç„¶ï¼Œæ­¤é¢˜å…·æœ‰äºŒæ®µæ€§ï¼Œæ•…æˆ‘ä»¬å¯ä»¥äºŒåˆ†ç­”æ¡ˆã€‚</p><p>åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>check</mtext></mrow><annotation encoding="application/x-tex">\text{check}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">check</span></span></span></span></span> ä¸­ï¼Œå‡è®¾æ­¤æ—¶é€‰æ‹©çš„é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span>ã€‚åœ¨éå†å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œè‹¥å½“å‰ä¸‹æ ‡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ã€‚å¦‚æœé‡åˆ°çš„æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥ä¸ç®¡ï¼›å¦‚æœé‡åˆ°çš„æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œç”±äºè¦å°†æ‰€æœ‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> éƒ½å˜æˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œå› æ­¤å½“å‰çš„ä¸‹æ ‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> å¿…é¡»é€‰æ‹©ï¼Œå¹¶ä¸”åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>i</mi><mo>+</mo><mi>L</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[i, i + L - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> èŒƒå›´å†…çš„éƒ½å˜æˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼ˆæ— è®ºåŸå…ˆæ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> è¿˜æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼‰ã€‚å› æ­¤ï¼Œåªéœ€è¦éå†å­—ç¬¦ä¸²è¿‡ç¨‹ä¸­ï¼Œé‡åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> å°± $i ++ $ è·³è¿‡ï¼Œè€Œé‡åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å°±æ¬¡æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>+</mtext><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{+}1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord">+</span></span><span class="mord">1</span></span></span></span>ï¼ŒåŒæ—¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mtext>+=</mtext><mi>L</mi></mrow><annotation encoding="application/x-tex">i \text{+=} L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">i</span><span class="mord text"><span class="mord">+=</span></span><span class="mord mathnormal">L</span></span></span></span>ï¼Œç›´åˆ°æœ€åéå†å®Œæ•´ä¸ªå­—ç¬¦ä¸²ã€‚æœ€åå¾—åˆ°çš„æ¬¡æ•°å¦‚æœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰¤</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">\le k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ï¼Œé‚£ä¹ˆè¿”å› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>true</mtext></mrow><annotation encoding="application/x-tex">\text{true}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord text"><span class="mord">true</span></span></span></span></span>ï¼›å¦åˆ™ï¼Œè¿”å› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>false</mtext></mrow><annotation encoding="application/x-tex">\text{false}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">false</span></span></span></span></span>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-type">int</span> n, k;<br>string s;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">check</span><span class="hljs-params">(<span class="hljs-type">int</span> d)</span></span>&#123;<br>    <span class="hljs-type">int</span> cnt = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; )&#123;<br>        <span class="hljs-keyword">if</span>(s[i] == <span class="hljs-string">&#x27;0&#x27;</span>) i ++ ;<br>        <span class="hljs-keyword">else</span> i += d, cnt ++ ;<br>    &#125;<br>    <span class="hljs-keyword">return</span> cnt &lt;= k;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        cin &gt;&gt; n &gt;&gt; k &gt;&gt; s;<br>        s = <span class="hljs-string">&quot; &quot;</span> + s;<br>        <span class="hljs-type">int</span> l = <span class="hljs-number">1</span>, r = n;<br>        <span class="hljs-keyword">while</span>(l &lt; r)&#123;<br>            <span class="hljs-type">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">check</span>(mid)) r = mid;<br>            <span class="hljs-keyword">else</span> l = mid + <span class="hljs-number">1</span>;<br>        &#125;<br>        cout &lt;&lt; r &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="D-âœŒå·«å¥³è¦ä¹°èŒ¶å¶äº†"><strong>D âœŒå·«å¥³è¦ä¹°èŒ¶å¶äº†</strong></h2><h3 id="é¢˜æ„æè¿°-4"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„æ•°ç»„ï¼Œç°åœ¨éœ€è¦æ¸…ç©ºæ•°ç»„ï¼Œæœ‰ä¸¤ç§æ“ä½œï¼š</p><ul><li><p>é€‰æ‹©ä¸€ä¸ªå…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> ï¼Œç›´æ¥åˆ é™¤ï¼ŒèŠ±è´¹ä»£ä»·ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼›</p></li><li><p>è‹¥ä¹‹å‰åˆ é™¤çš„ä¸€ä¸ªå…ƒç´ ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼Œé‚£ä¹ˆå¯ä»¥é€‰æ‹©ä¸€ä¸ªå…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> è¿›è¡Œåˆ é™¤ï¼ŒèŠ±è´¹ä»£ä»·ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ã€‚ï¼ˆå‰ææ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å­˜åœ¨äºæ•°ç»„ä¸­ï¼‰</p></li></ul><p>æ±‚æ¸…ç©ºæ•°ç»„çš„æœ€å°‘æ“ä½œæ¬¡æ•°ã€‚</p><p><a href="https://www.luogu.com.cn/problem/T434255">ã€ŒYAC Round 7ã€âœŒå·«å¥³è¦ä¹°èŒ¶å¶äº†</a></p><h3 id="è§£é¢˜æ€è·¯-è´ªå¿ƒ-æ’åº"><strong>è§£é¢˜æ€è·¯</strong> è´ªå¿ƒ + æ’åº</h3><p>æ˜¾ç„¶æˆ‘ä»¬å¯ä»¥ä»»æ„é€‰æ‹©ä¸€ä¸ªè¾ƒå°çš„å…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼Œç„¶åå°†å¯ä»¥é€‰åˆ°çš„è¿ç»­çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>x</mi><mo>+</mo><mn>2</mn><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><mi>x</mi><mo>+</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">x + 1, x + 2, \ldots, x + k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> éƒ½ä¸€æ¬¡æ€§åˆ é™¤ï¼Œåˆ é™¤è¿™ä¸€è¿ç»­åºåˆ—èŠ±è´¹çš„ä»£ä»·ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„é—®é¢˜å°±è½¬åŒ–ä¸ºæ±‚å‡ºæ•°ç»„ä¸­æœ€å°‘æœ‰å¤šå°‘ä¸ªè¿ç»­åºåˆ—ï¼Œå½¢å¦‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>x</mi><mo>+</mo><mn>2</mn><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><mi>x</mi><mo>+</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">x, x + 1, x + 2, \ldots , x + k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ã€‚</p><p>æˆ‘ä»¬å¯ä»¥è®°å½•å½“å‰å…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> å‡ºç°çš„æ¬¡æ•°ï¼ˆç”±äºå…ƒç´ èŒƒå›´æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1, 10^9]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>ï¼Œæ‰€ä»¥å»ºè®®ç›´æ¥ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>a</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">map</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">p</span></span></span></span> å“ˆå¸Œæ˜ å°„ï¼‰ï¼Œå°†æ•°ç»„ä»¥å½“å‰å…ƒç´ å‡ºç°æ¬¡æ•°ä¸ºç¬¬ä¸€å…³é”®å­—ã€ä»¥å…ƒç´ å€¼ä¸ºç¬¬äºŒå…³é”®å­—æ’åºï¼ˆå¯ä»¥ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>a</mi><mi>i</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">pair</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">ai</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> å­˜ï¼‰ã€‚æ’åºåå¾—åˆ°çš„åºåˆ—å°±å˜æˆè‹¥å¹²ä¸ªè¿ç»­çš„åºåˆ—æ‹¼æ¥åœ¨ä¸€èµ·ã€‚</p><p>æœ€åï¼Œåªéœ€è¦ç»Ÿè®¡ä¸€ä¸‹æ’åºåçš„åºåˆ—ä¸­ï¼Œæœ‰å¤šå°‘ä¸ªæ–­ç‚¹å³å¯ï¼ˆä¹Ÿå°±æ˜¯ç›¸é‚»ä¸¤ä¸ªä¸æ˜¯è¿ç»­çš„ä½ç½®çš„ä¸ªæ•°ï¼‰ï¼Œç­”æ¡ˆå°±æ˜¯æ–­ç‚¹æ•°é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+ 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span> ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><span class="hljs-meta">#<span class="hljs-keyword">define</span> se second</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> fi first</span><br><br>pii a[N];<br>unordered_map&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; mp;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> n; cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        cin &gt;&gt; a[i].se;<br>        mp[a[i].se] ++ ;   <span class="hljs-comment">// ç»Ÿè®¡å…ƒç´ å‡ºç°æ¬¡æ•°</span><br>        a[i].fi = mp[a[i].se];<br>    &#125;<br>    <span class="hljs-built_in">sort</span>(a + <span class="hljs-number">1</span>, a + n + <span class="hljs-number">1</span>);  <span class="hljs-comment">// æŒ‰ç…§å‡ºç°æ¬¡æ•°ä¸ºç¬¬ä¸€å…³é”®å­—æ’åº</span><br>    <br>    <span class="hljs-type">int</span> res = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++ ) res += (a[i].se - a[i - <span class="hljs-number">1</span>].se != <span class="hljs-number">1</span>); <br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="E-é­”ç†æ²™éª‘ç€æ‰«å¸šé£"><strong>E é­”ç†æ²™éª‘ç€æ‰«å¸šé£</strong></h2><h3 id="é¢˜æ„æè¿°-5"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> çš„ç½‘æ ¼å›¾ï¼Œæ¯ä¸ªä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> ä¸Šæœ‰ä¸€ä¸ªæ–¹å‘ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">s_{i, j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> å’Œä¸€ä¸ªå…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">a_{i, j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ã€‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><msup><mo stretchy="false">{</mo><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msup><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msup><mo separator="true">,</mo><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msup><mi>d</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msup><mo separator="true">,</mo><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msup><mi>l</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msup><mo separator="true">,</mo><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msup><mi>r</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">s_{i, j} = \{&#x27;u&#x27;, &#x27;d&#x27;, &#x27;l&#x27;, &#x27;r&#x27;\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mopen"><span class="mopen">{</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mpunct"><span class="mpunct">,</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mpunct"><span class="mpunct">,</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mpunct"><span class="mpunct">,</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>ï¼Œåˆ†åˆ«è¡¨ç¤ºä¸Šä¸‹å·¦å³ã€‚å¤„äºä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> ä¸Šæ—¶å¯ä»¥å‘å½“å‰ä½ç½®æŒ‡å®šæ–¹å‘ç§»åŠ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">a_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> çš„è·ç¦»ï¼ˆå‰ææ˜¯ä½ç½®å­˜åœ¨ï¼‰ã€‚åˆ¤æ–­æ˜¯å¦å¯ä»¥æ‰¾ä¸€ä¸ªåˆå§‹ä½ç½®ï¼Œä¸€ç›´èµ°ç›´åˆ°æ‰€æœ‰ä½ç½®éƒ½èµ°è¿‡ä¸€æ¬¡ã€‚<a href="https://www.luogu.com.cn/problem/T434252">ã€ŒYAC Round 7ã€é­”ç†æ²™éª‘ç€æ‰«å¸šé£</a></p><h3 id="è§£é¢˜æ€è·¯-å¹¶æŸ¥é›†"><strong>è§£é¢˜æ€è·¯</strong> å¹¶æŸ¥é›†</h3><p>é¦–å…ˆæˆ‘ä»¬è¦æ³¨æ„åˆ°ï¼Œæ¯ä¸ªä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> åªæœ‰ä¸€ä¸ªå‡ºè¾¹ï¼Œæˆ‘ä»¬è€ƒè™‘å°†æ‰€æœ‰è¾¹éƒ½å»ºç«‹èµ·æ¥æ„æˆä¸€ä¸ªå›¾ã€‚ä»ä¸€ä¸ªåˆå§‹ç‚¹ä¸€æ¬¡æ€§èµ°å®Œæ‰€æœ‰ç‚¹åªæœ‰ä¸¤ç§æƒ…å†µï¼š</p><ul><li><p>æ•´ä¸ªå›¾æ„æˆä¸€ä¸ªç¯ï¼Œæ­¤æ—¶ä»ä»»æ„ç‚¹å‡ºå‘éƒ½ä¸€ä¸ªèµ°åˆ°æ‰€æœ‰ç‚¹ã€‚</p></li><li><p>ä»ä¸€ä¸ªç‚¹å‡ºå‘ï¼Œèµ°åˆ°ä¸€ä¸ªå°ç¯ä¸Šï¼Œä»è€Œèµ°åˆ°æ‰€æœ‰ç‚¹ã€‚</p></li></ul><p>å› æ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ»¡è¶³çš„ä¸€ç‚¹å°±æ˜¯æ‰€æœ‰ç‚¹éƒ½å¿…é¡»åœ¨ä¸€ä¸ªè¿é€šå—ä¸­ï¼Œå¦åˆ™ä¸å¯èƒ½é€‰æ‹©ä¸€ä¸ªç‚¹åˆ°è¾¾æ‰€æœ‰ç‚¹ã€‚å¯¹äºåˆ¤æ–­æ‰€æœ‰ç‚¹æ˜¯å¦éƒ½åœ¨ä¸€ä¸ªè¿é€šå—ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¹¶æŸ¥é›†è¿›è¡Œåˆ¤æ–­ã€‚</p><p>å…¶æ¬¡ï¼Œæˆ‘ä»¬åªèƒ½é€‰æ‹©ä¸€ä¸ªåˆå§‹ç‚¹ï¼Œæ ¹æ®ä¸Šé¢çš„ä¸¤ç§å¯èƒ½çš„æƒ…å†µï¼Œæ˜¾ç„¶å…¥åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> çš„ç‚¹ä¸èƒ½è¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä¸ªã€‚å¦‚æœå­˜åœ¨å¤šä¸ªå…¥åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> çš„ç‚¹ï¼Œé€‰æ‹©å…¶ä¸­ä¸€ä¸ªä½œä¸ºåˆå§‹ç‚¹ï¼Œå…¶ä»–çš„å…¥åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> çš„ç‚¹æ˜¾ç„¶éƒ½æ— æ³•åˆ°è¾¾ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e6</span> + <span class="hljs-number">2</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> dx[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">-1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>&#125;;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> dy[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">1</span>&#125;;<br><br>unordered_map&lt;<span class="hljs-type">char</span>, <span class="hljs-type">int</span>&gt; mp = &#123;&#123;<span class="hljs-string">&#x27;u&#x27;</span>, <span class="hljs-number">0</span>&#125;, &#123;<span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-string">&#x27;l&#x27;</span>, <span class="hljs-number">2</span>&#125;, &#123;<span class="hljs-string">&#x27;r&#x27;</span>, <span class="hljs-number">3</span>&#125;&#125;;<br>string g[N];              <span class="hljs-comment">// åªç»™äº† n x m å¤§å°èŒƒå›´ï¼Œæ•…éœ€è¦é‡‡ç”¨å­—ç¬¦ä¸²</span><br><span class="hljs-type">int</span> n, m, fa[N], ind[N];  <span class="hljs-comment">// å¹¶æŸ¥é›† å’Œ å…¥åº¦</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">getID</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>&#123; <span class="hljs-keyword">return</span> (x - <span class="hljs-number">1</span>) * m + y; &#125;<br><br><span class="hljs-comment">// å¹¶æŸ¥é›†</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123; <span class="hljs-keyword">return</span> fa[x] == x ? x : fa[x] = <span class="hljs-built_in">find</span>(fa[x]); &#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>&#123; fa[<span class="hljs-built_in">find</span>(x)] = <span class="hljs-built_in">find</span>(y); &#125;<br><br><span class="hljs-comment">// åˆ¤æ–­åœ¨ä¸€ä¸ªè¿é€šå—ä¸­</span><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">check1</span><span class="hljs-params">()</span></span>&#123; <br>    <span class="hljs-type">int</span> f = <span class="hljs-built_in">find</span>(<span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= n * m; i ++ )<br>        <span class="hljs-keyword">if</span>(f != <span class="hljs-built_in">find</span>(i)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-comment">// åˆ¤æ–­å…¥åº¦ä¸º0çš„ç‚¹ä¸è¶…è¿‡1</span><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">check2</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> cnt = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n * m; i ++ ) cnt += (!ind[i]);<br>    <span class="hljs-keyword">return</span> cnt &lt;= <span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        cin &gt;&gt; n &gt;&gt; m;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; g[i], g[i] = <span class="hljs-string">&quot; &quot;</span> + g[i];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n * m; i ++ ) fa[i] = i, ind[i] = <span class="hljs-number">0</span>;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )    <span class="hljs-comment">// åœ¨è¾“å…¥ a_&#123;i,j&#125; æ—¶å°±å¼€å§‹åˆå¹¶</span><br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j ++ )&#123;<br>                <span class="hljs-type">int</span> c = mp[g[i][j]], d; cin &gt;&gt; d;<br>                <span class="hljs-type">int</span> ni = i + d * dx[c], nj = j + d * dy[c];<br>                <span class="hljs-keyword">if</span>(ni &lt; <span class="hljs-number">1</span> || ni &gt; n || nj &lt; <span class="hljs-number">1</span> || nj &gt; m) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// å‡ºç•Œ</span><br>                <span class="hljs-built_in">merge</span>(<span class="hljs-built_in">getID</span>(i, j), <span class="hljs-built_in">getID</span>(ni, nj));<br>                ind[<span class="hljs-built_in">getID</span>(ni, nj)] ++ ;<br>            &#125;<br><br>        cout &lt;&lt; ((<span class="hljs-built_in">check1</span>() &amp; <span class="hljs-built_in">check2</span>()) ? <span class="hljs-string">&quot;Yes&quot;</span> : <span class="hljs-string">&quot;No&quot;</span>) &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125; <br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="F-ä¸åŠ¨çš„å¤§å›¾ä¹¦é¦†æƒ³è¦å‡ºé—¨"><strong>F ä¸åŠ¨çš„å¤§å›¾ä¹¦é¦†æƒ³è¦å‡ºé—¨</strong></h2><h3 id="é¢˜æ„æè¿°-6"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªèŠ‚ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> æ¡æœ‰å‘è¾¹çš„æœ‰å‘å›¾ï¼Œè¾¹çš„é•¿åº¦æœªçŸ¥ã€‚æ„é€ æ¯æ¡è¾¹çš„é•¿åº¦ä½¿å¾—ä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å·ç‚¹åˆ°è¾¾å…¶ä»–æ‰€æœ‰ç‚¹çš„æœ€çŸ­è·¯å”¯ä¸€ï¼Œä¸”æ‰€æœ‰è¾¹çš„é•¿åº¦èŒƒå›´éœ€è¦æ§åˆ¶åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1, k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span> ã€‚<a href="https://www.luogu.com.cn/problem/T434253">ã€ŒYAC Round 7ã€ä¸åŠ¨çš„å¤§å›¾ä¹¦é¦†æƒ³è¦å‡ºé—¨</a></p><h3 id="è§£é¢˜æ€è·¯-æœ€çŸ­è·¯-è´ªå¿ƒ-æ„é€ "><strong>è§£é¢˜æ€è·¯</strong> æœ€çŸ­è·¯ + è´ªå¿ƒ + æ„é€ </h3><p>æˆ‘ä»¬å¯ä»¥å…ˆå°†æ¯æ¡è¾¹çš„é•¿åº¦éƒ½è®¾ç½®ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œç„¶ååœ¨è¿™ä¸ªåˆå§‹çš„å›¾ä¸Šè·‘æœ€çŸ­è·¯ã€‚æ•°æ®é‡è¾ƒå¤§ï¼Œå»ºè®®ä½¿ç”¨ <strong>å †ä¼˜åŒ–</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>dijkstra</mtext></mrow><annotation encoding="application/x-tex">\text{dijkstra}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">dijkstra</span></span></span></span></span> ç®—æ³•ã€‚</p><p>æœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯å¦‚ä½•ä½¿å¾—æœ€çŸ­è·¯å”¯ä¸€ã€‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>dijkstra</mtext></mrow><annotation encoding="application/x-tex">\text{dijkstra}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">dijkstra</span></span></span></span></span> ç®—æ³•çš„åŸç†æ˜¯ä¸æ–­å°†ç‚¹è¿›è¡Œæ‰©å±•åŠ å…¥åˆ°ä»æºç‚¹å¼€å§‹çš„ä¸€ä¸ªæœ€çŸ­è·¯å¾„ç½‘ç»œä¸­ï¼Œå‡è®¾æºç‚¹ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œå½“ä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> æ‰©å±•åˆ°ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> å¹¶ä¸”éœ€è¦åŠ å…¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> åˆ°æœ€çŸ­è·¯å¾„ç½‘ç»œä¸­æ—¶ï¼Œæ­¤æ—¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>âˆ¼</mo><mi>v</mi></mrow><annotation encoding="application/x-tex">1 \sim v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> çš„æœ€çŸ­è·¯ä¹Ÿå°±ç¡®å®šäº†ã€‚</p><p>è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dist[v]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span> ä¸ºç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> çš„æœ€çŸ­è·¯é•¿åº¦ï¼Œæ˜¾ç„¶ï¼Œä¸ºäº†ä½¿å¾—æœ€çŸ­è·¯å”¯ä¸€ï¼Œåœ¨æ‰©å±•è¿‡ç¨‹ä¸­æˆ‘ä»¬ä¸å®¹è®¸å‡ºç° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo>=</mo><mo>=</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">dist[v] == dist[u] + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">==</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ã€‚åŸºäºè´ªå¿ƒçš„æ€æƒ³ï¼Œæˆ‘ä»¬æ­¤æ—¶å¯ä»¥å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>u</mi><mo separator="true">,</mo><mi>v</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{u, v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> è¿›è¡Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+ 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span> çš„æ“ä½œï¼Œè¿™æ ·å°±å¯ä»¥é¿å…å­˜åœ¨ç›¸åŒçš„æœ€çŸ­è·¯å‡ºç°ã€‚</p><p>åœ¨è¿›è¡Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span> æ“ä½œä¸­ï¼Œå¦‚æœå‡ºç°äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>u</mi><mo separator="true">,</mo><mi>v</mi></mrow></msub><mo>&gt;</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">w_{u,v} &gt; k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8252em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> çš„æƒ…å†µï¼Œè¡¨ç¤ºå·²ç»è¶…è¿‡äº†é™åˆ¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ï¼Œé‚£ä¹ˆç›´æ¥åˆ¤å®šæ— è§£ï¼›å¦‚æœè·‘å®Œæ•´ä¸ªå›¾éƒ½æ²¡æœ‰å‡ºç°æ­¤æƒ…å†µï¼Œé‚£ä¹ˆå°±æ˜¯æœ‰è§£ï¼Œå¹¶ä¸”ä¸€ä¸ªåˆæ³•çš„å¸¦æƒæœ‰å‘å›¾ä¹Ÿå°±æ„é€ å‡ºæ¥äº†ï¼Œæœ€ç»ˆä¾æ¬¡è¾“å‡ºè¾¹æƒå³å¯ã€‚</p><p>ä»£ç æ•´ä½“åŸºæœ¬ä¸Šåªæ˜¯åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>dijkstra</mtext></mrow><annotation encoding="application/x-tex">\text{dijkstra}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">dijkstra</span></span></span></span></span> æœ€çŸ­è·¯è®¡æ•°çš„åŸºç¡€ä¸Šåšäº†äº›ä¿®æ”¹ï¼Œæ•´ä½“ä¸éš¾ã€‚æœ€çŸ­è·¯è®¡æ•°ä¸ç†Ÿæ‚‰çš„å¯ä»¥åšä¸€ä¸‹ <a href="https://www.luogu.com.cn/problem/P1144">P1144 æœ€çŸ­è·¯è®¡æ•°</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">3e5</span> + <span class="hljs-number">10</span>, M = (N &lt;&lt; <span class="hljs-number">1</span>);<br><br><span class="hljs-type">int</span> h[N], e[M], ne[M], w[M], idx; <span class="hljs-comment">// é“¾å¼å‰å‘æ˜Ÿ</span><br><span class="hljs-type">int</span> dist[N], n, m, K;<br><span class="hljs-type">bool</span> st[N];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">int</span> c)</span></span>&#123;<br>    e[ ++ idx] = b, ne[idx] = h[a], w[idx] = c, h[a] = idx;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">dijkstra</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">memset</span>(st, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> st);<br>    <span class="hljs-built_in">memset</span>(dist, <span class="hljs-number">0x3f</span>, <span class="hljs-built_in">sizeof</span>(dist));<br>    dist[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br><br>    priority_queue&lt;pii, vector&lt;pii&gt;, greater&lt;pii&gt; &gt; q; <br>    q.<span class="hljs-built_in">push</span>(&#123;dist[<span class="hljs-number">1</span>], <span class="hljs-number">1</span>&#125;);<br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-keyword">auto</span> [d, u] = q.<span class="hljs-built_in">top</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">if</span>(st[u]) <span class="hljs-keyword">continue</span>;<br>        st[u] = <span class="hljs-literal">true</span>;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; i; i = ne[i])&#123;<br>            <span class="hljs-type">int</span> v = e[i];<br>            <span class="hljs-keyword">if</span>(dist[v] &gt; dist[u] + w[i])&#123;<br>                dist[v] = dist[u] + w[i];<br>                q.<span class="hljs-built_in">push</span>(&#123;dist[v], v&#125;);<br>            &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(dist[v] == dist[u] + w[i])&#123;<br>                w[i] ++ ;<br>                <span class="hljs-keyword">if</span>(w[i] &gt; K) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        cin &gt;&gt; n &gt;&gt; m &gt;&gt; K;<br>        <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(h)), idx = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i ++ )&#123;<br>            <span class="hljs-type">int</span> u, v; cin &gt;&gt; u &gt;&gt; v;<br>            <span class="hljs-built_in">add</span>(u, v, <span class="hljs-number">1</span>);<br>        &#125;<br><br>        <span class="hljs-type">bool</span> flag = <span class="hljs-built_in">dijkstra</span>();<br><br>        cout &lt;&lt; (flag ? <span class="hljs-string">&quot;Yes&quot;</span> : <span class="hljs-string">&quot;No&quot;</span>) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>        <span class="hljs-keyword">if</span>(flag)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i ++ ) cout &lt;&lt; w[i] &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span>;<br>            cout &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>        &#125; <br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="G-æ°¸è¿œé²œçº¢çš„å¹¼æœˆ"><strong>G æ°¸è¿œé²œçº¢çš„å¹¼æœˆ</strong></h2><h3 id="é¢˜æ„æè¿°-7"><strong>é¢˜æ„æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªå¤§å°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> çš„æ–¹æ ¼å›¾ï¼Œè®¾è¢«çº¢é›¾å æ®ä¸º <code>x</code>ï¼Œæœªè¢«å æ®ä¸º <code>o</code>ï¼Œåˆå§‹æƒ…å†µä¸‹å…¨éƒ¨ä¸º <code>o</code>ã€‚ç°æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> æ¬¡æ“ä½œï¼Œåˆ†ä¸ºä¸¤ç§æ“ä½œï¼š</p><ul><li><p><code>1 x y</code>ï¼Œè¡¨ç¤ºåœ¨ä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> æœä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘é‡Šæ”¾æ— é™é•¿çš„çº¢é›¾ï¼Œæ³¨æ„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> ä¸è¢«çº¢é›¾å æ®ï¼›</p></li><li><p><code>2 x1 y1 x2 y2</code>ï¼Œè¡¨ç¤ºè¯¢é—®ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_1, y_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ä¸ºå·¦ä¸Šè§’ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_2, y_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ä¸ºå³ä¸‹è§’çš„æ–¹å½¢åŒºåŸŸä¸­ï¼Œè¢«çº¢é›¾å æ®çš„ä½ç½®æ•°é‡ã€‚</p></li></ul><p><a href="https://www.luogu.com.cn/problem/T434256">ã€ŒYAC Round 7ã€æ°¸è¿œé²œçº¢çš„å¹¼æœˆ</a></p><h3 id="è§£é¢˜æ€è·¯-çº¿æ®µæ ‘-å®¹æ–¥åŸç†"><strong>è§£é¢˜æ€è·¯</strong> çº¿æ®µæ ‘ + å®¹æ–¥åŸç†</h3><p>æœ¬é¢˜åªéœ€è¦ç”¨ä¸€ç»´çº¿æ®µæ ‘å°±å¯ä»¥è§£å†³ã€‚</p><p>æˆ‘ä»¬å‡è®¾åŒºåŸŸèŒƒå›´å†…çš„è¢«çº¢é›¾å æ®çš„ä½ç½®ä¸ªæ•°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>ã€‚</p><p>ä»¤ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">sx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">x</span></span></span></span> ä¸ºåŒºåŸŸèŒƒå›´å†…é‡Šæ”¾è¿‡çº¢é›¾çš„ <strong>è¡Œæ•°</strong>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">sy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">sy</span></span></span></span> ä¸ºåŒºåŸŸèŒƒå›´å†…é‡Šæ”¾è¿‡çº¢é›¾çš„ <strong>åˆ—æ•°</strong>ã€‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä¸ºä¸€ä¸ªæŠµæ¶ˆçš„ä½ç½®æ•°é‡ã€‚</p><p>é‚£ä¹ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> çš„å…¬å¼å¤§æ¦‚å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>s</mi><mo>=</mo><mi>s</mi><mi>x</mi><mo>Ã—</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>s</mi><mi>y</mi><mo>Ã—</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>âˆ’</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">s = sx \times (y_2 - y_1 + 1) + sy \times (x_2 - x_1 + 1) - k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">sy</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span></p><p>è€Œæœ€å…³é”®çš„åœ°æ–¹å°±åœ¨äºæ±‚å‡ºæŠµæ¶ˆçš„ä½ç½®æ•°é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ã€‚é¦–å…ˆï¼Œåœ¨è®¡ç®—è¡Œåˆ—æ•°é‡æ—¶ï¼Œæ¯ä¸€ä¸ªäº¤å‰ç‚¹å¤šè®¡ç®—äº†ä¸€æ¬¡ï¼Œå› æ­¤éœ€è¦å‡å»ä¸€æ¬¡äº¤å‰çš„ç‚¹æ•°ï¼›è€Œç”±äºé¢˜ä¸­æ‰€æè¿°çš„ <strong>é‡Šæ”¾ä½ç½®ä¸è¢«çº¢é›¾å æ®</strong> ä»¥åŠçº¢é›¾ <strong>ç›¸é‡æŠµæ¶ˆ</strong>ï¼Œæ‰€ä»¥éœ€è¦å†å‡å»ä¸€æ¬¡äº¤å‰çš„ç‚¹æ•°ã€‚æ€»è®¡è¦å‡å»ä¸¤æ¬¡äº¤å‰çš„ç‚¹æ•°ï¼Œè€Œäº¤å‰çš„ç‚¹æ•°å°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>x</mi><mo>Ã—</mo><mi>s</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">sx \times sy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">sy</span></span></span></span> ã€‚æ•…æœ€åæˆ‘ä»¬çš„å…¬å¼å¦‚ä¸‹ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>s</mi><mo>=</mo><mi>s</mi><mi>x</mi><mo>Ã—</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>s</mi><mi>y</mi><mo>Ã—</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>âˆ’</mo><mn>2</mn><mo>Ã—</mo><mi>s</mi><mi>x</mi><mo>Ã—</mo><mi>s</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">s = sx \times (y_2 - y_1 + 1) + sy \times (x_2 - x_1 + 1) - 2 \times sx \times sy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">sy</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">sy</span></span></span></span></span></p><p>è§‚å¯Ÿå…¬å¼æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œåªè¦æœ‰äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> ç›¸å…³çš„æ•°é‡å°±å¯ä»¥æ±‚å‡ºåŒºåŸŸèŒƒå›´å†…çš„çº¢é›¾å æ®ä½ç½®æ•°é‡ã€‚æ•…æˆ‘ä»¬åªéœ€è¦å®ç°ä¸¤ä¸ªå•ç‚¹ä¿®æ”¹ã€åŒºé—´è¯¢é—®çš„çº¿æ®µæ ‘ï¼Œä¸€ä¸ªçº¿æ®µæ ‘ç»´æŠ¤å æ®çš„è¡Œæ•°ï¼Œå¦ä¸€ä¸ªç»´æŠ¤å æ®çš„åˆ—æ•°ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ls (u &lt;&lt; 1)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> rs (u &lt;&lt; 1 | 1)</span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> sum[<span class="hljs-number">2</span>][N &lt;&lt; <span class="hljs-number">2</span>], n, m, q; <span class="hljs-comment">// 0 ç»´æŠ¤ x, 1 ç»´æŠ¤ y</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">pushup</span><span class="hljs-params">(<span class="hljs-type">int</span> c, <span class="hljs-type">int</span> u)</span></span>&#123; sum[c][u] = sum[c][ls] + sum[c][rs]; &#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">modify</span><span class="hljs-params">(<span class="hljs-type">int</span> c, <span class="hljs-type">int</span> u, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r, <span class="hljs-type">int</span> k)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(l == r)&#123; sum[c][u] ^= <span class="hljs-number">1</span>; <span class="hljs-keyword">return</span>; &#125;<br>    <span class="hljs-type">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span>(k &lt;= mid) <span class="hljs-built_in">modify</span>(c, ls, l, mid, k);<br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">modify</span>(c, rs, mid + <span class="hljs-number">1</span>, r, k);<br>    <span class="hljs-built_in">pushup</span>(c, u);<br>&#125;<br><br><span class="hljs-function">ll <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-type">int</span> c, <span class="hljs-type">int</span> u, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r, <span class="hljs-type">int</span> ql, <span class="hljs-type">int</span> qr)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(ql &lt;= l &amp;&amp; r &lt;= qr) <span class="hljs-keyword">return</span> sum[c][u];<br>    <span class="hljs-type">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>;<br>    ll res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span>(ql &lt;= mid) res += <span class="hljs-built_in">query</span>(c, ls, l, mid, ql, qr);<br>    <span class="hljs-keyword">if</span>(qr &gt; mid) res += <span class="hljs-built_in">query</span>(c, rs, mid + <span class="hljs-number">1</span>, r, ql, qr);<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m &gt;&gt; q; <span class="hljs-comment">// åˆå§‹å…¨éƒ¨ä¸º0 ä¸éœ€è¦äº‹å…ˆå»ºæ ‘</span><br>    <span class="hljs-keyword">while</span>(q -- )&#123;<br>        <span class="hljs-type">int</span> op; cin &gt;&gt; op;<br>        <span class="hljs-keyword">if</span>(op == <span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-type">int</span> x, y; cin &gt;&gt; x &gt;&gt; y;<br>            <span class="hljs-built_in">modify</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, n, x);  <span class="hljs-comment">// å•ç‚¹ä¿®æ”¹ x</span><br>            <span class="hljs-built_in">modify</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, m, y);  <span class="hljs-comment">// å•ç‚¹ä¿®æ”¹ y</span><br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-type">int</span> x1, y1, x2, y2; cin &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2;<br>            ll sx = <span class="hljs-built_in">query</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, n, x1, x2), sy = <span class="hljs-built_in">query</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, m, y1, y2);<br>            <span class="hljs-type">int</span> lx = x2 - x1 + <span class="hljs-number">1</span>, ly = y2 - y1 + <span class="hljs-number">1</span>;<br>            cout &lt;&lt; sx * ly + sy * lx - sx * sy * <span class="hljs-number">2</span> &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>; <span class="hljs-comment">// å®¹æ–¥åŸç†</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å’å”±å…‰èŠ’</category>
      
      <category>YAC æ‰¬å·å¤§å­¦ç®—æ³•ç»ƒä¹ èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>ç®—æ³•ç«èµ›</tag>
      
      <tag>Luogu</tag>
      
      <tag>YAC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 YAC Round 6 é¢˜è§£</title>
    <link href="/2024/12/14/YAC_Round_6/"/>
    <url>/2024/12/14/YAC_Round_6/</url>
    
    <content type="html"><![CDATA[<h2 id="A-çªéœ²è¯ºçš„è¶…çº§â‘¨æ‹†åˆ†"><strong>A. çªéœ²è¯ºçš„è¶…çº§â‘¨æ‹†åˆ†</strong></h2><h3 id="é¢˜ç›®æè¿°"><strong>é¢˜ç›®æè¿°</strong></h3><p>å®šä¹‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> é˜¶æ•°å­—ä¸ºï¼šæ¯ä¸€ä½éƒ½æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>9</mn></mrow><annotation encoding="application/x-tex">9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span></span></span></span> çš„ï¼Œä¸”ä½æ•°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> çš„å€æ•°çš„æ­£æ•´æ•°ã€‚ç»™å®šå¤šæ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ä¸€ä¸ªæ•°å­— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>ï¼Œåˆ¤æ–­è¿™ä¸ªæ•°å­—æ˜¯å¦å¯ä»¥æ‹†æˆè‹¥å¹²ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> é˜¶æ•°å­—çš„å’Œã€‚<a href="https://www.luogu.com.cn/problem/T429116">ã€ŒYAC Round 6ã€çªéœ²è¯ºçš„è¶…çº§â‘¨æ‹†åˆ†</a></p><h3 id="è§£é¢˜æ€è·¯-æ•°å­¦"><strong>è§£é¢˜æ€è·¯ æ•°å­¦</strong></h3><p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæ¯”æœ€å° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> é˜¶æ•°å­—å¤§çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> é˜¶æ•°å­—ï¼Œéƒ½æ˜¯æœ€å° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> é˜¶æ•°å­—çš„å€æ•°ã€‚</p><p>ä¾‹å¦‚ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">k = 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span>ï¼Œé‚£ä¹ˆæœ€å° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> é˜¶æ•°å­—å°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>999</mn></mrow><annotation encoding="application/x-tex">999</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">999</span></span></span></span>ï¼Œæ¯”å®ƒå¤§çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> é˜¶æ•°å­—æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>999999</mn></mrow><annotation encoding="application/x-tex">999999</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">999999</span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>999999999</mn></mrow><annotation encoding="application/x-tex">999999999</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">999999999</span></span></span></span> ç­‰ç­‰ï¼Œè€Œä¸”ä¹Ÿéƒ½æ˜¯æœ€å° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> é˜¶æ•°å­—çš„å€æ•°ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬è¦åˆ¤æ–­ç”¨è‹¥å¹²ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> é˜¶æ•°å­—å»å‡‘æˆæ•°å­— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> æ—¶ï¼Œåªéœ€è¦ç”¨æœ€å° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> é˜¶æ•°å­—å»å‡‘å³å¯ã€‚</p><p>æˆ‘ä»¬çš„é—®é¢˜å°±è½¬æ¢ä¸ºï¼šåˆ¤æ–­æ•°å­— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> æ˜¯å¦æ˜¯æœ€å° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> é˜¶æ•°å­—çš„å€æ•°ã€‚</p><p><strong>æ³¨æ„æ•°æ®èŒƒå›´ï¼Œéœ€è¦å¼€ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>longÂ long</mtext></mrow><annotation encoding="application/x-tex">\text{long long}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">longÂ long</span></span></span></span></span></strong> ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">check</span><span class="hljs-params">(ll k, ll n)</span></span>&#123;<br>    ll c = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(k -- ) c = c * <span class="hljs-number">10</span> + <span class="hljs-number">9</span>; <span class="hljs-comment">// å¾—åˆ°æœ€å°ké˜¶æ•°å­—</span><br>    <span class="hljs-keyword">return</span> n % c == <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> q; cin &gt;&gt; q;<br>    <span class="hljs-keyword">while</span>(q -- )&#123;<br>        ll k, n; cin &gt;&gt; k &gt;&gt; n;<br>        cout &lt;&lt; (<span class="hljs-built_in">check</span>(k, n) ? <span class="hljs-string">&quot;aya&quot;</span> : <span class="hljs-string">&quot;baka&quot;</span>) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="B-çªéœ²è¯ºçš„å®åŠ›éšè—æ³•"><strong>B. çªéœ²è¯ºçš„å®åŠ›éšè—æ³•</strong></h2><h3 id="é¢˜ç›®æè¿°-2"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„æ•°ç»„ï¼Œæ‰¾åˆ°ä¸€ä¸ªæ’åºæ–¹æ³•ä½¿å¾—æ•°ç»„ä¸­æœ€å¤§çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>a</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">a_i - a_{i + 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> æœ€å°ã€‚<a href="https://www.luogu.com.cn/problem/T429110">ã€ŒYAC Round 6ã€çªéœ²è¯ºçš„å®åŠ›éšè—æ³•</a></p><h3 id="è§£é¢˜æ€è·¯-è´ªå¿ƒ"><strong>è§£é¢˜æ€è·¯ è´ªå¿ƒ</strong></h3><p>æˆ‘ä»¬å‘ç°å°†æ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> ä»å°åˆ°å¤§æ’åºåï¼Œæ»¡è¶³æ‰€æœ‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>a</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>â‰¤</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a_i - a_{i + 1} \le 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8443em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ï¼Œå³å…¨éƒ¨ä¸ºéæ­£æ•°ï¼›å¦åˆ™ï¼Œä¸€å®šä¼šå­˜åœ¨ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>a</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a_i - a_{i + 1} &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7474em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œä»è€Œå¯¼è‡´æ•°ç»„ä¸­æœ€å¤§çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>a</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">a_i - a_{i + 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> å¢å¤§ï¼Œå˜ä¸ºäº†ä¸€ä¸ªæ­£æ•°ã€‚</p><p>æ‰€ä»¥ï¼Œå°†æ•°ç»„ä»å°åˆ°å¤§æ’åºå³ä¸ºæœ€ä¼˜ç­–ç•¥ã€‚æœ€åæšä¸¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>a</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">a_i - a_{i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> å–æœ€å¤§å€¼å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> n; cin &gt;&gt; n;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">a</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br>    <br>    <span class="hljs-built_in">sort</span>(a.<span class="hljs-built_in">begin</span>() + <span class="hljs-number">1</span>, a.<span class="hljs-built_in">end</span>());<br>    <br>    <span class="hljs-type">int</span> mx = <span class="hljs-number">-1e9</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; n; i ++ ) mx = <span class="hljs-built_in">max</span>(mx, a[i] - a[i + <span class="hljs-number">1</span>]);<br>    cout &lt;&lt; mx &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="C-çªéœ²è¯ºçš„å®Œç¾ç®—æœ¯æ•™å®¤"><strong>C. çªéœ²è¯ºçš„å®Œç¾ç®—æœ¯æ•™å®¤</strong></h2><h3 id="é¢˜ç›®æè¿°-3"><strong>é¢˜ç›®æè¿°</strong></h3><p>è¯¢é—®ä¸€ä¸ªåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>L</mi><mo separator="true">,</mo><mi>R</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[L, R]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">]</span></span></span></span>ï¼Œè¿™ä¸ªåŒºé—´ä¸­æœ‰å¤šå°‘ä¸ªæ•°å­— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> æ»¡è¶³å­˜åœ¨è‡ªç„¶æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>c</mi><mo separator="true">,</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">a, b, c, d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span></span></span></span>  ä½¿å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><msup><mn>2</mn><mi>a</mi></msup><mo>Ã—</mo><msup><mn>3</mn><mi>b</mi></msup><mo>Ã—</mo><msup><mn>5</mn><mi>c</mi></msup><mo>Ã—</mo><msup><mn>7</mn><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">X = 2^a \times 3^b \times 5^c \times 7^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7477em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9324em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7477em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">7</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span> ã€‚<a href="https://www.luogu.com.cn/problem/T429109">ã€ŒYAC Round 6ã€çªéœ²è¯ºçš„å®Œç¾ç®—æœ¯æ•™å®¤</a></p><h3 id="è§£é¢˜æ€è·¯-é¢„å¤„ç†-å¿«é€Ÿå¹‚"><strong>è§£é¢˜æ€è·¯ é¢„å¤„ç† + å¿«é€Ÿå¹‚</strong></h3><p>è¯¢é—®çš„åŒºé—´çš„æ•°æ®èŒƒå›´ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1, 10^9]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>ï¼Œç›´æ¥å»åˆ¤æ–­åŒºé—´å†…æ¯ä¸ªæ•°å­—æ˜¯å¦å¯ä»¥å‡‘æˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>a</mi></msup><mo>Ã—</mo><msup><mn>3</mn><mi>b</mi></msup><mo>Ã—</mo><msup><mn>5</mn><mi>c</mi></msup><mo>Ã—</mo><msup><mn>7</mn><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">2^a \times 3^b \times 5^c \times 7^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7477em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9324em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7477em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">7</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span> æ˜¾ç„¶æ˜¯ä¼šè¶…æ—¶çš„ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é¢„å¤„ç† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1, 10^9]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> èŒƒå›´å†…æ‰€æœ‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>a</mi></msup><mo>Ã—</mo><msup><mn>3</mn><mi>b</mi></msup><mo>Ã—</mo><msup><mn>5</mn><mi>c</mi></msup><mo>Ã—</mo><msup><mn>7</mn><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">2^a \times 3^b \times 5^c \times 7^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7477em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9324em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7477em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">7</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span>ã€‚æˆ‘ä»¬æŠŠ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mtext>ã€</mtext><mn>3</mn><mtext>ã€</mtext><mn>5</mn><mtext>ã€</mtext><mn>7</mn></mrow><annotation encoding="application/x-tex">2ã€3ã€5ã€7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">2</span><span class="mord cjk_fallback">ã€</span><span class="mord">3</span><span class="mord cjk_fallback">ã€</span><span class="mord">5</span><span class="mord cjk_fallback">ã€</span><span class="mord">7</span></span></span></span> çœ‹ä½œæ˜¯å››ä¸ªå› å­ã€‚</p><p>å¯¹äºæ¯ä¸ªå› å­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>ï¼Œæœ€å¤šä¸ä¼šè¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">âŒŠ</mo><msub><mrow><mi>log</mi><mo>â¡</mo></mrow><mi>p</mi></msub><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup><mo fence="true">âŒ‹</mo></mrow><annotation encoding="application/x-tex">\left \lfloor \log_p 10^9 \right \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2302em;vertical-align:-0.3802em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">âŒŠ</span></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0573em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3802em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">âŒ‹</span></span></span></span></span></span> æ¬¡æ–¹ã€‚é¢„å¤„ç†æšä¸¾è¿‡ç¨‹ä¸­å°†æ‰€æœ‰ç¬¦åˆè¦æ±‚çš„æ•°å­—æ”¾åˆ°ä¸€ä¸ªå®¹å™¨ä¸­ï¼ˆå› ä¸ºéƒ½æ˜¯è´¨æ•°ï¼Œæ‰€ä»¥ä»”ç»†æƒ³æƒ³å‘ç°æ˜¯ä¸ä¼šå‡ºç°é‡å¤çš„æ•°å­—çš„ï¼Œä¸éœ€è¦ç”¨é›†åˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>set</mtext></mrow><annotation encoding="application/x-tex">\text{set}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord text"><span class="mord">set</span></span></span></span></span>ï¼‰ã€‚æœ€åç»è¿‡é¢„å¤„ç†åå‘ç°ç¬¦åˆè¦æ±‚çš„æ•°å­—å¹¶ä¸æ˜¯å¾ˆå¤šã€‚</p><p>å¯¹äºè¯¢é—®åŒºé—´ï¼Œæšä¸¾å®¹å™¨ä¸­å­˜å‚¨çš„æ•°å­—åˆ¤æ–­æ˜¯å¦åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>L</mi><mo separator="true">,</mo><mi>R</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[L, R]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">]</span></span></span></span> èŒƒå›´å†…å³å¯ã€‚</p><p>ä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>C++</mtext></mrow><annotation encoding="application/x-tex">\text{C++}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord">C++</span></span></span></span></span> çš„åŒå­¦éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œå‡½æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>o</mi><mi>w</mi></mrow><annotation encoding="application/x-tex">pow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span> å¯èƒ½å­˜åœ¨ç²¾åº¦ç¼ºå¤±é—®é¢˜ï¼Œä¸å»ºè®®ä½¿ç”¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>C++</mtext></mrow><annotation encoding="application/x-tex">\text{C++}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord">C++</span></span></span></span></span> é€‰æ‰‹å¯èƒ½è¿˜éœ€è¦ç”¨åˆ°å¿«é€Ÿå¹‚ã€‚</p><p>åœ¨é¢„å¤„ç†æšä¸¾çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æå‰åˆ¤æ–­æ¯ä¸ªå› å­çš„æ¬¡æ–¹ç›¸ä¹˜æ˜¯å¦å·²ç»è¶…è¿‡äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding="application/x-tex">10^9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span>ï¼Œå› ä¸ºå¦‚æœä¸æå‰åˆ¤æ–­ï¼Œå¯èƒ½ä¼šå‡ºç°å¤šä¸ªå°†è¿‘ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding="application/x-tex">10^9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span> çš„æ•°å­—ç›¸ä¹˜ï¼Œè¿™æ—¶å€™è¿ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>longÂ long</mtext></mrow><annotation encoding="application/x-tex">\text{long long}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">longÂ long</span></span></span></span></span> éƒ½æ•‘ä¸äº†ä½ ã€‚ğŸ˜‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e9</span> + <span class="hljs-number">2</span>;<br><br>vector&lt;<span class="hljs-type">int</span>&gt; v;<br><span class="hljs-comment">// å¿«é€Ÿå¹‚</span><br><span class="hljs-function">ll <span class="hljs-title">qmi</span><span class="hljs-params">(ll a, ll b)</span></span>&#123;<br>    ll res = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span>(b)&#123;<br>        <span class="hljs-keyword">if</span>(b &amp; <span class="hljs-number">1</span>) res *= a;<br>        a *= a;<br>        b &gt;&gt;= <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">work</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> a = <span class="hljs-number">0</span>; a &lt;= (<span class="hljs-type">int</span>)(<span class="hljs-built_in">log</span>(n) / <span class="hljs-built_in">log</span>(<span class="hljs-number">2</span>)) + <span class="hljs-number">1</span>; a ++ )&#123;<br>        ll c2 = <span class="hljs-built_in">qmi</span>(<span class="hljs-number">2</span>, a);<br>        <span class="hljs-keyword">if</span>(c2 &gt;= n) <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> b = <span class="hljs-number">0</span>; b &lt;= (<span class="hljs-type">int</span>)(<span class="hljs-built_in">log</span>(n) / <span class="hljs-built_in">log</span>(<span class="hljs-number">3</span>)) + <span class="hljs-number">1</span>; b ++ )&#123;<br>            ll c3 = <span class="hljs-built_in">qmi</span>(<span class="hljs-number">3</span>, b);<br>            <span class="hljs-keyword">if</span>(c2 * c3 &gt;= n) <span class="hljs-keyword">break</span>; <span class="hljs-comment">// æå‰åˆ¤æ–­</span><br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> c = <span class="hljs-number">0</span>; c &lt;= (<span class="hljs-type">int</span>)(<span class="hljs-built_in">log</span>(n) / <span class="hljs-built_in">log</span>(<span class="hljs-number">5</span>)) + <span class="hljs-number">1</span>; c ++ )&#123;<br>                ll c5 = <span class="hljs-built_in">qmi</span>(<span class="hljs-number">5</span>, c);<br>                <span class="hljs-keyword">if</span>(c2 * c3 * c5 &gt;= n) <span class="hljs-keyword">break</span>;  <span class="hljs-comment">// æå‰åˆ¤æ–­</span><br>                <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> d = <span class="hljs-number">0</span>; d &lt;= (<span class="hljs-type">int</span>)(<span class="hljs-built_in">log</span>(n) / <span class="hljs-built_in">log</span>(<span class="hljs-number">7</span>)) + <span class="hljs-number">1</span>; d ++ )&#123;<br>                    ll c7 = <span class="hljs-built_in">qmi</span>(<span class="hljs-number">7</span>, d);<br>                    <span class="hljs-keyword">if</span>(c2 * c3 * c5 * c7 &gt;= n) <span class="hljs-keyword">break</span>;<br>                    v.<span class="hljs-built_in">push_back</span>(c2 * c3 * c5 * c7);<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-built_in">work</span>(N);<br><br>    <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>, l, r; cin &gt;&gt; l &gt;&gt; r;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;x : v)<br>        <span class="hljs-keyword">if</span>(x &gt;= l &amp;&amp; x &lt;= r) res ++; <br>        <br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="D-çªéœ²è¯ºçš„Homoé¦†æ”»åšæˆ˜"><strong>D. çªéœ²è¯ºçš„Homoé¦†æ”»åšæˆ˜</strong></h2><h3 id="é¢˜ç›®æè¿°-4"><strong>é¢˜ç›®æè¿°</strong></h3><p>è‡ªå·±æ‰‹ä¸­æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> å¼ ç¬¦å¡ï¼Œå¯ä»¥æŠŠå®ƒä»¬éšæ„åˆ†é…åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>âˆ¼</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1 \sim n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªåŸå ¡ï¼Œå³åˆ†é…ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">a_1, a_2, \ldots, a_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚æ¯è½®è¿›æ”»ä¸­ï¼Œå¦‚æœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸¥æ ¼å¤§äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">2 \times b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œé‚£ä¹ˆå°±å¯ä»¥è·å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> åˆ†ã€‚æ¯è½®è¿›æ”»çš„åˆ†é…æ–¹æ¡ˆå¿…é¡»ä¸€è‡´ï¼Œå·²çŸ¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> è½®çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>b</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">b_1, b_2, \ldots, b_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œæ±‚æœ€å¤§çš„æ€»å¾—åˆ†ã€‚<a href="https://www.luogu.com.cn/problem/T429164">ã€ŒYAC Round 6ã€çªéœ²è¯ºçš„Homoé¦†æ”»åšæˆ˜</a></p><h3 id="è§£é¢˜æ€è·¯-åˆ†ç»„èƒŒåŒ…-è´ªå¿ƒ-æ’åº"><strong>è§£é¢˜æ€è·¯ åˆ†ç»„èƒŒåŒ… + è´ªå¿ƒ + æ’åº</strong></h3><p>å¯ä»¥ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span> è¡¨ç¤ºè¿›æ”»å‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> è½®è¿›æ”»ï¼Œæ¯è½®è¿›æ”»éƒ½ä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> å¼ ç¬¦å¡çš„æœ€å¤§æ€»å¾—åˆ†ã€‚ä¸€å…±æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> è½®è¿›æ”»ï¼Œæ¯è½®è¿›æ”»æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> å¼ ç¬¦å¡ã€‚</p><p>å¯¹äºç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªåŸå ¡ã€‚å¦‚æœè¦å¾—åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> åˆ†ï¼Œé‚£ä¹ˆæˆ‘ä»¬åŸºäºè´ªå¿ƒçš„ç­–ç•¥ï¼Œæœ€å°‘éœ€è¦åˆ†é… <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2 \times b_i + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å¼ ç¬¦å¡ã€‚æˆ‘ä»¬å¯ä»¥å…ˆå¯¹æ¯ä¸ªåŸå ¡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> çš„æ‰€æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> è½®çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> è¿›è¡Œä»å°åˆ°å¤§æ’åºã€‚ç»è¿‡æ’åºåï¼Œå¦‚æœåˆ†é…çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><msub><mi>b</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2 \times b_{ik} + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">ik</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> è½®è¿›æ”»ä¸­åœ¨åŸå ¡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸Šåˆ†é…çš„ç¬¦å¡æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> æ¬¡å¯ä»¥å‡»è´¥å¯¹æ–¹ï¼Œé‚£ä¹ˆåœ¨åŸå ¡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸Šå°±å¯ä»¥å¾—åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>Ã—</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">k \times i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> çš„åˆ†æ•°ã€‚ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">b_{ik}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">ik</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸ºæ‰€æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> è½®çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ’åºåçš„ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä¸ªï¼‰</p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç¬¦å¡çš„æ•°é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> çœ‹ä½œæ˜¯èƒŒåŒ…å®¹é‡ï¼Œå…± <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ç»„ç‰©å“ï¼Œæ¯ç»„ä¸­çš„ç‰©å“æ˜¯å¯¹åº”çš„ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> åº§åŸå ¡æ‰€æœ‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ„æˆçš„ï¼Œæ¯ç»„ç‰©å“å…± <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> ä¸ªç‰©å“ï¼Œç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä¸ªç‰©å“çš„ä½“ç§¯ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><msub><mi>b</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2 \times b_{ik} + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">ik</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œä»·å€¼ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>Ã—</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">k \times i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ã€‚æ¯ç»„ç‰©å“æœ€å¤šé€‰æ‹©ä¸€ä¸ªã€‚è¿™å°±æ˜¯å…¸å‹çš„åˆ†ç»„èƒŒåŒ…æ¨¡å‹äº†ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬å¥—ç”¨åˆ†ç»„èƒŒåŒ…çš„æ¨¡æ¿å³å¯ã€‚ï¼ˆæœ¬é¢˜è§£çš„åˆ†ç»„èƒŒåŒ…æ¨¡æ¿åŠ ä¸Šäº†ç©ºé—´ä¼˜åŒ–ï¼Œé€šè¿‡é€†å‘æšä¸¾èƒŒåŒ…å®¹é‡çœå»äº†ç¬¬ä¸€ä¸ªç»´åº¦ï¼‰<a href="https://www.acwing.com/solution/content/3483/">AcWing åˆ†ç»„èƒŒåŒ…æ¨¡æ¿</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">2e4</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> s, n, m;<br><span class="hljs-type">int</span> g[<span class="hljs-number">110</span>][<span class="hljs-number">110</span>];<br>ll dp[N];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; s &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= s; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ ) cin &gt;&gt; g[i][j];<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-comment">// åˆ†ä¸º n ç»„ï¼Œåˆ†ç»„èƒŒåŒ…</span><br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">b</span><span class="hljs-params">(s + <span class="hljs-number">1</span>)</span></span>; <span class="hljs-comment">// æ¯ç»„sä¸ªç‰©å“</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= s; j ++ ) b[j] = g[j][i];<br>    <br>        <span class="hljs-built_in">sort</span>(b.<span class="hljs-built_in">begin</span>() + <span class="hljs-number">1</span>, b.<span class="hljs-built_in">end</span>()); <span class="hljs-comment">// æ’åº</span><br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = m; j &gt;= <span class="hljs-number">0</span>; j -- )     <span class="hljs-comment">// åŒç»„å†…æœ€å¤šåªé€‰ä¸€ä¸ª</span><br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>; k &lt;= s; k ++ ) <span class="hljs-comment">// æœ‰ k è½®å¯ä»¥æ”»ä¸‹åŸå ¡ i</span><br>                <span class="hljs-keyword">if</span>(j &gt;= <span class="hljs-number">2</span> * b[k] + <span class="hljs-number">1</span>)     <span class="hljs-comment">// ä¸¥æ ¼å¤§äºé•‡å®ˆäººæ•°çš„ä¸¤å€</span><br>                    dp[j] = <span class="hljs-built_in">max</span>(dp[j], dp[j - (<span class="hljs-number">2</span> * b[k] + <span class="hljs-number">1</span>)] + k * i);<br>    &#125;<br><br>    cout &lt;&lt; dp[m] &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="E-çªéœ²è¯ºçš„å°çƒçŒœçŒœæ¸¸æˆ"><strong>E. çªéœ²è¯ºçš„å°çƒçŒœçŒœæ¸¸æˆ</strong></h2><h3 id="é¢˜ç›®æè¿°-5"><strong>é¢˜ç›®æè¿°</strong></h3><p>æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªæ¯å­æ’æˆä¸€è¡Œï¼Œå…¶ä¸­æœ‰ä¸€äº›æ¯å­åº•ä¸‹è—æœ‰å°çƒï¼Œå¯ä»¥èŠ±è´¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">c_{i, j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> çš„ä»£ä»·çŸ¥é“åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> å†…å°çƒæ€»æ•°çš„å¥‡å¶æ€§ã€‚æ±‚å‡ºå‡†ç¡®çŸ¥é“æ¯ä¸ªæ¯å­ä¸‹æ˜¯å¦æœ‰å°çƒçš„æœ€å°èŠ±è´¹ã€‚<a href="https://www.luogu.com.cn/problem/T429208">ã€ŒYAC Round 6ã€çªéœ²è¯ºçš„å°çƒçŒœçŒœæ¸¸æˆ</a></p><h3 id="è§£é¢˜æ€è·¯-æœ€å°ç”Ÿæˆæ ‘"><strong>è§£é¢˜æ€è·¯ æœ€å°ç”Ÿæˆæ ‘</strong></h3><p>å‡†ç¡®çŸ¥é“æ¯ä¸ªæ¯å­ä¸‹æ˜¯å¦æœ‰å°çƒï¼Œç›¸å½“äºæˆ‘ä»¬éœ€è¦çŸ¥é“æ¯ä¸ªæ¯å­é‡Œå°çƒä¸ªæ•°çš„å¥‡å¶æ€§ã€‚æ¯å­ä¸‹æœ‰å°çƒï¼Œåˆ™ä¸ºå¥‡ï¼›æ¯å­ä¸‹æ— å°çƒï¼Œåˆ™ä¸ºå¶ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå½“çŸ¥é“äº†åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r_1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> å’ŒåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r_2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> çš„å¥‡å¶æ€§åï¼Œæˆ‘ä»¬å¯ä»¥æ¨å¯¼å‡ºåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[r_1 + 1, r_2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> çš„å¥‡å¶æ€§ã€‚æ‰€ä»¥ï¼Œè€ƒè™‘å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªæ¯å­çœ‹ä½œæ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªç‚¹ï¼Œå°†çŸ¥é“åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> å†…å°çƒæ•°é‡çš„å¥‡å¶æ€§çœ‹ä½œæ˜¯ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> åˆ° ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> è¿è¾¹ã€‚é‚£ä¹ˆï¼Œå›¾ä¸­å­˜åœ¨è¾¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>l</mi><mo separator="true">,</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(l, r_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>l</mi><mo separator="true">,</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(l, r_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œç›¸å½“äºæœ‰è¾¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(r_1 + 1, r_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ã€‚</p><p>å¯æ˜¯ï¼Œå¦‚æœæŒ‰ç…§ä¸Šè¿°æ¨¡å‹å»å»ºå›¾ï¼Œå¹¶ä¸èƒ½å¾ˆå¥½çš„æ„é€ å‡ºè¿é€šæ€§ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç¨ç¨åœ°æ”¹å˜ä¸€ä¸‹å»ºè¾¹æ–¹å¼ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å°†çŸ¥é“åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> å†…å°çƒä¸ªæ•°çš„å¥‡å¶æ€§çœ‹ä½œæ˜¯ä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">l - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> è¿è¾¹ã€‚é‚£ä¹ˆï¼Œå›¾ä¸­å­˜åœ¨è¾¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>l</mi><mo separator="true">,</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(l, r_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>l</mi><mo separator="true">,</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(l, r_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼ˆçŸ¥é“äº†åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l + 1, r_1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l + 1, r_2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> çš„å¥‡å¶æ€§ï¼‰ï¼Œç›¸å½“äºæœ‰è¾¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>r</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(r_1, r_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼ˆçŸ¥é“äº†åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[r_1 + 1, r_2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> çš„å¥‡å¶æ€§ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">r_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">r_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> é€šè¿‡ä¸¤æ¡è¾¹è¿é€šï¼‰ã€‚è¿™æ ·å°±å¯ä»¥å°±é¡ºç•…å¾ˆå¤šã€‚</p><p>æˆ‘ä»¬å†é‡æ–°èšç„¦ä¸€ä¸‹æˆ‘ä»¬çš„æœ€ç»ˆç›®çš„ï¼Œå³çŸ¥é“æ¯ä¸ªæ¯å­é‡Œå°çƒä¸ªæ•°çš„å¥‡å¶æ€§ï¼Œé‚£ä¹ˆå…¶å®å°±æ˜¯çŸ¥é“æ‰€æœ‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[i, i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span> çš„å¥‡å¶æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¦ä½¿å¾—æ‰€æœ‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> è¿é€šï¼Œå…¶å®å°±æ˜¯è®©æ•´ä¸ªå›¾è¿é€šï¼ˆæ³¨æ„æ­¤æ—¶çš„å›¾å¤šäº†ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ç‚¹ï¼Œå…± <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä¸ªç‚¹ï¼‰ã€‚</p><p>æŒ‰ç…§æ›´æ”¹åçš„æ–¹å¼å»å»ºå›¾ï¼Œå¯¹æ¯ä¸ªç»™å‡ºçš„åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> æ„å»ºä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">l - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> çš„æƒå€¼ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>l</mi><mo separator="true">,</mo><mi>r</mi></mrow></msub></mrow><annotation encoding="application/x-tex">c_{l, r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> çš„è¾¹ã€‚ä¸ºäº†ä½¿å¾—æ•´ä¸ªå›¾è¿é€šï¼Œå¹¶ä¸”èŠ±è´¹æœ€å°ï¼Œè¿™æ˜¾ç„¶åªéœ€è¦æˆ‘ä»¬æ±‚ä¸€ä¸‹æ‰€å»ºå›¾çš„æœ€å°ç”Ÿæˆæ ‘å³å¯ã€‚</p><p><em>æœ¬é¢˜è§£é‡‡ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>kruskal</mtext></mrow><annotation encoding="application/x-tex">\text{kruskal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">kruskal</span></span></span></span></span> æ±‚è§£æœ€å°ç”Ÿæˆæ ‘ï¼Œç›¸å¯¹ç®€å•ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>prim</mtext></mrow><annotation encoding="application/x-tex">\text{prim}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8623em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">prim</span></span></span></span></span>ã€‚</em></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">2010</span>, M = N * N;<br><br><span class="hljs-type">int</span> n, m, fa[N];<br>ll res;<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123;<span class="hljs-type">int</span> u, v, w;&#125;e[M];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123; <span class="hljs-keyword">return</span> fa[x] == x ? x : fa[x] = <span class="hljs-built_in">find</span>(fa[x]); &#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">kruskal</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) fa[i] = i;<br>    <span class="hljs-built_in">sort</span>(e + <span class="hljs-number">1</span>, e + m + <span class="hljs-number">1</span>, [](node &amp;a, node &amp;b)&#123;<br>        <span class="hljs-keyword">return</span> a.w &lt; b.w;<br>    &#125;);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i ++ )&#123;<br>        <span class="hljs-type">int</span> fx = <span class="hljs-built_in">find</span>(e[i].u), fy = <span class="hljs-built_in">find</span>(e[i].v);<br>        <span class="hljs-keyword">if</span>(fx == fy) <span class="hljs-keyword">continue</span>;<br>        fa[fy] = fx;<br>        res += e[i].w;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> l = <span class="hljs-number">1</span>; l &lt;= n; l ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> r = l; r &lt;= n; r ++ )&#123;<br>            <span class="hljs-type">int</span> x; cin &gt;&gt; x;<br>            e[ ++ m] = node&#123;l - <span class="hljs-number">1</span>, r, x&#125;;<br>        &#125;<br><br>    <span class="hljs-built_in">kruskal</span>();<br><br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="F-çªéœ²è¯ºçš„å¦–ç²¾èˆè¸ä¼š"><strong>F. çªéœ²è¯ºçš„å¦–ç²¾èˆè¸ä¼š</strong></h2><h3 id="é¢˜ç›®æè¿°-6"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šå¾ˆå¤šå¯¹ç›¸äº’è·³è¿‡èˆçš„ç”·å¥³ï¼Œè¦æ±‚é€‰æ‹©çš„äººä¸­çš„ä»»ä½•ä¸€å¯¹ç”·å¥³éƒ½æ˜¯äº’ç›¸æ²¡æœ‰è·³è¿‡èˆçš„ã€‚æ±‚æœ€å¤šå¯ä»¥é‚€è¯·å¤šå°‘äººã€‚<a href="https://www.luogu.com.cn/problem/T429167">ã€ŒYAC Round 6ã€çªéœ²è¯ºçš„å¦–ç²¾èˆè¸ä¼š</a></p><h3 id="è§£æ³•ä¸€-äºŒåˆ†å›¾æŸ“è‰²-åŒˆç‰™åˆ©ç®—æ³•-æœ€å¤§ç‹¬ç«‹é›†"><strong>è§£æ³•ä¸€ äºŒåˆ†å›¾æŸ“è‰² + åŒˆç‰™åˆ©ç®—æ³• + æœ€å¤§ç‹¬ç«‹é›†</strong></h3><p>æˆ‘ä»¬å¯ä»¥å°†é—®é¢˜æ„å»ºä¸ºæ˜¯ä¸€ä¸ªäºŒåˆ†å›¾ã€‚æˆ‘ä»¬å¯ä»¥æŠŠç”·ç”Ÿçœ‹ä½œæ˜¯å·¦éƒ¨èŠ‚ç‚¹ï¼Œå°†å¥³ç”Ÿçœ‹ä½œæ˜¯å³éƒ¨èŠ‚ç‚¹ï¼Œç”·ç”Ÿ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> å’Œå¥³ç”Ÿ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> ä¹‹é—´è·³è¿‡èˆçœ‹ä½œæ˜¯å·¦éƒ¨ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> å’Œå³éƒ¨ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> å­˜åœ¨ä¸€æ¡è¾¹ã€‚è€Œæˆ‘ä»¬è¦æ±‚å¾—ä¸€ä¸ªç‚¹é›†ï¼Œç‚¹é›†ä¸­æ‰€æœ‰ç‚¹äº’ç›¸ä¹‹é—´ä¸èƒ½å­˜åœ¨å…³ç³»ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªå®šä¹‰ï¼Œä¹Ÿå°±æ˜¯äºŒåˆ†å›¾çš„æœ€å¤§ç‹¬ç«‹é›†ï¼šä¸€ä¸ªæœ€å¤§çš„ç‚¹çš„é›†åˆï¼Œè¯¥é›†åˆå†…çš„ä»»æ„ä¸¤ç‚¹æ²¡æœ‰è¾¹ç›¸è¿ã€‚</p><p>äºŒåˆ†å›¾çš„æœ€å¤§ç‹¬ç«‹é›†æœ‰ä¸€ä¸ªå®šç†ï¼Œå°±æ˜¯ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>æœ€å¤§ç‹¬ç«‹é›†</mtext><mo>=</mo><mi>n</mi><mo>âˆ’</mo><mtext>æœ€å¤§åŒ¹é…</mtext></mrow><annotation encoding="application/x-tex">æœ€å¤§ç‹¬ç«‹é›† = n - æœ€å¤§åŒ¹é…</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">æœ€å¤§ç‹¬ç«‹é›†</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">æœ€å¤§åŒ¹é…</span></span></span></span>ï¼Œå…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> è¡¨ç¤ºå›¾ä¸­èŠ‚ç‚¹ä¸ªæ•°ã€‚ï¼ˆ<a href="https://oiwiki.org/graph/graph-matching/bigraph-match/">æœ€å¤§ç‹¬ç«‹é›† OI Wiki</a>ï¼‰</p><p>å› æ­¤ï¼Œæˆ‘ä»¬çš„é—®é¢˜å°±è½¬æ¢ä¸ºæ±‚è§£äºŒåˆ†å›¾çš„æœ€å¤§åŒ¹é…ï¼Œæœ€å¤§åŒ¹é…æ¯”è¾ƒä¼ ç»Ÿçš„æ–¹æ³•å°±æ˜¯ <strong>åŒˆç‰™åˆ©ç®—æ³•</strong>ï¼Œ æœ€åç”¨èŠ‚ç‚¹æ•°é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> å‡å»è¿™ä¸ªæœ€å¤§åŒ¹é…å³ä¸ºç­”æ¡ˆã€‚</p><p>ä½†æ˜¯ï¼Œé¢˜ç›®æ‰€ç»™çš„å…³ç³»å¹¶æ²¡æœ‰æ˜ç¡®ç»™å‡ºæ¯ä¸ªç‚¹æ˜¯ç”·ç”Ÿè¿˜æ˜¯å¥³ç”Ÿï¼Œæ•…æˆ‘ä»¬éœ€è¦å»ºå›¾ä¹‹åï¼Œå¯¹äºŒåˆ†å›¾è¿›è¡ŒæŸ“è‰²ï¼ŒæŸ“è‰²åé¢œè‰²ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> çš„æˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ˜¯å·¦éƒ¨ç‚¹ï¼Œé¢œè‰²ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> è®¤ä¸ºæ˜¯å³éƒ¨ç‚¹ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1010</span>, M = N * N;<br><br><span class="hljs-type">int</span> n, m;<br><span class="hljs-type">int</span> h[N], e[M], ne[M], idx;<br><span class="hljs-type">int</span> col[N], match[N];<br><span class="hljs-type">bool</span> st[N];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>&#123;<br>    e[ ++ idx] = b, ne[idx] = h[a], h[a] = idx;<br>&#125;<br><span class="hljs-comment">// æŸ“è‰²</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">get_col</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> c)</span></span>&#123;<br>    col[u] = c;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; i; i = ne[i])&#123;<br>        <span class="hljs-type">int</span> v = e[i];<br>        <span class="hljs-keyword">if</span>(col[v]) <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-built_in">get_col</span>(v, <span class="hljs-number">3</span> - c);<br>    &#125;<br>&#125;<br><span class="hljs-comment">// åŒˆç‰™åˆ©ç®—æ³•</span><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> u)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; i; i = ne[i])&#123;<br>        <span class="hljs-type">int</span> v = e[i];<br>        <span class="hljs-keyword">if</span>(!st[v])&#123;<br>            st[v] = <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">if</span>(!match[v] || <span class="hljs-built_in">find</span>(match[v]))&#123;<br>                match[v] = u;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">while</span>(m -- )&#123;<br>        <span class="hljs-type">int</span> u, v; cin &gt;&gt; u &gt;&gt; v;<br>        u ++ , v ++ ;<br>        <span class="hljs-built_in">add</span>(u, v), <span class="hljs-built_in">add</span>(v, u);<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-keyword">if</span>(!col[i]) <span class="hljs-built_in">get_col</span>(i, <span class="hljs-number">1</span>);<br><br>    <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-keyword">if</span>(col[i] != <span class="hljs-number">1</span>) <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-built_in">memset</span>(st, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> st);<br>        res += <span class="hljs-built_in">find</span>(i);<br>    &#125;<br><br>    cout &lt;&lt; n - res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è§£æ³•äºŒ-äºŒåˆ†å›¾æŸ“è‰²-æœ€å¤§æµ-æœ€å¤§ç‹¬ç«‹é›†"><strong>è§£æ³•äºŒ äºŒåˆ†å›¾æŸ“è‰² + æœ€å¤§æµ + æœ€å¤§ç‹¬ç«‹é›†</strong></h3><p>æ±‚äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ä¹Ÿå°†äºŒåˆ†å›¾è½¬æ¢ä¸ºæœ€å¤§æµæ¨¡å‹ï¼Œæ‰€æ±‚æœ€å¤§æµå°±æ˜¯äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ã€‚ï¼ˆæœ€å¤§æµç®—æ³•è¾ƒéš¾ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å¤šäº†è§£äº†è§£ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> inf = <span class="hljs-number">0x3f3f3f3f</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1010</span>, M = N * N;<br><br><span class="hljs-type">int</span> n, m;<br><span class="hljs-type">int</span> h[N], e[M], ne[M], w[M], idx;<br><span class="hljs-type">int</span> src, des, res; <span class="hljs-comment">// æºç‚¹ æ±‡ç‚¹ æœ€å¤§æµ</span><br><span class="hljs-type">int</span> now[M], d[N];  <span class="hljs-comment">// å½“å‰å¼§ï¼Œ ç‚¹çš„å±‚æ¬¡</span><br><span class="hljs-type">int</span> col[N];<br><span class="hljs-type">int</span> g[N][N];       <span class="hljs-comment">// é¢„å…ˆå­˜å‚¨å…³ç³»</span><br><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">int</span> c)</span></span>&#123;<br>    e[idx] = b, ne[idx] = h[a], w[idx] = c, h[a] = idx ++ ;<br>    e[idx] = a, ne[idx] = h[b], w[idx] = <span class="hljs-number">0</span>, h[b] = idx ++ ;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">get_col</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> c)</span></span>&#123;<br>    col[u] = c;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> v = <span class="hljs-number">1</span>; v &lt;= n; v ++ )&#123;<br>        <span class="hljs-keyword">if</span>(!g[u][v] || col[v]) <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-built_in">get_col</span>(v, <span class="hljs-number">3</span> - c);<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">memset</span>(d, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> d);<br>    queue&lt;<span class="hljs-type">int</span>&gt; q;<br>    q.<span class="hljs-built_in">push</span>(src), d[src] = <span class="hljs-number">0</span>;<br>    now[src] = h[src];<br><br>    <span class="hljs-keyword">while</span>(!q.<span class="hljs-built_in">empty</span>())&#123;<br>        <span class="hljs-type">int</span> u = q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; ~i; i = ne[i])&#123;<br>            <span class="hljs-type">int</span> v = e[i], c = w[i];<br>            <span class="hljs-keyword">if</span>(!c || ~d[v]) <span class="hljs-keyword">continue</span>;<br><br>            q.<span class="hljs-built_in">push</span>(v), d[v] = d[u] + c;<br>            now[v] = h[v];<br><br>            <span class="hljs-keyword">if</span>(v == des) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> flow)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(u == des) <span class="hljs-keyword">return</span> flow;<br>    <span class="hljs-type">int</span> used = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = now[u]; ~i &amp;&amp; used &lt; flow; i = ne[i])&#123;<br>        now[u] = i;<br>        <span class="hljs-type">int</span> v = e[i], c = w[i];<br>        <span class="hljs-keyword">if</span>(c &amp;&amp; d[v] == d[u] + c)&#123;<br>            <span class="hljs-type">int</span> f = <span class="hljs-built_in">dfs</span>(v, <span class="hljs-built_in">min</span>(c, flow - used));<br>            w[i] -= f, w[i ^ <span class="hljs-number">1</span>] += f;<br>            used += f;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> used;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dinic</span><span class="hljs-params">()</span></span>&#123; <span class="hljs-comment">// æœ€å¤§æµ</span><br>    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">bfs</span>()) res += <span class="hljs-built_in">dfs</span>(src, inf);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);<br>    cin &gt;&gt; n &gt;&gt; m;<br><br>    src = <span class="hljs-number">0</span>, des = n + <span class="hljs-number">1</span>; <span class="hljs-comment">// æºç‚¹ æ±‡ç‚¹</span><br>    <span class="hljs-keyword">while</span>(m -- )&#123;<br>        <span class="hljs-type">int</span> u, v; cin &gt;&gt; u &gt;&gt; v;<br>        u ++ , v ++ ;<br>        g[u][v] = g[v][u] = <span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-keyword">if</span>(!col[i]) <span class="hljs-built_in">get_col</span>(i, <span class="hljs-number">1</span>);<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-keyword">if</span>(col[i] == <span class="hljs-number">1</span>) <span class="hljs-built_in">add</span>(src, i, <span class="hljs-number">1</span>); <span class="hljs-comment">// æºç‚¹è¿å‘å·¦éƒ¨ç‚¹</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-built_in">add</span>(i, des, <span class="hljs-number">1</span>);  <span class="hljs-comment">// å³éƒ¨ç‚¹è¿å‘æ±‡ç‚¹</span><br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>            <span class="hljs-keyword">if</span>(col[i] == <span class="hljs-number">1</span> &amp;&amp; col[j] == <span class="hljs-number">2</span> &amp;&amp; g[i][j]) <span class="hljs-built_in">add</span>(i, j, <span class="hljs-number">1</span>);<br><br>    <span class="hljs-built_in">dinic</span>();<br><br>    cout &lt;&lt; n - res &lt;&lt; endl;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å’å”±å…‰èŠ’</category>
      
      <category>YAC æ‰¬å·å¤§å­¦ç®—æ³•ç»ƒä¹ èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>ç®—æ³•ç«èµ›</tag>
      
      <tag>Luogu</tag>
      
      <tag>YAC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 YAC Round 5 é¢˜è§£</title>
    <link href="/2024/12/14/YAC_Round_5/"/>
    <url>/2024/12/14/YAC_Round_5/</url>
    
    <content type="html"><![CDATA[<h2 id="A-çªéœ²è¯ºçš„ç›¸äº¤çº¿æ®µ"><strong>A. çªéœ²è¯ºçš„ç›¸äº¤çº¿æ®µ</strong></h2><h3 id="é¢˜ç›®æè¿°"><strong>é¢˜ç›®æè¿°</strong></h3><p>åœ¨äºŒç»´å¹³é¢ä¸­ï¼Œç»™å®šä¸€æ¡ä¸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> è½´å¹³è¡Œçš„çº¿æ®µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">AB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> å’Œ ä¸€æ¡ä¸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> è½´å¹³è¡Œçš„çº¿æ®µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">CD</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>ã€‚çº¿æ®µå¯ä»¥æ²¿ç€åæ ‡è½´æ–¹å‘å¹³ç§»ä»»æ„å•ä½é•¿åº¦ï¼Œè®°ä¸ºä¸€æ¬¡æ“ä½œï¼Œé—®éœ€è¦å‡ æ¬¡æ“ä½œä½¿å¾—ä¸¤æ¡çº¿æ®µç›¸äº¤ã€‚<a href="https://www.luogu.com.cn/problem/T426259">ã€ŒYAC Round 5ã€çªéœ²è¯ºçš„ç›¸äº¤çº¿æ®µ</a></p><h3 id="è§£é¢˜æ€è·¯-åŸºç¡€è®¡ç®—å‡ ä½•"><strong>è§£é¢˜æ€è·¯ åŸºç¡€è®¡ç®—å‡ ä½•</strong></h3><p>ç”±é¢˜æ„ä¸¤æ¡çº¿æ®µåˆ†åˆ«ä¸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> è½´å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> è½´å¹³è¡Œï¼Œå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>A</mi></msub><mo>&lt;</mo><msub><mi>x</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">x_A &lt; x_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>A</mi></msub><mo>=</mo><msub><mi>y</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">y_A = y_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>C</mi></msub><mo>=</mo><msub><mi>x</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">x_C = x_D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>C</mi></msub><mo>&lt;</mo><msub><mi>y</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">y_C &lt; y_D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚æ˜¾ç„¶ï¼Œåªè¦åŒæ—¶æ»¡è¶³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>A</mi></msub><mo>â‰¤</mo><msub><mi>x</mi><mi>C</mi></msub><mo>â‰¤</mo><msub><mi>x</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">x_A \le x_C \le x_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>C</mi></msub><mo>â‰¤</mo><msub><mi>y</mi><mi>A</mi></msub><mo>â‰¤</mo><msub><mi>y</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">y_C \le y_A \le y_D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> è¿™ä¸¤ä¸ªæ¡ä»¶æ—¶ï¼Œä¸¤æ¡çº¿æ®µç›¸äº¤ã€‚ç”±äºæ¯æ¬¡æ“ä½œå¯ä»¥æ²¿ç€åæ ‡è½´ï¼ˆä¸Šä¸‹å·¦å³ï¼‰<strong>ä»»æ„ç§»åŠ¨ä»»ä½•é•¿åº¦</strong>ï¼Œæ•…åªéœ€è¦åˆ¤æ–­åˆå§‹æƒ…å†µä¸‹çš„ä¸¤æ¡çº¿æ®µæ»¡è¶³æ¡ä»¶çš„ä¸ªæ•°ï¼Œå³å¯å¾—åˆ°ç­”æ¡ˆã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-type">int</span> x[<span class="hljs-number">4</span>], y[<span class="hljs-number">4</span>];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i ++ ) cin &gt;&gt; x[i] &gt;&gt; y[i];<br>        <span class="hljs-type">bool</span> flag1 = (x[<span class="hljs-number">0</span>] &lt;= x[<span class="hljs-number">2</span>] &amp;&amp; x[<span class="hljs-number">2</span>] &lt;= x[<span class="hljs-number">1</span>]);<br>        <span class="hljs-type">bool</span> flag2 = (y[<span class="hljs-number">2</span>] &lt;= y[<span class="hljs-number">0</span>] &amp;&amp; y[<span class="hljs-number">0</span>] &lt;= y[<span class="hljs-number">3</span>]);<br>        <br>        <span class="hljs-keyword">if</span>(flag1 &amp;&amp; flag2) cout &lt;&lt; <span class="hljs-number">0</span> &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(flag1 || flag2) cout &lt;&lt; <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>        <span class="hljs-keyword">else</span> cout &lt;&lt; <span class="hljs-number">2</span> &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="B-å®ˆçŸ¢æ–—ç‰›ä¸‰ç¼ºä¸€"><strong>B. å®ˆçŸ¢æ–—ç‰›ä¸‰ç¼ºä¸€</strong></h2><h3 id="é¢˜ç›®æè¿°-2"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šäº”ä¸ªä¸è¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span> çš„æ­£æ•´æ•°ï¼Œåˆ¤æ–­æ˜¯å¦å¯ä»¥å‡‘å‡ºå…¶ä¸­ä¸‰ä¸ªæ•°å­—ä¹‹å’Œä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span> çš„å€æ•°ã€‚å¦‚æœå¯ä»¥ï¼Œè¾“å‡ºå‰©ä¸‹ä¸¤ä¸ªæ•°å­—ä¹‹å’Œé™¤ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span> å¾—åˆ°çš„ä½™æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼ˆç‰¹åˆ«åœ°ï¼Œä½™æ•°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œè¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span>ï¼‰ï¼›å¦åˆ™è¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ã€‚<a href="https://www.luogu.com.cn/problem/T426258">ã€ŒYAC Round 5ã€å®ˆçŸ¢æ–—ç‰›ä¸‰ç¼ºä¸€</a></p><h3 id="è§£æ³•ä¸€-é€’å½’ï¼ˆå…¨æ’åˆ—ï¼‰"><strong>è§£æ³•ä¸€ é€’å½’ï¼ˆå…¨æ’åˆ—ï¼‰</strong></h3><p>æˆ‘ä»¬å¯ä»¥é€’å½’æšä¸¾å…¨æ’åˆ—ï¼Œæ¯æ¬¡é€‰å–æ’åˆ—çš„å‰ä¸‰ä¸ªæ•°ï¼Œçœ‹è¿™ä¸‰ä¸ªæ•°ä¹‹å’Œæ˜¯å¦æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span> çš„å€æ•°ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è®°å½•å‰©ä½™ä¸¤ä¸ªæ•°ä¹‹å’Œé™¤ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span> å¾—åˆ°çš„ç­”æ¡ˆã€‚</p><p>å¤æ‚åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">!</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n!)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">!)</span></span></span></span>ï¼Œä½†æ˜¯ç”±äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">n=5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span>ï¼Œä¸”æ•°æ®ç»„æ•°ä¸è¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span>ï¼Œå¤§æ¦‚éœ€è¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1.2</mn></mrow><annotation encoding="application/x-tex">1.2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.2</span></span></span></span> ç§’å·¦å³ã€‚ç‰¹æ„æ²¡æœ‰å¡è¿™ä¸ªåšæ³•ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-type">int</span> a[<span class="hljs-number">6</span>];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">5</span>; i ++ ) cin &gt;&gt; a[i];<br>        <span class="hljs-built_in">sort</span>(a + <span class="hljs-number">1</span>, a + <span class="hljs-number">6</span>);<br>        <br>        <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">do</span>&#123;<br>            <span class="hljs-type">int</span> sum = a[<span class="hljs-number">1</span>] + a[<span class="hljs-number">2</span>] + a[<span class="hljs-number">3</span>];<br>            <span class="hljs-keyword">if</span>(sum % <span class="hljs-number">10</span> == <span class="hljs-number">0</span>) res = <span class="hljs-built_in">max</span>(res, (a[<span class="hljs-number">4</span>] + a[<span class="hljs-number">5</span>] - <span class="hljs-number">1</span>) % <span class="hljs-number">10</span> + <span class="hljs-number">1</span>);<br>        &#125;<span class="hljs-keyword">while</span>(<span class="hljs-built_in">next_permutation</span>(a + <span class="hljs-number">1</span>, a + <span class="hljs-number">6</span>));<br><br>        cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è§£æ³•äºŒ-æšä¸¾"><strong>è§£æ³•äºŒ æšä¸¾</strong></h3><p>æˆ‘ä»¬å¯ä»¥åè¿‡æ¥æ€è€ƒã€‚åªéœ€è¦ä¸¤ä¸¤æšä¸¾æ•°å­—ï¼Œåˆ¤æ–­å‰©ä¸‹ä¸‰ä¸ªæ•°å­—ä¹‹å’Œæ˜¯å¦æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span> çš„å€æ•°å³å¯ã€‚æ•…æˆ‘ä»¬éœ€è¦å…ˆæ±‚å‡ºäº”ä¸ªæ•°å­—ä¹‹å’Œï¼Œç„¶åä¸¤ä¸¤æšä¸¾è®°å½•ç­”æ¡ˆã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-type">int</span> a[<span class="hljs-number">6</span>];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br>    <br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        <span class="hljs-type">int</span> sum = <span class="hljs-number">0</span>, res = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">5</span>; i ++ ) cin &gt;&gt; a[i], sum += a[i];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">5</span>; i ++ )<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = i + <span class="hljs-number">1</span>; j &lt;= <span class="hljs-number">5</span>; j ++ )<br>                <span class="hljs-keyword">if</span>((sum - (a[i] + a[j])) % <span class="hljs-number">10</span> == <span class="hljs-number">0</span>)<br>                    res = <span class="hljs-built_in">max</span>(res, (a[i] + a[j] - <span class="hljs-number">1</span>) % <span class="hljs-number">10</span> + <span class="hljs-number">1</span>);<br>        cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è§£æ³•ä¸‰-æ•°å­¦-æšä¸¾"><strong>è§£æ³•ä¸‰ æ•°å­¦ + æšä¸¾</strong></h3><p>äº”ä¸ªéº»å°†æ•°å­—ä¹‹å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span> é™¤ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span> å¾—åˆ°ä½™æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼Œæ ¹æ®éº»å°†æ–—ç‰›çš„è§„åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè¿™äº”ä¸ªæ•°å­—æœ€ç»ˆè¦ä¹ˆå°±æ˜¯ ç‰› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼ˆç‰¹åˆ«çš„ï¼Œä½™æ•°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> æ—¶å¯¹åº”ç‰› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span>ï¼‰ï¼Œè¦ä¹ˆå°±æ˜¯æ— ç‰›ã€‚è¿™ä¹ŸéªŒè¯äº†ä¸€å‰¯éº»å°†ä¸ä¼šå‡‘å‡ºå…¶ä»–çš„ç‰›ã€‚</p><p>å‡è®¾æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><mi>m</mi><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><mo>â€¦</mo><mo>+</mo><msub><mi>a</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">sum = a_1 + a_2 + \ldots + a_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>s</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">x = sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>mod</mtext></mrow><annotation encoding="application/x-tex">\text{mod}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">mod</span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span>ã€‚è‹¥æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a_i + a_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>mod</mtext></mrow><annotation encoding="application/x-tex">\text{mod}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">mod</span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">10 = x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼Œé‚£ä¹ˆå‰©ä½™çš„æ•°å­—ä¹‹å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>mod</mtext></mrow><annotation encoding="application/x-tex">\text{mod}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">mod</span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span> æ˜¾ç„¶ç­‰äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ã€‚ï¼ˆå–ä½™è¿ç®—çš„åŠ æ³•æ€§è´¨ï¼‰</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦å…ˆæ±‚å‡ºäº”ä¸ªæ•°å­—ä¹‹å’Œé™¤ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span> çš„ä½™æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼Œç„¶åä¸¤ä¸¤æšä¸¾æ˜¯å¦å­˜åœ¨ä¸¤ä¸ªæ•°å­—ä¹‹å’Œé™¤ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span> çš„ä½™æ•°æ­£å¥½æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ã€‚å¦‚æœå­˜åœ¨ï¼Œé‚£ä¹ˆç›´æ¥è®°å½•ç­”æ¡ˆå¹¶é€€å‡ºï¼›å¦åˆ™å°±æ˜¯æ— ç‰›ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-type">int</span> a[<span class="hljs-number">6</span>];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">work</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">5</span>; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = i + <span class="hljs-number">1</span>; j &lt;= <span class="hljs-number">5</span>; j ++ )<br>            <span class="hljs-keyword">if</span>((a[i] + a[j] - <span class="hljs-number">1</span>) % <span class="hljs-number">10</span> + <span class="hljs-number">1</span> == x)<br>                <span class="hljs-keyword">return</span> x;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br>    <br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        <span class="hljs-type">int</span> sum = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">5</span>; i ++ ) cin &gt;&gt; a[i], sum += a[i];<br>        <span class="hljs-type">int</span> x = (sum - <span class="hljs-number">1</span>) % <span class="hljs-number">10</span> + <span class="hljs-number">1</span>;<br>        cout &lt;&lt; <span class="hljs-built_in">work</span>(x) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="C-ç§˜ç¥æ‘©å¤šç½—"><strong>C. ç§˜ç¥æ‘©å¤šç½—</strong></h2><h3 id="é¢˜ç›®æè¿°-3"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªå®Œå…¨å›¾ï¼Œæ¯ä¸ªç‚¹æœ‰ä¸€ä¸ªç‚¹æƒ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œä¸¤ä¸ªç‚¹ä¹‹é—´çš„è¾¹æƒä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>âˆ’</mo><mn>2</mn><mo>Ã—</mo><msub><mi>a</mi><mi>j</mi></msub><mo>+</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">a_i - 2 \times a_j + c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>ï¼Œå…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> ä¸ºå¸¸æ•°ã€‚æ¯æ¬¡è¯¢é—®ä¸€ä¸ªç‚¹é›†ï¼Œæ±‚åŒ…å«ç‚¹é›†çš„æœ€çŸ­ç®€å•è·¯å¾„é•¿åº¦ã€‚ï¼ˆä¿è¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>âˆ’</mo><mn>2</mn><mo>Ã—</mo><msub><mi>a</mi><mi>j</mi></msub><mo>+</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">a_i - 2 \times a_j + c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> éè´Ÿï¼‰<a href="https://www.luogu.com.cn/problem/T426518">ã€ŒYAC Round 5ã€ç§˜ç¥æ‘©å¤šç½—</a></p><h3 id="è§£é¢˜æ€è·¯-è´ªå¿ƒ"><strong>è§£é¢˜æ€è·¯ è´ªå¿ƒ</strong></h3><p>è¿™é¢˜å’Œå›¾è®ºæ²¡æœ‰ä»€ä¹ˆå…³ç³»ã€‚</p><p>å¯¹äºä¸€ä¸ªç‚¹é›† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>ï¼Œå…¶å¤§å°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ï¼Œæˆ‘ä»¬å°†ç‚¹é›†ä¸­çš„ç‚¹æ˜ å°„åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mtext>Â </mtext><mi>k</mi></mrow><annotation encoding="application/x-tex">1 ~ k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">1</span><span class="mspace nobreak">Â </span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ã€‚æˆ‘ä»¬å¯ä»¥å…ˆçœ‹ä¸€ä¸‹ï¼Œç®€å•è·¯å¾„ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>â†’</mo><mn>2</mn><mo>â†’</mo><mo>â‹¯</mo><mo>â†’</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">1 \rightarrow 2 \rightarrow \dots \rightarrow k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> å¾—åˆ°çš„è·¯å¾„é•¿åº¦ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>âˆ’</mo><mn>2</mn><mo>Ã—</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><mi>c</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mn>2</mn></msub><mo>âˆ’</mo><mn>2</mn><mo>Ã—</mo><msub><mi>a</mi><mn>3</mn></msub><mo>+</mo><mi>c</mi><mo stretchy="false">)</mo><mo>+</mo><mo>â€¦</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>âˆ’</mo><mn>2</mn><mo>Ã—</mo><msub><mi>a</mi><mi>k</mi></msub><mo>+</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a_1 - 2 \times a_2 + c) + (a_2 - 2 \times a_3 + c) + \dots (a_{k-1} - 2 \times a_k + c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span></span></p><p>æ˜¾ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆå¹¶å¹¶æ¶ˆå»ä¸€äº›é¡¹ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi>a</mi><mn>2</mn></msub><mo>âˆ’</mo><mo>â‹¯</mo><mo>âˆ’</mo><msub><mi>a</mi><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>âˆ’</mo><mn>2</mn><mo>Ã—</mo><msub><mi>a</mi><mi>k</mi></msub><mo>+</mo><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">a_1 - a_2 - \dots - a_{k-1} - 2 \times a_k + (k-1) \times c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span></p><p>åŒ–ç®€å¯å¾—ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>2</mn><mo>Ã—</mo><msub><mi>a</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi>a</mi><mi>k</mi></msub><mo>+</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><mo stretchy="false">(</mo><mo>âˆ’</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">2 \times a_1 - a_k + \sum_{i=1}^k (-a_i) + (k-1) \times c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.1138em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span></p><p>æ•…æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œç®€å•è·¯å¾„çš„é•¿åº¦ <strong>åªå’Œèµ·ç‚¹å’Œç»ˆç‚¹æœ‰å…³</strong>ã€‚</p><p>è€Œæˆ‘ä»¬éœ€è¦è®©é•¿åº¦å°½å¯èƒ½å°ï¼Œæ˜¾ç„¶ï¼Œæˆ‘ä»¬åªéœ€è¦æœ€å°åŒ– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">a_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå¹¶æœ€å¤§åŒ– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">a_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å³å¯ã€‚æ•…å¯¹äºæ¯æ¬¡è¯¢é—®çš„ç‚¹é›†ï¼Œæˆ‘ä»¬åªéœ€è¦è®°å½•ç‚¹é›†ä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚å¯¹äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mo stretchy="false">(</mo><mo>âˆ’</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sum_{i=1}^k (-a_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2887em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.989em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ï¼Œåªéœ€è¦åœ¨è®°å½•æœ€å¤§å’Œæœ€å°å€¼çš„åŒæ—¶ç´¯åŠ ä¸€ä¸‹å³å¯ã€‚ï¼ˆæ³¨æ„å¼€ long longï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> n, c, q; cin &gt;&gt; n &gt;&gt; c &gt;&gt; q;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">a</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br><br>    <span class="hljs-keyword">while</span>(q -- )&#123;<br>        <span class="hljs-type">int</span> k, mn = <span class="hljs-number">1e9</span>, mx = <span class="hljs-number">0</span>; cin &gt;&gt; k;<br>        ll sum = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, x; i &lt;= k; i ++ )&#123;<br>            cin &gt;&gt; x;<br>            mn = <span class="hljs-built_in">min</span>(mn, a[x]), mx = <span class="hljs-built_in">max</span>(mx, a[x]);<br>            sum -= a[x];<br>        &#125;<br>        cout &lt;&lt; (<span class="hljs-number">2ll</span> * mn - mx + sum + (ll)(k - <span class="hljs-number">1</span>) * c) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="D-å¼‚æˆ–æ“ä½œçœŸæ˜¯å¤ªæ£’å•¦"><strong>D. å¼‚æˆ–æ“ä½œçœŸæ˜¯å¤ªæ£’å•¦</strong></h2><h3 id="é¢˜ç›®æè¿°-4"><strong>é¢˜ç›®æè¿°</strong></h3><p>ä¸¤ç§æ“ä½œï¼Œç¬¬ä¸€ç§ä¸ºä¿®æ”¹ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä¸ªæ•°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼›ç¬¬äºŒç§ä¸ºè¯¢é—®ä¸€ä¸ªåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>ï¼Œæ±‚å‡ºåŒºé—´å†… <strong>æ‰€æœ‰å­åŒºé—´å¼‚æˆ–å’Œçš„å¼‚æˆ–å’Œ</strong>ã€‚<a href="https://www.luogu.com.cn/problem/T426567">https://www.luogu.com.cn/problem/T426567</a></p><h3 id="è§£é¢˜æ€è·¯-æ ‘çŠ¶æ•°ç»„-ä½è¿ç®—"><strong>è§£é¢˜æ€è·¯ æ ‘çŠ¶æ•°ç»„ + ä½è¿ç®—</strong></h3><p>å¯¹äºåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>ï¼Œæ ¹æ®æŒ‰ä½å¼‚æˆ–çš„äº¤æ¢å¾‹ä»¥åŠä¸¤ä¸ªç›¸ç­‰çš„æ•°å¼‚æˆ–æŠµæ¶ˆä¸º 0 çš„æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼š</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>l</mi></msub><mo>âŠ•</mo><msub><mi>a</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>âŠ•</mo><mo>â‹¯</mo><mo>âŠ•</mo><msub><mi>a</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">a_l \oplus a_{l+1} \oplus \dots \oplus a_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æŠµæ¶ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mi>l</mi></msub><mo>âŠ•</mo><msub><mi>a</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>âŠ•</mo><mo>â‹¯</mo><mo>âŠ•</mo><msub><mi>a</mi><mi>r</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a_l \oplus a_{l+1} \oplus \dots \oplus a_r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mi>l</mi></msub><mo>âŠ•</mo><msub><mi>a</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>âŠ•</mo><msub><mi>a</mi><mrow><mi>l</mi><mo>+</mo><mn>2</mn></mrow></msub><mo stretchy="false">)</mo><mo>âŠ•</mo><mo>â‹¯</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mrow><mi>r</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>âŠ•</mo><msub><mi>a</mi><mi>r</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a_l \oplus a_{l+1}) \oplus (a_{l+1} \oplus a_{l+2}) \oplus \dots \oplus (a_{r-1} \oplus a_{r})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> æŠµæ¶ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mi>l</mi></msub><mo>âŠ•</mo><msub><mi>a</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>âŠ•</mo><msub><mi>a</mi><mrow><mi>l</mi><mo>+</mo><mn>2</mn></mrow></msub><mo>âŠ•</mo><mo>â‹¯</mo><mo>âŠ•</mo><msub><mi>a</mi><mrow><mi>r</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>âŠ•</mo><msub><mi>a</mi><mrow><mi>l</mi><mo>+</mo><mn>2</mn></mrow></msub><mo>âŠ•</mo><mo>â‹¯</mo><mo>âŠ•</mo><msub><mi>a</mi><mrow><mi>r</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>âŠ•</mo><msub><mi>a</mi><mi>r</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a_l \oplus a_{l+1} \oplus a_{l+2} \oplus \dots \oplus a_{r-1}) \oplus (a_{l+1} \oplus a_{l+2} \oplus \dots \oplus a_{r-1} \oplus a_{r})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â€¦</mo></mrow><annotation encoding="application/x-tex">\dots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.123em;"></span><span class="minner">â€¦</span></span></span></span> ä»¥æ­¤ç±»æ¨</p><p>å› æ­¤ï¼Œå½“åŒºé—´é•¿åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>âˆ’</mo><mi>l</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r - l + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä¸ºå¶æ•°æ—¶ï¼Œæ‰€æœ‰é¡¹å…¨éƒ¨æŠµæ¶ˆä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼›</p><p>è€Œå½“åŒºé—´é•¿åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>âˆ’</mo><mi>l</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r - l + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä¸ºå¥‡æ•°æ—¶ï¼Œè®° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>e</mi><mi>n</mi><mo>=</mo><mi>r</mi><mo>âˆ’</mo><mi>l</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">len = r - l + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œåˆ™æœ€åå‰©ä¸‹çš„æ˜¯ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mi>l</mi></msub><mo>âŠ•</mo><msub><mi>a</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>âŠ•</mo><mo>â‹¯</mo><mo>âŠ•</mo><msub><mi>a</mi><mfrac><mrow><mi>l</mi><mi>e</mi><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></mfrac></msub><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>âŠ•</mo><msub><mi>a</mi><mrow><mi>l</mi><mo>+</mo><mn>2</mn></mrow></msub><mo>âŠ•</mo><mo>â‹¯</mo><mo>âŠ•</mo><msub><mi>a</mi><mfrac><mrow><mi>l</mi><mi>e</mi><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></mfrac></msub><mo>âŠ•</mo><msub><mi>a</mi><mrow><mfrac><mrow><mi>l</mi><mi>e</mi><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>âŠ•</mo><mo>â‹¯</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mfrac><mrow><mi>l</mi><mi>e</mi><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></mfrac></msub><mo>âŠ•</mo><msub><mi>a</mi><mrow><mfrac><mrow><mi>l</mi><mi>e</mi><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo>+</mo><mn>1</mn></mrow></msub><mo>âŠ•</mo><mo>â‹¯</mo><mo>âŠ•</mo><msub><mi>a</mi><mi>r</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a_l \oplus a_{l+1} \oplus \dots \oplus a_{\frac{len + 1}{2}}) \oplus (a_{l+1} \oplus a_{l+2} \oplus \dots \oplus a_{\frac{len + 1}{2}} \oplus a_{\frac{len + 1}{2} + 1}) \oplus \dots \oplus (a_{\frac{len + 1}{2}} \oplus a_{\frac{len + 1}{2} + 1} \oplus \dots \oplus a_{r})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.262em;vertical-align:-0.512em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.7288em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.88em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.512em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0953em;vertical-align:-0.512em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.7288em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.88em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.512em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.262em;vertical-align:-0.512em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.7288em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.88em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.512em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.262em;vertical-align:-0.512em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.7288em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.88em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.512em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0953em;vertical-align:-0.512em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.7288em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.88em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.512em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>å¯ä»¥å‘ç°ï¼ŒåŒºé—´å†… <strong>ç¬¬å¥‡æ•°ä¸ªå…ƒç´ </strong>ï¼Œç»è¿‡æŠµæ¶ˆåæœ€åè¿˜å‰©ä¸‹ä¸€ä¸ªï¼Œè€Œ <strong>ç¬¬å¶æ•°ä¸ªå…ƒç´ </strong>ï¼Œå…¨éƒ¨æŠµæ¶ˆã€‚</p><p>æ•…å¯¹äºæ¯æ¬¡è¯¢é—®çš„åŒºé—´ï¼Œæˆ‘ä»¬åªéœ€è¦è¾“å‡ºåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> å†…æ‰€æœ‰ç¬¬å¥‡æ•°ä¸ªå…ƒç´ çš„å¼‚æˆ–å’Œå³å¯ã€‚</p><p>ç”±äºæ¶‰åŠåˆ°å•ç‚¹ä¿®æ”¹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¼€ä¸¤ä¸ªæ ‘çŠ¶æ•°ç»„ï¼Œä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><msub><mi>r</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">tr_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord mathnormal">t</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><msub><mi>r</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">tr_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord mathnormal">t</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œåˆ†åˆ«ç»´æŠ¤æ•°ç»„ä¸­å¶æ•°ä½çš„å¼‚æˆ–å’Œ ä¸ å¥‡æ•°ä½çš„å¼‚æˆ–å’Œã€‚</p><p>å¯¹äºåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l,r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>ï¼Œå¦‚æœåŒºé—´é•¿åº¦ä¸ºå¶æ•°ï¼Œé‚£ä¹ˆå°±ç›´æ¥è¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼›</p><p>å¦‚æœåŒºé—´é•¿åº¦ä¸ºå¥‡æ•°ï¼Œè‹¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> ä¸ºå¥‡æ•°ï¼Œé‚£ä¹ˆåªéœ€è¦å–å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><msub><mi>r</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">tr_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord mathnormal">t</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸­å¯¹åº”çš„åŒºé—´å¼‚æˆ–å’Œå³å¯ï¼›è‹¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> ä¸ºå¶æ•°ï¼Œé‚£ä¹ˆå–å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><msub><mi>r</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">tr_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord mathnormal">t</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸­å¯¹åº”çš„åŒºé—´å¼‚æˆ–å’Œå³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> lowbit(x) (x) &amp; (-x)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">2e5</span> + <span class="hljs-number">10</span>;<br><span class="hljs-type">int</span> a[N], n, q;<br><span class="hljs-type">int</span> tr[<span class="hljs-number">2</span>][N]; <span class="hljs-comment">// ä¸¤ä¸ªæ ‘çŠ¶æ•°ç»„ç»´æŠ¤å¥‡æ•°ä½å’Œå¶æ•°ä½å¼‚æˆ–å’Œ</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> flag, <span class="hljs-type">int</span> x, <span class="hljs-type">int</span> c)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = x; i &lt;= n; i += <span class="hljs-built_in">lowbit</span>(i)) tr[flag][i] ^= c;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-type">int</span> flag, <span class="hljs-type">int</span> x)</span></span>&#123;<br>    <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = x; i; i -= <span class="hljs-built_in">lowbit</span>(i)) res ^= tr[flag][i];<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; q;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i], <span class="hljs-built_in">add</span>(i &amp; <span class="hljs-number">1</span>, i, a[i]); <br>    <span class="hljs-keyword">while</span>(q -- )&#123;<br>        <span class="hljs-type">int</span> op; cin &gt;&gt; op;<br>        <span class="hljs-keyword">if</span>(op == <span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-type">int</span> x, c; cin &gt;&gt; x &gt;&gt; c;<br>            <span class="hljs-built_in">add</span>(x &amp; <span class="hljs-number">1</span>, x, a[x] ^ c), a[x] = c; <span class="hljs-comment">// ä¿®æ”¹ä¸ºcï¼Œæ³¨æ„åŸæ•°ç»„ä¹Ÿè®°å¾—ä¿®æ”¹</span><br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-type">int</span> l, r; cin &gt;&gt; l &gt;&gt; r;<br>            <span class="hljs-keyword">if</span>((r - l + <span class="hljs-number">1</span>) &amp; <span class="hljs-number">1</span>) cout &lt;&lt; (<span class="hljs-built_in">query</span>(r &amp; <span class="hljs-number">1</span>, r) ^ <span class="hljs-built_in">query</span>(r &amp; <span class="hljs-number">1</span>, l - <span class="hljs-number">1</span>)) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>            <span class="hljs-keyword">else</span> cout &lt;&lt; <span class="hljs-number">0</span> &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>; <span class="hljs-comment">// è‹¥é•¿åº¦ä¸ºå¶æ•° å…¨éƒ¨æŠµæ¶ˆ</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="E-æ²³ç«¥ç§‘æŠ€ä¸–ç•Œ-No-1ï¼"><strong>E. æ²³ç«¥ç§‘æŠ€ä¸–ç•Œ No.1ï¼</strong></h2><h3 id="é¢˜ç›®æè¿°-5"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„åºåˆ— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> ä¸ªåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>l</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l_i, r_i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>ï¼Œåœ¨åºåˆ— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> ä¸­é€‰æ‹©ä»»æ„ä¸ªæ•°ä½¿å¾—åœ¨æ»¡è¶³æ‰€æœ‰åŒºé—´å†…éƒ½æœ‰ä¸€ä¸ªæ•°è¢«é€‰æ‹©çš„æƒ…å†µä¸‹ï¼Œæ‰€é€‰æ‹©çš„æ•°å’Œæœ€å°ã€‚ <a href="https://www.luogu.com.cn/problem/T426479">ã€ŒYAC Round 5ã€æ²³ç«¥ç§‘æŠ€ä¸–ç•Œ No.1ï¼</a></p><h3 id="è§£é¢˜æ€è·¯-å•è°ƒé˜Ÿåˆ—DP"><strong>è§£é¢˜æ€è·¯ å•è°ƒé˜Ÿåˆ—DP</strong></h3><p>å‡è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">dp_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸ºè€ƒè™‘å‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªæ•°ï¼Œå¹¶ä¸”é€‰æ‹©äº†ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªæ•°çš„æœ€å°å€¼ã€‚</p><p>æˆ‘ä»¬å¯ä»¥è®¾ä¸€ä¸ªè™šæ‹Ÿæ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a_{n+1} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œé‚£ä¹ˆæœ€åçš„ç­”æ¡ˆå°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">dp_{n+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> ã€‚</p><p>çŠ¶æ€è½¬ç§»å¦‚ä¸‹ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mi>i</mi></msub><mo>=</mo><munder><mrow><mi>min</mi><mo>â¡</mo></mrow><mi>j</mi></munder><mi>d</mi><msub><mi>p</mi><mi>j</mi></msub><mo>+</mo><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">dp_i = \min_{j} dp_j + a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.5582em;vertical-align:-0.8638em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.3723em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8638em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>æ˜¾ç„¶ï¼Œè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„å¯ä»¥ç”¨å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–çš„è½¬ç§»æ–¹å¼ã€‚ä½†æ˜¯ï¼Œè½¬ç§»åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> çŠ¶æ€çš„ä¸‹æ ‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> æ˜¾ç„¶æ˜¯éœ€è¦æ»¡è¶³æŸç§è¦æ±‚çš„ã€‚å¯¹äºæ¯ä¸€ä¸ªåˆæ³•çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>ï¼Œåœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>j</mi><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(j, i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span> èŒƒå›´å†…æ˜¾ç„¶ä¸å¯ä»¥å­˜åœ¨ä¸€ä¸ªå®Œæ•´çš„åŒºé—´æ¡ä»¶ã€‚å‡å¦‚åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>j</mi><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(j, i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span> èŒƒå›´å†…å­˜åœ¨æŸä¸ªæ¡ä»¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>ï¼Œå½“ä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> è½¬ç§»åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> æ—¶ï¼Œæ˜¾ç„¶å°±ç›´æ¥æŠŠ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> ç»™å¿½ç•¥äº†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">pre</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">re</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><msub><mi>e</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">pre_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> è®°å½•çš„æ˜¯èƒ½å¤Ÿè½¬ç§»åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> çš„æœ€å°åˆæ³•çš„ä¸‹æ ‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>ã€‚</p><p>æ•…æœ‰å¦‚ä¸‹çŠ¶æ€è½¬ç§»ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mi>i</mi></msub><mo>=</mo><munder><mrow><mi>min</mi><mo>â¡</mo></mrow><mrow><mi>p</mi><mi>r</mi><msub><mi>e</mi><mi>i</mi></msub><mo>â‰¤</mo><mi>j</mi><mo>&lt;</mo><mi>i</mi></mrow></munder><mi>d</mi><msub><mi>p</mi><mi>j</mi></msub><mo>+</mo><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">dp_i = \min_{pre_i \le j &lt; i} dp_j + a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.5582em;vertical-align:-0.8638em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.3723em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">â‰¤</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8638em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>å¯¹äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><msub><mi>e</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">pre_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œæœ‰å¦‚ä¸‹è¡¨è¾¾å¼ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mi>r</mi><msub><mi>e</mi><mi>i</mi></msub><mo>=</mo><munder><mrow><mi>max</mi><mo>â¡</mo></mrow><mrow><msub><mi>r</mi><mi>k</mi></msub><mo>&lt;</mo><mi>i</mi></mrow></munder><msub><mi>l</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">pre_i = \max_{r_k &lt; i} l_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.528em;vertical-align:-0.8335em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em;"><span style="top:-2.3723em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0278em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8335em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>ä¸Šé¢çš„è¡¨è¾¾å¼ï¼Œå³ç»™å®šçš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> ä¸ªåŒºé—´æ¡ä»¶ä¸­ï¼Œæ‰€æœ‰å³ç«¯ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">r_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å°äºä¸‹æ ‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> çš„åŒºé—´çš„å·¦ç«¯ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">l_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„æœ€å¤§å€¼ã€‚æ˜¾ç„¶ï¼Œåœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>p</mi><mi>r</mi><msub><mi>e</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(pre_i, i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span> ä¹‹é—´æ˜¯ä¸å­˜åœ¨ä¸€ä¸ªå®Œæ•´çš„åŒºé—´æ¡ä»¶çš„ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–DPä¹‹å‰ï¼Œå…ˆé¢„å¤„ç†å‰ç¼€æœ€å¤§å€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><msub><mi>e</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">pre_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå…·ä½“çš„æ±‚è§£å¦‚ä»£ç æ‰€ç¤ºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">5e5</span> + <span class="hljs-number">10</span>;<br><span class="hljs-type">int</span> n, m;<br><span class="hljs-type">int</span> q[N], hh, tt; <span class="hljs-comment">// å•è°ƒé˜Ÿåˆ— dequeå®¹æ˜“è¶…æ—¶</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        cin &gt;&gt; n;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">a</span><span class="hljs-params">(n + <span class="hljs-number">2</span>)</span></span>; <span class="hljs-comment">// å¢åŠ ä¸€ä¸ªa[n+1]=0ä½œä¸ºè™šæ‹Ÿç‚¹</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br><br>        cin &gt;&gt; m;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">pre</span><span class="hljs-params">(n + <span class="hljs-number">2</span>)</span></span>; <span class="hljs-comment">// [pre[i], i) å¯ä»¥è½¬ç§»åˆ° i</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, l, r; i &lt;= m; i ++ )&#123; <span class="hljs-comment">// é¢„å¤„ç†å‰ç¼€æœ€å¤§å€¼</span><br>            cin &gt;&gt; l &gt;&gt; r;<br>            pre[r + <span class="hljs-number">1</span>] = <span class="hljs-built_in">max</span>(pre[r + <span class="hljs-number">1</span>], l); <br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= n + <span class="hljs-number">1</span>; i ++ ) pre[i] = <span class="hljs-built_in">max</span>(pre[i], pre[i - <span class="hljs-number">1</span>]);<br><br>        <span class="hljs-function">vector&lt;ll&gt; <span class="hljs-title">dp</span><span class="hljs-params">(n + <span class="hljs-number">2</span>)</span></span>;<br>        hh = <span class="hljs-number">1</span>, tt = <span class="hljs-number">0</span>;<br>        q[ ++ tt] = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n + <span class="hljs-number">1</span>; i ++ )&#123; <br>            <span class="hljs-keyword">while</span>(hh &lt;= tt &amp;&amp; q[hh] &lt; pre[i]) hh ++ ; <span class="hljs-comment">// å‡ºç•Œ</span><br>            dp[i] = dp[q[hh]] + a[i];<br>            <span class="hljs-keyword">while</span>(hh &lt;= tt &amp;&amp; dp[q[tt]] &gt;= dp[i]) tt -- ; <span class="hljs-comment">// é˜Ÿå°¾ä¸æ¯”å½“å‰æ›´ä¼˜</span><br>            q[ ++ tt] = i;<br>        &#125;<br>        cout &lt;&lt; dp[n + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="F-The-World-ä¸–ç•Œ"><strong>F. The World ä¸–ç•Œ</strong></h2><h3 id="é¢˜ç›®æè¿°-6"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> ä¸ªç‚¹å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> æ¡æœ‰å‘è¾¹çš„å›¾ï¼Œæœ€å¤šå¯ä»¥è¿›è¡Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> æ¬¡è®©ä¸€æ¡è¾¹æƒå€¼å˜ä¸ºåŸå…ˆç›¸åæ•°çš„æ“ä½œï¼Œé—® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> çš„æœ€çŸ­è·ç¦»æ˜¯å¤šå°‘ã€‚<a href="https://www.luogu.com.cn/problem/T426519">ã€ŒYAC Round 5ã€The World ä¸–ç•Œ</a></p><h3 id="è§£é¢˜æ€è·¯-å€å¢Floydï¼ˆçŸ©é˜µå¿«é€Ÿå¹‚ï¼‰"><strong>è§£é¢˜æ€è·¯ å€å¢Floydï¼ˆçŸ©é˜µå¿«é€Ÿå¹‚ï¼‰</strong></h3><p>æˆ‘ä»¬å¯ä»¥ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³è¿™ä¸ªå›¾è®ºé—®é¢˜ï¼ˆfloydï¼‰ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦é¢„å¤„ç†å¾—åˆ°ä¸ä½¿ç”¨é­”æ³•ä»¥åŠæœ€å¤šä½¿ç”¨ä¸€æ¬¡é­”æ³•å¾—åˆ°çš„æœ€çŸ­è·¯ï¼Œç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">d[i][j][p]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span></span></span></span> è¡¨ç¤ºä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> æœ€å¤šä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> æ¬¡é­”æ³•çš„æœ€çŸ­è·¯é•¿åº¦ï¼ŒçŠ¶æ€è½¬ç§»å¦‚ä¸‹ï¼š</p><ul><li><p><strong>ä¸ä½¿ç”¨é­”æ³•</strong></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>=</mo><mi>min</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>+</mo><mi>d</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d[i][j][0] = \min(d[i][j][0], d[i][k][0] + d[k][j][0])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">])</span></span></span></span></span></p><p>å°±æ˜¯æœ€ç®€å•çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Floyd</mtext></mrow><annotation encoding="application/x-tex">\text{Floyd}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">Floyd</span></span></span></span></span> æ¨¡æ¿ã€‚</p></li><li><p><strong>æœ€å¤šä½¿ç”¨ä¸€æ¬¡é­”æ³•</strong></p><p>ä¸ä½¿ç”¨é­”æ³•æœ‰å¯èƒ½æ›´ä¼˜</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>min</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d[i][j][1] = \min(d[i][j][1], d[i][j][0])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">])</span></span></span></span></span></p><p>ä½¿ç”¨ä¸€æ¬¡é­”æ³•ä¼šæ›´ä¼˜</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>min</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>+</mo><mi>d</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>âˆ’</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d[i][j][1] = \min(d[i][j][1], d[i][u][0] + d[v][j][0] - w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span></span></p><p>å…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u, v, w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span> ä¸ºæšä¸¾çš„ä½¿ç”¨é­”æ³•çš„è¾¹ã€‚</p></li></ul><p>ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”±è¿™ä¸¤ä¸ªåˆå§‹çŠ¶æ€å¾—åˆ°æœ€å¤šä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> æ¬¡é­”æ³•çš„æœ€çŸ­è·¯ã€‚çŠ¶æ€è½¬ç§»å¦‚ä¸‹ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mo>=</mo><mi>min</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>p</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mi>d</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d[i][j][p] = \min(d[i][j][p], d[i][k][p - 1] + d[k][j][1])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">])</span></span></span></span></span></p><p>ç”¨æœ€å¤šä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> æ¬¡é­”æ³•å’Œæœ€å¤šä½¿ç”¨ä¸€æ¬¡é­”æ³•è½¬ç§»å¾—åˆ°æœ€å¤šä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> æ¬¡é­”æ³•å¾—åˆ°çš„æœ€çŸ­è·¯ã€‚åœ¨æ±‚è§£æœ€å¤šä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> æ¬¡æ—¶ï¼Œæ˜¾ç„¶æœ€å¤šä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> æ¬¡é­”æ³•æ˜¯å…ˆå‰å·²ç»æ±‚å‡ºæ¥çš„ã€‚</p><p>ç»¼ä¸Šï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ä»£ç ï¼ˆé€šè¿‡ç‚¹æ•° 14 / 20ï¼‰ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">110</span>, M = <span class="hljs-number">2510</span>;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123;<span class="hljs-type">int</span> u, v, w;&#125;e[M];<br>ll d[N][N][M];<br><span class="hljs-type">int</span> n, m, K;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-built_in">memset</span>(d, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> d);<br>    cin &gt;&gt; n &gt;&gt; m &gt;&gt; K;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) d[i][i][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, u, v, w; i &lt;= m; i ++ ) &#123;<br>        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w, e[i] = node&#123;u, v, w&#125;;<br>        d[u][v][<span class="hljs-number">0</span>] = w;<br>    &#125;<br><br>    <span class="hljs-comment">// ä¸ä½¿ç”¨é­”æ³•</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>; k &lt;= n; k ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )   <br>                d[i][j][<span class="hljs-number">0</span>] = <span class="hljs-built_in">min</span>(d[i][j][<span class="hljs-number">0</span>], d[i][k][<span class="hljs-number">0</span>] + d[k][j][<span class="hljs-number">0</span>]);<br><br>    <span class="hljs-comment">// æœ€å¤šä½¿ç”¨ä¸€æ¬¡é­”æ³•</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>; k &lt;= m; k ++ )&#123;<br>        <span class="hljs-keyword">auto</span> [u, v, w] = e[k];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )&#123;<br>                <span class="hljs-keyword">if</span>(d[i][j][<span class="hljs-number">0</span>] &lt; d[i][j][<span class="hljs-number">1</span>]) d[i][j][<span class="hljs-number">1</span>] = d[i][j][<span class="hljs-number">0</span>]; <span class="hljs-comment">// ä¸ä½¿ç”¨</span><br>                d[i][j][<span class="hljs-number">1</span>] = <span class="hljs-built_in">min</span>(d[i][j][<span class="hljs-number">1</span>], d[i][u][<span class="hljs-number">0</span>] + d[v][j][<span class="hljs-number">0</span>] - w);<br>            &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// æœ€å¤šä½¿ç”¨Kæ¬¡é­”æ³•</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> p = <span class="hljs-number">2</span>; p &lt;= K; p ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>; k &lt;= n; k ++ )<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>                <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>                    d[i][j][p] = <span class="hljs-built_in">min</span>(d[i][j][p], d[i][k][p - <span class="hljs-number">1</span>] + d[k][j][<span class="hljs-number">1</span>]); <span class="hljs-comment">// i-&gt;kæœ€å¤šp-1æ¬¡ k-&gt;jæœ€å¤šä¸€æ¬¡</span><br><br>    cout &lt;&lt; d[<span class="hljs-number">1</span>][n][K] &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">K \le 10^6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span> ï¼Œä¸ä»…ç©ºé—´ä¸å¤Ÿï¼Œè€Œä¸”æ˜æ˜¾ä¼šè¶…æ—¶ã€‚ä¸è¿‡åˆ°äº†è¿™é‡Œï¼Œéƒ¨åˆ†åŒå­¦å¯èƒ½å‘ç°äº†å…ˆå‰çŠ¶æ€è½¬ç§»æœ‰ç‚¹åƒæ˜¯å¿«é€Ÿå¹‚ã€‚åœ¨å¿«é€Ÿå¹‚ä¸­ï¼Œæˆ‘ä»¬æŠŠ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>ï¼ˆå¹‚æ¬¡ï¼‰ è¿›è¡Œäº†äºŒè¿›åˆ¶æ‹†åˆ†ï¼Œåœ¨æœ¬é¢˜æˆ‘ä»¬å¯ä»¥å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">d[i][j][p]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span></span></span></span> çœ‹ä½œæ˜¯æ‰€è°“çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> æ¬¡æ–¹ï¼Œå°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">d[i][j][1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span></span></span></span> å°±çœ‹ä½œæ˜¯åŸå§‹çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>ï¼Œæ•…æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <strong>çŸ©é˜µå¿«é€Ÿå¹‚</strong> æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">110</span>, M = <span class="hljs-number">2510</span>;<br><br><span class="hljs-type">int</span> n, m, K;<br>ll d[N][N];<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123;<span class="hljs-type">int</span> u, v, w;&#125;e[M];<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Matrix</span>&#123;<br>    ll mat[N][N];<br>    <span class="hljs-built_in">Matrix</span>() &#123; <span class="hljs-built_in">memset</span>(mat, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> mat); &#125;<br>    Matrix <span class="hljs-keyword">operator</span> * (<span class="hljs-type">const</span> Matrix &amp;a)&#123; <span class="hljs-comment">// è¿ç®—ç¬¦é‡è½½</span><br>        Matrix res;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>; k &lt;= n; k ++ )<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>                <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>                    res.mat[i][j] = <span class="hljs-built_in">min</span>(res.mat[i][j], mat[i][k] + a.mat[k][j]);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;ans, base; <br><br><span class="hljs-comment">// çŸ©é˜µå¿«é€Ÿå¹‚</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">mat_qmi</span><span class="hljs-params">(<span class="hljs-type">int</span> k)</span></span>&#123;<br>    <span class="hljs-keyword">while</span>(k)&#123;<br>        <span class="hljs-keyword">if</span>(k &amp; <span class="hljs-number">1</span>) ans = ans * base;<br>        base = base * base;<br>        k &gt;&gt;= <span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">floyd</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">// ä¸ä½¿ç”¨é­”æ³•æœ€çŸ­è·¯</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>; k &lt;= n; k ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>                d[i][j] = <span class="hljs-built_in">min</span>(d[i][j], d[i][k] + d[k][j]);<br>    <span class="hljs-comment">// æœ€å¤šç”¨ä¸€æ¬¡é­”æ³•å¾—åˆ°çš„æœ€çŸ­è·¯ å³base</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>; k &lt;= m; k ++ ) &#123;<br>        <span class="hljs-keyword">auto</span> [u, v, w] = e[k];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>                base.mat[i][j] = <span class="hljs-built_in">min</span>(base.mat[i][j], <span class="hljs-built_in">min</span>(d[i][j], d[i][u] + d[v][j] - w));<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>            ans.mat[i][j] = d[i][j];<br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m &gt;&gt; K;<br><br>    <span class="hljs-built_in">memset</span>(d, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> d);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) d[i][i] = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, u, v, w; i &lt;= m; i ++ )&#123;<br>        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w, e[i] = node&#123;u, v, w&#125;;<br>        d[u][v] = w;<br>    &#125;<br><br>    <span class="hljs-built_in">floyd</span>(); <span class="hljs-comment">// æ±‚ä¸ä½¿ç”¨é­”æ³•å¾—åˆ°æœ€çŸ­è·¯ æœ€å¤šä½¿ç”¨ä¸€æ¬¡é­”æ³•å¾—åˆ°base</span><br><br>    <span class="hljs-keyword">if</span>(!K) cout &lt;&lt; d[<span class="hljs-number">1</span>][n] &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-built_in">init</span>();     <span class="hljs-comment">// æœ€çŸ­è·¯èµ‹å€¼ç»™ans</span><br>        <span class="hljs-built_in">mat_qmi</span>(K);<br>        cout &lt;&lt; ans.mat[<span class="hljs-number">1</span>][n] &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å’å”±å…‰èŠ’</category>
      
      <category>YAC æ‰¬å·å¤§å­¦ç®—æ³•ç»ƒä¹ èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>ç®—æ³•ç«èµ›</tag>
      
      <tag>Luogu</tag>
      
      <tag>YAC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 YAC Round 4 é¢˜è§£</title>
    <link href="/2024/12/14/YAC_Round_4/"/>
    <url>/2024/12/14/YAC_Round_4/</url>
    
    <content type="html"><![CDATA[<h2 id="A-åœ¨æ‰¬å¤§å¯»æ±‚ç®—ç«æ˜¯å¦æé”™äº†ä»€ä¹ˆ"><strong>A. åœ¨æ‰¬å¤§å¯»æ±‚ç®—ç«æ˜¯å¦æé”™äº†ä»€ä¹ˆ</strong></h2><h3 id="é¢˜ç›®æè¿°"><strong>é¢˜ç›®æè¿°</strong></h3><p>åˆ¤æ–­è¾“å…¥çš„æ­£æ•´æ•°æ˜¯å¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰¤</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">\le 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span>ï¼Œè‹¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰¤</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">\le 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span> è¾“å‡º <code>OI</code>ï¼›å¦åˆ™è¾“å‡º <code>ACM</code>ã€‚<a href="https://www.luogu.com.cn/problem/T425835">ã€ŒYAC Round 4ã€åœ¨æ‰¬å¤§å¯»æ±‚ç®—ç«æ˜¯å¦æé”™äº†ä»€ä¹ˆ</a></p><h3 id="è§£é¢˜æ€è·¯-åŸºæœ¬è¯­æ³•"><strong>è§£é¢˜æ€è·¯ åŸºæœ¬è¯­æ³•</strong></h3><p>åŸºæœ¬è¯­æ³•é¢˜ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        <span class="hljs-type">int</span> x; cin &gt;&gt; x;<br>        cout &lt;&lt; (x &lt;= <span class="hljs-number">4</span> ? <span class="hljs-string">&quot;OI&quot;</span> : <span class="hljs-string">&quot;ACM&quot;</span>) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="B-çµæ¢¦çš„é¦™ç«é’±"><strong>B. çµæ¢¦çš„é¦™ç«é’±</strong></h2><h3 id="é¢˜ç›®æè¿°-2"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªå…ƒç´ ï¼Œå°†è¿™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªå…ƒç´ ä¸¤ä¸¤è¿›è¡Œé…å¯¹ï¼Œä¸¤ä¸ªå…ƒç´ é…å¯¹ä¹‹åå¾—åˆ°çš„å€¼ä¸ºå¯¹åº”æ•°å­—é¦–å°¾æ‹¼æ¥å¾—åˆ°çš„æ•°å­—ã€‚æ±‚å‡ºæœ€å¤šèƒ½å¤Ÿå‡‘å‡ºå¤šå°‘ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> çš„å€æ•°ã€‚<a href="https://www.luogu.com.cn/problem/T425162">https://www.luogu.com.cn/problem/T425162</a></p><h3 id="è§£é¢˜æ€è·¯-æ•°å­¦"><strong>è§£é¢˜æ€è·¯ æ•°å­¦</strong></h3><p>æˆ‘ä»¬å¯ä»¥å‡è®¾å½“å‰é…å¯¹çš„ä¸¤ä¸ªæ•°å­—åˆ†åˆ«ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚æˆ‘ä»¬å¯ä»¥è¿›è¡Œå¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> å–æ¨¡è¿ç®—åï¼Œå¯ä»¥å°†ä¸¤ä¸ªæ•°å­—åˆ†è§£åè¡¨ç¤ºå¦‚ä¸‹ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><msub><mi>k</mi><mn>1</mn></msub><mo>Ã—</mo><mn>3</mn><mo>+</mo><msub><mi>r</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1 = k_1 \times 3 + r_1 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><msub><mi>k</mi><mn>2</mn></msub><mo>Ã—</mo><mn>3</mn><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2 = k_2 \times 3 + r_2 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>å…¶ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> å–æ¨¡åå¾—åˆ°çš„ä½™æ•°ã€‚</p><p>æˆ‘ä»¬å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„å°¾éƒ¨å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„é¦–éƒ¨è¿›è¡Œæ‹¼æ¥ï¼ŒåŒæ—¶æˆ‘ä»¬å¯ä»¥å‡è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„æ•°å­—é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´æ‹¼æ¥åå¾—åˆ°çš„æ•°å­—å°†ä¼šæ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mi>m</mi></msup><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_1 \times 10^m + x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7477em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå³ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>k</mi><mn>1</mn></msub><mo>Ã—</mo><mn>3</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mi>m</mi></msup><mo>+</mo><msub><mi>r</mi><mn>1</mn></msub><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mi>m</mi></msup><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mo>Ã—</mo><mn>3</mn><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">(k_1 \times 3) \times 10^m + r_1 \times 10^m + k_2 \times 3 + r_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7977em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7977em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>å–æ¨¡è¿ç®—æ˜¯ç¬¦åˆåŠ æ³•å’Œä¹˜æ³•è¿ç®—çš„ï¼Œæ•…æˆ‘ä»¬å¯¹å½“å‰æ‹¼æ¥åå¾—åˆ°çš„æ•°å­—çš„å„ä¸ªéƒ¨åˆ†è¿›è¡Œå¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> å–æ¨¡:</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>k</mi><mn>1</mn></msub><mo>Ã—</mo><mn>3</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mi>m</mi></msup><mtext>â€Š</mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext>â€Š</mtext><mn>3</mn><mo>=</mo><msub><mi>k</mi><mn>1</mn></msub><mo>Ã—</mo><mn>3</mn><mtext>â€Š</mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext>â€Š</mtext><mn>3</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">(k_1 \times 3) \times 10^m \bmod 3 = k_1 \times 3 \bmod 3 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7144em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>r</mi><mn>1</mn></msub><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mi>m</mi></msup><mtext>â€Š</mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext>â€Š</mtext><mn>3</mn><mo>=</mo><msub><mi>r</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">r_1 \times 10^m \bmod 3 = r_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7144em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>Ã—</mo><mn>3</mn><mtext>â€Š</mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext>â€Š</mtext><mn>3</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">k_2 \times 3 \bmod 3 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>r</mi><mn>2</mn></msub><mtext>â€Š</mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext>â€Š</mtext><mn>3</mn><mo>=</mo><msub><mi>r</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">r_2 \bmod 3 = r_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>å› æ­¤ï¼Œæ‹¼æ¥åå¾—åˆ°æ•°å­—å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> å–æ¨¡åå³ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">r_1 + r_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚ï¼ˆä¼šå‘ç°ï¼Œæ‹¼æ¥å¾—åˆ°æ•°å­—æ¨¡3çš„ç»“æœå’Œç›¸åŠ æ˜¯ä¸€æ ·çš„ï¼‰</p><p>é‚£ä¹ˆï¼Œè¦ä½¿å¾—æ‹¼æ¥åä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> çš„å€æ•°ï¼Œæ˜¾ç„¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">r_1 + r_2 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> æˆ–è€… <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">r_1 + r_2 = 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span>ï¼Œæ‰€ä»¥è¦ä¹ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">r_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">r_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> éƒ½ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼›è¦ä¹ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">r_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">r_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸­ä¸€ä¸ªä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å¦ä¸€ä¸ªä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>ã€‚</p><p>ä¹Ÿå°±æ˜¯ä½™æ•°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> çš„åªå¯ä»¥å’Œä½™æ•°åŒæ ·æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> çš„ç›¸åŒ¹é…ï¼›ä½™æ•°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> æˆ– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> çš„ï¼Œåªå¯ä»¥å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> æˆ– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åŒ¹é…ã€‚å¯¹äºå‰è€…ï¼Œç”±äºæˆ‘ä»¬ä¸åŒ¹é…çš„æ•°å­—ä¸ç®—ï¼Œæ‰€ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">r_1 + r_2 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> æœ€å¤šå¯ä»¥åŒ¹é…å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">âŒŠ</mo><mfrac><mrow><mi>c</mi><mi>n</mi><msub><mi>t</mi><mn>0</mn></msub></mrow><mn>2</mn></mfrac><mo fence="true">âŒ‹</mo></mrow><annotation encoding="application/x-tex">\left \lfloor \frac{cnt_0}{2} \right \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">âŒŠ</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8407em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">n</span><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">âŒ‹</span></span></span></span></span></span> ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> çš„å€æ•°ï¼›å¯¹äºåè€…ï¼Œåˆ™ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>c</mi><mi>n</mi><msub><mi>t</mi><mn>1</mn></msub><mo separator="true">,</mo><mi>c</mi><mi>n</mi><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\min(cnt_1, cnt_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ã€‚</p><p>æ•…æˆ‘ä»¬åªéœ€è¦ç»Ÿè®¡æ¯ä¸ªä½™æ•°æœ‰å¤šå°‘ä¸ªå…ƒç´ ï¼Œæœ€åè¾“å‡ºç­”æ¡ˆä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">âŒŠ</mo><mfrac><mrow><mi>c</mi><mi>n</mi><msub><mi>t</mi><mn>0</mn></msub></mrow><mn>2</mn></mfrac><mo fence="true">âŒ‹</mo></mrow><mo>+</mo><mi>min</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>c</mi><mi>n</mi><msub><mi>t</mi><mn>1</mn></msub><mo separator="true">,</mo><mi>c</mi><mi>n</mi><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\left \lfloor \frac{cnt_0}{2} \right \rfloor + \min(cnt_1, cnt_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">âŒŠ</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8407em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">n</span><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">âŒ‹</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">cnt</span><span class="hljs-params">(<span class="hljs-number">3</span>)</span></span>;<br>    <span class="hljs-type">int</span> n; cin &gt;&gt; n;<br>    <span class="hljs-keyword">while</span>(n -- )&#123;<br>        <span class="hljs-type">int</span> x; cin &gt;&gt; x;<br>        cnt[x % <span class="hljs-number">3</span>] ++ ;<br>    &#125;<br>    cout &lt;&lt; (cnt[<span class="hljs-number">0</span>] / <span class="hljs-number">2</span> + <span class="hljs-built_in">min</span>(cnt[<span class="hljs-number">1</span>], cnt[<span class="hljs-number">2</span>])) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="C-é’æ˜¥å¼‚æˆ–å°‘å¹´ä¸ä¼šé‡åˆ°æŒ‰ä½ä¸å­¦å§"><strong>C. é’æ˜¥å¼‚æˆ–å°‘å¹´ä¸ä¼šé‡åˆ°æŒ‰ä½ä¸å­¦å§</strong></h2><h3 id="é¢˜ç›®æè¿°-3"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªæ­£æ•´æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼Œæ‰¾å‡ºæœ€å°çš„æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„æ­£æ•´æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ï¼š</p><ul><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>and</mtext></mrow><annotation encoding="application/x-tex">\text{and}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">and</span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></p></li><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>xor</mtext></mrow><annotation encoding="application/x-tex">\text{xor}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">xor</span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></p></li></ul><p><a href="https://www.luogu.com.cn/problem/T425196">ã€ŒYAC Round 4ã€é’æ˜¥å¼‚æˆ–å°‘å¹´ä¸ä¼šé‡åˆ°æŒ‰ä½ä¸å­¦å§</a></p><h3 id="è§£é¢˜æ€è·¯-ä½è¿ç®—-è´ªå¿ƒ"><strong>è§£é¢˜æ€è·¯ ä½è¿ç®— + è´ªå¿ƒ</strong></h3><p>å¯¹äºç¬¬ä¸€ä¸ªæ¡ä»¶ï¼Œä¸¤ä¸ªæ•°å­— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> æŒ‰ä½ä¸å¤§äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œæ˜¾ç„¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> çš„å¯¹åº”äºŒè¿›åˆ¶ä½ä¸­è‡³å°‘éœ€è¦æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä½åŒæ—¶æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œé‚£ä¹ˆä¸ºäº†è®© <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> å°½å¯èƒ½å°ï¼Œæˆ‘ä»¬å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> æœ€åä¸€ä½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å³å‰é¢ä½çš„æ‰€æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> å³å¯ã€‚ä¾‹å¦‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn><mo>=</mo><mo stretchy="false">(</mo><mn>1010</mn><msub><mo stretchy="false">)</mo><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">10 = (1010)_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1010</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œæ­¤æ—¶å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>=</mo><mo stretchy="false">(</mo><mn>10</mn><msub><mo stretchy="false">)</mo><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">2 = (10)_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">10</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å³å¯ï¼Œä¹Ÿå°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>lowbit</mtext><mo stretchy="false">(</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{lowbit} (10)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">lowbit</span></span><span class="mopen">(</span><span class="mord">10</span><span class="mclose">)</span></span></span></span>ã€‚ <a href="https://www.cnblogs.com/fusiwei/p/11752540.html">æµ…è°ˆlowbitè¿ç®— - Seaway-Fu - åšå®¢å›­</a></p><p>å¯¹äºç¬¬äºŒä¸ªæ¡ä»¶ï¼Œä¸¤ä¸ªæ•°å­— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> æŒ‰ä½å¼‚æˆ–å¤§äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬è‡³å°‘éœ€è¦æœ‰ä¸€ä½äºŒè¿›åˆ¶ä½ä¸åŒã€‚åœ¨ç¬¬ä¸€ä¸ªæ¡ä»¶ä¸‹æˆ‘ä»¬å–äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></msup><mo>=</mo><mtext>lowbit</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y^{&#x27;} = \text{lowbit}(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1369em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-2.9425em;margin-right:0.05em;"><span class="pstrut" style="height:2.5795em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">lowbit</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> ã€‚<strong>å¦‚æœæ­¤æ—¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></msup><mo>=Ì¸</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">y^{&#x27;} \not = x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1369em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-2.9425em;margin-right:0.05em;"><span class="pstrut" style="height:2.5795em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel">î€ </span></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼Œé‚£ä¹ˆå°±å–æ­¤æ—¶çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msup><mi>y</mi><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></msup></mrow><annotation encoding="application/x-tex">y = y^{&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1369em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-2.9425em;margin-right:0.05em;"><span class="pstrut" style="height:2.5795em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> å³å¯</strong>ã€‚</p><p><strong>å¦‚æœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></msup><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">y^{&#x27;} = x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1369em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-2.9425em;margin-right:0.05em;"><span class="pstrut" style="height:2.5795em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></strong>ï¼Œè¯´æ˜æ­¤æ—¶å–çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></msup></mrow><annotation encoding="application/x-tex">y^{&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1369em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-2.9425em;margin-right:0.05em;"><span class="pstrut" style="height:2.5795em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> æ¯ä¸€ä½éƒ½ä¸€æ ·ï¼Œä¸ºäº†ä½¿å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> å°½é‡å°ï¼Œæˆ‘ä»¬åªéœ€è¦è®©æ­¤æ—¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></msup></mrow><annotation encoding="application/x-tex">y^{&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1369em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-2.9425em;margin-right:0.05em;"><span class="pstrut" style="height:2.5795em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> çš„æœ€ä½ä½çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å³å¯ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªè¦ä½¿å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></msup></mrow><annotation encoding="application/x-tex">y^{&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1369em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-2.9425em;margin-right:0.05em;"><span class="pstrut" style="height:2.5795em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> çš„æœ€ä½ä½å˜ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å³å¯ï¼Œä¹Ÿå°±æ˜¯ <strong>å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msup><mi>y</mi><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></msup><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">y = y^{&#x27;} + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1369em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-2.9425em;margin-right:0.05em;"><span class="pstrut" style="height:2.5795em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å³å¯</strong>ã€‚</p><p>ä½†æ˜¯ï¼Œå½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> æ—¶ï¼Œéœ€è¦ç‰¹æ®Šåˆ¤æ–­ä¸€ä¸‹ï¼Œæ­¤æ—¶ä¸ºäº†æ»¡è¶³ç¬¬ä¸€ä¸ªæ¡ä»¶ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">y^{&#x27;} = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1369em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-2.9425em;margin-right:0.05em;"><span class="pstrut" style="height:2.5795em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œä¸ºäº†æ»¡è¶³ç¬¬äºŒä¸ªæ¡ä»¶ï¼Œç”±äºæœ€ä½ä½å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œæ•…åªèƒ½ä½¿å¾—ç¬¬äºŒä½ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œä¹Ÿå°±æ˜¯å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">y = 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> lowbit(x) (x) &amp; (-x)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        ll x; cin &gt;&gt; x;<br>        <span class="hljs-keyword">if</span>(x == <span class="hljs-number">1</span>)&#123;<br>            cout &lt;&lt; <span class="hljs-number">3</span> &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br>        ll y = <span class="hljs-built_in">lowbit</span>(x);<br>        cout &lt;&lt; y + (y == x) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="D-K-ON"><strong>D. K-ON!</strong></h2><h3 id="é¢˜ç›®æè¿°-4"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªç¤¾å›¢ï¼Œæ¯ä¸ªç¤¾å›¢æœ‰ä¸€ä¸ªè¡¨æ¼”æ—¶é—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼ŒæŒ‰ç…§ä¸‹æ ‡é¡ºåºä¸Šå°è¡¨æ¼”ï¼Œèˆå°å¯ä»¥åŒæ—¶å®¹çº³å¤šä¸ªæ˜¯ç¤¾å›¢è¿›è¡Œè¡¨æ¼”ï¼ˆå³èˆå°æœ‰ä¸€ä¸ªå¤§å°ï¼‰ã€‚ç»™å®šä¸€ä¸ªæ€»æ—¶é—´é™åˆ¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>ï¼Œåœ¨æ‰€æœ‰ç¤¾å›¢è¡¨æ¼”æ€»æ—¶é—´ä¸è¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> çš„æƒ…å†µä¸‹ï¼Œä½¿å¾—èˆå°å¤§å°æœ€å°åŒ–ã€‚<a href="https://www.luogu.com.cn/problem/T425220">ã€ŒYAC Round 4ã€K-ON!</a></p><h3 id="è§£é¢˜æ€è·¯-äºŒåˆ†-å †"><strong>è§£é¢˜æ€è·¯ äºŒåˆ† + å †</strong></h3><p>å¯ä»¥å‘ç°èˆå°è¶Šå¤§ï¼Œæ€»æ—¶é—´å¿…å®šè¶Šå°‘ï¼›åä¹‹äº¦ç„¶ã€‚</p><p>æ˜¾ç„¶é—®é¢˜å…·æœ‰äºŒæ®µæ€§ï¼Œå› æ­¤æˆ‘ä»¬è€ƒè™‘äºŒåˆ†ç­”æ¡ˆï¼ˆå³èˆå°å¤§å°ï¼‰ã€‚</p><p>å‡è®¾äºŒåˆ†æ—¶çš„èˆå°å¤§å°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ã€‚åœ¨äºŒåˆ†çš„åˆ¤æ–­å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ¯æ¬¡å–å‡ºå½“å‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä¸ªç¤¾å›¢ä¸­æœ€æ—©è¡¨æ¼”å®Œçš„ä¸€ä¸ªç¤¾å›¢è®©å…¶ä¸‹åœºï¼ŒåŒæ—¶æŒ‰ç…§ç¼–å·é¡ºåºè®©ä¸‹ä¸€ä¸ªè¦ä¸Šåœºçš„ç¤¾å›¢ä¸Šåœºå¼€å§‹è¡¨æ¼”ã€‚æ•…æˆ‘ä»¬å¯ä»¥ç”¨å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰ç»´æŠ¤å½“å‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä¸ªç¤¾å›¢è¡¨æ¼”ç»“æŸæ—¶é—´ï¼Œå› ä¸ºè¦å–æœ€å°å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰ç”¨çš„æ˜¯å°æ ¹å †æ¥è¿›è¡Œæ¨¡æ‹Ÿã€‚</p><p>å¦‚æœåœ¨æ¨¡æ‹Ÿè¿‡ç¨‹ä¸­ï¼Œå½“å‰è¦ä¸Šåœºçš„ç¤¾å›¢è¡¨æ¼”æ—¶é—´å¤§äºæ€»æ—¶é—´é™åˆ¶æ—¶ï¼Œå°±è¿”å› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>false</mtext></mrow><annotation encoding="application/x-tex">\text{false}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">false</span></span></span></span></span>ï¼›æ¨¡æ‹Ÿåˆ°æœ€åéƒ½æ²¡æœ‰å‡ºç°è¶…è¿‡æ—¶é—´é™åˆ¶çš„ç¤¾å›¢ï¼Œé‚£ä¹ˆå°±è¿”å› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>true</mtext></mrow><annotation encoding="application/x-tex">\text{true}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord text"><span class="mord">true</span></span></span></span></span> ã€‚</p><p>PSï¼šé¢˜ç›®ä¿è¯ä¸€å®šæœ‰è§£ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒä¸€å¼€å§‹å°±å‡ºç°æ— æ³•è¡¨æ¼”ç»“æŸçš„ç¤¾å›¢ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e4</span> + <span class="hljs-number">10</span>;<br><span class="hljs-type">int</span> a[N], n, t;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">check</span><span class="hljs-params">(<span class="hljs-type">int</span> k)</span></span>&#123;<br>    priority_queue&lt;<span class="hljs-type">int</span>, vector&lt;<span class="hljs-type">int</span>&gt;, greater&lt;<span class="hljs-type">int</span>&gt; &gt; q;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= k; i ++ ) q.<span class="hljs-built_in">push</span>(a[i]);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = k + <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-type">int</span> now = q.<span class="hljs-built_in">top</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br>        <span class="hljs-keyword">if</span>(now + a[i] &gt; t) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// è¶…å‡ºæ—¶é—´é™åˆ¶</span><br>        q.<span class="hljs-built_in">push</span>(now + a[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; t;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br>    <span class="hljs-type">int</span> l = <span class="hljs-number">1</span>, r = n;<br>    <span class="hljs-keyword">while</span>(l &lt; r)&#123;<br>        <span class="hljs-type">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">check</span>(mid)) r = mid;<br>        <span class="hljs-keyword">else</span> l = mid + <span class="hljs-number">1</span>;<br>    &#125;<br>    cout &lt;&lt; r &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="E-æ—©è‹—çš„æœºåŠ¨æˆ˜å£«é«˜è¾¾æ¢¦"><strong>E. æ—©è‹—çš„æœºåŠ¨æˆ˜å£«é«˜è¾¾æ¢¦</strong></h2><h3 id="é¢˜ç›®æè¿°-5"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªå›¾ï¼Œå›¾ä¸­æ„æˆå¤šä¸ªè¿é€šå—ã€‚å…ˆè¾“å‡ºå½“å‰å›¾ä¸­çš„è¿é€šå—ä¸ªæ•°ï¼Œç„¶åç»™å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡å»é™¤ä¸€ä¸ªç‚¹åŠå…¶é‚»æ¥çš„è¾¹ï¼Œé—®å»é™¤å½“å‰è¿™ä¸ªç‚¹æ—¶å›¾ä¸­æœ‰å¤šå°‘è¿é€šå—ã€‚<a href="https://www.luogu.com.cn/problem/T425234">ã€ŒYAC Round 4ã€æ—©è‹—çš„æœºåŠ¨æˆ˜å£«é«˜è¾¾æ¢¦</a></p><h3 id="è§£é¢˜æ€è·¯-å¹¶æŸ¥é›†"><strong>è§£é¢˜æ€è·¯ å¹¶æŸ¥é›†</strong></h3><p>æˆ‘ä»¬å¯ä»¥ç”¨å¹¶æŸ¥é›†ç»´æŠ¤è¿é€šå—ä¸ªæ•°ã€‚</p><p>å¦‚æœæˆ‘ä»¬æ­£å‘è€ƒè™‘è¿™ä¸ªé—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¯æ¬¡è¯¢é—®éƒ½éœ€è¦é‡æ–°å»ºç«‹å…³ç³»ï¼Œç„¶åå¾—åˆ°å»é™¤å½“å‰ç‚¹åçš„è¿é€šå—ä¸ªæ•°ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¼šè¶…æ—¶çš„ã€‚</p><p>æ•…æˆ‘ä»¬è€ƒè™‘é€†å‘æ€è€ƒè¿™ä¸ªé—®é¢˜ã€‚é¢„å…ˆå°†æ‰€æœ‰çš„è¾¹éƒ½å­˜èµ·æ¥ã€‚æˆ‘ä»¬å¯ä»¥å…ˆå¾—åˆ°ç»è¿‡æœ€åä¸€æ¬¡æ“ä½œåï¼Œå›¾ä¸­è¿˜æœ‰å¤šå°‘è¿é€šå—ã€‚ç„¶åï¼Œæ¯ä¸€æ¬¡è¿˜åŸä¸€ä¸ªç‚¹ï¼Œç›¸å½“äºæ¯æ¬¡åŠ å…¥ä¸€ä¸ªç‚¹åŠå…¶é‚»æ¥è¾¹ï¼Œ<strong>é€†å‘è¿˜åŸæ¯æ¬¡æ“ä½œä¹‹å‰å›¾ä¸­çš„è¿é€šå—ä¸ªæ•°</strong>ã€‚</p><p>ç­”æ¡ˆå­˜å‚¨åœ¨æ•°ç»„ä¸­ï¼Œæœ€åè¾“å‡ºå³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> fi first</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> se second</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">4e5</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> n, m, k, fa[N], a[N], res[N];<br><span class="hljs-type">int</span> h[N], e[N], ne[N], idx;<br><span class="hljs-type">bool</span> ban[N];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span></span>&#123;<br>    e[ ++ idx] = b, ne[idx] = h[a], h[a] = idx;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123;<br>    <span class="hljs-keyword">return</span> fa[x] == x ? x : fa[x] = <span class="hljs-built_in">find</span>(fa[x]);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">while</span>(m -- )&#123;<br>        <span class="hljs-type">int</span> u, v; cin &gt;&gt; u &gt;&gt; v;<br>        <span class="hljs-built_in">add</span>(u, v), <span class="hljs-built_in">add</span>(v, u);<br>    &#125;<br>    cin &gt;&gt; k;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= k; i ++ ) cin &gt;&gt; a[i], ban[a[i]] = <span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) fa[i] = i;<br><br>    <span class="hljs-comment">// å…ˆå¾—åˆ°æœ€åä¸€æ¬¡è¯¢é—®ä¹‹åçš„è¿é€šå—ä¸ªæ•°</span><br>    <span class="hljs-type">int</span> tot = n - k; <span class="hljs-comment">// æœ€åä¸€æ¬¡è¯¢é—®ä¹‹åå›¾ä¸­å…±æœ‰ n - k ä¸ªç‚¹</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> u = <span class="hljs-number">0</span>; u &lt; n; u ++ )&#123;<br>        <span class="hljs-keyword">if</span>(ban[u]) <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; i; i = ne[i])&#123;<br>            <span class="hljs-type">int</span> v = e[i];<br>            <span class="hljs-keyword">if</span>(ban[v]) <span class="hljs-keyword">continue</span>;<br>            <span class="hljs-type">int</span> fx = <span class="hljs-built_in">find</span>(u), fy = <span class="hljs-built_in">find</span>(v);<br>            <span class="hljs-keyword">if</span>(fx != fy) fa[fy] = fx, tot -- ; <span class="hljs-comment">// åˆå¹¶ä¸¤ä¸ªè¿é€šå—</span><br>        &#125;<br>    &#125;<br>    res[k + <span class="hljs-number">1</span>] = tot;<br><br>    <span class="hljs-comment">// é€†å‘è¿˜åŸ</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = k; j; j -- )&#123;<br>        <span class="hljs-type">int</span> u = a[j];<br>        ban[u] = <span class="hljs-literal">false</span>; <span class="hljs-comment">// åŠ å…¥ç‚¹</span><br>        tot ++ ;   <span class="hljs-comment">// ä¸€ä¸ªç‚¹ä¸€ä¸ªè¿é€šå—</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; i; i = ne[i])&#123;<br>            <span class="hljs-type">int</span> v = e[i];<br>            <span class="hljs-keyword">if</span>(ban[v]) <span class="hljs-keyword">continue</span>;<br>            <span class="hljs-type">int</span> fx = <span class="hljs-built_in">find</span>(u), fy = <span class="hljs-built_in">find</span>(v);<br>            <span class="hljs-keyword">if</span>(fx != fy) fa[fy] = fx, tot -- ; <span class="hljs-comment">// åˆå¹¶ä¸¤ä¸ªè¿é€šå—</span><br>        &#125;<br>        res[j] = tot;<br>    &#125;<br><br>    <span class="hljs-comment">// è¾“å‡ºç­”æ¡ˆ</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= k + <span class="hljs-number">1</span>; i ++ ) cout &lt;&lt; res[i] &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="F-çˆ±ä¸½ä¸é€ç»™é­”ç†æ²™çš„æ‰‹é“¾"><strong>F. çˆ±ä¸½ä¸é€ç»™é­”ç†æ²™çš„æ‰‹é“¾</strong></h2><h3 id="é¢˜ç›®æè¿°-6"><strong>é¢˜ç›®æè¿°</strong></h3><p>å‡è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> ä¸ºè“è‰²ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> ä¸ºé‡‘è‰²ã€‚ç»™å®šä¸€ä¸ªé•¿åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>ï¼Œæ±‚å‡ºç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> å¯ä»¥æ„é€ å‡ºçš„ç›¸é‚»å…ƒç´ ä¸èƒ½åŒæ—¶ä¸ºé‡‘è‰²ï¼Œå³ä¸èƒ½åŒæ—¶ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>ï¼ˆæˆ–è€…è¯´ç›¸é‚»å…ƒç´ è‡³å°‘æœ‰ä¸€ä¸ªä¸ºè“è‰²ï¼Œå³è‡³å°‘æœ‰ä¸€ä¸ªä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>ï¼‰ çš„é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„ <strong>ç¯çŠ¶</strong> å­—ç¬¦ä¸²æ–¹æ¡ˆæ•°ã€‚<a href="https://www.luogu.com.cn/problem/T425230">ã€ŒYAC Round 4ã€çˆ±ä¸½ä¸é€ç»™é­”ç†æ²™çš„æ‰‹é“¾</a></p><h3 id="è§£é¢˜æ€è·¯-dp-çŸ©é˜µåŠ é€Ÿ"><strong>è§£é¢˜æ€è·¯ dp + çŸ©é˜µåŠ é€Ÿ</strong></h3><p>æˆ‘ä»¬å¯ä»¥å…ˆè€ƒè™‘ä¸€ä¸‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">n \le 10^6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span> æ—¶å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŠ¨æ€è§„åˆ’è§£å†³è¿™ä¸ªå­é—®é¢˜ã€‚</p><p>ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i][0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span></span></span></span> è¡¨ç¤ºæ„é€ çš„é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸”ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªå®çŸ³é€‰ç”¨ <strong>é‡‘è‰²å®çŸ³</strong> çš„æ–¹æ¡ˆæ•°ï¼› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i][1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span></span></span></span> è¡¨ç¤ºæ„é€ çš„é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸”ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªå®çŸ³é€‰ç”¨ <strong>è“è‰²å®çŸ³</strong> çš„æ–¹æ¡ˆæ•°ã€‚</p><p>é¢˜ä¸­è¦æ±‚ç›¸é‚»çš„ä¸¤ä¸ªä¸èƒ½åŒæ—¶ä¸ºé‡‘è‰²ã€‚å¯¹äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i][0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span></span></span></span> ï¼Œç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªé€‰æ‹©äº†é‡‘è‰²ï¼Œé‚£ä¹ˆå‰ä¸€ä½åªèƒ½ç”¨è“è‰²ï¼›å¯¹äº  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i][1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span></span></span></span>ï¼Œç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªé€‰æ‹©äº†è“è‰²ï¼Œé‚£ä¹ˆå‰ä¸€ä½é€‰æ‹©è“è‰²æˆ–é‡‘è‰²éƒ½å¯ä»¥ã€‚ æ•…çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>+</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases}dp[i][0] = dp[i - 1][1]\\\\dp[i][1] = dp[i - 1][0] + dp[i - 1][1]\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â©</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â¨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â§</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>ç”±äºæ˜¯ <strong>ç¯çŠ¶</strong> çš„ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è¿›è¡Œä¸€ä¸‹åˆå§‹åŒ–çš„åˆ†ç±»è®¨è®ºã€‚</p><ul><li><p>å¦‚æœç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä¸ªé€‰æ‹©é‡‘è‰²å®çŸ³ï¼Œé‚£ä¹ˆç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªå®çŸ³åªèƒ½é€‰æ‹©è“è‰²å®çŸ³ï¼ˆå› ä¸ºç¯å½¢è¿æ¥å¤„ä¹Ÿéœ€è¦æ»¡è¶³æ¡ä»¶ï¼‰ï¼Œæ•…æ­¤æƒ…å†µç­”æ¡ˆä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[n][1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span></span></span></span></p></li><li><p>å¦‚æœç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä¸ªé€‰æ‹©è“è‰²å®çŸ³ï¼Œé‚£ä¹ˆç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªå®çŸ³ä¸¤ç§é¢œè‰²éƒ½å¯ä»¥é€‰æ‹©ï¼Œæ•…æ­¤æƒ…å†µç­”æ¡ˆä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>+</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[n][0] + dp[n][1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span></span></span></span></p></li></ul><p>è§£å†³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">n \le 10^6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span> çš„å­ä»»åŠ¡ï¼Œåªéœ€è¦åˆ†æƒ…å†µè·‘ä¸¤æ¬¡çº¿æ€§dpï¼Œç„¶åç­”æ¡ˆå°±æ˜¯ä¸¤ç§æƒ…å†µç›¸åŠ ã€‚</p><p>ä»¥ä¸‹æ˜¯è§£å†³å­ä»»åŠ¡çš„ä»£ç ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e6</span> + <span class="hljs-number">10</span>, mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;<br><span class="hljs-type">int</span> dp[N][<span class="hljs-number">2</span>], n;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        cin &gt;&gt; n;<br>        ll res = <span class="hljs-number">0</span>;<br><br>        dp[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>, dp[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;    <span class="hljs-comment">// ç¬¬ä¸€ä¸ªä¸ºé‡‘è‰²å®çŸ³</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++ )&#123;<br>            dp[i][<span class="hljs-number">0</span>] = dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] % mod;<br>            dp[i][<span class="hljs-number">1</span>] = (dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] + dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>]) % mod;<br>        &#125;<br>        res = (res + dp[n][<span class="hljs-number">1</span>]) % mod;  <span class="hljs-comment">// æœ€åä¸€ä¸ªåªèƒ½é€‰è“è‰²</span><br><br>        dp[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>, dp[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;    <span class="hljs-comment">// ç¬¬äºŒä¸ªä¸ºè“è‰²å®çŸ³</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++ )&#123;<br>            dp[i][<span class="hljs-number">0</span>] = dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] % mod;<br>            dp[i][<span class="hljs-number">1</span>] = (dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] + dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>]) % mod;<br>        &#125;<br>        res = (res + dp[n][<span class="hljs-number">0</span>] + dp[n][<span class="hljs-number">1</span>]) % mod; <span class="hljs-comment">// æœ€åä¸€ä¸ªä¸¤ç§é¢œè‰²çš†å¯é€‰</span><br><br>        cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>18</mn></msup></mrow><annotation encoding="application/x-tex">n \le 10^{18}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">18</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œç”¨æ™®é€šçš„çº¿æ€§åŠ¨æ€è§„åˆ’æ˜¾ç„¶æ— æ³•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>å› æ­¤æˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸€ä¸ªæ¯”è¾ƒè¿›é˜¶çš„æŠ€å·§ï¼Œ<strong>çŸ©é˜µåŠ é€Ÿ</strong> ã€‚</p><p>æˆ‘ä»¬å‡è®¾ä¸€ä¸ªè¡Œå‘é‡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\begin{bmatrix}dp_{i,0} &amp; dp_{i,1}\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span>ï¼Œç”±å…ˆå‰çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªçŸ©é˜µå®ç° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\begin{bmatrix}dp_{i,0} &amp; dp_{i,1}\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn></mrow></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\begin{bmatrix}dp_{i+1,0} &amp; dp_{i+1,1}\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span> çš„çº¿æ€§å˜æ¢ã€‚</p><p>å¯ä»¥æ„é€ çŸ©é˜µå¾—åˆ°çº¿æ€§å˜æ¢å¦‚ä¸‹ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn></mrow></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix}dp_{i,0} &amp; dp_{i,1}\end{bmatrix}\begin{bmatrix}0 &amp; 1\\\\1 &amp; 1\end{bmatrix}= \begin{bmatrix}dp_{i + 1,0} &amp; dp_{i + 1,1}\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347zM347 1759 V0 H263 V1759 v0 v1759 h84z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p><p>åˆ†ä¸¤ç§åˆå§‹æƒ…å†µç”¨çŸ©é˜µå¿«é€Ÿå¹‚å°±å¯ä»¥é¡ºåˆ©è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>t</mi><mn>3</mn></msup><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(t^3 \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ï¼Œå…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">t = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>ï¼ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> ä¸ºçŸ©é˜µå¤§å°ï¼‰ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> mst(a, x) memset(a, x, sizeof(a))</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Matrix</span>&#123;<br>    ll mat[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>];<br>    <span class="hljs-built_in">Matrix</span>()&#123; <span class="hljs-built_in">mst</span>(mat, <span class="hljs-number">0</span>); &#125;<br>    Matrix <span class="hljs-keyword">operator</span> * (<span class="hljs-type">const</span> Matrix &amp;b)&#123;<br>        Matrix res;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2</span>; i ++ )<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">2</span>; j ++ )<br>                <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">2</span>; k ++ )<br>                    res.mat[i][j] = (res.mat[i][j] + mat[i][k] * b.mat[k][j] % mod) % mod;<br>        <span class="hljs-keyword">return</span> res;<br>    &#125; <br>&#125;ans, base;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">init</span><span class="hljs-params">(<span class="hljs-type">int</span> flag)</span></span>&#123;<br>    <span class="hljs-built_in">mst</span>(base.mat, <span class="hljs-number">0</span>), <span class="hljs-built_in">mst</span>(ans.mat, <span class="hljs-number">0</span>); <span class="hljs-comment">// åˆå§‹åŒ–</span><br>    base.mat[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] = base.mat[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = base.mat[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span>(!flag) ans.mat[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;  <span class="hljs-comment">// ç¬¬ä¸€ä¸ªä¸ºé‡‘è‰²å®çŸ³</span><br>    <span class="hljs-keyword">else</span> ans.mat[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;       <span class="hljs-comment">// ç¬¬ä¸€ä¸ªä¸ºè“è‰²å®çŸ³</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">mat_qmi</span><span class="hljs-params">(ll n)</span></span>&#123;<br>    <span class="hljs-keyword">while</span>(n)&#123;<br>        <span class="hljs-keyword">if</span>(n &amp; <span class="hljs-number">1</span>) ans = ans * base;<br>        base = base * base;<br>        n &gt;&gt;= <span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        ll n; cin &gt;&gt; n;<br>        n -- ;       <span class="hljs-comment">// å¿«é€Ÿå¹‚ç›¸å½“äºè¦è·‘ n-1 æ¬¡æ–¹</span><br>        ll res = <span class="hljs-number">0</span>;<br><br>        <span class="hljs-comment">// ç¬¬ä¸€ä¸ªä¸ºé‡‘è‰²å®çŸ³</span><br>        <span class="hljs-built_in">init</span>(<span class="hljs-number">0</span>);<br>        <span class="hljs-built_in">mat_qmi</span>(n);<br>        res = (res + ans.mat[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]) % mod;<br><br>        <span class="hljs-comment">// ç¬¬ä¸€ä¸ªä¸ºè“è‰²å®çŸ³</span><br>        <span class="hljs-built_in">init</span>(<span class="hljs-number">1</span>);<br>        <span class="hljs-built_in">mat_qmi</span>(n);<br>        res = (res + ans.mat[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] + ans.mat[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]) % mod;<br><br>        cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å’å”±å…‰èŠ’</category>
      
      <category>YAC æ‰¬å·å¤§å­¦ç®—æ³•ç»ƒä¹ èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>ç®—æ³•ç«èµ›</tag>
      
      <tag>Luogu</tag>
      
      <tag>YAC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 YAC Round 3 é¢˜è§£</title>
    <link href="/2024/12/14/YAC_Round_3/"/>
    <url>/2024/12/14/YAC_Round_3/</url>
    
    <content type="html"><![CDATA[<h2 id="A-çˆ±ä¸½ä¸çš„-Sweet-Magic"><strong>A. çˆ±ä¸½ä¸çš„ Sweet Magic</strong></h2><h3 id="é¢˜ç›®æè¿°"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªæ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>ï¼Œå¯¹å…¶ä¸­æŸä¸€ä¸ªå…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span>ï¼Œä½¿å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\prod_{i=1}^n a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å°½å¯èƒ½å¤§ã€‚<a href="https://www.luogu.com.cn/problem/T422762">ã€ŒYAC Round 3ã€çˆ±ä¸½ä¸çš„ Sweet Magic</a></p><h3 id="è§£æ³•ä¸€-æš´åŠ›æšä¸¾"><strong>è§£æ³•ä¸€ æš´åŠ›æšä¸¾</strong></h3><p>æ•°æ®é‡æ¯”è¾ƒå°ï¼Œæ¯ç»„æ•°æ®æ•°ç»„å¤§å°ä¸è¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span>ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æš´åŠ›æšä¸¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span> çš„å…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œè®¡ç®—å¯¹åº”çš„ç´¯ä¹˜ç»“æœï¼Œå–æœ€å¤§å€¼è¾“å‡ºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        <span class="hljs-type">int</span> n; cin &gt;&gt; n;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">a</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br>        ll res = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>            ll prod = a[i] + <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>                <span class="hljs-keyword">if</span>(i != j) prod *= a[j];<br>            res = <span class="hljs-built_in">max</span>(res, prod);<br>        &#125;<br>        cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è§£æ³•äºŒ-è´ªå¿ƒ"><strong>è§£æ³•äºŒ è´ªå¿ƒ</strong></h3><p>æˆ‘ä»¬å¯ä»¥å‡è®¾è¿›è¡Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span> çš„å…ƒç´ ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">a_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>k</mi><mo>â‰¤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1 \le k \le n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>ï¼‰ï¼Œæ˜¾ç„¶å½“å‰å…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span> å¯¹ç­”æ¡ˆçš„è´¡çŒ®ä¸º $a_1 + \ldots + a_{k-1} + a_{k + 1} + \ldots + a_n $ï¼Œæˆ‘ä»¬è®°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>sum</mtext></mrow><annotation encoding="application/x-tex">\text{sum}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">sum</span></span></span></span></span>ï¼Œå³å‰©ä½™å…ƒç´ ä¹‹å’Œã€‚æ‰€ä»¥æˆ‘ä»¬çš„é—®é¢˜è½¬æ¢ä¸ºé€‰æ‹©ä¸€ä¸ªå…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">a_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä½¿å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>sum</mtext></mrow><annotation encoding="application/x-tex">\text{sum}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">sum</span></span></span></span></span> å°½å¯èƒ½å¤§ï¼Œé‚£ä¹ˆåŸºäºè´ªå¿ƒçš„æ€æƒ³ï¼Œæˆ‘ä»¬åªè¦é€‰æ‹©æ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> ä¸­æœ€å°çš„å…ƒç´ ä½œä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">a_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå°±å¯ä»¥ä½¿å¾—å‰©ä½™å…ƒç´ ä¹‹å’Œæœ€å¤§äº†ã€‚é€‰å–æœ€å°å€¼è¿›è¡Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span> åï¼Œå†è®¡ç®—æ•°ç»„å…ƒç´ ç´¯ä¹˜å¹¶è¾“å‡ºå³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        <span class="hljs-type">int</span> n; cin &gt;&gt; n;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">a</span><span class="hljs-params">(n + <span class="hljs-number">1</span>, <span class="hljs-number">10</span>)</span></span>;<br>        <span class="hljs-type">int</span> mn = <span class="hljs-number">0</span>;  <span class="hljs-comment">// è®°å½•æœ€å°ä¸‹æ ‡</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>            cin &gt;&gt; a[i];<br>            <span class="hljs-keyword">if</span>(a[i] &lt; a[mn]) mn = i;<br>        &#125;<br>        a[mn] ++ ;<br><br>        ll res = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) res *= a[i];<br>        cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="B-è¿·é€”ç«¹æ—çš„æœˆè‰²"><strong>B. è¿·é€”ç«¹æ—çš„æœˆè‰²</strong></h2><h3 id="é¢˜ç›®æè¿°-2"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªèµ·ç‚¹å’Œä¸€ä¸ªç»ˆç‚¹ï¼Œé—®ç½‘æ ¼å›¾ä¸­æ˜¯å¦å¯ä»¥ä»èµ·ç‚¹åˆ°è¾¾ç»ˆç‚¹ã€‚ï¼ˆéå¸¸ç®€å•ä¸”å…¸å‹çš„æœç´¢æ¨¡æ¿é¢˜ï¼‰<a href="https://www.luogu.com.cn/problem/T422770">ã€ŒYAC Round 3ã€è¿·é€”ç«¹æ—çš„æœˆè‰²</a></p><h3 id="è§£æ³•ä¸€-BFS"><strong>è§£æ³•ä¸€ BFS</strong></h3><p>å¹¿åº¦ä¼˜å…ˆæœç´¢ã€‚æ ‡å‡†çš„æ¨¡æ¿é¢˜ï¼Œå†…å®¹è¾ƒä¸ºç®€å•ï¼Œå¦‚æœ‰ä¸ç†Ÿæ‚‰è¯¥æ¨¡æ¿çš„å¯è‡ªè¡ŒæŸ¥æ‰¾èµ„æ–™ç­‰è¿›è¡Œå­¦ä¹ ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MP make_pair</span><br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> dx[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>&#125;;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> dy[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>&#125;;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">110</span>;<br><br><span class="hljs-type">int</span> n, m, sx, sy, tx, ty;<br><span class="hljs-type">char</span> g[N][N];<br><span class="hljs-type">bool</span> vis[N][N];<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(g[sx][sy] == <span class="hljs-string">&#x27;#&#x27;</span> || g[tx][ty] == <span class="hljs-string">&#x27;#&#x27;</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// æ³¨æ„èµ·ç‚¹ç»ˆç‚¹åˆæ³•</span><br>    queue&lt;pii&gt; q;<br>    q.<span class="hljs-built_in">push</span>(<span class="hljs-built_in">MP</span>(sx, sy)), vis[sx][sy] = <span class="hljs-literal">true</span>;<br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-keyword">auto</span> [x, y] = q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">if</span>(x == tx &amp;&amp; y == ty) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">4</span>; k ++ )&#123;<br>            <span class="hljs-type">int</span> nx = x + dx[k], ny = y + dy[k];<br>            <span class="hljs-keyword">if</span>(nx &lt; <span class="hljs-number">1</span> || nx &gt; n || ny &lt; <span class="hljs-number">1</span> || ny &gt; m) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// å‡ºç•Œ</span><br>            <span class="hljs-keyword">if</span>(g[nx][ny] == <span class="hljs-string">&#x27;#&#x27;</span> || vis[nx][ny]) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// æ— æ³•é€šè¡Œæˆ–è®¿é—®è¿‡</span><br>            q.<span class="hljs-built_in">push</span>(<span class="hljs-built_in">MP</span>(nx, ny)), vis[nx][ny] = <span class="hljs-literal">true</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m &gt;&gt; sx &gt;&gt; sy &gt;&gt; tx &gt;&gt; ty;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; (g[i] + <span class="hljs-number">1</span>);<br><br>    cout &lt;&lt; (<span class="hljs-built_in">bfs</span>() ? <span class="hljs-string">&quot;Marisa&quot;</span> : <span class="hljs-string">&quot;Alice&quot;</span>) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è§£æ³•äºŒ-DFS"><strong>è§£æ³•äºŒ DFS</strong></h3><p>æ·±åº¦ä¼˜å…ˆæœç´¢</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MP make_pair</span><br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> dx[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>&#125;;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> dy[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>&#125;;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">110</span>;<br><br><span class="hljs-type">int</span> n, m, sx, sy, tx, ty;<br><span class="hljs-type">char</span> g[N][N];<br><span class="hljs-type">bool</span> vis[N][N];<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(x &lt; <span class="hljs-number">1</span> || x &gt; n || y &lt; <span class="hljs-number">1</span> || y &gt; m) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// å‡ºç•Œ</span><br>    <span class="hljs-keyword">if</span>(g[x][y] == <span class="hljs-string">&#x27;#&#x27;</span> || vis[x][y]) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// æ— æ³•é€šè¡Œæˆ–è®¿é—®è¿‡</span><br><br>    vis[x][y] = <span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">if</span>(x == tx &amp;&amp; y == ty) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// åˆ°è¾¾ç»ˆç‚¹</span><br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">4</span>; k ++ )&#123;<br>        <span class="hljs-type">int</span> nx = x + dx[k], ny = y + dy[k];<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">dfs</span>(nx, ny)) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// æœç´¢æˆåŠŸ</span><br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// æœç´¢å¤±è´¥</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m &gt;&gt; sx &gt;&gt; sy &gt;&gt; tx &gt;&gt; ty;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; (g[i] + <span class="hljs-number">1</span>);<br><br>    cout &lt;&lt; (<span class="hljs-built_in">dfs</span>(sx, sy) ? <span class="hljs-string">&quot;Marisa&quot;</span> : <span class="hljs-string">&quot;Alice&quot;</span>) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="C-æŸç§‘å­¦çš„ç‚«å½©å‘±å¤ª"><strong>C. æŸç§‘å­¦çš„ç‚«å½©å‘±å¤ª</strong></h2><h3 id="é¢˜ç›®æè¿°-3"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„æ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>ï¼Œå…±æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ä¸€ä¸ªåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>ï¼Œåˆ¤æ–­åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> å†…æ‰€æœ‰å…ƒç´ æ˜¯å¦äº’ä¸ç›¸åŒã€‚<a href="https://www.luogu.com.cn/problem/T423499">ã€ŒYAC Round 3ã€æŸç§‘å­¦çš„ç‚«å½©å‘±å¤ª</a></p><h3 id="è§£é¢˜æ€è·¯-æ€ç»´"><strong>è§£é¢˜æ€è·¯ æ€ç»´</strong></h3><p>æˆ‘ä»¬å¯ä»¥å€’è¿‡æ¥æ€è€ƒè¿™ä¸ªé—®é¢˜ï¼ŒæŠŠé—®é¢˜è½¬æ¢ä¸ºï¼šåˆ¤æ–­ä¸€ä¸ªåŒºé—´ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªæ•°ï¼Œå…¶ <strong>å‰ä¸€ä¸ª</strong> ç›¸ç­‰çš„æ•°çš„ä½ç½®æ˜¯å¦åœ¨å½“å‰çš„åŒºé—´ä¸­ã€‚</p><p>å¯ä»¥æ³¨æ„åˆ°ï¼Œå…ƒç´ å¤§å°ä¸è¶…è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span>ã€‚æˆ‘ä»¬å¯ä»¥å¼€ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>idx</mtext></mrow><annotation encoding="application/x-tex">\text{idx}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">idx</span></span></span></span></span> æ•°ç»„ï¼Œç”¨äºè®°å½•æ¯ä¸ªæ•°å‡ºç°çš„å‰ä¸€ä¸ªä½ç½®ï¼Œå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>idx</mtext><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\text{idx}[x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">idx</span></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span> è¡¨ç¤ºæ•°å€¼ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> çš„å…ƒç´ å‡ºç°çš„å‰ä¸€ä¸ªä¸‹æ ‡ã€‚</p><p>æˆ‘ä»¬å†å¼€ä¸€ä¸ªæ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>mx</mtext></mrow><annotation encoding="application/x-tex">\text{mx}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">mx</span></span></span></span></span>ï¼Œç”¨äºè®°å½•åˆ°ä¸‹æ ‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¹‹å‰æ‰€æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>idx</mtext></mrow><annotation encoding="application/x-tex">\text{idx}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">idx</span></span></span></span></span> çš„å‰ç¼€æœ€å¤§å€¼ï¼ˆè¿™é‡Œå®é™…ä¸Šä¹Ÿæœ‰ç‚¹è´ªå¿ƒçš„æ€æƒ³åœ¨é‡Œé¢ï¼Œæ˜¾ç„¶æœ€å³è¾¹çš„ä¸‹æ ‡æ˜¯æœ€æœ‰å¯èƒ½æ”¹å˜ç­”æ¡ˆçš„ï¼‰ã€‚</p><p>å¯¹äºæ¯ä¸ªè¯¢é—®çš„åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ¤æ–­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>mx</mtext><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\text{mx}[r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">mx</span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> æ˜¯å¦ <strong>å°äº</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>ï¼Œå³å¯ã€‚å¦‚æœæ»¡è¶³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>mx</mtext><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo>&lt;</mo><mi>l</mi></mrow><annotation encoding="application/x-tex">\text{mx}[r] &lt; l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">mx</span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>ï¼Œæ­¤æ—¶è¡¨æ˜åŒºé—´å†…å‡ºç°çš„æ•°çš„å‰ä¸€ä¸ªä½ç½®éƒ½åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> ä¹‹å‰ï¼Œæ•…åŒºé—´å†…çš„æ•°äº’ä¸ç›¸åŒï¼›å¦åˆ™ï¼Œè¡¨æ˜åŒºé—´å†…å­˜åœ¨è‡³å°‘ä¸€å¯¹ç›¸åŒçš„æ•°ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> n, q; cin &gt;&gt; n &gt;&gt; q;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">a</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span>, <span class="hljs-title">mx</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span>, <span class="hljs-title">idx</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        cin &gt;&gt; a[i];<br>        mx[i] = <span class="hljs-built_in">max</span>(mx[i - <span class="hljs-number">1</span>], idx[a[i]]); <span class="hljs-comment">// å‰ç¼€æœ€å¤§å€¼</span><br>        idx[a[i]] = i; <span class="hljs-comment">// è®°å½•ä¸‹æ ‡</span><br>    &#125;<br><br>    <span class="hljs-keyword">while</span>(q -- )&#123;<br>        <span class="hljs-type">int</span> l, r; cin &gt;&gt; l &gt;&gt; r;<br>        cout &lt;&lt; (mx[r] &lt; l ? <span class="hljs-string">&quot;Yes&quot;</span> : <span class="hljs-string">&quot;No&quot;</span>) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>; <br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><em>PS: æ­¤é¢˜ä¹Ÿå¯ä»¥ç”¨è«é˜Ÿè§£å†³ï¼Œå±äºè¿›é˜¶å†…å®¹ï¼Œä¸è¦æ±‚æŒæ¡ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»äº†è§£äº†è§£ã€‚</em></p><h2 id="D-èŠ™è‰è²çš„å†’é™©"><strong>D. èŠ™è‰è²çš„å†’é™©</strong></h2><h3 id="é¢˜ç›®æè¿°-4"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„æ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>ï¼Œå’Œä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„æ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>ã€‚å¯¹äºæ¯ä¸ªä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ï¼Œå°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_1, a_2, \ldots , a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸­æ‰€æœ‰å…ƒç´ éƒ½å‡å» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">t_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼ˆå¦‚æœå‡å»åå°äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œåˆ™å‡å»å…ƒç´ æœ¬èº«ï¼Œå³å‡å» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>â¡</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\min(a_k, t_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>k</mi><mo>â‰¤</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">1 \le k \le i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>ï¼‰ã€‚å¯¹äºæ¯ä¸ªä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ï¼Œæ±‚å‡ºå‡å»çš„å€¼ä¹‹å’Œï¼Œæœ€ååˆ¤æ–­å’Œçš„æœ€å°å€¼å’Œæœ€å¤§å€¼ä¹‹å·®æ˜¯å¦å°äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ã€‚<a href="https://www.luogu.com.cn/problem/T422943">ã€ŒYAC Round 3ã€èŠ™è‰è²çš„å†’é™©</a></p><h3 id="è§£é¢˜æ€è·¯-æ¨¡æ‹Ÿ-å‰ç¼€å’Œ-äºŒåˆ†-å·®åˆ†"><strong>è§£é¢˜æ€è·¯ æ¨¡æ‹Ÿ + å‰ç¼€å’Œ + äºŒåˆ† + å·®åˆ†</strong></h3><p>å¯¹äºæ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> ä¸­çš„æ¯ä¸ªå…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œæ ¹æ®é¢˜æ„åªæœ‰å½“å‰ä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> åŠå…¶åé¢çš„ä½ç½®çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> å¯ä»¥ä½¿å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å‡å°ç›´è‡³å˜ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼ˆå½“ç„¶ä¹Ÿæœ‰å¯èƒ½åˆ°æœ€åä¾ç„¶ä¸ä¼šå˜ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼‰ã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆé¢„å¤„ç†ä¸€ä¸‹æ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> çš„ <strong>å‰ç¼€å’Œ</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">pre</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">re</span></span></span></span>ï¼Œç„¶ååœ¨æ¨¡æ‹Ÿè¿‡ç¨‹ä¸­ç”¨ <strong>äºŒåˆ†</strong> æŸ¥æ‰¾å¾—åˆ°æ¯ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¼šå˜ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> çš„ä½ç½®ï¼ˆäºŒåˆ†çš„åŒºé—´ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[i, n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span>ï¼‰ã€‚</p><p>å¯¹äºæ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> çš„æ¯ä¸ªä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>ï¼Œå‡è®¾å½“å‰æ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1, j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span> åŒºé—´å†…ï¼Œæœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> ä¸ªå…ƒç´ å¤§äºç­‰äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">t_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œæ•…å½“å‰ä½ç½®å‡å»å…ƒç´ ä¹‹å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><msub><mi>m</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">sum_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> å°±æ˜¯ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>Ã—</mo><msub><mi>t</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">p \times t_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> åŠ ä¸Š å½“å‰æ•°ç»„ <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1, j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span> åŒºé—´å†…å‰©ä¸‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><msub><mi>t</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">&lt; t_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> çš„å…ƒç´ ä¹‹å’Œ</strong>ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åè¿‡æ¥æ€è€ƒï¼Œçœ‹æ¯ä¸ªå…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><msub><mi>m</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">sum_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> è´¡çŒ®ã€‚å¯¹äºæ¯ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">t_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œæˆ‘ä»¬å¯ä»¥ç»Ÿè®¡æœ‰å¤šå°‘ä¸ªå…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> èƒ½å¤Ÿåœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> ä½ç½®ä¾æ—§ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰¥</mo><msub><mi>t</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\ge t_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ã€‚å¦‚æœæ­¤æ—¶çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>&lt;</mo><msub><mi>t</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">a_i &lt; t_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç´¯åŠ ä¸€ä¸‹å‰©ä½™éƒ¨åˆ†å¯¹å½“å‰ä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><msub><mi>m</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">sum_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> çš„è´¡çŒ®ã€‚</p><p>å¯¹äºç»Ÿè®¡æ¯ä¸ªå…ƒç´  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><msub><mi>m</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">sum_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> è´¡çŒ®ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <strong>å·®åˆ†</strong> æ¥è®°å½•ï¼Œå·®åˆ†æ•°ç»„è®°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">diff</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span></span></span></span>ã€‚å‡è®¾äºŒåˆ†æ‰¾åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¼šå˜ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> çš„ä½ç½®ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">pos</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">os</span></span></span></span>ï¼Œæˆ‘ä»¬éœ€è¦åˆ†æƒ…å†µè®¨è®ºï¼š</p><ul><li><p>å¦‚æœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mo stretchy="false">[</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">]</mo><mo>âˆ’</mo><mi>p</mi><mi>r</mi><mi>e</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo>&lt;</mo><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">pre[pos] - pre[i - 1] &lt; a[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">re</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mord mathnormal">os</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">re</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>ï¼Œè¡¨æ˜å½“å‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> åˆ°æœ€åéƒ½ä¸ä¼šå˜ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œæ•… $diff[i] ++ $ï¼ŒåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[i, n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span> æ‰€æœ‰éƒ½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span>ï¼Œè¡¨ç¤º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span> å¯¹åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[i, n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span> çš„ä½ç½®éƒ½è´¡çŒ®äº†å¯¹åº”çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">t_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>â‰¤</mo><mi>j</mi><mo>â‰¤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">i \le j \le n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7955em;vertical-align:-0.136em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>ï¼‰ã€‚</p></li><li><p>å¦‚æœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mo stretchy="false">[</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">]</mo><mo>âˆ’</mo><mi>p</mi><mi>r</mi><mi>e</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">pre[pos] - pre[i - 1] = a[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">re</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mord mathnormal">os</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">re</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>ï¼Œè¡¨æ˜å½“å‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ­£å¥½åœ¨ä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">pos</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">os</span></span></span></span> å˜ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œæ•… $diff[i] ++ , diff[pos + 1] â€“ $ï¼ŒåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[i, pos]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">os</span><span class="mclose">]</span></span></span></span> éƒ½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span>ï¼Œè¡¨ç¤º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span> å¯¹åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[i, pos]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">os</span><span class="mclose">]</span></span></span></span> çš„ä½ç½®éƒ½è´¡çŒ®äº†å¯¹åº”çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">t_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>â‰¤</mo><mi>j</mi><mo>â‰¤</mo><mi>p</mi><mi>o</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">i \le j \le pos</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7955em;vertical-align:-0.136em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">os</span></span></span></span>ï¼‰ã€‚</p></li><li><p>å¦‚æœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mo stretchy="false">[</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">]</mo><mo>âˆ’</mo><mi>p</mi><mi>r</mi><mi>e</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo>&gt;</mo><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">pre[pos] - pre[i - 1] &gt; a[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">re</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mord mathnormal">os</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">re</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>ï¼Œè¡¨æ˜ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">pos</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">os</span></span></span></span> ä½ç½®å½“å‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸æ»¡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_{pos}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">os</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦å•ç‹¬ç´¯åŠ ä¸€ä¸‹è¿™ä¸ªå‰©ä½™éƒ¨åˆ†ã€‚æ•… <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>+</mo><mo>+</mo><mo separator="true">,</mo><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mo stretchy="false">[</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">]</mo><mo>âˆ’</mo><mo>âˆ’</mo></mrow><annotation encoding="application/x-tex">diff[i] ++ , diff[pos] --</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">+</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mord mathnormal">os</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span></span></span></span>ï¼ŒåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[i, pos - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">os</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> éƒ½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span>ï¼ŒåŒæ—¶æŠŠå‰©ä¸‹çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>âˆ’</mo><mo stretchy="false">(</mo><mi>p</mi><mi>r</mi><mi>e</mi><mo stretchy="false">[</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo>âˆ’</mo><mi>p</mi><mi>r</mi><mi>e</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a_i - (pre[pos - 1] - pre[i - 1])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">re</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mord mathnormal">os</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">re</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">])</span></span></span></span> ç´¯åŠ åˆ°è´¡çŒ®å‰©ä½™éƒ¨åˆ†çš„ä¸€ä¸ªæ–°çš„æ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>f</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">lft</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span></span></span></span> ä¸­ã€‚</p></li></ul><p>å¤„ç†å®Œå·®åˆ†åï¼Œæ±‚ä¸€ä¸‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">diff</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span></span></span></span> çš„å‰ç¼€å’Œå°±å¯ä»¥è¿˜åŸå¾—åˆ°æ¯ä¸ªä½ç½®çš„è´¡çŒ®æ»¡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">t_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> çš„æ•°é‡ã€‚å¯¹äºæ¯ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><msub><mi>m</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">sum_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå…¶è®¡ç®—å…¬å¼ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><msub><mi>m</mi><mi>j</mi></msub><mo>=</mo><msub><mi>t</mi><mi>j</mi></msub><mo>Ã—</mo><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>+</mo><mi>l</mi><mi>f</mi><mi>t</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">sum_j = t_j \times diff[j] + lft[j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>ï¼ˆæ­¤å¤„çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">diff</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span></span></span></span> ä¸ºæ±‚å‰ç¼€å’Œè¿˜åŸåçš„ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>f</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">lft</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span></span></span></span> ä¸ºå‰©ä½™éƒ¨åˆ†ï¼‰ã€‚</p><p>éå†æ‰€æœ‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span>ï¼Œåˆ†åˆ«è®°å½•ä¸€ä¸‹æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼Œæœ€ååˆ¤æ–­ä¸€ä¸‹æ˜¯å¦ <strong>å°äº</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>;<br><br>ll pre[N];   <span class="hljs-comment">// å¸æ”¶é­”åŠ›å€¼å‰ç¼€å’Œ</span><br>ll lft[N];   <span class="hljs-comment">// a_i ä¼šå‡ä¸º 0 é‚£ä¸ªæ—¶é—´å‰©ä½™éƒ¨åˆ†çš„é­”åŠ› </span><br><span class="hljs-type">int</span> diff[N]; <span class="hljs-comment">// å·®åˆ† ç»Ÿè®¡æ¯ä¸ª a_i å¯¹ sum_j çš„è´¡çŒ®</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> n, k; cin &gt;&gt; n &gt;&gt; k;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">a</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span>, <span class="hljs-title">t</span><span class="hljs-params">(n + <span class="hljs-number">1</span>)</span></span>;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; t[i];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) pre[i] = pre[i - <span class="hljs-number">1</span>] + t[i]; <span class="hljs-comment">// t çš„å‰ç¼€å’Œ</span><br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-type">int</span> l = i, r = n; <span class="hljs-comment">// [i, n] å†…äºŒåˆ†æ‰¾åˆ°æ¯ä¸ª a_i ä¼šå˜ä¸º 0 çš„ä½ç½®</span><br>        <span class="hljs-keyword">while</span>(l &lt; r)&#123;<br>            <span class="hljs-type">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">if</span>(pre[mid] - pre[i - <span class="hljs-number">1</span>] &gt;= a[i]) r = mid;<br>            <span class="hljs-keyword">else</span> l = mid + <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(pre[r] - pre[i - <span class="hljs-number">1</span>] &lt; a[i]) diff[i] ++ ; <span class="hljs-comment">// åˆ°æœ€åéƒ½ä¸ä¼šå˜ä¸º 0</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(pre[r] - pre[i - <span class="hljs-number">1</span>] == a[i]) diff[i] ++ , diff[r + <span class="hljs-number">1</span>] -- ; <span class="hljs-comment">// æ­£å¥½å˜ä¸º 0</span><br>        <span class="hljs-keyword">else</span> &#123;<br>            diff[i] ++ , diff[r] -- ; <span class="hljs-comment">// åœ¨poså˜ä¸º0ï¼Œä½†æ˜¯ä¸æ»¡å½“å‰ t_pos</span><br>            lft[r] += a[i] - (pre[r - <span class="hljs-number">1</span>] - pre[i - <span class="hljs-number">1</span>]);  <span class="hljs-comment">// ç´¯åŠ å½“å‰å‰©ä½™éƒ¨åˆ†</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ ) diff[j] += diff[j - <span class="hljs-number">1</span>]; <span class="hljs-comment">// å·®åˆ†æ±‚å‰ç¼€å’Œ æ¯ä¸ª sum_j æ»¡ t_j çš„ä¸ªæ•°</span><br>    <br>    ll mx = <span class="hljs-number">0</span>, mn = <span class="hljs-number">2e18</span>; <span class="hljs-comment">// æœ€å¤§ æœ€å°</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )&#123;<br>        ll sum = (ll)t[j] * diff[j] + lft[j]; <span class="hljs-comment">// æ¯ä¸ªsum_j</span><br>        mx = <span class="hljs-built_in">max</span>(mx, sum), mn = <span class="hljs-built_in">min</span>(mn, sum);<br>    &#125;<br><br>    ll d = mx - mn;<br>    cout &lt;&lt; (d &gt; k ? <span class="hljs-string">&quot;YES&quot;</span> : <span class="hljs-string">&quot;NO&quot;</span>) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    cout &lt;&lt; d &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br> <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="E-æ˜Ÿå±‘å¹»æƒ³-Stardust-Reverie"><strong>E. æ˜Ÿå±‘å¹»æƒ³ Stardust Reverie</strong></h2><h3 id="é¢˜ç›®æè¿°-5"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€é¢—æ— å‘æ ‘ï¼Œä»»é€‰ä¸‰ä¸ªç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo separator="true">,</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A, B, C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>ï¼Œæ±‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>max</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub><mo>+</mo><mi>min</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>A</mi></mrow></msub><mo separator="true">,</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>B</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\max{(dist_{AB} + \min{(dist_{CA}, dist_{CB})})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">CB</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mclose">)</span></span></span></span></span> ã€‚<a href="https://www.luogu.com.cn/problem/T423196">æ˜Ÿå±‘å¹»æƒ³ Stardust Reverie</a></p><h3 id="è§£é¢˜æ€è·¯-è´ªå¿ƒ-æ ‘çš„ç›´å¾„-æšä¸¾"><strong>è§£é¢˜æ€è·¯ è´ªå¿ƒ + æ ‘çš„ç›´å¾„ + æšä¸¾</strong></h3><p>æˆ‘ä»¬ä¸å¦¨å‡è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> è·ç¦» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> æ¯” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> è·ç¦» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> æ›´è¿‘ï¼Œä¹Ÿå°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>A</mi></mrow></msub><mo>â‰¤</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">dist_{CA} \le dist_{CB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">CB</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ€ç»ˆçš„ç­”æ¡ˆä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>A</mi></mrow></msub><mo>+</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">dist_{CA} + dist_{AB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚</p><p>å¯¹äºè·¯å¾„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>A</mi></mrow></msub><mo>+</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">dist_{CA} + dist_{AB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š</p><ul><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>â†’</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">C \rightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> çš„è·¯å¾„å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>â†’</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \rightarrow B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> çš„è·¯å¾„<strong>ä¸­é—´éƒ¨åˆ†</strong>å­˜åœ¨äº¤ç‚¹ã€‚</p><p>å‡è®¾äº¤ç‚¹ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>ï¼Œç”±äºæ˜¯ä¸€é¢—æ ‘ï¼Œä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„è·¯å¾„æ˜¯å”¯ä¸€çš„ï¼Œæ•… <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>â†’</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">C \rightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> ä¸­çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>â†’</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">D \rightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> éƒ¨åˆ†ä¸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>â†’</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \rightarrow B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>â†’</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">A \rightarrow D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> çš„éƒ¨åˆ†æ˜¯å®Œå…¨é‡åˆçš„ã€‚æ‰€ä»¥å½“å‰æƒ…å†µä¸‹çš„è·¯å¾„åªæœ‰å¯èƒ½å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>  <div align='center'>      <img src="https://s2.loli.net/2024/12/14/6SUCuEdnDz3XBIx.png" width='60%' />  </div><p>æ˜¾ç„¶ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">dist_{CA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å…·æœ‰é™åˆ¶ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å‘ç° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">dist_{AB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å¹¶æ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œæ•…åŸºäºè´ªå¿ƒçš„æ€æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥ <strong>è®© <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">dist_{AB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å°½å¯èƒ½é•¿</strong>ã€‚ç”±äºæ˜¯ä¸€æ£µæ ‘ï¼Œæœ€é•¿çš„ä¸¤ç‚¹ä¹‹é—´è·ç¦»ï¼Œå½“ä¸º <strong>æ ‘çš„ç›´å¾„</strong>ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬åŸºäºè´ªå¿ƒæ€æƒ³å¾—åˆ°çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> å°±æ˜¯æ ‘çš„ç›´å¾„çš„ä¸¤ä¸ªç«¯ç‚¹ã€‚ï¼ˆè¿™é‡Œæš‚ä¸”å…ˆä¸è¯æ˜é€‰å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> ä¸ºæ ‘çš„ç›´å¾„ç«¯ç‚¹çš„æ­£ç¡®æ€§ï¼Œåé¢æœ‰ç›¸å…³è¯æ˜ï¼‰</p><p>æ‰€ä»¥å½“å‰æƒ…å†µä¸‹çš„ç­”æ¡ˆä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">dist_{CA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> <strong>+ æ ‘çš„ç›´å¾„</strong></p></li><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>â†’</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">C \rightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> çš„è·¯å¾„å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>â†’</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \rightarrow B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> çš„è·¯å¾„<strong>ä¸­é—´éƒ¨åˆ†</strong>æ²¡æœ‰äº¤ç‚¹ã€‚</p><p>å½“å‰æƒ…å†µï¼Œè¡¨æ˜è·¯å¾„å°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>â†’</mo><mi>A</mi><mo>â†’</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">C \rightarrow A \rightarrow B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>ï¼Œæ­¤æ—¶è·¯å¾„å½¢æˆä¸€æ¡é“¾ã€‚ç„¶è€Œæ ‘ä¸­ä¸€æ¡é“¾æœ€é•¿é•¿åº¦ä¹Ÿå°±æ˜¯æ ‘çš„ç›´å¾„ï¼Œæ­¤æ—¶æœ€å¤šåªèƒ½å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">dist_{CB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">CB</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸ºæ ‘çš„ç›´å¾„ã€‚</p><p>æ‰€ä»¥å½“å‰æƒ…å†µä¸‹çš„ç­”æ¡ˆä¸º <strong>æ ‘çš„ç›´å¾„</strong>ï¼Œæ˜¾ç„¶ä¸å¦‚å‰é¢æœ‰äº¤ç‚¹çš„æƒ…å†µã€‚</p></li></ul><p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ±‚å‡ºæ ‘çš„ç›´å¾„ï¼Œå¾—åˆ°æ ‘çš„ç›´å¾„å¯¹åº”çš„ç«¯ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>ã€‚æ­¤å¤„æˆ‘ä»¬ä¸å†å‡è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> è·ç¦» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> æ›´è¿‘äº†ï¼Œå¯¹äºå‰©ä¸‹çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>A</mi></mrow></msub><mo separator="true">,</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>B</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\min{(dist_{CA}, dist_{CB})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">CB</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>ï¼Œæˆ‘ä»¬å¯ä»¥åè¿‡æ¥è€ƒè™‘ï¼Œ<strong>æšä¸¾æ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ä½œä¸ºç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>ï¼Œå–æœ€å¤§çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>A</mi></mrow></msub><mo separator="true">,</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>B</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\min{(dist_{CA}, dist_{CB})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">CB</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> åŠ ä¸Šå³å¯</strong>ã€‚</p><p>å¯¹äºæ±‚æ ‘çš„ç›´å¾„ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•ï¼Œåˆ†åˆ«ä¸º <strong>ä¸¤æ¬¡</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>f</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">dfs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">df</span><span class="mord mathnormal">s</span></span></span></span> å’Œ <strong>æ ‘å½¢DP</strong>ã€‚é¢˜è§£ä¸­å°†é‡‡ç”¨ <strong>ä¸¤æ¬¡</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>f</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">dfs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">df</span><span class="mord mathnormal">s</span></span></span></span> æ±‚å¾—æ ‘çš„ç›´å¾„é•¿åº¦åŠå…¶ä¸¤ä¸ªç«¯ç‚¹ã€‚ï¼ˆå…³äºæ ‘çš„ç›´å¾„çƒé˜€åŠæ±‚æ³•æ­£ç¡®æ€§å¯ä»¥çœ‹ <a href="https://oi-wiki.org/graph/tree-diameter/">OI Wiki æ ‘çš„ç›´å¾„</a>ï¼‰</p><p>å¯¹äºæšä¸¾çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸¤ä¸ªç«¯ç‚¹å¼€å§‹æ±‚å‡ºå„è‡ªåˆ°å…¶ä»–ç‚¹çš„æ ‘ä¸Šè·ç¦»ï¼Œå¯ä»¥é‡‡ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>f</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">dfs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">df</span><span class="mord mathnormal">s</span></span></span></span> æˆ–è€… <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>f</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">bfs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">s</span></span></span></span> ç­‰ç­‰ã€‚é¢˜è§£ä¸­ï¼Œæˆ‘ç”¨äº† <strong>åŒæº</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>f</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">bfs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">s</span></span></span></span>ï¼ˆåå­—å¤§æ¦‚æ˜¯æˆ‘è‡ªå·±å–çš„ï¼‰çš„æŠ€å·§ï¼Œå°±æ˜¯å°†ä¸¤ä¸ªç«¯ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> åŒæ—¶å…¥é˜Ÿï¼Œå®šä¹‰æ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">d[u]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>A</mi></mrow></msub><mo separator="true">,</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>B</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\min{(dist_{CA}, dist_{CB})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">CB</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>ï¼Œåœ¨åŒæº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>f</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">bfs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">s</span></span></span></span> çš„è¿‡ç¨‹ä¸­ï¼Œç¬¬ä¸€æ¬¡è®¿é—®åˆ°ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span>ï¼Œå…¶æ›´æ–°å¾—åˆ°çš„è·ç¦»å°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>A</mi></mrow></msub><mo separator="true">,</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mrow><mi>C</mi><mi>B</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\min{(dist_{CA}, dist_{CB})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">CB</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>ã€‚æœ€åæšä¸¾å¾—åˆ°æœ€å¤§çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">d[u]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span>ï¼ŒåŠ ä¸Šæ ‘çš„ç›´å¾„çš„é•¿åº¦å³ä¸ºç­”æ¡ˆã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">2e5</span> + <span class="hljs-number">10</span>, M = (N &lt;&lt; <span class="hljs-number">1</span>);<br><br><span class="hljs-type">int</span> h[N], e[M], ne[M], w[M], idx;<br><span class="hljs-comment">// é“¾å¼å‰å‘æ˜Ÿ</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">int</span> c)</span></span>&#123;<br>    e[ ++ idx] = b, ne[idx] = h[a], w[idx] = c, h[a] = idx;<br>&#125;<br><br>ll dist[N];  <span class="hljs-comment">// ä¸¤æ¬¡dfsæ±‚æ ‘çš„ç›´å¾„</span><br><span class="hljs-type">int</span> a, b, f; <span class="hljs-comment">// a, b æ ‘çš„ç›´å¾„ç«¯ç‚¹ f ä¸ºä»å½“å‰æ ¹èŠ‚ç‚¹å‘ä¸‹æœç´¢å¾—åˆ°çš„æœ€è¿œç‚¹</span><br><span class="hljs-comment">// dfsæ±‚æ ‘çš„ç›´å¾„</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> fa)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; i; i = ne[i])&#123;<br>        <span class="hljs-type">int</span> v = e[i];<br>        <span class="hljs-keyword">if</span>(v == fa) <span class="hljs-keyword">continue</span>;<br>        dist[v] = dist[u] + w[i];    <span class="hljs-comment">// è‡ªé¡¶å‘ä¸‹æ›´æ–°</span><br>        <span class="hljs-keyword">if</span>(dist[v] &gt; dist[f]) f = v; <span class="hljs-comment">// æ›´æ–°æœ€è¿œç‚¹</span><br>        <span class="hljs-built_in">dfs</span>(v, u);<br>    &#125;<br>&#125;<br><br>ll d[N];<br><span class="hljs-comment">// åŒæºbfsæ±‚d[u]ï¼Œå³ \min(dist_&#123;CA&#125;, dist_&#123;CB&#125;)</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">memset</span>(d, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> d);<br>    queue&lt;<span class="hljs-type">int</span>&gt; q;<br>    q.<span class="hljs-built_in">push</span>(a), d[a] = <span class="hljs-number">0</span>;<br>    q.<span class="hljs-built_in">push</span>(b), d[b] = <span class="hljs-number">0</span>;  <span class="hljs-comment">// åŒæ—¶å…¥é˜Ÿ</span><br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-type">int</span> u = q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; i; i = ne[i])&#123;<br>            <span class="hljs-type">int</span> v = e[i];<br>            <span class="hljs-keyword">if</span>(d[v] &gt; d[u] + w[i]) q.<span class="hljs-built_in">push</span>(v), d[v] = d[u] + w[i];<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> n, m; cin &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">while</span>(m -- )&#123;  <span class="hljs-comment">// é¢˜ç›®ç¡®å®šæ˜¯ä¸€ä¸ªæ ‘ï¼Œmå…¶å®æ²¡ç”¨ï¼Œè¿™é‡Œç”šè‡³for[1...n]éƒ½å¯ä»¥</span><br>        <span class="hljs-type">int</span> u, v, c; cin &gt;&gt; u &gt;&gt; v &gt;&gt; c; <br>        <span class="hljs-built_in">add</span>(u, v, c), <span class="hljs-built_in">add</span>(v, u, c);<br>    &#125;<br><br>    f = <span class="hljs-number">1</span>;<br>    <span class="hljs-built_in">dfs</span>(<span class="hljs-number">1</span>, <span class="hljs-number">-1</span>); <span class="hljs-comment">// ä»èŠ‚ç‚¹1æœç´¢å¾—åˆ°æœ€è¿œç‚¹ ä¸€å®šæ˜¯æ ‘çš„ç›´å¾„çš„ç«¯ç‚¹ä¹‹ä¸€</span><br>    a = f;      <span class="hljs-comment">// A é€‰å–ä¸ºæ ‘çš„ç›´å¾„ç«¯ç‚¹</span><br><br>    dist[f] = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">dfs</span>(f, <span class="hljs-number">-1</span>); <span class="hljs-comment">// ä»å½“å‰ç«¯ç‚¹ç¬¬äºŒæ¬¡æœç´¢ï¼Œå¾—åˆ°æœ€è¿œç‚¹ï¼Œå³æ ‘çš„ç›´å¾„çš„å¦ä¸€ä¸ªç«¯ç‚¹</span><br>    b = f;      <span class="hljs-comment">// B é€‰å–ä¸ºæ ‘çš„ç›´å¾„å¦ä¸€ä¸ªç«¯ç‚¹ï¼Œç¬¬äºŒæ¬¡dfsæ±‚å¾—çš„dist[f]å³æ ‘çš„ç›´å¾„</span><br><br>    <span class="hljs-built_in">bfs</span>();      <span class="hljs-comment">// åŒæºbfsæ±‚d[u]</span><br><br>    ll res = <span class="hljs-number">0</span>; <span class="hljs-comment">// æšä¸¾Cç‚¹</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) res = <span class="hljs-built_in">max</span>(res, dist[f] + d[i]);<br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br/><h3 id="é€‰å–-A-B-ä¸ºæ ‘çš„ç›´å¾„ç«¯ç‚¹çš„æ­£ç¡®æ€§"><strong>é€‰å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A, B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> ä¸ºæ ‘çš„ç›´å¾„ç«¯ç‚¹çš„æ­£ç¡®æ€§</strong></h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡åè¯æ³•æ¥è¯æ˜é€‰å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mtext>ï¼Œ</mtext><mi>B</mi></mrow><annotation encoding="application/x-tex">Aï¼ŒB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> ä¸ºæ ‘çš„ç›´å¾„ç«¯ç‚¹è¿™ä¸€è´ªå¿ƒæ€è·¯çš„æ­£ç¡®æ€§ã€‚</p><p>å‡è®¾æˆ‘ä»¬é€‰å–çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mtext>ï¼Œ</mtext><mi>B</mi></mrow><annotation encoding="application/x-tex">Aï¼ŒB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> ä¸æ˜¯æ ‘çš„ç›´å¾„çš„ç«¯ç‚¹ï¼Œè€Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mtext>ï¼Œ</mtext><mi>E</mi></mrow><annotation encoding="application/x-tex">Dï¼ŒE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> ä¸ºæ ‘çš„ç›´å¾„ç«¯ç‚¹ã€‚ç”±äºæ ‘çš„ç›´å¾„çš„ç‰¹æ€§ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> ä¸€å®šæœ‰äº¤ç‚¹åœ¨æ ‘çš„ç›´å¾„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">DE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> ä¸Šï¼Œäº¤ç‚¹ä¹‹é—´çš„è·¯å¾„æ˜¯å®Œå…¨é‡å¤çš„ï¼Œå¯¹åæœŸçš„è¯æ˜æ²¡æœ‰ä»€ä¹ˆå½±å“ï¼Œæ•…æˆ‘ä»¬å®Œå…¨å¯ä»¥è®¤ä¸ºäº¤ç‚¹æ˜¯åŒä¸€ä¸ªï¼Œæˆ‘ä»¬è®°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><div align='center'>    <img src="https://s2.loli.net/2024/12/14/BU32zpw7lMVbKTD.png" width='50%' /></div><p>ç”±äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">DE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> ä¸ºæ ‘çš„ç›´å¾„ï¼Œè€Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">AB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> ä¸æ˜¯ï¼Œæ•…æˆ‘ä»¬éœ€è¦æ»¡è¶³ä»¥ä¸‹å…³ç³»ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mo>+</mo><mi>b</mi><mo>&lt;</mo><mi>d</mi><mo>+</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">a + b &lt; d + f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span></p><p>åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜ä¸èƒ½è®© <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">AD</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">AE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">BD</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">BE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">BE</span></span></span></span> çš„è·¯å¾„é•¿åº¦ä¸ºæ ‘çš„ç›´å¾„ï¼Œæ•…éœ€è¦è¿˜æ»¡è¶³ä»¥ä¸‹å…³ç³»ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mo>+</mo><mi>d</mi><mo>&lt;</mo><mi>d</mi><mo>+</mo><mi>f</mi><mo>â†’</mo><mi>a</mi><mo>&lt;</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">a + d &lt; d + f \rightarrow a &lt; f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mo>+</mo><mi>f</mi><mo>&lt;</mo><mi>d</mi><mo>+</mo><mi>f</mi><mo>â†’</mo><mi>a</mi><mo>&lt;</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">a + f &lt; d + f \rightarrow a &lt; d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>b</mi><mo>+</mo><mi>d</mi><mo>&lt;</mo><mi>d</mi><mo>+</mo><mi>f</mi><mo>â†’</mo><mi>b</mi><mo>&lt;</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">b + d &lt; d + f \rightarrow b &lt; f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>b</mi><mo>+</mo><mi>f</mi><mo>&lt;</mo><mi>d</mi><mo>+</mo><mi>f</mi><mo>â†’</mo><mi>b</mi><mo>&lt;</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">b + f &lt; d + f \rightarrow b &lt; d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></span></p><p>æˆ‘ä»¬å¯ä»¥å†å‡è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>&lt;</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a &lt; b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> ä¸” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>&gt;</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">d &gt; f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>ï¼Œå¯¹äºæ­¤æ—¶æˆ‘ä»¬é€‰å–çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A, B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>ï¼Œæˆ‘ä»¬å¯ä»¥é€‰å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> ä½œä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>ï¼Œå³é€‰æ‹©è·¯å¾„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>â†’</mo><mi>F</mi><mo>â†’</mo><mi>A</mi><mo>â†’</mo><mi>F</mi><mo>â†’</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">D \rightarrow F \rightarrow A \rightarrow F \rightarrow B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>ï¼Œæ­¤æ—¶å¾—åˆ°æœ€é•¿é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>+</mo><mn>2</mn><mo>Ã—</mo><mi>a</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">d + 2 \times a + b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> ã€‚</p><p>ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¦‚æœä»»æ„é€‰å–è·¯å¾„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>â†’</mo><mi>F</mi><mo>â†’</mo><mi>E</mi><mo>â†’</mo><mi>F</mi><mo>â†’</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">B \rightarrow F \rightarrow E \rightarrow F \rightarrow D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>ï¼Œé‚£ä¹ˆè·¯å¾„é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>+</mo><mn>2</mn><mo>Ã—</mo><mi>f</mi><mo>+</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">b + 2 \times f + d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span> ã€‚æ ¹æ®å‰é¢éœ€è¦æ»¡è¶³çš„å…³ç³» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>&lt;</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">a &lt; f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>ï¼Œæ˜¾ç„¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>+</mo><mn>2</mn><mo>Ã—</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo>&lt;</mo><mi>d</mi><mo>+</mo><mn>2</mn><mo>Ã—</mo><mi>f</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">d + 2 \times a + b &lt; d + 2 \times f + b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> ã€‚æ‰€ä»¥ï¼Œå¦‚æœé€‰å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mtext>ï¼Œ</mtext><mi>B</mi></mrow><annotation encoding="application/x-tex">Aï¼ŒB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> ä¸æ˜¯æ ‘çš„ç›´å¾„çš„ç«¯ç‚¹ï¼Œé‚£ä¹ˆå¿…æœ‰ä¸€æ¡è·¯å¾„æ¯”æ­¤æ—¶é€‰å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A, B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> èƒ½å¤Ÿå¾—åˆ°çš„æœ€é•¿è·¯å¾„é•¿åº¦æ›´é•¿ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬åè¯æ³•å¯ä»¥å¾—åˆ°ï¼Œé€‰å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A, B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> ä¸ºæ ‘çš„ç›´å¾„ç«¯ç‚¹è¿™ä¸€è´ªå¿ƒç­–ç•¥æ˜¯æœ€ä¼˜çš„ã€‚</p><br/><h3 id="å…³äºå­˜åœ¨å¤šå¯¹æ ‘çš„ç›´å¾„ç«¯ç‚¹çš„é—®é¢˜"><strong>å…³äºå­˜åœ¨å¤šå¯¹æ ‘çš„ç›´å¾„ç«¯ç‚¹çš„é—®é¢˜</strong></h3><p>è¿˜æ˜¯å’Œå‰é¢ç±»ä¼¼çš„ä¸€å¼ å›¾ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><div align='center'>    <img src="https://s2.loli.net/2024/12/14/yjg4fb3VhmYuNRl.png" width='50%' /></div><p>æˆ‘ä»¬å‡è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A, B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo separator="true">,</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">D, E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> æ˜¯ä¸¤å¯¹æ ‘çš„ç›´å¾„ç«¯ç‚¹ã€‚æ˜¾ç„¶æˆ‘ä»¬éœ€è¦æ»¡è¶³ä»¥ä¸‹å…³ç³»ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mo>+</mo><mi>b</mi><mo>=</mo><mi>d</mi><mo>+</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">a + b = d + f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span></p><p>å› ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> å„è‡ªéƒ½æ˜¯æ ‘çš„ç›´å¾„ç«¯ç‚¹ï¼Œè€Œä¸”ä¸¤ç‚¹ä¹‹é—´çš„è·¯å¾„é•¿åº¦è¿˜å¿…é¡»æ»¡è¶³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰¤</mo></mrow><annotation encoding="application/x-tex">\le</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">â‰¤</span></span></span></span> æ ‘çš„ç›´å¾„é•¿åº¦ï¼Œæ‰€ä»¥æ­¤æ—¶åªæœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">AD</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> è·¯å¾„è·ç¦»é•¿åº¦ä¹Ÿæ˜¯æ ‘çš„ç›´å¾„é•¿åº¦æ‰èƒ½åŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶ã€‚ä¹Ÿå°±æ˜¯æ»¡è¶³å¦‚ä¸‹å…³ç³»ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mo>+</mo><mi>d</mi><mo>=</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo>=</mo><mi>d</mi><mo>+</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">a + d = a + b = d + f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span></p><p>ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">b = d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span> ä¸” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">a = f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>ã€‚</p><p>ç±»ä¼¼ä¸Šé¢çš„è¯æ˜ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¾—åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">a = d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span> ä¸” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">b = f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>ï¼Œæ•…æˆ‘ä»¬å¯ä»¥å‘ç°ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mo>=</mo><mi>b</mi><mo>=</mo><mi>d</mi><mo>=</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">a = b = d = f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span></p><p>æ‰€ä»¥ï¼Œå¯¹äºå­˜åœ¨å¤šå¯¹æ ‘çš„ç›´å¾„ç«¯ç‚¹çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæœ€é•¿çš„è·¯å¾„é•¿åº¦ä¸€å®šæ˜¯åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo separator="true">,</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A, B, C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> é€‰å–ä¸ºä¸‰ä¸ªä¸åŒçš„æ ‘çš„ç›´å¾„çš„ç«¯ç‚¹æ—¶å¾—åˆ°çš„ï¼Œæ­¤æ—¶çš„ç­”æ¡ˆå°±æ˜¯ <strong>ä¸¤å€çš„æ ‘çš„ç›´å¾„é•¿åº¦</strong>ï¼ˆé€‰å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> ä¸ºéæ ‘çš„ç›´å¾„ç«¯ç‚¹æ˜¾ç„¶ä¸ä¼šæ›´é•¿ï¼‰ã€‚</p><p>å› æ­¤ï¼Œå®Œå…¨ä¸ç”¨æ‹…å¿ƒå‡ºç°å¤šå¯¹æ ‘çš„ç›´å¾„çš„æƒ…å†µï¼Œä»»æ„é€‰å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A, B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> ä¸ºä¸€å¯¹æ ‘çš„ç›´å¾„ç«¯ç‚¹åï¼Œæšä¸¾åˆ°æœ€åçš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> ä¸€å®šä¼šæ˜¯å¦ä¸€ä¸ªæ ‘çš„ç›´å¾„çš„ç«¯ç‚¹ï¼Œä¸”ç­”æ¡ˆå°±æ˜¯ä¸¤å€æ ‘çš„ç›´å¾„ã€‚</p><h2 id="F-æ¬¢è¿æ¥åˆ°é›¾é›¨é­”æ³•åº—"><strong>F. æ¬¢è¿æ¥åˆ°é›¾é›¨é­”æ³•åº—</strong></h2><h3 id="é¢˜ç›®æè¿°-6"><strong>é¢˜ç›®æè¿°</strong></h3><p>åˆå§‹æƒ…å†µä¸‹æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ªç‚¹ï¼Œæ¯ä¸ªç‚¹å¯¹åº”ä¸€ä¸ªä¸‹æ ‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ ä¸€ä¸ªå€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚ç»™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> æ¬¡æ“ä½œï¼š</p><p>å¯¹äºæ“ä½œ <code>1 l r</code>ï¼Œåˆ™è¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> åŒºé—´èŒƒå›´å†…å‰ç¼€å’Œçš„æœŸæœ›ï¼ˆå¹³å‡å€¼ï¼Œå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mi>l</mi></mrow><mi>r</mi></msubsup><msub><mi>s</mi><mi>i</mi></msub></mrow><mrow><mi>r</mi><mo>âˆ’</mo><mi>l</mi><mo>+</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\sum_{i=l}^r s_i}{r - l + 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4633em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.06em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mbin mtight">âˆ’</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.535em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7385em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3214em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ï¼Œå…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸ºå‰ç¼€å’Œï¼‰ã€‚</p><p>å¯¹äºæ“ä½œ <code>2 x y</code>ï¼Œå°†ä¸‹æ ‡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> çš„å€¼ <strong>å¢åŠ </strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ã€‚</p><p><a href="https://www.luogu.com.cn/problem/T423191">ã€ŒYAC Round 3ã€æ¬¢è¿æ¥åˆ°é›¾é›¨é­”æ³•åº—</a></p><h3 id="è§£é¢˜æ€è·¯-åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘-ç»´æŠ¤å‰ç¼€å’ŒåŒºé—´å’Œ"><strong>è§£é¢˜æ€è·¯ åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ + ç»´æŠ¤å‰ç¼€å’ŒåŒºé—´å’Œ</strong></h3><p>æ ¹æ®æ•°æ®èŒƒå›´ï¼Œé‡‡ç”¨ä¸€èˆ¬çº¿æ®µæ ‘æ— ç–‘ä¼šå†…å­˜è¶…é™ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦è¿›è¡Œç¦»æ•£åŒ–ï¼Œä½†æ˜¯æœ¬é¢˜åœ¨ä¸¤ç§æ“ä½œä¸­éƒ½ä¼šå‡ºç°å…ˆå‰æœªå‡ºç°è¿‡çš„ä¸‹æ ‡ï¼ˆå¯¹åº”é¢˜ä¸­çš„ç­‰çº§ï¼‰ã€‚æ•…å¦‚æœé‡‡ç”¨ç¦»æ•£åŒ–çš„æŠ€å·§ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»æŠŠæ“ä½œä¸­æ‰€æœ‰çš„ä¸‹æ ‡ä¹Ÿå­˜èµ·æ¥å†è¿›è¡Œç¦»æ•£åŒ–ï¼Œè€Œæ“ä½œåˆæ¶‰åŠåŒºé—´è¯¢é—®ï¼ŒåŒºé—´çš„ç¦»æ•£åŒ–æ˜¾ç„¶ä¼šæ¯”è¾ƒç¹çï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è½¬è€Œé‡‡ç”¨å¦å¤–ä¸€ç§æŠ€å·§ <strong>åŠ¨æ€å¼€ç‚¹</strong>ã€‚ï¼ˆ<a href="https://www.cnblogs.com/light-house/p/11756048.html">åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘</a>ï¼‰</p><p>å› ä¸ºä¸‹æ ‡æ•°æ®èŒƒå›´ï¼Œè¾¾åˆ°äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>32</mn></mrow><annotation encoding="application/x-tex">32</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">32</span></span></span></span> ä½å¸¦ç¬¦å·æ•´æ•°ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å®šä¹‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>INF</mtext><mo>=</mo><mn>2147483647</mn></mrow><annotation encoding="application/x-tex">\text{INF} = 2147483647</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">INF</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2147483647</span></span></span></span>ï¼Œå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>31</mn></msup><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{31} - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">31</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mtext>INF</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1, \text{INF}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">INF</span></span><span class="mclose">]</span></span></span></span> ä¸ºæˆ‘ä»¬çš„æ“ä½œåŒºé—´ã€‚</p><p>åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘å¼€çš„ç©ºé—´å¤§å°éœ€è¦å…³æ³¨çš„æ˜¯ <strong>æ“ä½œæ¬¡æ•°</strong> å’Œ <strong>åŒºé—´èŒƒå›´</strong>ï¼Œæ³¨æ„æ“ä½œæ¬¡æ•°è¿˜åŒ…æ‹¬äº†å‰é¢åˆå§‹çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´æ“ä½œæ¬¡æ•°çš„ä¸Šé™ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">2\times 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span>ã€‚å¯¹äºæ¯æ¬¡æ“ä½œçš„åŒºé—´ï¼Œæˆ‘ä»¬æœ€å¤šæ¶‰åŠåˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> ä¸ªèŠ‚ç‚¹ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> å°±æ˜¯åŒºé—´èŒƒå›´å¤§å°ï¼‰ï¼Œæ ¹æ®é¢˜ä¸­æ‰€ç»™æ•°æ®èŒƒå›´æ˜¾ç„¶æˆ‘ä»¬åªéœ€è¦å¼€ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>32</mn></mrow><annotation encoding="application/x-tex">32</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">32</span></span></span></span> å€çš„æ“ä½œæ¬¡æ•°å¤§å°ç©ºé—´å³å¯ã€‚</p><p>è§£å†³äº†ç©ºé—´é—®é¢˜ï¼Œé‚£ä¹ˆå¦‚ä½•å¤„ç†æ“ä½œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä¸­çš„å‰ç¼€å’ŒæœŸæœ›å€¼å‘¢ï¼Ÿ</p><p>å¦‚æœæ¯æ¬¡å¤„ç†æ“ä½œ <code>1 l r</code>ï¼ŒæŠŠèŒƒå›´å†…çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><msub><mi>m</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">sum_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å…¨éƒ¨æ±‚å‡ºæ¥å†ç´¯åŠ ï¼Œæœ€åå†é™¤ä»¥åŒºé—´é•¿åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>âˆ’</mo><mi>l</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r - l + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œå¾ˆæ˜æ˜¾æ˜¯ä¼šè¶…æ—¶çš„ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ <strong>ç»´æŠ¤å‰ç¼€å’Œçš„åŒºé—´å’Œ</strong>ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å°† <strong>å•ç‚¹ä¿®æ”¹æ“ä½œè½¬æ¢ä¸ºåŒºé—´ä¿®æ”¹æ“ä½œ</strong>ã€‚æ¯”å¦‚ä¸‹æ ‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> ä¸Šçš„å€¼è¦åŠ ä¸Š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ï¼Œä¸‹æ ‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> å¯¹åº”çš„å‰ç¼€å’Œä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><msub><mi>m</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">sum_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼ˆå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1, x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span> èŒƒå›´å†…çš„å¯¹åº”æ•°å€¼ä¹‹å’Œï¼‰ã€‚é‚£ä¹ˆåŸºäºå‰ç¼€å’Œçš„æ€§è´¨ï¼Œä¸‹æ ‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> åé¢çš„ä½ç½®ä¹Ÿéƒ½éœ€è¦åŠ ä¸Š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ï¼Œå³å¯¹åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo separator="true">,</mo><mtext>INF</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x, \text{INF}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">INF</span></span><span class="mclose">]</span></span></span></span> èŒƒå›´å†…æ¯ä¸ªæ•°éƒ½è¦åŠ ä¸Š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ã€‚ç”±æ­¤ï¼Œæˆ‘ä»¬å°†å•ç‚¹ä¿®æ”¹æ“ä½œè½¬å˜ä¸ºäº†åŒºé—´ä¿®æ”¹æ“ä½œã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºæ“ä½œ <code>1 l r</code>ï¼Œæˆ‘ä»¬åªéœ€è¦è¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> èŒƒå›´å†…çš„å‰ç¼€å’ŒåŒºé—´å’Œå†é™¤ä»¥åŒºé—´é•¿åº¦å³å¯ï¼›å¯¹äºæ“ä½œ <code>2 x y</code> ä»¥åŠåˆå§‹åŒ–æ“ä½œï¼Œæˆ‘ä»¬åˆ™éœ€è¦è¿›è¡ŒåŒºé—´ä¿®æ”¹ï¼Œå°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo separator="true">,</mo><mtext>INF</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x, \text{INF}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">INF</span></span><span class="mclose">]</span></span></span></span> èŒƒå›´å†…æ‰€æœ‰æ•°åŠ ä¸Š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">2e5</span> + <span class="hljs-number">10</span>, INF = <span class="hljs-number">2147483647</span>; <br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123;<span class="hljs-type">int</span> ls, rs; ll sum, lazy;&#125;tr[N * <span class="hljs-number">32</span>]; <span class="hljs-comment">// åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘</span><br><span class="hljs-type">int</span> root, tot; <span class="hljs-comment">// rootä¸ºæ ¹èŠ‚ç‚¹ totä¸ºæ¶‰åŠèŠ‚ç‚¹ä¸ªæ•°</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">pushup</span><span class="hljs-params">(<span class="hljs-type">int</span> u)</span></span>&#123;<br>    tr[u].sum = tr[tr[u].ls].sum + tr[tr[u].rs].sum;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">pushdown</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(tr[u].lazy)&#123; <span class="hljs-comment">// æ‡’æ ‡è®°</span><br>        <span class="hljs-type">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span>(!tr[u].ls) tr[u].ls = ++ tot;<br>        <span class="hljs-keyword">if</span>(!tr[u].rs) tr[u].rs = ++ tot; <span class="hljs-comment">// åŠ¨æ€å¼€ç‚¹</span><br>        tr[tr[u].ls].lazy += tr[u].lazy;<br>        tr[tr[u].ls].sum += tr[u].lazy * (mid - l + <span class="hljs-number">1</span>);<br>        tr[tr[u].rs].lazy += tr[u].lazy;<br>        tr[tr[u].rs].sum += tr[u].lazy * (r - mid);   <br>        tr[u].lazy = <span class="hljs-number">0</span>;     <br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">modify</span><span class="hljs-params">(<span class="hljs-type">int</span> &amp;u, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r, <span class="hljs-type">int</span> ql, <span class="hljs-type">int</span> qr, ll x)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(!u) u = ++ tot;  <span class="hljs-comment">// åŠ¨æ€å¼€ç‚¹</span><br>    <span class="hljs-keyword">if</span>(ql &lt;= l &amp;&amp; r &lt;= qr)&#123;<br>        tr[u].lazy += x, tr[u].sum += x * (r - l + <span class="hljs-number">1</span>); <br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-built_in">pushdown</span>(u, l, r);<br>    <span class="hljs-type">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span>(ql &lt;= mid) <span class="hljs-built_in">modify</span>(tr[u].ls, l, mid, ql, qr, x);<br>    <span class="hljs-keyword">if</span>(qr &gt; mid) <span class="hljs-built_in">modify</span>(tr[u].rs, mid + <span class="hljs-number">1</span>, r, ql, qr, x);<br>    <span class="hljs-built_in">pushup</span>(u);<br>&#125;<br><br><span class="hljs-function">ll <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r, <span class="hljs-type">int</span> ql, <span class="hljs-type">int</span> qr)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(!u) <span class="hljs-keyword">return</span> <span class="hljs-number">0ll</span>;<br>    <span class="hljs-keyword">if</span>(ql &lt;= l &amp;&amp; r &lt;= qr) <span class="hljs-keyword">return</span> tr[u].sum;<br>    <span class="hljs-built_in">pushdown</span>(u, l, r);<br>    <span class="hljs-type">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>; ll res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span>(ql &lt;= mid) res += <span class="hljs-built_in">query</span>(tr[u].ls, l, mid, ql, qr);<br>    <span class="hljs-keyword">if</span>(qr &gt; mid) res += <span class="hljs-built_in">query</span>(tr[u].rs, mid + <span class="hljs-number">1</span>, r, ql, qr);<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-type">int</span> n, m;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;  <br>        <span class="hljs-type">int</span> x, y; cin &gt;&gt; x &gt;&gt; y;<br>        <span class="hljs-built_in">modify</span>(root, <span class="hljs-number">1</span>, INF, x, INF, y); <span class="hljs-comment">// ç»´æŠ¤å‰ç¼€å’ŒåŒºé—´å’Œ ä»å½“å‰ä½ç½®åŠ åˆ°æœ«å°¾</span><br>    &#125;<br><br>    <span class="hljs-keyword">while</span>(m -- )&#123;<br>        <span class="hljs-type">int</span> op, x, y; cin &gt;&gt; op &gt;&gt; x &gt;&gt; y;<br>        <span class="hljs-keyword">if</span>(op == <span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-type">double</span> res = <span class="hljs-built_in">query</span>(root, <span class="hljs-number">1</span>, INF, x, y);<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%.4lf\n&quot;</span>, res / (y - x + <span class="hljs-number">1</span>));<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-built_in">modify</span>(root, <span class="hljs-number">1</span>, INF, x, INF, y); <span class="hljs-comment">// åŒºé—´ä¿®æ”¹</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å’å”±å…‰èŠ’</category>
      
      <category>YAC æ‰¬å·å¤§å­¦ç®—æ³•ç»ƒä¹ èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>ç®—æ³•ç«èµ›</tag>
      
      <tag>Luogu</tag>
      
      <tag>YAC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 YAC Round 2 é¢˜è§£</title>
    <link href="/2024/12/14/YAC_Round_2/"/>
    <url>/2024/12/14/YAC_Round_2/</url>
    
    <content type="html"><![CDATA[<h2 id="A-è¾‰å¤œçš„æœ€å¼ºå¯†ç "><strong>A. è¾‰å¤œçš„æœ€å¼ºå¯†ç </strong></h2><h3 id="é¢˜ç›®æè¿°"><strong>é¢˜ç›®æè¿°</strong></h3><p>è¾“å…¥å¤šä¸ªå­—ç¬¦ä¸²ï¼Œåˆ¤æ–­æ¯ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ»¡è¶³æŒ‡å®šæ¡ä»¶ã€‚æ»¡è¶³æ¡ä»¶è¾“å‡ºâ€œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>True</mtext></mrow><annotation encoding="application/x-tex">\text{True}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">True</span></span></span></span></span>â€ï¼›å¦åˆ™è¾“å‡ºâ€œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>False</mtext></mrow><annotation encoding="application/x-tex">\text{False}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">False</span></span></span></span></span>â€ã€‚<a href="https://www.luogu.com.cn/problem/T419870">ã€ŒYAC Round 2ã€è¾‰å¤œçš„æœ€å¼ºå¯†ç </a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆå­—ç¬¦ä¸²æ¨¡æ‹Ÿï¼‰"><strong>è§£é¢˜æ€è·¯ ï¼ˆå­—ç¬¦ä¸²æ¨¡æ‹Ÿï¼‰</strong></h3><p>è€ƒå¯Ÿå­—ç¬¦ä¸²çš„ä¸€äº›åŸºæœ¬æ“ä½œï¼ŒæŒ‰ç…§é¢˜æ„æ¨¡æ‹Ÿå³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        string s; cin &gt;&gt; s;<br>        <span class="hljs-type">int</span> n = (<span class="hljs-type">int</span>)s.<span class="hljs-built_in">size</span>(); <br>        <span class="hljs-keyword">if</span>(n &lt; <span class="hljs-number">7</span>)&#123; <span class="hljs-comment">// æ¡ä»¶1</span><br>            cout &lt;&lt; <span class="hljs-string">&quot;False&quot;</span> &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br>        <span class="hljs-comment">// æ¡ä»¶2</span><br>        <span class="hljs-function">vector&lt;<span class="hljs-type">bool</span>&gt; <span class="hljs-title">flag</span><span class="hljs-params">(<span class="hljs-number">3</span>, <span class="hljs-literal">false</span>)</span></span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;ch : s)&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">islower</span>(ch)) flag[<span class="hljs-number">0</span>] = <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">isupper</span>(ch)) flag[<span class="hljs-number">1</span>] = <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">else</span> flag[<span class="hljs-number">2</span>] = <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(!flag[<span class="hljs-number">0</span>] || !flag[<span class="hljs-number">1</span>] || !flag[<span class="hljs-number">2</span>])&#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;False&quot;</span> &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br>        <span class="hljs-comment">// æ¡ä»¶3</span><br>        <span class="hljs-type">bool</span> ok = <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i ++ )<br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">isdigit</span>(s[i]) &amp;&amp; <span class="hljs-built_in">isdigit</span>(s[i + <span class="hljs-number">1</span>]))&#123;<br>                ok = <span class="hljs-literal">false</span>;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        cout &lt;&lt; (ok ? <span class="hljs-string">&quot;True&quot;</span> : <span class="hljs-string">&quot;False&quot;</span>) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>    &#125; <br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="B-Light-çš„æœ‰åºæ’åˆ—"><strong>B. Light çš„æœ‰åºæ’åˆ—</strong></h2><h3 id="é¢˜ç›®æè¿°-2"><strong>é¢˜ç›®æè¿°</strong></h3><p>å°†ä¸€ä¸ªæ’åˆ—åˆ‡å‰²æˆè‹¥å¹²æ®µï¼Œé‡æ–°ç»„åˆå˜æˆä¸€ä¸ªæœ‰åºæ’åˆ—ï¼Œç»Ÿè®¡æœ€å°‘çš„åˆ‡å‰²æ¬¡æ•°ã€‚<a href="https://www.luogu.com.cn/problem/T419963">Light çš„æœ‰åºæ’åˆ—</a></p><h3 id="è§£æ³•ä¸€-ï¼ˆåŒæŒ‡é’ˆï¼‰"><strong>è§£æ³•ä¸€ ï¼ˆåŒæŒ‡é’ˆï¼‰</strong></h3><p>ä¸ºäº†ä½¿å¾—åˆ‡å‰²æ¬¡æ•°æœ€å°‘ï¼Œå¯¹äºç°æœ‰æ’åˆ—ä¸­çš„æœ‰åºä¸”è¿ç»­çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¸å»è€ƒè™‘åˆ‡å‰²å®ƒä»¬ä¸­é—´çš„ä½ç½®ï¼Œä¾‹å¦‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>4</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[2, 3, 4]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">4</span><span class="mclose">]</span></span></span></span> æˆ–è€… <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>7</mn><mo separator="true">,</mo><mn>6</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[7, 6]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">6</span><span class="mclose">]</span></span></span></span>ã€‚</p><p>æˆ‘ä»¬åªéœ€è¦è®©åˆ‡å‰²çš„æ¬¡æ•°æœ€å°‘ï¼Œè€Œä¸éœ€è¦å»è€ƒè™‘ç¿»è½¬ã€ç»„åˆçš„æ¬¡æ•°æœ‰å¤šå°‘ã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬åªéœ€è¦å°†æ‰€æœ‰ <strong>å•è°ƒä¸”è¿ç»­</strong> çš„åŒºé—´åˆ‡å‰²å‡ºæ¥ï¼Œç„¶åå†è¿›è¡Œå¤šæ¬¡ç¿»è½¬ç»„åˆå³å¯å¾—åˆ°æœ‰åºçš„æ’åˆ—ï¼ˆå‡åºæˆ–é™åºéƒ½å¯ä»¥ï¼‰ã€‚</p><p>æ•…æˆ‘ä»¬å¯ä»¥é‡‡ç”¨åŒæŒ‡é’ˆç®—æ³•ç»Ÿè®¡ <strong>å•è°ƒè¿ç»­</strong> åŒºé—´çš„ä¸ªæ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">cnt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span></span></span></span>ï¼Œæœ€ååŒºé—´ä¸ªæ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span> å³ä¸ºéœ€è¦åˆ‡å‰²çš„æœ€å°‘æ¬¡æ•°ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e6</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> n, a[N];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br>    <span class="hljs-type">int</span> cnt = <span class="hljs-number">0</span>, l = <span class="hljs-number">1</span>, r;<br>    <span class="hljs-keyword">while</span>(l &lt;= n)&#123;<br>        r = l + <span class="hljs-number">1</span>;<br>        <span class="hljs-type">int</span> flag = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">if</span>(a[l] == a[r] - <span class="hljs-number">1</span>) flag = <span class="hljs-number">1</span>; <span class="hljs-comment">// å•è°ƒè¿ç»­ä¸Šå‡</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(a[l] == a[r] + <span class="hljs-number">1</span>) flag = <span class="hljs-number">-1</span>; <span class="hljs-comment">// å•è°ƒè¿ç»­ä¸‹é™</span><br>        <span class="hljs-keyword">else</span>&#123;  <br>            cnt ++ ; <span class="hljs-comment">// ä¸€ä¸ªæ•°å•ç‹¬åˆ‡å‰²å‡ºæ¥</span><br>            l = r;<br>            <span class="hljs-keyword">continue</span>; <br>        &#125;<br>        <span class="hljs-keyword">while</span>(r &lt;= n &amp;&amp; a[r] == a[r - <span class="hljs-number">1</span>] + flag) r ++ ;<br>        cnt ++ ; <span class="hljs-comment">// ç»Ÿè®¡å•è°ƒè¿ç»­ä¸Šå‡åŒºé—´å’Œå•è°ƒä¸‹é™åŒºé—´ä¸ªæ•°</span><br>        l = r;<br>    &#125;<br>    cout &lt;&lt; cnt - <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;  <span class="hljs-comment">// è¿ç»­åŒºé—´ä¸ªæ•°-1å³ä¸ºç­”æ¡ˆ</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è§£æ³•äºŒ-ï¼ˆæ€ç»´ï¼‰"><strong>è§£æ³•äºŒ ï¼ˆæ€ç»´ï¼‰</strong></h3><p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¯¹äºè¿ç»­çš„éƒ¨åˆ†æˆ‘ä»¬ä¸éœ€è¦è¿›è¡Œåˆ‡å‰²ï¼›å¯¹äºä¸è¿ç»­çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬éœ€è¦åˆ‡å‰²å‡ºæ¥è¿›è¡Œé‡ç»„ã€‚åŸºäºæ’åˆ—çš„æ€§è´¨ï¼Œæ˜¾ç„¶å¯ä»¥æ€»ç»“å‡ºï¼š<strong>å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">âˆ£</mi><msub><mi>a</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>a</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|a_i - a_{i + 1}| &gt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> æ—¶ï¼Œéœ€è¦è¿›è¡Œåˆ‡å‰²</strong>ã€‚æ•…æœ€ç»ˆç­”æ¡ˆä¸ºæ’åˆ—ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">âˆ£</mi><msub><mi>a</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>a</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|a_i - a_{i + 1}| &gt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å‡ºç°çš„æ¬¡æ•°ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e6</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> n, a[N], res;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; n; i ++ ) res += (<span class="hljs-built_in">abs</span>(a[i] - a[i + <span class="hljs-number">1</span>]) &gt; <span class="hljs-number">1</span>);<br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="C-å…«äº‘è“çš„-gcd-é—®é¢˜"><strong>C. å…«äº‘è“çš„ gcd é—®é¢˜</strong></h2><h3 id="é¢˜ç›®æè¿°-3"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªæ•°å­— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>ï¼Œæ±‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>gcd</mtext><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{gcd}(1, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">gcd</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> ä¸€ç›´åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>gcd</mtext><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{gcd}(n, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">gcd</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> çš„ <strong>å¼‚æˆ–å’Œ</strong>ï¼Œå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>âŠ•</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mtext>gcd</mtext><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\oplus_{i=1}^n \text{gcd}(i, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0087em;vertical-align:-0.2587em;"></span><span class="mord"><span class="mbin">âŠ•</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mord text"><span class="mord">gcd</span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âŠ•</mo></mrow><annotation encoding="application/x-tex">\oplus</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">âŠ•</span></span></span></span> è¡¨ç¤ºæŒ‰ä½å¼‚æˆ–ã€‚<a href="https://www.luogu.com.cn/problem/T419838">å…«äº‘è“çš„ gcd é—®é¢˜</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆæ•°å­¦ï¼‰"><strong>è§£é¢˜æ€è·¯ ï¼ˆæ•°å­¦ï¼‰</strong></h3><p>å¯¹äºæ±‚è§£æœ€å¤§å…¬çº¦æ•°ï¼Œé™¤äº†è¾—è½¬ç›¸é™¤æ³•ï¼Œè¿˜æœ‰ä¸€ä¸ªæ–¹æ³•ç§°ä¸º <strong>æ›´ç›¸å‡æŸæœ¯</strong>ï¼Œå…¶ç”¨åˆ°äº†ä»¥ä¸‹ç»“è®ºï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>gcd</mtext><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>gcd</mtext><mo stretchy="false">(</mo><mi>b</mi><mo>âˆ’</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{gcd}(a, b) = \text{gcd}(b - a, b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">gcd</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">gcd</span></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></span></p><p>åœ¨æœ¬é¢˜ä¸­ä¹Ÿå°±æ˜¯ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>gcd</mtext><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>gcd</mtext><mo stretchy="false">(</mo><mi>n</mi><mo>âˆ’</mo><mi>i</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{gcd}(i, n) = \text{gcd}(n - i, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">gcd</span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">gcd</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p><p>è€Œå¼‚æˆ–æ“ä½œæœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œä¸º <strong>ä¸¤ä¸ªç›¸åŒçš„æ•°å¼‚æˆ–ä¹‹åç›¸äº’æŠµæ¶ˆ</strong>ï¼Œå³å˜ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ï¼Œä¹Ÿå°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>âŠ•</mo><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x \oplus x = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ã€‚</p><p>æŒ‰ä½å¼‚æˆ–è¿ç®—æ˜¯ <strong>æ»¡è¶³äº¤æ¢å¾‹</strong>çš„ï¼Œæ˜¾ç„¶ï¼Œåœ¨æ±‚å¼‚æˆ–å’Œæ—¶ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>gcd</mtext><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>âŠ•</mo><mtext>gcd</mtext><mo stretchy="false">(</mo><mi>n</mi><mo>âˆ’</mo><mi>i</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\text{gcd}(i, n) \oplus \text{gcd}(n - i, n) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">gcd</span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">gcd</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—å‡ºå¦‚ä¸‹ç»“è®ºï¼š</p><p>å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸º <strong>å¥‡æ•°</strong>ï¼Œç»è¿‡ä¸¤ä¸¤æŠµæ¶ˆåï¼Œæœ€ååªå‰© <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>gcd</mtext><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{gcd}(n, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">gcd</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ï¼Œä¹Ÿå°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>ã€‚æ•… <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ºå¥‡æ•°ç›´æ¥è¾“å‡ºæœ¬èº«ï¼›</p><p>å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸º <strong>å¶æ•°</strong>ï¼Œç»è¿‡æŠµæ¶ˆåï¼Œæœ€åå‰©ä¸‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>gcd</mtext><mo stretchy="false">(</mo><mfrac><mi>n</mi><mn>2</mn></mfrac><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{gcd}(\frac{n}{2}, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mord text"><span class="mord">gcd</span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>gcd</mtext><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{gcd}(n, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">gcd</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>ã€‚æ•… <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ºå¶æ•°è¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>âŠ•</mo><mtext>gcd</mtext><mo stretchy="false">(</mo><mfrac><mi>n</mi><mn>2</mn></mfrac><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n \oplus \text{gcd}(\frac{n}{2}, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mord text"><span class="mord">gcd</span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> ã€‚ï¼ˆå½“ç„¶ï¼Œå…¶å®è¿™é¢˜ç”šè‡³æ²¡å¿…è¦å»ç”¨gcdï¼Œå› ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸ºå¶æ•°æ—¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>gcd</mtext><mo stretchy="false">(</mo><mfrac><mi>n</mi><mn>2</mn></mfrac><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mi>n</mi><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\text{gcd}(\frac{n}{2}, n) = \frac{n}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mord text"><span class="mord">gcd</span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0404em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ï¼Œæ‰€ä»¥å¶æ•°è¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>âŠ•</mo><mfrac><mi>n</mi><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">n \oplus \frac{n}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0404em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> å³å¯ï¼‰</p><p><em>PSï¼šæ±‚è§£æœ€å¤§å…¬çº¦æ•°è‹¥è°ƒç”¨å‡½æ•°éœ€è¦æ³¨æ„ C++ ç‰ˆæœ¬ã€‚C++ 14 å¼€å§‹å¼•å…¥ __gcd å‡½æ•°ï¼ˆæ³¨æ„æ˜¯ä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰ï¼ŒC++ 17 å¼€å§‹å¼•å…¥ gcd åº“å‡½æ•°ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥è‡ªå·±æ‰‹å†™ä¸€ä¸ª gcd å‡½æ•°ï¼Œä»£ç ä¸­æä¾›é€’å½’å†™æ³•ã€‚</em></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-function">ll <span class="hljs-title">gcd</span><span class="hljs-params">(ll a, ll b)</span></span>&#123;<span class="hljs-keyword">return</span> b ? <span class="hljs-built_in">gcd</span>(b, a % b) : a;&#125; <span class="hljs-comment">// æ‰‹å†™ gcd</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        ll x; cin &gt;&gt; x; <span class="hljs-comment">// gcd(i, n) == gcd(n - i, n) å¼‚æˆ–åæŠµæ¶ˆ</span><br>        cout &lt;&lt; ((x &amp; <span class="hljs-number">1</span>) ? x : (x ^ __gcd(x &gt;&gt; <span class="hljs-number">1</span>, x)))  &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>; <br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="D-è•¾å¨œçš„åŸºåœ°æ‰©å¼ "><strong>D. è•¾å¨œçš„åŸºåœ°æ‰©å¼ </strong></h2><h3 id="é¢˜ç›®æè¿°-4"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªç½‘æ ¼å›¾ï¼Œç½‘æ ¼å›¾ä¸Šæœ‰è‹¥å¹²çš„ç‚¹ï¼Œæ¯ä¸ªç‚¹æ¯ç»è¿‡ä¸€ä¸ªæ—¶åˆ»ä¼šå‘å››å‘¨æ‰©å¼ ä¸€æ¬¡ã€‚ä¸¤ä¸ªç‚¹æ‰©å¼ çš„åŒºåŸŸæœ‰é‡å¤çš„ç‚¹å³è§†ä¸ºè¿é€šï¼Œæ±‚æœ€æ—©ä»€ä¹ˆæ—¶åˆ»æ‰€æœ‰ç‚¹è¿é€šï¼ˆå³å½¢æˆä¸€ä¸ªè¿é€šå—ï¼‰ã€‚<a href="https://www.luogu.com.cn/problem/T420000">ã€ŒYAC Round 2ã€è•¾å¨œçš„åŸºåœ°æ‰©å¼ </a></p><h3 id="è§£æ³•ä¸€-ï¼ˆäºŒåˆ†-å¹¶æŸ¥é›†ï¼‰"><strong>è§£æ³•ä¸€ ï¼ˆäºŒåˆ† + å¹¶æŸ¥é›†ï¼‰</strong></h3><p><strong>æ¯ä¸ªç‚¹</strong> æ¯ç»è¿‡ä¸€ä¸ªæ—¶åˆ»ä¼šå‘å››å‘¨æ‰©å¼ ä¸€æ¬¡ï¼Œæ˜¾ç„¶ä¸¤ç‚¹ä¹‹é—´çš„ <strong>æ›¼å“ˆé¡¿è·ç¦» å°äºç­‰äº ä¸¤å€çš„æ—¶é—´</strong> æ‰ä¼šä½¿å¾—ä¸¤ç‚¹è¿é€šã€‚æ•…æˆ‘ä»¬å¯ä»¥äºŒåˆ†ç­”æ¡ˆï¼ˆæ‰©å¼ çš„æ—¶é—´ï¼‰ï¼Œç„¶åä¸¤ä¸¤æšä¸¾å›¾ä¸Šçš„ç‚¹ï¼Œç”¨ <strong>å¹¶æŸ¥é›†</strong> å°†æ›¼å“ˆé¡¿è·ç¦»å°äºç­‰äºå½“å‰æ—¶é—´ä¸¤å€çš„ä¸¤ç‚¹è¿›è¡Œåˆå¹¶ï¼Œæ¯æ¬¡äºŒåˆ† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>check</mtext></mrow><annotation encoding="application/x-tex">\text{check}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">check</span></span></span></span></span> åˆ¤æ–­æ˜¯å¦åªæœ‰ä¸€ä¸ªè¿é€šå—å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> fi first</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> se second</span><br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">60</span>;<br><br>pii p[N];<br><span class="hljs-type">int</span> n, fa[N];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123;<span class="hljs-keyword">return</span> fa[x] == x ? x : fa[x] = <span class="hljs-built_in">find</span>(fa[x]);&#125;;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span>&#123;fa[<span class="hljs-built_in">find</span>(x)] = <span class="hljs-built_in">find</span>(y);&#125;;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">check</span><span class="hljs-params">(<span class="hljs-type">int</span> t)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) fa[i] = i;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-keyword">auto</span> [x1, y1] = p[i];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = i + <span class="hljs-number">1</span>; j &lt;= n; j ++ )&#123;<br>            <span class="hljs-keyword">auto</span> [x2, y2] = p[j];<br>            <span class="hljs-type">int</span> d = <span class="hljs-built_in">abs</span>(x1 - x2) + <span class="hljs-built_in">abs</span>(y1 - y2); <span class="hljs-comment">// æ›¼å“ˆé¡¿è·ç¦»</span><br>            <span class="hljs-keyword">if</span>(d &lt;= <span class="hljs-number">2</span> * t) <span class="hljs-built_in">merge</span>(i, j); <br>        &#125;<br>    &#125;<br>    <span class="hljs-type">int</span> f = <span class="hljs-built_in">find</span>(<span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++ ) <br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">find</span>(i) != f) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦æœ‰å…¶ä»–é¢†å¤´å­˜åœ¨</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// è¿é€šå—ä¸ªæ•°ä¸º1</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è§£æ³•äºŒ-ï¼ˆkruskal-æœ€å°ç”Ÿæˆæ ‘ï¼‰"><strong>è§£æ³•äºŒ ï¼ˆkruskal æœ€å°ç”Ÿæˆæ ‘ï¼‰</strong></h3><p>æˆ‘ä»¬å¯ä»¥è´ªå¿ƒåœ°å»æ±‚è§£è¿™ä¸ªé—®é¢˜ï¼Œåœ¨ç½‘æ ¼å›¾ä¸Šçš„ç‚¹ä¸¤ä¸¤ä¹‹é—´å»ºç«‹ä¸€æ¡è¾¹ï¼ˆé•¿åº¦å³æ›¼å“ˆé¡¿è·ç¦»ï¼‰ã€‚é€šè¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>krusakl</mtext></mrow><annotation encoding="application/x-tex">\text{krusakl}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">krusakl</span></span></span></span></span> ç®—æ³•ä½¿å¾—å›¾ä¸­æ‰€æœ‰ç‚¹æ„æˆä¸€ä¸ªæœ€å°ç”Ÿæˆæ ‘ï¼Œæ­¤æ—¶ä¹Ÿæ‰€æœ‰ç‚¹ä¹Ÿå˜æˆä¸€ä¸ªè¿é€šå—ã€‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>krusakl</mtext></mrow><annotation encoding="application/x-tex">\text{krusakl}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">krusakl</span></span></span></span></span> ç®—æ³•è¿‡ç¨‹ä¸­åˆå¹¶ä¸¤ç‚¹æ—¶çš„æ›¼å“ˆé¡¿è·ç¦»å³ä¸ºå½“å‰ä¸¤ç‚¹è¿é€šæ‰€éœ€çš„æœ€å°è·ç¦»ã€‚</p><p>æ•…æˆ‘ä»¬åªéœ€è¦çŸ¥é“ <strong>æœ€å°ç”Ÿæˆæ ‘ä¸­çš„æœ€å¤§è¾¹é•¿åº¦</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span> å³å¯ï¼Œæœ€åè¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">âŒˆ</mo><mfrac><mi>d</mi><mn>2</mn></mfrac><mo fence="true">âŒ‰</mo></mrow><annotation encoding="application/x-tex">\left \lceil \frac{d}{2}  \right \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2301em;vertical-align:-0.35em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">âŒˆ</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">âŒ‰</span></span></span></span></span></span> å³ä¸ºæœ€å°‘éœ€è¦çš„æ—¶é—´ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> fi first</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> se second</span><br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">60</span>;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123;<span class="hljs-type">int</span> u, v, w;&#125;e[N * N];<br>pii p[N];<br><span class="hljs-type">int</span> n, m, fa[N];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123;<span class="hljs-keyword">return</span> fa[x] == x ? x : fa[x] = <span class="hljs-built_in">find</span>(fa[x]);&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">kruskal</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) fa[i] = i;<br>    <span class="hljs-built_in">sort</span>(e + <span class="hljs-number">1</span>, e + m + <span class="hljs-number">1</span>, [](node &amp;a, node &amp;b)&#123;<br>        <span class="hljs-keyword">return</span> a.w &lt; b.w;<br>    &#125;);<br>    <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;  <span class="hljs-comment">// è®°å½•æœ€åä¸€ä¸ªåˆšå¥½ä½¿å¾—æ‰€æœ‰ç‚¹å½¢æˆä¸€ä¸ªè¿é€šå—çš„è¾¹é•¿åº¦</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i ++ )&#123;<br>        <span class="hljs-keyword">auto</span> [u, v, w] = e[i];<br>        <span class="hljs-type">int</span> fx = <span class="hljs-built_in">find</span>(u), fy = <span class="hljs-built_in">find</span>(v);<br>        <span class="hljs-keyword">if</span>(fx == fy) <span class="hljs-keyword">continue</span>;<br>        fa[fx] = fy;<br>        res = w;<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; p[i].fi &gt;&gt; p[i].se;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-keyword">auto</span> [x1, y1] = p[i];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = i + <span class="hljs-number">1</span>; j &lt;= n; j ++ )&#123; <span class="hljs-comment">// å»ºè¾¹</span><br>            <span class="hljs-keyword">auto</span> [x2, y2] = p[j];<br>            <span class="hljs-type">int</span> d = <span class="hljs-built_in">abs</span>(x1 - x2) + <span class="hljs-built_in">abs</span>(y1 - y2);<br>            e[ ++ m] = node&#123;i, j, d&#125;;<br>        &#125;<br>    &#125;<br><br>    cout &lt;&lt; ((<span class="hljs-built_in">kruskal</span>() + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>; <span class="hljs-comment">// å‘ä¸Šå–æ•´</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è§£æ³•ä¸‰-ï¼ˆç±»Floydç®—æ³•ï¼‰"><strong>è§£æ³•ä¸‰ ï¼ˆç±»Floydç®—æ³•ï¼‰</strong></h3><p>æˆ‘ä»¬è¿˜å¯ä»¥è€ƒè™‘ç”¨ç±»ä¼¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Floyd</mtext></mrow><annotation encoding="application/x-tex">\text{Floyd}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">Floyd</span></span></span></span></span> ç®—æ³•çš„æ€è·¯æ¥æ±‚è§£è¿™ä¸ªé—®é¢˜ã€‚è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> è¡¨ç¤ºç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> å’Œ ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> è¿é€šéœ€è¦çš„æœ€çŸ­æ—¶é—´ï¼ˆæ­¤æ—¶é—´ä¸æ˜¯æœ€ç»ˆç­”æ¡ˆï¼ŒæŒ‡çš„æ˜¯éœ€è¦çš„æœ€çŸ­çš„æ›¼å“ˆé¡¿è·ç¦»ï¼‰ã€‚é‡‡ç”¨ç±» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Floyd</mtext></mrow><annotation encoding="application/x-tex">\text{Floyd}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">Floyd</span></span></span></span></span> ç®—æ³•ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> ä½œä¸ºä¸­é—´ç‚¹ï¼Œåˆ™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> å¯ä»¥å€ŸåŠ©ä¸­é—´ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> è¿æ¥ä»è€Œè¿é€šã€‚</p><p>å‡è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> è¿é€šæ‰€éœ€æ—¶é—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{ik}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">ik</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> è¿é€šæ‰€éœ€æ—¶é—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{kj}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">kj</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> çš„è¾ƒå¤§è€…ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>ã€‚æœ€å <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> è¿é€šæ‰€éœ€çš„æœ€å°‘æ—¶é—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> å³æœ¬èº«ä¸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> ä¹‹é—´çš„è¾ƒå°è€…ã€‚ ç”±æ­¤å¾—åˆ°æ›´æ–°è¡¨è¾¾å¼ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>min</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>max</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d[i][j] = \min(d[i][j], \max(d[i][k], d[k][j]))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]))</span></span></span></span></span></p><p>æœ€åæ‰¾å‡ºæœ€å¤§çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>ï¼Œè¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">âŒˆ</mo><mfrac><mi>d</mi><mn>2</mn></mfrac><mo fence="true">âŒ‰</mo></mrow><annotation encoding="application/x-tex">\left \lceil \frac{d}{2}  \right \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2301em;vertical-align:-0.35em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">âŒˆ</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">âŒ‰</span></span></span></span></span></span> å³ä¸ºç­”æ¡ˆã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> fi first</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> se second</span><br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">60</span>;<br><br>pii p[N];<br><span class="hljs-type">int</span> d[N][N], n;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">floyd</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>; k &lt;= n; k ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>                d[i][j] = <span class="hljs-built_in">min</span>(d[i][j], <span class="hljs-built_in">max</span>(d[i][k], d[k][j])); <br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; p[i].fi &gt;&gt; p[i].se;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123; <span class="hljs-comment">// å»ºè¾¹</span><br>        <span class="hljs-keyword">auto</span> [x1, y1] = p[i];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )&#123;<br>            <span class="hljs-keyword">auto</span> [x2, y2] = p[j];<br>            d[i][j] = <span class="hljs-built_in">abs</span>(x1 - x2) + <span class="hljs-built_in">abs</span>(y1 - y2);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-built_in">floyd</span>();<br><br>    <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>            res = <span class="hljs-built_in">max</span>(res, d[i][j]);   <span class="hljs-comment">// å¯»æ‰¾æœ€å¤§è¾¹</span><br><br>    cout &lt;&lt; ((res + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="E-Kurisu-çš„ä¸é™æ•°ç»„"><strong>E. Kurisu çš„ä¸é™æ•°ç»„</strong></h2><h3 id="é¢˜ç›®æè¿°-5"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ä¸”åªåŒ…å« <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1, 0, 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">âˆ’</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span></span></span></span> çš„æ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>ï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>â†</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><msub><mi>a</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">a_i \leftarrow a_i + a_{i - 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œæ±‚ä½¿å¾—æ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> å•è°ƒä¸é™çš„ <strong>æœ€å°‘æ“ä½œæ¬¡æ•°</strong>ã€‚<a href="https://www.luogu.com.cn/problem/T420024">ã€ŒYAC Round 2ã€Kurisu çš„ä¸é™æ•°ç»„</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆçŠ¶æ€æœº-DPï¼‰"><strong>è§£é¢˜æ€è·¯ ï¼ˆçŠ¶æ€æœº DPï¼‰</strong></h3><p>æ˜¾ç„¶æˆ‘ä»¬å¯ä»¥ç”¨åŠ¨æ€è§„åˆ’æ±‚è§£è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span> è¡¨ç¤ºçŠ¶æ€:</p><ul><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i][0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span></span></span></span> è¡¨ç¤ºå‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªæ•°å­—ï¼Œä¸”ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªæ•°å­—ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> æ—¶ï¼Œä½¿å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>1</mn><mo>â€¦</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[1 \ldots i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span> ä¸é™çš„æœ€å°‘æ“ä½œæ¬¡æ•°ï¼›</p></li><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i][1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span></span></span></span> è¡¨ç¤ºå‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªæ•°å­—ï¼Œä¸”ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªæ•°å­—ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> æ—¶ï¼Œä½¿å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>1</mn><mo>â€¦</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[1 \ldots i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span> ä¸é™çš„æœ€å°‘æ“ä½œæ¬¡æ•°ï¼›</p></li><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i][2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span></span></span></span> è¡¨ç¤ºå‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªæ•°å­—ï¼Œä¸”ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> ä¸ªæ•°å­—ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span> æ—¶ï¼Œä½¿å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>1</mn><mo>â€¦</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[1 \ldots i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span> ä¸é™çš„æœ€å°‘æ“ä½œæ¬¡æ•°ã€‚</p></li></ul><p><em>PSï¼šå½“ç„¶çŠ¶æ€è¡¨ç¤ºä¸æ˜¯å”¯ä¸€çš„ï¼Œä»¥ä¸Šåªæ˜¯æä¾›äº†æˆ‘è‡ªå·±çš„æ–¹å¼</em></p><br/><p>ç”±æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š</p><ul><li><p>å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a[i] = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> æ—¶ï¼š</p><ul><li>ä¸å¯¹å½“å‰ä½ç½®è¿›è¡Œæ“ä½œã€‚å‰é¢å¯ä»¥æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span> æˆ– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œæ»¡è¶³ä¸é™ã€‚</li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>=</mo><mi>min</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dp[i][0] = \min(dp[i - 1][0], dp[i - 1][2])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">])</span></span></span></span></span></p><ul><li>å½“å‰ä½ç½®çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ç»è¿‡ <strong>ä¸€æ¬¡</strong> æ“ä½œåå˜æˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œå‰é¢ä¸€ä¸ªä½ç½®è¦æ±‚ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ã€‚ æ­¤æ—¶æ»¡è¶³ä¸é™ã€‚</li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">dp[i][1] = dp[i - 1][1] + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p><ul><li>å½“å‰ä½ç½®çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ç»è¿‡ <strong>ä¸€æ¬¡</strong> æ“ä½œåå˜æˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span>ï¼Œå‰é¢ä¸€ä¸ªä½ç½®è¦æ±‚ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span> ã€‚ æ­¤æ—¶æ»¡è¶³ä¸é™ã€‚</li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">dp[i][2] = dp[i - 1][2] + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p></li><li><p>å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a[i] = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> æ—¶ï¼š</p><ul><li>å½“å‰ä½ç½®çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ç»è¿‡ <strong>ä¸€æ¬¡</strong> æ“ä½œåå˜æˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œå‰é¢è¦æ±‚ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span>ã€‚æ­¤æ—¶æ»¡è¶³ä¸é™ã€‚</li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">dp[i][0] = dp[i - 1][2] + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p><ul><li>ä¸å¯¹å½“å‰ä½ç½®è¿›è¡Œæ“ä½œã€‚å‰é¢å¯ä»¥æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span> æˆ– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> æˆ– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œæ»¡è¶³ä¸é™ã€‚</li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>min</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dp[i][1] = \min(dp[i - 1][0], dp[i - 1][1], dp[i - 1][2])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">])</span></span></span></span></span></p><ul><li>å½“å‰ä½ç½®çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ç»è¿‡ <strong>ä¸¤æ¬¡</strong> æ“ä½œåå˜æˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span>ï¼Œå‰é¢è¦æ±‚ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span>ã€‚æ­¤æ—¶æ»¡è¶³ä¸é™ã€‚</li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo>+</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">dp[i][2] = dp[i - 1][2] + 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></span></p></li><li><p>å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a[i] = -1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span> æ—¶ï¼š</p><ul><li><p>å‰é¢ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œå¯ä»¥ç»è¿‡ä¸€æ¬¡æ“ä½œä½¿å¾—å½“å‰ä½ç½®å˜ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œä½†æ˜¯æ­¤æ—¶ <strong>ä¸æ»¡è¶³ä¸é™æ€§è´¨</strong>ï¼Œæ‰€ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i][0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span></span></span></span> ä¸è¿›è¡ŒçŠ¶æ€è½¬ç§»ã€‚</p></li><li><p>å½“å‰ä½ç½®çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span> ç»è¿‡ <strong>ä¸¤æ¬¡æ¬¡</strong> æ“ä½œåå˜æˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œå‰é¢è¦æ±‚ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ã€‚æ­¤æ—¶æ»¡è¶³ä¸é™ã€‚</p></li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">dp[i][1] = dp[i - 1][1] + 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></span></p><ul><li>ä¸å¯¹å½“å‰ä½ç½®è¿›è¡Œæ“ä½œã€‚å‰é¢å¯ä»¥æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span>ï¼Œæ»¡è¶³ä¸é™ã€‚</li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i][2] = dp[i - 1][2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span></span></span></span></span></p></li></ul><br/>   <p>æ±‚è§£çš„æ˜¯æœ€å°æ¬¡æ•°ï¼Œæ•… <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">dp</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span></span></span></span> æ•°ç»„å…¨éƒ¨åˆå§‹åŒ–ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>inf</mtext></mrow><annotation encoding="application/x-tex">\text{inf}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">inf</span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>c</mi><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">dp[1][c] = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">c</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ã€‚ç»è¿‡çŠ¶æ€è½¬ç§»åï¼Œæœ€åæšä¸¾ç»“å°¾æ•°å­— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1, 0, 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">âˆ’</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span></span></span></span>ï¼Œè¾“å‡ºæœ€å°å€¼ï¼›è‹¥æœ€å°å€¼ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>inf</mtext></mrow><annotation encoding="application/x-tex">\text{inf}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">inf</span></span></span></span></span>ï¼Œåˆ™è¯´æ˜æ— æ³•ä½¿å¾—æ•°ç»„ä¸é™ï¼Œè¾“å‡º â€œBRAKâ€ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e6</span> + <span class="hljs-number">10</span>, inf = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-type">int</span> dp[N][<span class="hljs-number">3</span>], a[N], n; <br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br><br>    <span class="hljs-built_in">memset</span>(dp, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> dp);<br>    dp[<span class="hljs-number">1</span>][a[<span class="hljs-number">1</span>] &gt;= <span class="hljs-number">0</span> ? a[<span class="hljs-number">1</span>] : <span class="hljs-number">2</span>] = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-type">int</span> x = a[i];<br>        <span class="hljs-keyword">if</span>(x == <span class="hljs-number">0</span>)&#123;<br>            dp[i][<span class="hljs-number">0</span>] = <span class="hljs-built_in">min</span>(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">2</span>]);<br>            dp[i][<span class="hljs-number">1</span>] = dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] + <span class="hljs-number">1</span>;<br>            dp[i][<span class="hljs-number">2</span>] = dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">2</span>] + <span class="hljs-number">1</span>;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(x == <span class="hljs-number">1</span>)&#123;<br>            dp[i][<span class="hljs-number">0</span>] = dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">2</span>] + <span class="hljs-number">1</span>;<br>            dp[i][<span class="hljs-number">1</span>] = <span class="hljs-built_in">min</span>(&#123;dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">2</span>]&#125;);<br>            dp[i][<span class="hljs-number">2</span>] = dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">2</span>] + <span class="hljs-number">2</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            dp[i][<span class="hljs-number">1</span>] = dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] + <span class="hljs-number">2</span>;<br>            dp[i][<span class="hljs-number">2</span>] = dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">2</span>];<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-type">int</span> res = inf;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">2</span>; i ++ ) res = <span class="hljs-built_in">min</span>(res, dp[n][i]);<br>    <span class="hljs-keyword">if</span>(res == inf) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;BRAK&quot;</span>);<br>    <span class="hljs-keyword">else</span> cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œæ¯ä¸€å±‚å…³ç³»åªä¸å‰é¢ä¸€å±‚æœ‰å…³ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ»šåŠ¨æ•°ç»„è¿›è¡Œç©ºé—´ä¼˜åŒ–ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e6</span> + <span class="hljs-number">10</span>, inf = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-type">int</span> dp[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>], a[N], n; <br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br><br>    <span class="hljs-built_in">memset</span>(dp, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> dp);<br>    dp[<span class="hljs-number">1</span>][a[<span class="hljs-number">1</span>] &gt;= <span class="hljs-number">0</span> ? a[<span class="hljs-number">1</span>] : <span class="hljs-number">2</span>] = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-type">int</span> x = a[i];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">2</span>; j ++ ) dp[i &amp; <span class="hljs-number">1</span>][j] = inf;<br>        <span class="hljs-keyword">if</span>(x == <span class="hljs-number">0</span>)&#123;<br>            dp[i &amp; <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = <span class="hljs-built_in">min</span>(dp[(i - <span class="hljs-number">1</span>) &amp; <span class="hljs-number">1</span>][<span class="hljs-number">0</span>], dp[(i - <span class="hljs-number">1</span>) &amp; <span class="hljs-number">1</span>][<span class="hljs-number">2</span>]);<br>            dp[i &amp; <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = dp[(i - <span class="hljs-number">1</span>) &amp; <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] + <span class="hljs-number">1</span>;<br>            dp[i &amp; <span class="hljs-number">1</span>][<span class="hljs-number">2</span>] = dp[(i - <span class="hljs-number">1</span>) &amp; <span class="hljs-number">1</span>][<span class="hljs-number">2</span>] + <span class="hljs-number">1</span>;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(x == <span class="hljs-number">1</span>)&#123;<br>            dp[i &amp; <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = dp[(i - <span class="hljs-number">1</span>) &amp; <span class="hljs-number">1</span>][<span class="hljs-number">2</span>] + <span class="hljs-number">1</span>;<br>            dp[i &amp; <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = <span class="hljs-built_in">min</span>(&#123;dp[(i - <span class="hljs-number">1</span>) &amp; <span class="hljs-number">1</span>][<span class="hljs-number">0</span>], dp[(i - <span class="hljs-number">1</span>) &amp; <span class="hljs-number">1</span>][<span class="hljs-number">1</span>], dp[(i - <span class="hljs-number">1</span>) &amp; <span class="hljs-number">1</span>][<span class="hljs-number">2</span>]&#125;);<br>            dp[i &amp; <span class="hljs-number">1</span>][<span class="hljs-number">2</span>] = dp[(i - <span class="hljs-number">1</span>) &amp; <span class="hljs-number">1</span>][<span class="hljs-number">2</span>] + <span class="hljs-number">2</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            dp[i &amp; <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = dp[(i - <span class="hljs-number">1</span>) &amp; <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] + <span class="hljs-number">2</span>;<br>            dp[i &amp; <span class="hljs-number">1</span>][<span class="hljs-number">2</span>] = dp[(i - <span class="hljs-number">1</span>) &amp; <span class="hljs-number">1</span>][<span class="hljs-number">2</span>];<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-type">int</span> res = inf;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">2</span>; i ++ ) res = <span class="hljs-built_in">min</span>(res, dp[n &amp; <span class="hljs-number">1</span>][i]);<br>    <span class="hljs-keyword">if</span>(res == inf) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;BRAK&quot;</span>);<br>    <span class="hljs-keyword">else</span> cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="F-å¦–æ¢¦çš„éº»è–¯ä¹‹è¡Œ"><strong>F. å¦–æ¢¦çš„éº»è–¯ä¹‹è¡Œ</strong></h2><h3 id="é¢˜ç›®æè¿°-6"><strong>é¢˜ç›®æè¿°</strong></h3><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å·ç‚¹ åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> å·ç‚¹çš„æœ€çŸ­è·¯é•¿ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>ï¼Œç»™å®šä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>ï¼Œæ±‚æœ‰å‘å›¾ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> é•¿åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰¤</mo><mi>d</mi><mo>+</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">\le d + K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> çš„è·¯çº¿æ•°é‡ã€‚<a href="https://www.luogu.com.cn/problem/T420157">ã€ŒYAC Round 2ã€å¦–æ¢¦çš„éº»è–¯ä¹‹è¡Œ</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆæœ€çŸ­è·¯-è®°å¿†åŒ–æœç´¢ï¼‰"><strong>è§£é¢˜æ€è·¯ ï¼ˆæœ€çŸ­è·¯ + è®°å¿†åŒ–æœç´¢ï¼‰</strong></h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ±‚å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> çš„æœ€çŸ­è·¯è·ç¦» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>ï¼Œè¿™é‡Œé‡‡ç”¨å †ä¼˜åŒ– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>dijkstra</mtext></mrow><annotation encoding="application/x-tex">\text{dijkstra}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">dijkstra</span></span></span></span></span> ã€‚</p><p>ç„¶åæˆ‘ä»¬éœ€è¦ç”¨åŠ¨æ€è§„åˆ’æ¥æ±‚è§£è·ç¦»é•¿åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰¤</mo><mi>d</mi><mo>+</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">\le d + K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> çš„è·¯çº¿æ•°é‡ã€‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[u][k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span> è¡¨ç¤ºä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> çš„ä¸”è·¯å¾„é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> çš„æ–¹æ¡ˆæ•°é‡ï¼Œç”±æ­¤æœ‰å¦‚ä¸‹çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>âˆˆ</mo><mi>G</mi></mrow></munder><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo>âˆ’</mo><mi>w</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[u][k] = \sum_{(u,v)\in G} dp[v][k - w(u, v)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.566em;vertical-align:-1.516em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.809em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">u</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mclose mtight">)</span><span class="mrel mtight">âˆˆ</span><span class="mord mathnormal mtight">G</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)]</span></span></span></span></span></p><p>å…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> ä¸ºè¾¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> çš„é•¿åº¦ã€‚ä½†æ˜¯ï¼Œè·ç¦»æœ‰å¯èƒ½å¾ˆå¤§ï¼Œæ‰€ä»¥è¿™æ ·è¿›è¡ŒçŠ¶æ€è¡¨ç¤ºæ— ç–‘ä¼šå†…å­˜è¶…é™ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦ä¼˜åŒ–è®¾è®¡çŠ¶æ€è¡¨ç¤ºã€‚</p><p>æ˜¾ç„¶ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ°ä»»ä½•ä¸€ä¸ªç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> æœ€çŸ­è·¯çš„è·ç¦» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">d[u]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span> æ˜¯ä¸ä¼šå˜åŒ–çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[u][k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span> æ¥è¡¨ç¤º <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> ä¸”è·¯å¾„é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo>+</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">d[u] + k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> çš„è·¯çº¿æ–¹æ¡ˆæ•°é‡</strong>ã€‚ è¿™æ ·å¯ä»¥é¿å…å†…å­˜è¶…é™çš„é—®é¢˜ã€‚</p><p>å‡è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[u][k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span> å¯ä»¥ç”± <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[v][x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span> è¿›è¡ŒçŠ¶æ€è½¬ç§»å¾—åˆ°ï¼Œæœ‰å¦‚ä¸‹çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>âˆˆ</mo><mi>G</mi></mrow></munder><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[u][k] = \sum_{(u, v) \in G}dp[v][x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.566em;vertical-align:-1.516em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.809em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">u</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mclose mtight">)</span><span class="mrel mtight">âˆˆ</span><span class="mord mathnormal mtight">G</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[v][x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> ä¸”è·¯å¾„é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo>+</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">d[v] + x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> çš„è·¯çº¿æ–¹æ¡ˆæ•°é‡ã€‚é€šè¿‡è¾¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> ï¼ˆPSï¼šåœ¨å®é™…å›¾ä¸­å¯¹åº”è¾¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(v, u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span> ï¼‰å¾—åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> çš„é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo>+</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">d[u] + k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> çš„è·¯çº¿ï¼Œå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo>+</mo><mi>x</mi><mo>+</mo><mi>w</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>d</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo>+</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">d[v] + x + w(u, v) = d[u] + k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ã€‚ç»è¿‡ç§»é¡¹åï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>x</mi><mo>=</mo><mi>d</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo>+</mo><mi>k</mi><mo>âˆ’</mo><mi>d</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo>âˆ’</mo><mi>w</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x = d[u] + k - d[v] - w(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></span></p><p>æ•…æœ€ç»ˆçŠ¶æ€è½¬ç§»å¦‚ä¸‹ï¼š</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>âˆˆ</mo><mi>G</mi></mrow></munder><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>d</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo>+</mo><mi>k</mi><mo>âˆ’</mo><mi>d</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo>âˆ’</mo><mi>w</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[u][k] = \sum_{(u,v)\in G} dp[v][d[u] + k - d[v] - w(u,v)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.566em;vertical-align:-1.516em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.809em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">u</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mclose mtight">)</span><span class="mrel mtight">âˆˆ</span><span class="mord mathnormal mtight">G</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)]</span></span></span></span></span></p><p>æœ€ç»ˆçš„ç­”æ¡ˆä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>K</mi></msubsup><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>N</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\sum_{i=0}^K dp[N][i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è®°å¿†åŒ–æœç´¢ï¼Œè‡ªåº•å‘ä¸Šå¾—å‡ºæ¯ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>N</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[N][i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>ã€‚ç”±äºæ˜¯è‡ªåº•å‘ä¸Šçš„æ±‚è§£è¿‡ç¨‹ï¼Œç”±å‰é¢çš„ç‚¹å¾—åˆ°å½“å‰ç‚¹çš„çŠ¶æ€ï¼Œæ•…æˆ‘ä»¬éœ€è¦å¦å¤–å»ºç«‹ä¸€ä¸ªåå‘å›¾ï¼Œåœ¨åå‘å›¾ä¸Šè¿›è¡Œè®°å¿†åŒ–æœç´¢ã€‚</p><p>å¯¹äºåˆ¤æ–­æ˜¯å¦æœ‰æ— æ•°æ¡è·¯å¾„ï¼Œä¸»è¦åŸå› åœ¨äºå›¾ä¸­ä¼šå­˜åœ¨è‹¥å¹²é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> çš„è¾¹ï¼Œæœ‰å¯èƒ½ä¼šæ„æˆä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> çš„ç¯è·¯ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è®°å¿†åŒ–æœç´¢çš„è¿‡ç¨‹ä¸­è®°å½•æ˜¯å¦ä¼šå¯¼è‡´æ— æ•°æ¡æ»¡è¶³æ¡ä»¶çš„è·¯çº¿æ•°é‡ã€‚ç”¨ä¸€ä¸ªäºŒç»´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>i</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">vis</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> æ•°ç»„ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>i</mi><mi>s</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">vis[u][k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span> è¡¨ç¤º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[u][k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span> çš„çŠ¶æ€æ˜¯å¦æ›´æ–°è¿‡ï¼Œå†ç”¨ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">flag</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> è®°å½•æ˜¯å¦å¯¼è‡´æ— æ•°æ¡æ»¡è¶³æ¡ä»¶çš„è·¯çº¿ã€‚å¦‚æœå½“å‰ $dp[u][k] $æ›´æ–°è¿‡çš„å‰æä¸‹ï¼Œç»è¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ç¯ç»§ç»­æ›´æ–° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[u][k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span> çš„çŠ¶æ€ï¼Œæ­¤æ—¶å°±è¡¨æ˜ä¼šå‡ºç°æ— æ•°æ¡æ»¡è¶³æ¡ä»¶çš„è·¯çº¿ï¼Œä¹‹åç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">flag</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>true</mtext></mrow><annotation encoding="application/x-tex">\text{true}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord text"><span class="mord">true</span></span></span></span></span> åŒæ—¶åœæ­¢é€’å½’å³å¯ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ±‚è§£ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>N</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[N][i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span> çš„è®°å¿†åŒ–æœç´¢è¿‡ç¨‹ä¸­ï¼Œæ— æ³•å¤„ç†èµ·ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> å¯èƒ½å­˜åœ¨çš„é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> çš„ç¯è·¯ï¼Œå¦‚æœå‡ºç°è¿™æ ·çš„ç¯è·¯æ˜¾ç„¶æ»¡è¶³æ¡ä»¶çš„è·¯çº¿ä¹Ÿæœ‰å¯èƒ½æ— ç©·å¤šï¼Œæ•…éœ€è¦æå‰ç‰¹æ®Šå¤„ç†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MP make_pair</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> pque priority_queue</span><br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>, M = (N &lt;&lt; <span class="hljs-number">1</span>), inf = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-type">int</span> h[N], e[M], ne[M], w[M], idx; <span class="hljs-comment">// æ­£å‘å›¾ ç”¨äºæ±‚æœ€çŸ­è·¯</span><br>vector&lt;pii&gt; edge[N];  <span class="hljs-comment">// åå‘å›¾ ç”¨äºè®°å¿†åŒ–æœç´¢</span><br><span class="hljs-type">int</span> n, m, K, P;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">int</span> c)</span></span>&#123;<br>    e[ ++ idx] = b, ne[idx] = h[a], w[idx] = c, h[a] = idx;<br>&#125;<br><br><span class="hljs-type">int</span> dist[N];<br><span class="hljs-type">bool</span> st[N];<br><span class="hljs-comment">// å †ä¼˜åŒ–dijkstraæ±‚æœ€çŸ­è·¯</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dijkstra</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) dist[i] = inf, st[i] = <span class="hljs-literal">false</span>;<br>    dist[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>    pque&lt;pii, vector&lt;pii&gt;, greater&lt;pii&gt; &gt; q;<br>    q.<span class="hljs-built_in">push</span>(<span class="hljs-built_in">MP</span>(dist[<span class="hljs-number">1</span>], <span class="hljs-number">1</span>));<br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-keyword">auto</span> [d, u] = q.<span class="hljs-built_in">top</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">if</span>(st[u]) <span class="hljs-keyword">continue</span>;<br>        st[u] = <span class="hljs-literal">true</span>;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; i; i = ne[i])&#123;<br>            <span class="hljs-type">int</span> v = e[i], c = w[i];<br>            <span class="hljs-keyword">if</span>(dist[v] &gt; d + c)&#123;<br>                dist[v] = d + c;<br>                q.<span class="hljs-built_in">push</span>(<span class="hljs-built_in">MP</span>(dist[v], v));<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">bool</span> flag;        <span class="hljs-comment">// ç”¨äºæ ‡è®°åˆæ³•è·¯å¾„ä¸­æ˜¯å¦èµ°åˆ°è¿‡0è¾¹ï¼Œæœ‰åˆ™æœ‰æ— æ•°æ¡è·¯å¾„</span><br><span class="hljs-type">bool</span> vis[N][<span class="hljs-number">51</span>];  <span class="hljs-comment">// ç”¨äºæ ‡è®°æ˜¯å¦è®¿é—®è¿‡ï¼Œè‹¥è®¿é—®è¿‡åˆ™è¯´æ˜æ˜¯ä»0è¾¹è¿‡æ¥çš„</span><br><span class="hljs-type">int</span> f[N][<span class="hljs-number">51</span>];     <span class="hljs-comment">// f[u][k] è¡¨ç¤º 1 -&gt; u çš„é•¿åº¦ä¸º dist[u] + k çš„è·¯å¾„æ•°é‡</span><br><span class="hljs-comment">// è®°å¿†åŒ–æœç´¢</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">dp</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> k)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(k &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span>(vis[u][k])&#123; <span class="hljs-comment">// è‹¥æ›´æ–°è¿‡å†æ¬¡æ›´æ–° åˆ™è¡¨æ˜æ˜¯ä»0ç¯è¿‡æ¥çš„</span><br>        flag = <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(f[u][k]) <span class="hljs-keyword">return</span> f[u][k];<br><br>    vis[u][k] = <span class="hljs-literal">true</span>;<br>    <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;[v, w] : edge[u])&#123;<br>        res = (res + <span class="hljs-built_in">dp</span>(v, dist[u] + k - dist[v] - w)) % P; <span class="hljs-comment">// çŠ¶æ€è½¬ç§»</span><br>        <span class="hljs-keyword">if</span>(flag) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    vis[u][k] = <span class="hljs-literal">false</span>;<br><br>    <span class="hljs-keyword">return</span> f[u][k] = res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">clr</span><span class="hljs-params">()</span></span>&#123;<br>    idx = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) edge[i].<span class="hljs-built_in">clear</span>(), h[i] = <span class="hljs-number">0</span>;<br>    flag = <span class="hljs-literal">false</span>;<br>    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> f);<br>    <span class="hljs-built_in">memset</span>(vis, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> vis);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;T);<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        <br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;K, &amp;P);<br>        <span class="hljs-keyword">while</span>(m -- )&#123;<br>            <span class="hljs-type">int</span> u, v, c; <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;c);<br>            <span class="hljs-built_in">add</span>(u, v, c);<br>            edge[v].<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">MP</span>(u, c));<br>        &#125;<br><br>        <span class="hljs-built_in">dijkstra</span>();  <span class="hljs-comment">// æ±‚æœ€çŸ­è·¯</span><br>        <span class="hljs-built_in">dp</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);    <span class="hljs-comment">// è®°å¿†åŒ–æœç´¢å¤„ç†1åˆ°1çš„0ç¯ è‹¥å­˜åœ¨åˆ™flag=true</span><br>        f[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br><br>        <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= K; i ++ ) res = (res + <span class="hljs-built_in">dp</span>(n, i)) % P;<br><br>        <span class="hljs-keyword">if</span>(flag) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;-1&quot;</span>); <span class="hljs-comment">// è·¯å¾„ä¸Šå­˜åœ¨ 0 ç¯ï¼Œåˆ™è¡¨æ˜æœ‰æ— æ•°æ¡è·¯å¾„</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br><br>        <span class="hljs-built_in">clr</span>(); <span class="hljs-comment">// æ¸…ç©º </span><br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å’å”±å…‰èŠ’</category>
      
      <category>YAC æ‰¬å·å¤§å­¦ç®—æ³•ç»ƒä¹ èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>ç®—æ³•ç«èµ›</tag>
      
      <tag>Luogu</tag>
      
      <tag>YAC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 YAC Round 1 é¢˜è§£</title>
    <link href="/2024/12/14/YAC_Round_1/"/>
    <url>/2024/12/14/YAC_Round_1/</url>
    
    <content type="html"><![CDATA[<h2 id="A-ä¸‰å¦–ç²¾SAY-WA"><strong>A. ä¸‰å¦–ç²¾SAY WA!!!</strong></h2><h3 id="é¢˜ç›®æè¿°"><strong>é¢˜ç›®æè¿°</strong></h3><p>å³æ±‚å‡ºæ•°ç»„ä¸­ <strong>å°äºç­‰äº</strong> ä¸Šç•Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> çš„æœ€å¤§ä¸‰æ•°ä¹‹å’Œã€‚<a href="https://www.luogu.com.cn/problem/T409142">ã€ŒYAC Round 1ã€ä¸‰å¦–ç²¾SAY WA!!!</a></p><h3 id="è§£æ³•ä¸€-ï¼ˆæš´åŠ›æšä¸¾ï¼‰"><strong>è§£æ³•ä¸€ ï¼ˆæš´åŠ›æšä¸¾ï¼‰</strong></h3><p>ç”±äºæ•°æ®èŒƒå›´è¾ƒå°ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>â‰¤</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">n \le 100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">100</span></span></span></span>ï¼Œå¯ä»¥ç›´æ¥ä¸‰é‡å¾ªç¯æšä¸¾ä¸‰ä¸ªæ•°æš´åŠ›è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ã€‚(æ³¨æ„ä¸‰ä¸ªæ•°è¦æ±‚ä¸‹æ ‡ä¸é‡å¤)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">110</span>;<br><br><span class="hljs-type">int</span> a[N], n, m, res;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = i + <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = j + <span class="hljs-number">1</span>; k &lt;= n; k ++ )&#123;<br>                <span class="hljs-type">int</span> sum = a[i] + a[j] + a[k];<br>                <span class="hljs-keyword">if</span>(sum &lt;= m) res = <span class="hljs-built_in">max</span>(res, sum);<br>            &#125;<br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è§£æ³•äºŒ-ï¼ˆæšä¸¾-äºŒåˆ†ï¼‰"><strong>è§£æ³•äºŒ ï¼ˆæšä¸¾ + äºŒåˆ†ï¼‰</strong></h3><p>æˆ‘ä»¬éœ€è¦åœ¨å°äºç­‰äºä¸Šç•Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> çš„æ¡ä»¶ä¸‹ï¼Œæœ€å¤§åŒ–ä¸‰æ•°ä¹‹å’Œçš„æœ€å¤§å€¼ï¼Œæ˜¾ç„¶è¿™ä¸ªé—®é¢˜å…·æœ‰äºŒæ®µæ€§ï¼Œå³ å½“ä¸‰æ•°ä¹‹å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>sum</mtext><mo>â‰¤</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">\text{sum} \le m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord text"><span class="mord">sum</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> æ—¶ï¼Œæ­¤æ—¶çš„å’Œæ»¡è¶³æ¡ä»¶ â€œå°äºç­‰äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>â€ï¼›å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>sum</mtext><mo>&gt;</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">\text{sum} &gt; m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord text"><span class="mord">sum</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>ï¼Œæ­¤æ—¶çš„å’Œåˆ™ä¸æ»¡è¶³ã€‚</p><p>æ•…æˆ‘ä»¬å¯ä»¥å°è¯•ç”¨äºŒåˆ†æŸ¥æ‰¾åŠ ä»¥ä¼˜åŒ–ã€‚å…ˆå¯¹æ•°ç»„è¿›è¡Œæ’åºï¼Œå†æšä¸¾å‰ä¸¤ä¸ªæ•°å­—ï¼Œç„¶ååœ¨åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[j + 1, n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span> èŒƒå›´å†…äºŒåˆ†æŸ¥æ‰¾æ‰¾åˆ°ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>m</mi><mi>i</mi><mi>d</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[mid]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">mi</span><span class="mord mathnormal">d</span><span class="mclose">]</span></span></span></span> ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">mid</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">mi</span><span class="mord mathnormal">d</span></span></span></span> ä¸ºç¬¬ä¸‰ä¸ªæ•°ä¸‹æ ‡ï¼‰æ‰¾åˆ°ä¸‰æ•°ä¹‹å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>+</mo><mi>a</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>+</mo><mi>a</mi><mo stretchy="false">[</mo><mi>m</mi><mi>i</mi><mi>d</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[i] + a[j] + a[mid]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">mi</span><span class="mord mathnormal">d</span><span class="mclose">]</span></span></span></span> åœ¨å°äºç­‰äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> æ¡ä»¶ä¸‹çš„æœ€å¤§å€¼ã€‚è¿™æ ·å°±å¯ä»¥çœå»ç¬¬ä¸‰é‡å¾ªç¯ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">110</span>;<br><br><span class="hljs-type">int</span> a[N], n, m, res;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br>    <span class="hljs-built_in">sort</span>(a + <span class="hljs-number">1</span>, a + n + <span class="hljs-number">1</span>); <span class="hljs-comment">// æ’åº</span><br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = i + <span class="hljs-number">1</span>; j &lt;= n; j ++ )&#123;<br>            <span class="hljs-type">int</span> l = j + <span class="hljs-number">1</span>, r = n;<br>            <span class="hljs-keyword">if</span>(l &gt; r) <span class="hljs-keyword">continue</span>;  <span class="hljs-comment">// æ³¨æ„è¿™é‡Œè¦æå‰é€€å‡º</span><br>            <span class="hljs-keyword">while</span>(l &lt; r)&#123;<br>                <span class="hljs-type">int</span> mid = l + r + <span class="hljs-number">1</span> &gt;&gt; <span class="hljs-number">1</span>;<br>                <span class="hljs-keyword">if</span>(a[i] + a[j] + a[mid] &lt;= m) l = mid;<br>                <span class="hljs-keyword">else</span> r = mid - <span class="hljs-number">1</span>;<br>            &#125;<br>            <span class="hljs-type">int</span> sum = a[i] + a[j] + a[l];<br>            <span class="hljs-keyword">if</span>(sum &lt;= m) res = <span class="hljs-built_in">max</span>(res, sum); <span class="hljs-comment">// æœ€åè¿˜éœ€è¦å†checkä¸€æ¬¡</span><br>        &#125;<br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br/><h2 id="B-å¤œé›€ä¹‹æ­Œ"><strong>B. å¤œé›€ä¹‹æ­Œ</strong></h2><h3 id="é¢˜ç›®æè¿°-2"><strong>é¢˜ç›®æè¿°</strong></h3><p>æ„é€ ä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>01</mn></mrow><annotation encoding="application/x-tex">01</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">01</span></span></span></span> å­—ç¬¦ä¸²ï¼Œæ»¡è¶³ <strong>æ°å¥½</strong> æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> ä¸ªä¸å¤„äºå­—ç¬¦ä¸²ä¸¤ç«¯çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ä¸¤è¾¹æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œä¸”è¾“å‡ºå­—å…¸åºæœ€å°çš„æ„é€ æ–¹æ¡ˆã€‚<a href="https://www.luogu.com.cn/problem/T409120">ã€ŒYAC Round 1ã€å¤œé›€ä¹‹æ­Œ</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆè´ªå¿ƒï¼‰"><strong>è§£é¢˜æ€è·¯ ï¼ˆè´ªå¿ƒï¼‰</strong></h3><p>éœ€è¦æ»¡è¶³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> ä¸ªå­—ç¬¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ä¸¤è¾¹æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œæˆ‘ä»¬æœ€å°‘éœ€è¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä¸ªå­—ç¬¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è‡³å°‘éœ€è¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><mi>p</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2 \times p + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä¸ªå­—ç¬¦å¯ä»¥è¿›è¡Œæ„é€ ï¼Œæ‰€ä»¥å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&lt;</mo><mn>2</mn><mo>Ã—</mo><mi>p</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n &lt; 2 \times p + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> æ—¶ï¼Œä¸å¯èƒ½å®Œæˆæ„é€ ï¼Œæ•…ç›´æ¥è¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span> ã€‚</p><p>å¯¹äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>â‰¥</mo><mn>2</mn><mo>Ã—</mo><mi>p</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n \ge 2 \times p + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> çš„æƒ…å†µï¼Œåœ¨æ»¡è¶³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ä¸¤è¾¹æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> çš„æƒ…å†µä¸‹ï¼Œä¸ºäº†ä½¿å¾—å­—å…¸åºæœ€å°ï¼Œæˆ‘ä»¬åªéœ€è¦æœ€å°‘çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä¸ªå­—ç¬¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œå¹¶ä¸”å°½å¯èƒ½åœ°æŠŠ <strong>å¤šä½™çš„</strong> å­—ç¬¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> æ”¾åœ¨å‰é¢å³å¯ï¼ˆä¹Ÿå°±æ˜¯æ„é€ æˆç±»ä¼¼äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>000</mn><mo>â€¦</mo><mn>010101</mn></mrow><annotation encoding="application/x-tex">000 \ldots 010101</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">000</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">010101</span></span></span></span> çš„å½¢å¼ã€‚å½“ç„¶ï¼Œä¹Ÿæœ‰å¯èƒ½æ²¡æœ‰å¤šä½™çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ï¼‰ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><br><span class="hljs-type">int</span> n, p; <br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; cin &gt;&gt; T;<br>    <span class="hljs-keyword">while</span>(T -- )&#123;<br>        cin &gt;&gt; n &gt;&gt; p;<br>        <span class="hljs-keyword">if</span>(n &lt; <span class="hljs-number">2</span> * p + <span class="hljs-number">1</span>)&#123; <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦å¯ä»¥æ„é€ </span><br>            cout &lt;&lt; <span class="hljs-number">-1</span> &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br><br>        string res = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span> * p + <span class="hljs-number">1</span>; i &lt; n; i ++ ) res += <span class="hljs-string">&quot;0&quot;</span>; <span class="hljs-comment">// å¤šä½™çš„0</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= p; i ++ ) res += <span class="hljs-string">&quot;10&quot;</span>;       <span class="hljs-comment">// pä¸ªæ»¡è¶³çš„ 0</span><br>        res += <span class="hljs-string">&quot;1&quot;</span>;  <span class="hljs-comment">// æœ€åå†åŠ ä¸€ä¸ª 1</span><br>        cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;    <br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br/><h2 id="C-BBA"><strong>C. BBA</strong></h2><h3 id="é¢˜ç›®æè¿°-3"><strong>é¢˜ç›®æè¿°</strong></h3><p>ç»Ÿè®¡å­—ç¬¦ä¸²ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>â€œbbaâ€</mtext></mrow><annotation encoding="application/x-tex">â€œ\text{bba}â€</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">â€œ</span><span class="mord text"><span class="mord">bba</span></span><span class="mord">â€</span></span></span></span> å‹ <strong>å­åºåˆ—</strong> ä¸ªæ•°ï¼Œå­—ç¬¦ä¸²åªåŒ…å«å°å†™è‹±æ–‡å­—ç¬¦ã€‚<a href="https://www.luogu.com.cn/problem/T408861">ã€ŒYAC Round 1ã€BBA</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆå‰ç¼€å’Œï¼‰"><strong>è§£é¢˜æ€è·¯ ï¼ˆå‰ç¼€å’Œï¼‰</strong></h3><p>è¿™é‡Œç»™å‡ºä¸€ä¸ªæ¯”è¾ƒå¥½ç†è§£çš„æ–¹æ³•ã€‚ï¼ˆä¹Ÿæœ‰æ›´å¥½çš„åšæ³•ï¼Œæ¬¢è¿è®¨è®ºï¼‰</p><p>å¯¹äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>â€œbbaâ€</mtext></mrow><annotation encoding="application/x-tex">â€œ\text{bba}â€</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">â€œ</span><span class="mord text"><span class="mord">bba</span></span><span class="mord">â€</span></span></span></span> å‹å­åºåˆ—ï¼Œåªéœ€è¦æšä¸¾æ¯ä¸ªä½ç½®çš„å­—ç¬¦ï¼Œç„¶åè§‚å¯Ÿå‰é¢ä¸å½“å‰ä½ç½®å­—ç¬¦ä¸åŒçš„æ¯ç§å­—ç¬¦å„æœ‰å¤šå°‘ä¸ªï¼Œç„¶åç´¯åŠ ä¸€ä¸‹ç»„åˆæ•°å³å¯ã€‚</p><p>ä¾‹å¦‚ï¼Œæšä¸¾åˆ°å½“å‰ä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> çš„å­—ç¬¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>c</mtext></mrow><annotation encoding="application/x-tex">\text{c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">c</span></span></span></span></span>ï¼Œæˆ‘ä»¬éœ€è¦ç»Ÿè®¡åœ¨ä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> å‰é¢é™¤å­—ç¬¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>c</mtext></mrow><annotation encoding="application/x-tex">\text{c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">c</span></span></span></span></span> ä»¥å¤– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>a,Â b,Â dÂ ...Â z</mtext></mrow><annotation encoding="application/x-tex">\text{a, b, d ... z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">a,Â b,Â dÂ ...Â z</span></span></span></span></span> å„æœ‰å¤šå°‘ä¸ªï¼Œå…¶ä¸­å¯¹äºå­—ç¬¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>q</mtext></mrow><annotation encoding="application/x-tex">\text{q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">q</span></span></span></span></span>ï¼Œæœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">cnt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span></span></span></span> ä¸ªï¼Œé‚£ä¹ˆç”¨å½“å‰ä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> çš„å­—ç¬¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>c</mtext></mrow><annotation encoding="application/x-tex">\text{c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord text"><span class="mord">c</span></span></span></span></span> å’Œå‰é¢çš„å­—ç¬¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>q</mtext></mrow><annotation encoding="application/x-tex">\text{q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">q</span></span></span></span></span> æ„æˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>â€œbbaâ€</mtext></mrow><annotation encoding="application/x-tex">â€œ\text{bba}â€</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">â€œ</span><span class="mord text"><span class="mord">bba</span></span><span class="mord">â€</span></span></span></span> å‹å­—ç¬¦ä¸²çš„æ–¹æ¡ˆæ•°å°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>C</mi><mrow><mi>c</mi><mi>n</mi><mi>t</mi></mrow><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">C_{cnt}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0611em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œä¹Ÿå°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo>Ã—</mo><mo stretchy="false">(</mo><mi>c</mi><mi>n</mi><mi>t</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{cnt \times (cnt - 1)}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">Ã—</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> ã€‚</p><p>å­—ç¬¦ä¸²åªåŒ…å«å°å†™è‹±æ–‡å­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦é¢„å¤„ç†æ¯ä¸ªå­—ç¬¦çš„å‰ç¼€å’Œã€‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">cnt[i][j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span> è¡¨ç¤ºåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1, i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span> å†…å­—ç¬¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msup><mi>a</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo>+</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">&#x27;a&#x27; + j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8352em;vertical-align:-0.0833em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> çš„æ€»ä¸ªæ•°ã€‚</p><p>æœ€åæšä¸¾æ¯ä¸ªä½ç½®ï¼Œå†æšä¸¾æ¯ä¸ª <strong>ä¸å½“å‰ä½ç½®å­—ç¬¦ä¸åŒ</strong> çš„å­—ç¬¦ï¼Œç´¯åŠ ç­”æ¡ˆå³å¯ã€‚ï¼ˆæ³¨æ„å¼€ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>longÂ long</mtext></mrow><annotation encoding="application/x-tex">\text{long long}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">longÂ long</span></span></span></span></span>ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-type">int</span> n;<br>string s;<br>ll cnt[N][<span class="hljs-number">26</span>]; <span class="hljs-comment">// æ¯ä¸ªå­—ç¬¦çš„å‰ç¼€å’Œ</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; s;<br>    s = <span class="hljs-string">&quot; &quot;</span> + s;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">26</span>; j ++ )<br>            cnt[i][j] = cnt[i - <span class="hljs-number">1</span>][j] + (s[i] - <span class="hljs-string">&#x27;a&#x27;</span> == j);<br><br>    ll res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">3</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">26</span>; j ++ )<br>            <span class="hljs-keyword">if</span>(j != s[i] - <span class="hljs-string">&#x27;a&#x27;</span>) <br>                res += cnt[i - <span class="hljs-number">1</span>][j] * (cnt[i - <span class="hljs-number">1</span>][j] - <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;<br>    <br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ç´¯åŠ ç­”æ¡ˆæ—¶ï¼Œåªéœ€è¦çŸ¥é“å‰é¢ä¸€ä¸ªä½ç½®çš„æ•°é‡ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ç´¯åŠ ç­”æ¡ˆçš„åŒæ—¶ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦çš„ä¸ªæ•°ï¼Œè€Œä¸”å¯ä»¥ç›´æ¥çœå»ç¬¬ä¸€ä¸ªç»´åº¦ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><br><span class="hljs-type">int</span> n;<br>string s;<br>ll cnt[<span class="hljs-number">26</span>];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; s;<br>    s = <span class="hljs-string">&quot; &quot;</span> + s;<br><br>    ll res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">26</span>; j ++ )<br>            <span class="hljs-keyword">if</span>(j != s[i] - <span class="hljs-string">&#x27;a&#x27;</span>) res += cnt[j] * (cnt[j] - <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;<br>        cnt[s[i] - <span class="hljs-string">&#x27;a&#x27;</span>] ++ ;<br>    &#125;<br><br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br/><h2 id="D-é­”æ³•ä½¿çš„äº‹ï¼Œèƒ½å«å·å—ï¼Ÿ"><strong>D. é­”æ³•ä½¿çš„äº‹ï¼Œèƒ½å«å·å—ï¼Ÿ</strong></h2><h3 id="é¢˜ç›®æè¿°-4"><strong>é¢˜ç›®æè¿°</strong></h3><p>åœ¨åºåˆ—ä¸­æ‰¾åˆ°ä¸€ä¸ªåŒ…å«æ•°å­— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo>â€¦</mo><mo separator="true">,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">1, 2, 3 \ldots , m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span></span></span></span> çš„æœ€å°é•¿åº¦çš„è¿ç»­åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> ã€‚è‹¥æœ‰å¤šç»„è§£ï¼Œè¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> æœ€å°çš„é‚£ä¸ªã€‚ï¼ˆæ•°æ®ä¿è¯ä¸€å®šæœ‰è§£ï¼‰<a href="https://www.luogu.com.cn/problem/T408863">ã€ŒYAC Round 1ã€é­”æ³•ä½¿çš„äº‹ï¼Œèƒ½å«å·å—ï¼Ÿ</a></p><h3 id="è§£æ³•ä¸€-ï¼ˆäºŒåˆ†-æ»‘åŠ¨çª—å£ï¼‰"><strong>è§£æ³•ä¸€ ï¼ˆäºŒåˆ† + æ»‘åŠ¨çª—å£ï¼‰</strong></h3><p>æ˜¾ç„¶ï¼Œè¿ç»­åŒºé—´çš„é•¿åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>e</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">len</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span></span></span></span> è¶Šé•¿ï¼ŒåŒ…å«çš„ä¹¦çš„æ•°é‡è¶Šå¤šï¼Œæ›´æœ‰å¯èƒ½åŒ…å«æ‰€æœ‰ç§ç±»çš„ä¹¦ã€‚å‡è®¾æœ€ç»ˆå¾—åˆ°çš„åŒºé—´çš„é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span>ï¼Œå½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>e</mi><mi>n</mi><mo>â‰¥</mo><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">len \ge ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span> æ—¶ï¼Œåºåˆ—ä¸­å­˜åœ¨ä¸€ä¸ªè¿ç»­åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> åŒ…å«äº†æ‰€æœ‰ç§ç±»çš„ä¹¦ï¼›å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>e</mi><mi>n</mi><mo>&lt;</mo><mi>a</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">len &lt; ans</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span></span></span></span> æ—¶ï¼Œåºåˆ—ä¸­ä¸å­˜åœ¨åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> æ»¡è¶³æ¡ä»¶ã€‚å¯ä»¥çœ‹å‡ºè¯¥é—®é¢˜å…·æœ‰äºŒæ®µæ€§ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥äºŒåˆ†ç­”æ¡ˆï¼ˆåŒºé—´é•¿åº¦ï¼‰ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>check</mtext></mrow><annotation encoding="application/x-tex">\text{check}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">check</span></span></span></span></span> å‡½æ•°ä¸­ï¼Œé¡ºåºæšä¸¾å½“å‰é•¿åº¦çš„èµ·ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> å’Œç»ˆç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>ï¼Œå¦‚æœå½“å‰åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> å·²ç»åŒ…å«äº†æ‰€æœ‰ç§ç±»çš„ä¹¦ï¼Œåˆ™ç›´æ¥è¿”å› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>true</mtext></mrow><annotation encoding="application/x-tex">\text{true}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord text"><span class="mord">true</span></span></span></span></span>ï¼›å¦‚æœæšä¸¾åˆ°æœ€åéƒ½æ²¡æœ‰æ»¡è¶³çš„åŒºé—´ï¼Œåˆ™è¿”å› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>false</mtext></mrow><annotation encoding="application/x-tex">\text{false}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">false</span></span></span></span></span> ã€‚</p><p>å¯¹äºåŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> å†…æ˜¯å¦åŒ…å«æ‰€æœ‰ç§ç±»çš„ä¹¦è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªè®¡æ•°æ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">cnt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span></span></span></span> å’Œä¸€ä¸ªè®¡æ•°å˜é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">diff</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span></span></span></span> æ¥å®ç°ä¸€ä¸ª <strong>æ»‘åŠ¨çª—å£</strong> ç®—æ³•ã€‚å…¶ä¸­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">cnt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span></span></span></span> æ•°ç»„ç»Ÿè®¡çš„æ˜¯ <strong>æ¯ä¸ªç§ç±»çš„ä¹¦å‡ºç°çš„æ¬¡æ•°</strong>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">diff</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span></span></span></span> ç»Ÿè®¡çš„æ˜¯ <strong>å½“å‰åŒºé—´å†…ä¸åŒç§ç±»çš„ä¹¦çš„ä¸ªæ•°</strong>ã€‚</p><p>å…ˆé¢„å¤„ç†åˆå§‹æƒ…å†µä¸‹çš„æ»‘åŠ¨çª—å£ï¼Œèµ·ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">l = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ã€‚å¯¹äºå½“å‰ç§ç±»ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> çš„ä¹¦ï¼Œè‹¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>c</mi><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">cnt[c] = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">c</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œåˆ™è¡¨æ˜æ­¤ç§ç±»çš„ä¹¦åœ¨å½“å‰åŒºé—´æœªå‡ºç°è¿‡ï¼Œæ­¤æ—¶ $cnt[c] ++ $ çš„åŒæ—¶ï¼Œè¿˜éœ€è¦ $diff ++ $ï¼›è‹¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>c</mi><mo stretchy="false">]</mo><mo>=Ì¸</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">cnt[c] \not = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">c</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel">î€ </span></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œåˆ™è¡¨æ˜å·²ç»å‡ºç°è¿‡ï¼Œåªéœ€è¦ $cnt[c] ++ $ã€‚</p><p>æ¥ç€ç§»åŠ¨æ»‘åŠ¨çª—å£ï¼Œå¯¹äºæ–°è¿›å…¥çª—å£çš„æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>ï¼Œå¦‚æœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>a</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">cnt[a[r]] = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œéœ€è¦ $diff ++ $ã€‚å¯¹äºç¦»å¼€çª—å£çš„æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>l</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[l - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>ï¼Œå¦‚æœ $cnt[a[l-1]] â€“ $ åï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mi>a</mi><mo stretchy="false">[</mo><mi>l</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">cnt[a[l - 1]] = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ï¼Œæ­¤æ—¶è¯´æ˜åŒºé—´å†…ä¸å†æœ‰ç§ç±»ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>l</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[l - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> çš„ä¹¦ï¼Œæ•…éœ€è¦è¿›è¡Œ $diff â€“ $ã€‚</p><p>å¯¹äºå½“å‰çš„åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>ï¼Œ å¤„ç†å®Œè¿™äº›æ“ä½œåï¼Œè‹¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mo>=</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">diff = m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>ï¼Œåˆ™åŒ…å«äº†æ‰€æœ‰ç§ç±»çš„ä¹¦ï¼Œæ­¤æ—¶å°±è¿”å›èµ·ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>ï¼ˆç”±äºæ˜¯é¡ºåºæšä¸¾çš„ï¼Œç¬¬ä¸€ä¸ªæ»¡è¶³çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> å°±æ˜¯ç­”æ¡ˆï¼‰ã€‚å¦‚æœæšä¸¾åˆ°æœ€åéƒ½æ²¡æœ‰æ»¡è¶³çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>ï¼Œåˆ™è¿”å› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>ã€‚</p><p>æœ€ç»ˆæ—¶é—´å¤æ‚åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e6</span> + <span class="hljs-number">10</span>, M = <span class="hljs-number">2010</span>;<br><br><span class="hljs-type">int</span> n, m;<br><span class="hljs-type">int</span> a[N], cnt[M];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">check</span><span class="hljs-params">(<span class="hljs-type">int</span> mid)</span></span>&#123;<br>    <span class="hljs-built_in">memset</span>(cnt, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> cnt); <span class="hljs-comment">// åˆå§‹åŒ–æ¯ä¸ªç§ç±»è®¡æ•°</span><br><br>    <span class="hljs-comment">// é¢„å¤„ç†åˆå§‹åŒ–çª—å£</span><br>    <span class="hljs-type">int</span> l = <span class="hljs-number">1</span>, r = mid, diff = <span class="hljs-number">0</span>; <span class="hljs-comment">// diff ç»Ÿè®¡åŒºé—´å†…ä¸åŒç§ç±»æ•°</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = l; i &lt;= r; i ++ )&#123;<br>        <span class="hljs-keyword">if</span>(!cnt[a[i]]) diff ++ ;<br>        cnt[a[i]] ++ ;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(diff == m) <span class="hljs-keyword">return</span> l; <span class="hljs-comment">// è‹¥æ»¡è¶³ç›´æ¥è¿”å›</span><br><br>    <span class="hljs-comment">// æ»‘åŠ¨çª—å£ æ³¨æ„æ“ä½œçš„é¡ºåº</span><br>    <span class="hljs-keyword">for</span>(l = <span class="hljs-number">2</span>, r = mid + <span class="hljs-number">1</span>; r &lt;= n; l ++ , r ++ )&#123;<br>        <span class="hljs-keyword">if</span>(!cnt[a[r]]) diff ++ ;          <span class="hljs-comment">// å‡ºç°æ–°ç§ç±»</span><br>        cnt[a[l - <span class="hljs-number">1</span>]] -- , cnt[a[r]] ++ ; <span class="hljs-comment">// a[l - 1] ç¦»å¼€ï¼Œa[r] è¿›å…¥çª—å£</span><br>        <span class="hljs-keyword">if</span>(cnt[a[l - <span class="hljs-number">1</span>]] == <span class="hljs-number">0</span>) diff -- ;  <span class="hljs-comment">// æœ‰ç§ç±»è¢«åˆ å»</span><br>        <span class="hljs-keyword">if</span>(diff == m) <span class="hljs-keyword">return</span> l;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br>    <span class="hljs-type">int</span> l = m, r = n;<br>    <span class="hljs-keyword">while</span>(l &lt; r)&#123;<br>        <span class="hljs-type">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">check</span>(mid)) r = mid;<br>        <span class="hljs-keyword">else</span> l = mid + <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-type">int</span> s = <span class="hljs-built_in">check</span>(r), e = s + r - <span class="hljs-number">1</span>; <span class="hljs-comment">// èµ·ç‚¹ s, ç»ˆç‚¹ e ä¸ºèµ·ç‚¹åŠ ä¸Šé•¿åº¦r å† - 1</span><br>    cout &lt;&lt; s &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; e &lt;&lt; endl; <br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è§£æ³•äºŒ-ï¼ˆåŒæŒ‡é’ˆï¼‰"><strong>è§£æ³•äºŒ ï¼ˆåŒæŒ‡é’ˆï¼‰</strong></h3><p>å¯ä»¥ç”¨åŒæŒ‡é’ˆéå†æ•°ç»„æ¥è®°å½•æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> ã€‚æˆ‘ä»¬è¿˜æ˜¯éœ€è¦ä¸€ä¸ªè®¡æ•°æ•°ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">cnt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span></span></span></span> å’Œä¸€ä¸ªè®¡æ•°å˜é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">diff</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">cnt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span></span></span></span> æ•°ç»„ç»Ÿè®¡çš„æ˜¯ <strong>æ¯ä¸ªç§ç±»çš„ä¹¦å‡ºç°çš„æ¬¡æ•°</strong>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">diff</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span></span></span></span> ç»Ÿè®¡çš„æ˜¯ <strong>å½“å‰åŒºé—´å†…ä¸åŒç§ç±»çš„ä¹¦çš„ä¸ªæ•°</strong>ã€‚</p><p>å¦‚æœå½“å‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mo>&lt;</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">diff &lt; m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>ï¼Œæ­¤æ—¶å³æŒ‡é’ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> å¾€åç§»åŠ¨ï¼Œå¹¶åˆ¤æ–­ $r ++ $ åçš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> æ˜¯å¦å‡ºç°è¿‡ï¼ŒåŒæ—¶å¢åŠ è®¡æ•°ã€‚</p><p>å¦‚æœå½“å‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mo>=</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">diff = m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>ï¼Œæ­¤æ—¶çš„åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> æ˜¯æ»¡è¶³è¦æ±‚çš„ï¼Œæ•…æ›´æ–°ç­”æ¡ˆã€‚æˆ‘ä»¬æ³¨æ„åˆ°å½“å‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> ä¹‹åæ‰€æœ‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>r</mi><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></msup></mrow><annotation encoding="application/x-tex">r^{&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9425em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-2.9425em;margin-right:0.05em;"><span class="pstrut" style="height:2.5795em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> ä¸å½“å‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> æ‰€æ„æˆçš„åŒºé—´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><msup><mi>r</mi><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r^{&#x27;}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1925em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-2.9425em;margin-right:0.05em;"><span class="pstrut" style="height:2.5795em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> ä¹Ÿéƒ½ä¸€å®šæ˜¯æ»¡è¶³æ¡ä»¶çš„ï¼Œè€Œä¸”åŒºé—´é•¿åº¦è¿˜ä¸€å®šæ¯”å½“å‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> æ›´å¤§ã€‚</p><p>æ‰€ä»¥ï¼Œä¸ºäº†çœå»è¿™äº›å¤šä½™çš„æƒ…å†µï¼Œæˆ‘ä»¬è¿™æ—¶å€™éœ€è¦å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[l]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">]</span></span></span></span> ä»åŒºé—´ä¸­ç§»é™¤ï¼Œä¹Ÿå°±æ˜¯å·¦æŒ‡é’ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> å¾€åèµ°ï¼Œå¹¶æ›´æ–°åŒºé—´ä¸­çš„è®¡æ•°ã€‚éå†å®Œåå¾—åˆ°çš„ç­”æ¡ˆå°±æ˜¯æœ€çŸ­ä¸” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> æœ€å°çš„åŒºé—´ã€‚æ—¶é—´å¤æ‚åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">1e6</span> + <span class="hljs-number">10</span>, M = <span class="hljs-number">2010</span>, inf = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-type">int</span> n, m;<br><span class="hljs-type">int</span> a[N], cnt[M];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) cin &gt;&gt; a[i];<br><br>    <span class="hljs-comment">// åŒæŒ‡é’ˆ</span><br>    <span class="hljs-type">int</span> l = <span class="hljs-number">1</span>, r = l, diff = <span class="hljs-number">1</span>, res = inf, res_l, res_r;<br>    cnt[a[<span class="hljs-number">1</span>]] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span>(l &lt;= r &amp;&amp; r &lt;= n)&#123;<br>        <span class="hljs-keyword">if</span>(diff == m)&#123;<br>            <span class="hljs-keyword">if</span>(res &gt; r - l + <span class="hljs-number">1</span>)&#123;  <span class="hljs-comment">// æ›´æ–°ç­”æ¡ˆ</span><br>                res = r - l + <span class="hljs-number">1</span>;<br>                res_l = l, res_r = r;<br>            &#125;<br>            cnt[a[l]] -- ;<br>            <span class="hljs-keyword">if</span>(!cnt[a[l ++ ]]) diff -- ; <span class="hljs-comment">// å³æŒ‡é’ˆå¾€åèµ°</span><br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">if</span>(!cnt[a[ ++ r]]) diff ++ ; <span class="hljs-comment">// å·¦æŒ‡é’ˆå¾€åèµ°</span><br>            cnt[a[r]] ++ ;<br>        &#125;<br>    &#125;<br>    cout &lt;&lt; res_l &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; res_r &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="E-æ—¶é—´å†»ç»“"><strong>E. æ—¶é—´å†»ç»“</strong></h2><h3 id="é¢˜ç›®æè¿°-5"><strong>é¢˜ç›®æè¿°</strong></h3><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> ä¸ªç‚¹ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> æ¡æ— å‘è¾¹ï¼Œå¯ä»¥ <strong>æœ€å¤š</strong> é€‰æ‹© <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> æ¡è¾¹å°†å…¶é•¿åº¦ç¼©å‡ä¸ºåŸå…ˆé•¿åº¦çš„ä¸€åŠï¼Œæ±‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> çš„æœ€çŸ­è·ç¦»ã€‚ï¼ˆè¾¹çš„é•¿åº¦ä¸€å®šæ˜¯å¶æ•°ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒå‡ºç°æµ®ç‚¹æ•°æƒ…å†µï¼‰<a href="https://www.luogu.com.cn/problem/T409013">ã€ŒYAC Round 1ã€æ—¶é—´å†»ç»“</a></p><h3 id="è§£æ³•ä¸€-ï¼ˆdijkstra-DP-æœ€çŸ­è·¯ï¼‰"><strong>è§£æ³•ä¸€ ï¼ˆdijkstra + DP æœ€çŸ­è·¯ï¼‰</strong></h3><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> çš„èŒƒå›´å¾ˆå°ï¼Œæ•…å¯ä»¥åœ¨æ›´æ–°æœ€çŸ­è·¯çš„æ—¶å€™è®°å½•ä½¿ç”¨çš„ç¬¦å¡æ•°é‡ï¼Œè¿™æ˜¯å…¸å‹çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">DP</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> æœ€çŸ­è·¯åšæ³•ã€‚</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dist[v][cnt]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mclose">]</span></span></span></span> è¡¨ç¤º <strong>ä½¿ç”¨äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>n</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">cnt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span></span></span></span> å¼ ç¬¦å¡çŠ¶æ€ä¸‹  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></strong> çš„æœ€çŸ­è·ç¦»ã€‚èµ°ä¸€éæœ€çŸ­è·¯ç®—æ³•ï¼Œæœ€åæšä¸¾ä¸€ä¸‹ä½¿ç”¨ä¸åŒç¬¦å¡æ•°é‡åˆ°è¾¾é‡ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> çš„è·ç¦»å–æœ€å°å€¼å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">60</span>, M = <span class="hljs-number">2010</span>, inf = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-type">int</span> h[N], e[M], ne[M], w[M], idx; <span class="hljs-comment">// é“¾å¼å‰å‘æ˜Ÿ</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">int</span> c)</span></span>&#123;<br>    e[ ++ idx] = b, ne[idx] = h[a], w[idx] = c, h[a] = idx;<br>&#125;<br><br><span class="hljs-type">int</span> n, m, K;<br><span class="hljs-type">int</span> dist[N][N]; <span class="hljs-comment">// dist[v][cnt] ä½¿ç”¨äº†cntå¼ ç¬¦å¡çŠ¶æ€ä¸‹1åˆ°vçš„æœ€çŸ­è·ç¦»</span><br><span class="hljs-type">bool</span> st[N][N];  <span class="hljs-comment">// st[v][cnt] çŠ¶æ€æ˜¯å¦å·²ç»åœ¨æœ€çŸ­è·¯å¾„ç½‘ç»œä¸­</span><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span>&#123;<span class="hljs-type">int</span> d, u, cnt;&#125;; <span class="hljs-comment">// d ä¸ºè·ç¦»ï¼Œu ä¸ºåˆ°è¾¾çš„ç‚¹ï¼Œcnt è®°å½•çš„æ˜¯ç¬¦å¡ä½¿ç”¨æ¬¡æ•°</span><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">cmp</span>&#123; <span class="hljs-comment">// è¿ç®—ç¬¦é‡è½½</span><br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">operator</span> <span class="hljs-params">()</span> <span class="hljs-params">(<span class="hljs-type">const</span> node &amp;a, <span class="hljs-type">const</span> node &amp;b)</span></span>&#123;<br>        <span class="hljs-keyword">return</span> a.d &gt; b.d; <span class="hljs-comment">// æ ¹æ®è·ç¦»æ’åº</span><br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// å †ä¼˜åŒ– dijkstra</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dijkstra</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">memset</span>(dist, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> dist);<br>    dist[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br>    priority_queue&lt;node, vector&lt;node&gt;, cmp &gt; q;<br>    q.<span class="hljs-built_in">push</span>(node&#123;dist[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>], <span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;);<br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-keyword">auto</span> [d, u, cnt] = q.<span class="hljs-built_in">top</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">if</span>(st[u][cnt]) <span class="hljs-keyword">continue</span>;<br>        st[u][cnt] = <span class="hljs-literal">true</span>;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; i; i = ne[i])&#123;<br>            <span class="hljs-type">int</span> v = e[i], c = w[i];<br>            <span class="hljs-keyword">if</span>(dist[v][cnt] &gt; d + c)&#123; <span class="hljs-comment">// å½“å‰ä¸ä½¿ç”¨ç¬¦å¡</span><br>                dist[v][cnt] = d + c;<br>                q.<span class="hljs-built_in">push</span>(node&#123;dist[v][cnt], v, cnt&#125;);<br>            &#125;<br>            <span class="hljs-keyword">if</span>(cnt &lt; K)&#123; <span class="hljs-comment">// è¿˜æœ‰ç¬¦å¡å¯ä»¥ç”¨</span><br>                <span class="hljs-keyword">if</span>(dist[v][cnt + <span class="hljs-number">1</span>] &gt; d + (c &gt;&gt; <span class="hljs-number">1</span>))&#123; <span class="hljs-comment">// ä½¿ç”¨ç¬¦å¡</span><br>                    dist[v][cnt + <span class="hljs-number">1</span>] = d + (c &gt;&gt; <span class="hljs-number">1</span>);<br>                    q.<span class="hljs-built_in">push</span>(node&#123;dist[v][cnt + <span class="hljs-number">1</span>], v, cnt + <span class="hljs-number">1</span>&#125;);<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m &gt;&gt; K;<br>    <span class="hljs-keyword">while</span>(m -- )&#123;<br>        <span class="hljs-type">int</span> u, v, c; cin &gt;&gt; u &gt;&gt; v &gt;&gt; c;<br>        <span class="hljs-built_in">add</span>(u, v, c), <span class="hljs-built_in">add</span>(v, u, c); <span class="hljs-comment">// æ— å‘è¾¹</span><br>    &#125;<br><br>    <span class="hljs-built_in">dijkstra</span>();<br><br>    <span class="hljs-type">int</span> res = inf;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= K; i ++ ) res = <span class="hljs-built_in">min</span>(res, dist[n][i]);<br>    cout &lt;&lt; res &lt;&lt; endl;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è§£æ³•äºŒ-ï¼ˆdijkstra-åˆ†å±‚å›¾ï¼‰"><strong>è§£æ³•äºŒ ï¼ˆdijkstra + åˆ†å±‚å›¾ï¼‰</strong></h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æ„å»ºåˆ†å±‚å›¾ï¼Œåœ¨åˆ†å±‚å›¾ä¸Šè·‘ä¸€éæœ€çŸ­è·¯å³å¯ã€‚</p><p>å¯¹äºä¸€æ¡è¾¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{ u, v, w\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">}</span></span></span></span>ï¼Œæ¯ä¸ªç‚¹æ„å»º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">K + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> ä¸ªç‚¹ã€‚åŒå±‚çš„ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>+</mo><mi>k</mi><mo>Ã—</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">u + k \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>+</mo><mi>k</mi><mo>Ã—</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">v + k \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>â‰¤</mo><mi>k</mi><mo>â‰¤</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">0 \le k \le K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>ï¼‰ä¹‹é—´å»ºç«‹é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span> çš„è¾¹ï¼›ç›¸é‚»å±‚çš„ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>+</mo><mi>k</mi><mo>Ã—</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">u + k \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>+</mo><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">v + (k + 1) \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>ï¼Œå»ºç«‹é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>w</mi><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{w}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0404em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> çš„è¾¹ï¼Œè¡¨ç¤ºè¿™æ¡è¾¹ä¸Šä½¿ç”¨ä¸€æ¬¡ç¬¦å¡ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; pii;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">3010</span>, M = <span class="hljs-number">1e6</span> + <span class="hljs-number">10</span>, inf = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-type">int</span> h[N], e[M], ne[M], w[M], idx; <span class="hljs-comment">// é“¾å¼å‰å‘æ˜Ÿ</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">int</span> c)</span></span>&#123;<br>    e[ ++ idx] = b, ne[idx] = h[a], w[idx] = c, h[a] = idx;<br>&#125;<br><br><span class="hljs-type">int</span> n, m, K, dist[N];<br><span class="hljs-type">bool</span> st[N]; <br><br><span class="hljs-comment">// å †ä¼˜åŒ– dijkstra</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dijkstra</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">memset</span>(dist, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> dist);<br>    dist[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>    priority_queue&lt;pii, vector&lt;pii&gt;, greater&lt;pii&gt; &gt; q;<br>    q.<span class="hljs-built_in">push</span>(<span class="hljs-built_in">make_pair</span>(dist[<span class="hljs-number">1</span>], <span class="hljs-number">1</span>));<br><br>    <span class="hljs-keyword">while</span>(q.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-keyword">auto</span> [d, u] = q.<span class="hljs-built_in">top</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br><br>        <span class="hljs-keyword">if</span>(st[u]) <span class="hljs-keyword">continue</span>;<br>        st[u] = <span class="hljs-literal">true</span>;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = h[u]; i; i = ne[i])&#123;<br>            <span class="hljs-type">int</span> v = e[i], c = w[i];<br>            <span class="hljs-keyword">if</span>(dist[v] &gt; d + c)&#123; <span class="hljs-comment">// å½“å‰ä¸ä½¿ç”¨ç¬¦å¡</span><br>                dist[v] = d + c;<br>                q.<span class="hljs-built_in">push</span>(<span class="hljs-built_in">make_pair</span>(dist[v], v));<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; m &gt;&gt; K;<br>    <span class="hljs-keyword">while</span>(m -- )&#123;<br>        <span class="hljs-type">int</span> u, v, c; cin &gt;&gt; u &gt;&gt; v &gt;&gt; c;  <span class="hljs-comment">// æ„å»ºåˆ†å±‚å›¾</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt;= K; k ++ ) <br>            <span class="hljs-built_in">add</span>(u + k * n, v + k * n, c), <span class="hljs-built_in">add</span>(v + k * n, u + k * n, c);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt; K; k ++ ) <br>            <span class="hljs-built_in">add</span>(u + k * n, v + (k + <span class="hljs-number">1</span>) * n, c / <span class="hljs-number">2</span>), <span class="hljs-built_in">add</span>(v + k * n, u + (k + <span class="hljs-number">1</span>) * n, c / <span class="hljs-number">2</span>);<br>    &#125;<br><br>    <span class="hljs-built_in">dijkstra</span>();<br><br>    <span class="hljs-type">int</span> res = inf;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt;= K; k ++ ) res = <span class="hljs-built_in">min</span>(res, dist[n + k * n]);<br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br/><h2 id="F-å«æ˜Ÿéœ²å¤©å’–å•¡åº§"><strong>F. å«æ˜Ÿéœ²å¤©å’–å•¡åº§</strong></h2><h3 id="é¢˜ç›®æè¿°-6"><strong>é¢˜ç›®æè¿°</strong></h3><p>å…± <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span> æ¬¡æ“ä½œï¼Œæ¯æ¬¡æ“ä½œåŒ…å«ä¸€ä¸ªæ—¥æœŸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>ã€ä¸€ä¸ªå¥¶ç‰›ç¼–å· <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>ï¼Œä»¥åŠä¸€ä¸ªäº§å¥¶å˜åŒ–é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>ã€‚éœ€è¦ç»´æŠ¤æ‰€æœ‰å¥¶ç‰›ä¸­æœ€å¤§äº§å¥¶é‡å¥¶ç‰›çš„ç¼–å·ï¼ˆå¥¶ç‰›çš„æ•°é‡æœªçŸ¥ï¼‰ã€‚æ±‚å‡ºæ‰€æœ‰æ“ä½œç»“æŸåä¸€å…±ä¿®æ”¹æœ€å¤§äº§å¥¶é‡å¥¶ç‰›çš„ç¼–å·çš„æ¬¡æ•°ã€‚<a href="https://www.luogu.com.cn/problem/T409117">ã€ŒYAC Round 1ã€å«æ˜Ÿéœ²å¤©å’–å•¡åº§</a></p><h3 id="è§£é¢˜æ€è·¯-ï¼ˆçº¿æ®µæ ‘ï¼‰"><strong>è§£é¢˜æ€è·¯ ï¼ˆçº¿æ®µæ ‘ï¼‰</strong></h3><p>æˆ‘ä»¬å¯ä»¥ç”¨ <strong>çº¿æ®µæ ‘</strong> æ¥ç»´æŠ¤æ‰€æœ‰å¥¶ç‰›çš„æœ€å¤§å€¼ä»¥åŠæœ€å¤§å€¼å¯¹åº”çš„ç¼–å·ã€‚</p><p>ç”±äºæ“ä½œçš„æ—¥æœŸæ˜¯ä¹±åºçš„ï¼Œæ•…æˆ‘ä»¬éœ€è¦å…ˆæ ¹æ®æ“ä½œçš„æ—¥æœŸå¯¹æ“ä½œè¿›è¡Œæ’åºã€‚ä½†æ˜¯ï¼Œ<strong>å¥¶ç‰›çš„æ•°é‡æ˜¯æœªçŸ¥çš„ï¼Œè€Œä¸”é¢˜ä¸­è¯´æ˜ä¸€å®šå­˜åœ¨è‹¥å¹²å¥¶ç‰›äº§å¥¶é‡ä¿æŒåœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span></strong>ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦å¢åŠ ä¸€ä¸ªè™šæ‹Ÿçš„æ“ä½œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{0, 0, 0\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">}</span></span></span></span>ï¼Œé¢„å…ˆåŠ å…¥ä¸€ä¸ªäº§å¥¶é‡ä¸å˜çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> å·å¥¶ç‰›ã€‚</p><p>å¥¶ç‰›ç¼–å·èŒƒå›´ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1, 10^9]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>ï¼Œä½†æ˜¯æ“ä½œæ•°é‡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1, 10^6]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>ï¼Œä¸ºäº†ç»´æŠ¤å¥¶ç‰›åŒºé—´ï¼Œéœ€è¦å¯¹å¥¶ç‰›ç¼–å·è¿›è¡Œç¦»æ•£åŒ–ã€‚</p><p>å¯¹äºç»´æŠ¤æœ€å¤§äº§å¥¶é‡å¥¶ç‰›çš„ç¼–å·ï¼Œæˆ‘ä»¬ä¸ä»…éœ€è¦ç”¨çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´æœ€å€¼å’Œå¯¹åº”ç¼–å·ï¼Œè¿˜éœ€è¦ç»´æŠ¤æœ€å¤§äº§å¥¶é‡å¥¶ç‰›çš„æ•°é‡ï¼Œ<strong>å› ä¸ºé¢˜ä¸­è¡¨æ˜ï¼Œå½“æœ‰è‹¥å¹²å¤´å¥¶ç‰›çš„äº§å¥¶é‡æœ€é«˜ï¼Œéœ€è¦å±•ç¤º æ‰€æœ‰ çš„æœ€é«˜äº§å¥¶é‡å¥¶ç‰›çš„ç¼–å·ã€‚</strong></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¿®æ”¹å¥¶ç‰›ç¼–å·æ“ä½œæ¶‰åŠä¸¤ç§æƒ…å†µï¼š</p><ul><li><p>æœ€å¤§å€¼å¯¹åº”çš„å¥¶ç‰›ç¼–å·å˜åŒ–ï¼ˆæœ‰å¯èƒ½æ˜¯æœ‰å…¶ä»–å¥¶ç‰›äº§å¥¶é‡å¢åŠ è¶…è¿‡äº†å½“å‰å¥¶ç‰›ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯å½“å‰å¥¶ç‰›äº§å¥¶é‡å‡å°‘è¢«å…¶ä»–å¥¶ç‰›è¶…è¶Šï¼‰</p></li><li><p>æœ€å¤§å€¼å¯¹åº”çš„å¥¶ç‰›æ•°é‡å¢åŠ ï¼ˆæœ‰å…¶ä»–å¥¶ç‰›äº§å¥¶é‡å¢åŠ ï¼Œç„¶åå’Œå½“å‰æœ€å¤§äº§å¥¶é‡å¹¶åˆ—ï¼‰</p></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ios ios::sync_with_stdio(false), cin.tie(0), cout.tie(0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ls (u &lt;&lt; 1)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> rs (u &lt;&lt; 1 | 1)</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N =  <span class="hljs-number">1e6</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">qu</span>&#123;<span class="hljs-type">int</span> t, id, d;&#125;;<br>vector&lt;qu&gt; ques;   <span class="hljs-comment">// æ“ä½œ</span><br><span class="hljs-type">int</span> n, g; <span class="hljs-comment">// g ä¸ºå¥¶ç‰›åˆå§‹äº§å¥¶é‡ </span><br><br>vector&lt;<span class="hljs-type">int</span>&gt; v;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">lower_bound</span>(v.<span class="hljs-built_in">begin</span>(), v.<span class="hljs-built_in">end</span>(), x) - v.<span class="hljs-built_in">begin</span>();&#125;<br><br><span class="hljs-type">int</span> mx[N &lt;&lt; <span class="hljs-number">2</span>], cnt[N &lt;&lt; <span class="hljs-number">2</span>], id[N &lt;&lt; <span class="hljs-number">2</span>]; <span class="hljs-comment">// çº¿æ®µæ ‘</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">pushup</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(mx[ls] &gt; mx[rs])&#123;  <span class="hljs-comment">// å·¦è¾¹çš„æœ€å€¼æ¯”å³è¾¹çš„å¤§</span><br>        mx[u] = mx[ls];<br>        cnt[u] = cnt[ls];<br>        id[u] = id[ls];<br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(mx[ls] &lt; mx[rs])&#123;  <span class="hljs-comment">// å³è¾¹çš„æœ€å€¼æ¯”å·¦è¾¹çš„å¤§</span><br>        mx[u] = mx[rs];<br>        cnt[u] = cnt[rs];<br>        id[u] = id[rs];      <br>    &#125;<span class="hljs-keyword">else</span>&#123; <span class="hljs-comment">// ä¸¤è¾¹æœ€å€¼ä¸€æ ·å¤§</span><br>        mx[u] = mx[ls];<br>        cnt[u] = cnt[ls] + cnt[rs];<br>        id[u] = id[ls];     <br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">build</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r)</span></span>&#123;<br>    mx[u] = g;<br>    <span class="hljs-keyword">if</span>(l == r)&#123;cnt[u] = <span class="hljs-number">1</span>, id[u] = l; <span class="hljs-keyword">return</span>;&#125;<br>    <span class="hljs-type">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>;<br>    <span class="hljs-built_in">build</span>(ls, l, mid);<br>    <span class="hljs-built_in">build</span>(rs, mid + <span class="hljs-number">1</span>, r);<br>    <span class="hljs-built_in">pushup</span>(u, l, r);<br>&#125;<br><br><span class="hljs-comment">// å•ç‚¹ä¿®æ”¹</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">update</span><span class="hljs-params">(<span class="hljs-type">int</span> u, <span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r, <span class="hljs-type">int</span> k, <span class="hljs-type">int</span> d)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(l == r)&#123;mx[u] += d; <span class="hljs-keyword">return</span>;&#125;<br>    <span class="hljs-type">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span>(k &lt;= mid) <span class="hljs-built_in">update</span>(ls, l, mid, k, d);<br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">update</span>(rs, mid + <span class="hljs-number">1</span>, r, k, d);<br>    <span class="hljs-built_in">pushup</span>(u, l, r);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    cin &gt;&gt; n &gt;&gt; g;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>, t, id, d; i &lt;= n; i ++ )&#123;<br>        string s; cin &gt;&gt; t &gt;&gt; id &gt;&gt; s;<br>        d = (s[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;+&#x27;</span> ? <span class="hljs-built_in">stoi</span>(s.<span class="hljs-built_in">substr</span>(<span class="hljs-number">1</span>)) : <span class="hljs-built_in">stoi</span>(s)); <span class="hljs-comment">// stoiå¯ä»¥è¯†åˆ«è´Ÿæ•°</span><br>        ques.<span class="hljs-built_in">push_back</span>(qu&#123;t, id, d&#125;);<br>        v.<span class="hljs-built_in">push_back</span>(id);<br>    &#125;<br>    ques.<span class="hljs-built_in">push_back</span>(qu&#123;<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>&#125;); <span class="hljs-comment">// è™šæ‹Ÿæ“ä½œ</span><br>    v.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">0</span>);   <span class="hljs-comment">// äº§å¥¶é‡ä¸å˜çš„å¥¶ç‰›</span><br><br>    <span class="hljs-built_in">sort</span>(ques.<span class="hljs-built_in">begin</span>(), ques.<span class="hljs-built_in">end</span>(), [](qu &amp;a, qu &amp;b)&#123;<br>        <span class="hljs-keyword">return</span> a.t &lt; b.t;  <span class="hljs-comment">// æŒ‰ç…§æ—¥æœŸæ’åº</span><br>    &#125;);<br><br>    <span class="hljs-built_in">sort</span>(v.<span class="hljs-built_in">begin</span>(), v.<span class="hljs-built_in">end</span>());<br>    v.<span class="hljs-built_in">erase</span>(<span class="hljs-built_in">unique</span>(v.<span class="hljs-built_in">begin</span>(), v.<span class="hljs-built_in">end</span>()), v.<span class="hljs-built_in">end</span>()); <span class="hljs-comment">// æ’åº å»é‡ ç¦»æ•£åŒ–</span><br><br>    <span class="hljs-type">int</span> m = (<span class="hljs-type">int</span>)v.<span class="hljs-built_in">size</span>();<br>    <span class="hljs-built_in">build</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, m);   <span class="hljs-comment">// æ„å»ºåŒºé—´ [1, m] çš„çº¿æ®µæ ‘</span><br><br>    <span class="hljs-type">int</span> pre_id, pre_cnt, res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;p : ques)&#123;<br>        pre_id = id[<span class="hljs-number">1</span>], pre_cnt = cnt[<span class="hljs-number">1</span>];  <span class="hljs-comment">// å½“å‰çš„æœ€å¤§å€¼ç¼–å·ä»¥åŠæœ€å¤§å€¼æ•°é‡</span><br><br>        <span class="hljs-built_in">update</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, m, <span class="hljs-built_in">find</span>(p.id), p.d); <span class="hljs-comment">// æ›´æ–°äº§å¥¶é‡å˜åŒ–</span><br><br>        <span class="hljs-type">int</span> now_id = id[<span class="hljs-number">1</span>], now_cnt = cnt[<span class="hljs-number">1</span>];  <span class="hljs-comment">// æ›´æ–°åçš„æœ€å¤§å€¼ç¼–å·å’Œæœ€å¤§å€¼æ•°é‡</span><br>        res += (now_id != pre_id || now_cnt != pre_cnt); <span class="hljs-comment">// ä¸¤ç§æƒ…å†µ éœ€è¦ä¿®æ”¹</span><br>    &#125;<br><br>    cout &lt;&lt; res &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å’å”±å…‰èŠ’</category>
      
      <category>YAC æ‰¬å·å¤§å­¦ç®—æ³•ç»ƒä¹ èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>ç®—æ³•ç«èµ›</tag>
      
      <tag>Luogu</tag>
      
      <tag>YAC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MarisaMagic&#39;s Blog åšå®¢æ¨¡æ¿</title>
    <link href="/2024/12/13/hello-world/"/>
    <url>/2024/12/13/hello-world/</url>
    
    <content type="html"><![CDATA[<h1>é›¾é›¨é­”æ³•åº—</h1><p><a id='km'></a></p><h2 id="Kirisame-Marisa">Kirisame Marisa</h2><h3 id="MarisaMagic">MarisaMagic</h3><p>Hello! æˆ‘æ˜¯ MarisaMagic, å¾ˆé«˜å…´è§åˆ°ä½ ~</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mtext>ä¸‡è½¶è½©</mtext><mo stretchy="false">)</mo><mo>=</mo><mfrac><msubsup><mi>C</mi><mn>1</mn><mn>1</mn></msubsup><msubsup><mi>C</mi><mn>2</mn><mn>2</mn></msubsup></mfrac></mrow><annotation encoding="application/x-tex">P(\text{ä¸‡è½¶è½©}) = \frac{C_{1}^{1}}{C_{2}^{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord text"><span class="mord cjk_fallback">ä¸‡è½¶è½©</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4434em;vertical-align:-0.9523em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9523em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/*        MarisaMagic        */</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">marisa</span><span class="hljs-params">()</span></span>&#123;<br>    <br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios;<br><br>    <span class="hljs-type">int</span> T = <span class="hljs-number">1</span>; <span class="hljs-comment">//cin &gt;&gt; T;</span><br>    <span class="hljs-keyword">while</span>(T -- ) <span class="hljs-built_in">marisa</span>();<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><a href="#km">kirisame marisa</a></p><h2 id="hexo-åšå®¢æ›´æ–°æ“ä½œ">hexo åšå®¢æ›´æ–°æ“ä½œ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ¸…é™¤ç¼“å­˜</span><br>hexo clean <br><br><span class="hljs-comment"># ç”Ÿæˆé™æ€æ–‡ä»¶ hexo generate</span><br>hexo g    <br><br><span class="hljs-comment"># éƒ¨ç½²åˆ°githubï¼Œæ›´æ–°ç½‘é¡µ hexo deploy</span><br>hexo d     <br><br><span class="hljs-comment"># å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨é¢„è§ˆ hexo server</span><br>hexo s<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ol><li><a href="https://fluid-dev.github.io/hexo-fluid-docs/guide/">Hexo Fluid ç”¨æˆ·æ‰‹å†Œ<br></a></li></ol>]]></content>
    
    
    <categories>
      
      <category>æ˜Ÿå±‘å¹»æƒ³</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>Blog</tag>
      
      <tag>Touhou</tag>
      
      <tag>Marisa</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
